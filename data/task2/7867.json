{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: TR2MTL: LLM based framework for Metric Temporal Logic Formalization of Traffic Rules\n\nPaper Abstract: \n\nPaper Section Text:\nWe aim to formalize traffic rules from unstructured text using MTL. However, we face a challenge in finding a suitable dataset to evaluate our approach. For two reasons, existing datasets and evaluation metrics and evaluation metrics -[ref]23 are not adequate for our purposes. First, to our knowledge, no legal traffic rules have been incorporated as a reference for training or testing their models. Second, they focus on LTL data, which is different from MTL. There are well-curated datasets for robotics and drone motion planning  based on LTL data. Moreover, existing datasets (even non-traffic rule datasets) have simplified and structured rules that do not require complex reasoning or inference as in traffic rule formalization.  and  offered a comprehensive codification of MTL traffic laws for intersection and interstate driving. These works are the most relevant to our requirements, and we use them as a baseline for our dataset creation. Their MTL rules are not directly applicable to us, as they are derived from multiple traffic rules of a particular subtype and depend on the legal analysis of various rule sources (StVO, VCoRT) and court decisions for specific traffic scenarios. This rule representation is helpful for the manual approach as their approach tends to capture as many traffic situations in less number of rules. However, they are unsuitable for LLM-based unstructured traffic rules to MTL translation. Datasets created for other domains (robotics and drones) are good examples of rules that can be adapted and used for manual and automated models. In addition, these MTL rules are incompatible with learning-based models such as LLMs, and methods are hard to extend to new rule sets. So, we created a new dataset of traffic rules and MTL pairs that can work with LLMs. We kept the original format and language of the legal traffic rules text with minimal preprocessing or simplification. We also incorporate a few important traffic rules from earlier works on AV planning and forecasting [ref]18,. However, the dataset does not cover some less representative or exceptional driving scenarios in great detail. A dataset of 50 traffic rules and MTL pairs was generated based on the methodology explained in  and MTL syntax described in Sec. III-A. As in , we leveraged the parsed tree structure to develop the MTL formula, allowing us to find reusable predicates that can be used for multiple formulas. Our dataset handles both general driving rules and rules with exceptions where the current rules are not valid due to new situations on the road, such as emergency vehicles’ right of way. Legal text traffic rules were derived from VCoRT (for general driving rules) and the StVO (for country-specific rules, Germany in this case). Some preprocessing is given to the rules to give the phrases concrete meaning and remove the rules’ ambiguity. As per StVO §(3)(1), a vehicle may only drive at a speed that allows for constant control. In formal logic and automated systems, ambiguous phrases like under control require definition. We preprocess such phrases with more concrete terms, such as speed less than m​a​x​_​s​p​e​e​d​_​l​i​m​i​t𝑚𝑎𝑥_𝑠𝑝𝑒𝑒𝑑_𝑙𝑖𝑚𝑖𝑡max\\_speed\\_limit, to avoid multiple user-dependent interpretations. Some rules refer to other rules in the legal text, so we preprocessed them to make them clearer and more complete by merging the fragments across the legal text. We minimally preprocessed the rules to preserve their complexity so that the model can handle unstructured natural language rules. We paid special attention to capturing the complex linguistic semantics of the unstructured natural language text. This enabled us to cover rules with unclear implications, rules with conditions that were fulfilled in the past and have ramifications in the present, long or multiple sentences with complex pronouns and verb structures, and rules where it was not clear whether the conditions were connected by logical “OR” or logical “AND”. Our datasets also uses predicates and arguments from commonroad  and lanelet [ref]30. We assume the sensor detects objects correctly, and a high-definition map provides information about road infrastructure. TR2MTL can be adapted to other dataset structures by providing a list of available predicates and arguments based on the information of the other datasets. Our goal is to provide a framework and a dataset for automatically translating traffic rules into MTL through LLM and to evaluate how well TR2MTL can encode both temporal operators and their timing constraints. Table I shows our dataset’s natural language traffic rules and their corresponding MTL. As evident from the data sample in Table I, traffic rules exhibit a distinct linguistic structure that sets them apart from other temporal logic datasets. These rules tend to be longer and more complex. For instance, consider sample rule 2 in Table I: “At roundabouts and crossroads, if there is a pedestrian crossing the street or a cyclist on the left of the ego vehicle, then the ego vehicle must give way to the pedestrian or cyclist, unless there is a traffic sign number 205 indicating otherwise.” Upon closer examination, we observe that despite the mention of both roundabouts and crossroads in the rule, from a logical perspective, it implies a “logical OR” condition. It means that even if only one of the conditions (roundabouts or crossroads) is detected through driving sensors or map data, the rule should still be applicable. This shows the complexity that TR2MTL will face while formalizing traffic rules. Our formalized dataset and steps to reproduce traffic rules and MTL pairs can be accessed333Evaluation dataset and model prompts can be accessed here:https://github.com/kumarmanas/traffic_law_formalization. We will continue adding new traffic rules to support the growing community of researchers working at the intersection of NLP, LLMs, and rule compliance for developing safe and intelligent AVs. We acknowledge that in its current form, our dataset is more suitable for evaluation rather than for fine-tuning the model due to its small size. Nevertheless, it is a good resource for in-context learning models and trained model evaluation for AV and MTL domain.\n\nReference markers found: [23]\n\nContext windows for each [ref]:\n[ref]23: unstructured text using MTL. However, we face a challenge in finding a suitable dataset to evaluate our approach. For two reasons, existing datasets and evaluation metrics and evaluation metrics -[ref]23 are not adequate for our purposes. First, to our knowledge, no legal traffic rules have been incorporated as a reference for training or testing their models. Second, they focus on LTL data,\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 23,\n            \"titles\": [\n                \"DeepSTL - From English Requirements to Signal Temporal Logic\",\n                \"Monitoring Algorithms for Metric Temporal Logic Specifications\",\n                \"Logics and models of real time: A survey\",\n                \"Language Models are Few-Shot Learners\",\n                \"Chain-of-thought prompting elicits reasoning in large language models\",\n                \"Planning with State Abstractions for Non-Markovian Task Specifications\",\n                \"Formalization of intersection traffic rules in temporal logic\",\n                \"Formalization of interstate traffic rules in temporal logic\",\n                \"A formally verified checker of the safe distance traffic rules for autonomous vehicles\",\n                \"Formalizing traffic rules for uncontrolled intersections\",\n                \"Formalising and monitoring traffic rules for autonomous vehicles in isabelle/hol\",\n                \"Fast decision making using ontology-based knowledge base\",\n                \"A systematic framework to identify violations of scenario-dependent driving rules in autonomous vehicle software\",\n                \"Encoding and monitoring responsibility sensitive safety rules for automated vehicles in signal temporal logic\",\n                \"Specifying safety of autonomous vehicles in signal temporal logic\",\n                \"From Specifications to Behavior: Maneuver Verification in a Semantic State Space\",\n                \"Synthesis of controllers for co-safe linear temporal logic specifications using reinforcement learning\",\n                \"Intention-aware motion planning with road rules\",\n                \"Road Traffic Law Adaptive Decision-making for Self-Driving Vehicles\",\n                \"Language Models as Zero-Shot Planners: Extracting Actionable Knowledge for Embodied Agents\",\n                \"ReAct: Synergizing reasoning and acting in language models\",\n                \"Semantic role assisted natural language rule formalization for intelligent vehicle\",\n                \"NL2LTL – a python package for converting natural language (NL) instructions to linear temporal logic (LTL) formulas\",\n                \"Formal Specifications from Natural Language\",\n                \"Lang2LTL: Translating natural language commands to temporal specification with large language models\",\n                \"Attention Is All You Need\",\n                \"Differentiable logic layer for rule guided trajectory prediction\",\n                \"Legal compliance checking of autonomous driving with formalized traffic rule exceptions\",\n                \"Commonroad scenario designer: An open-source toolbox for map conversion and scenario creation for autonomous vehicles\",\n                \"Lanelet2: A high-definition map framework for the future of automated driving\",\n                \"StarCoder: may the source be with you!\",\n                \"Falcon-7b\",\n                \"Crosslingual Generalization through Multitask Finetuning\",\n                \"Temporal logic formalization of marine traffic rules\",\n                \"Data-Efficient Learning of Natural Language to Linear Temporal Logic Translators for Robot Task Specification\",\n                \"Parallel Context Windows for Large Language Models\",\n                \"Generated Reference Title 36 for [ref]23\",\n                \"Generated Reference Title 37 for [ref]23\",\n                \"Generated Reference Title 38 for [ref]23\",\n                \"Generated Reference Title 39 for [ref]23\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]23 based on the context and research area of TR2MTL: LLM based framework for Metric Temporal Logic Formalization of Traffic Rules. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}