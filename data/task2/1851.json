{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Morpho-evolution with learning using a controller archive as an inheritance mechanism\n\nPaper Abstract: \n\nPaper Section Text:\nAdvancing previous work in the domain of body-brain evolution, we proposed a method to evolve robots in a rich morphological space that includes a variety of sensors and actuators and can realise skeletons with diverse forms and sizes. Hence, a considerably more diverse range of body-plans can be produced in this space than in previous work that either uses modular systems  or spaces in which the components have common control mechanisms . The richer space increases the likelihood that a controller produced via evolutionary operators will not match a new body-plan. Although using a generative (morphology-independent) encoding can address the inheritance issue, the time-complexity associated with these methods can be prohibitive when working with physical robots. To address this we proposed the use of an external archive that stores a learned controller associated with a ‘type’ of robot. As described in section V, we have demonstrated that the archive significantly improves the quality of the solution and the efficiency in evolving a body-plan capable of solving multiple tasks. The role of the archive and the various components of the framework used in leading to this result are discussed below. Each cell of the controller archive stores the best controller learned during an individual lifetime. The archive thus represents a history of knowledge discovered in previous generations that can be passed to future generations. It therefore acts as a novel form of inheritance. In the sense that it stores information learned during an individual lifetime, it shares characteristics with Lamarckian artificial evolutionary systems . Note that the tuple defining a ‘type’ is deliberately simple. However, it should be clear that many different body-plans can be mapped to each single cell, given that for any given combination of sensors and actuators, the robot-skeleton they are attached to can vary enormously in shape and size, and the configuration of components can also vary. Given this variation, it might be expected that inheriting a controller of the correct ‘type’ would not necessarily bring much benefit. However, it is clear from figure 5 that shows the best and initial task-performance, that starting from a controller from the archive brings a significant advantage. Interestingly, this suggests that there is some generalisation of controllers across a range of body-plans. The results shown in the second row of figure 5 show that inheriting from the archive bootstraps the learning process, and the size of this effect increases in magnitude as the generations progress. It would of course be possible to define each cell using a higher degree of granularity, although it is reasonable to assume there is a balance to be struck in not making the archive too granular (which at the extreme would map every robot to an individual cell). Another way to approach this would be to store multiple controllers per cell, and either try them all, select one at random, or use a clustering or species system to select the most suitable one. Also, increasing the granularity of the archive requires defining an appropriate\nmorphological descriptor. This is not an easy task. In one of our previous works , different morphological descriptors were studied in the context of novelty search, designed to reflect different types of control (e.g. due to symmetry).\nThe results shows that in fact the most simple descriptor that simply counted components was better in producing a greater diversity of body-plans. Recall that the framework consists of two components: an MEA that learns body-plans and a learning algorithm based on an evolutionary strategy that learns controllers. The former is selected for its ability to explore a diverse space of plans and based on previous work . The selection of NIP-ES as the learner is deliberate in that this algorithm demonstrates high exploration capabilities. This is essential as the learner might have to start from scratch if no controller is available in the archive, or a selected controller might not be well adapted to a new body. In contrast previous work which has used learning as a mechanism to enhance a controller selected by evolution (e.g. ) can afford to be much more exploitative. Despite the diversity produced by MCME, the successful robots are all of the same ‘type’, mostly wheels, a few sensors, and almost no joints. In fact MELAI, fall into the local optima of the robots for which it is easy to learn a controller. This issue is a common issue in evolutionary robotics and it is even accentuated by the joint optimisation of body-plan and controllers. In the work of Cheney et al. [ref]18, this issue is explained by the fact that promising body-plans for which it takes longer to learn a controller are dropped by the EA. One of their latter works  proposed the morphological innovation protection mechanism. Each body-plan has an attribute corresponding to their age which increases at each generation. In addition of the task-performance, the EA selects the youngest body-plans and thus protect new body-plan which would needs more time to learn a controller. In MELAI, this solution could be implemented by attributing bigger budgets to the learning process for younger body-plans and decrease their budgets while they age. Another possible reason for the premature convergence in such local optimum is the generational aspect of the EA. At each generation the selection mechanism is applied to the whole population, thus, a high performing solution will often invade completely the population. The asynchronous parallel evolution (APE) proposed in the work of Gupta et al.  is a possible solution, indeed, they observe as a side effect, a diversity in the final high performing body-plans. APE performs tournament selection on small groups of four individuals asynchronously. So, a low performing robots could be preserved longer because it would not be always confronted to the high performing individuals. Given the importance of the learning loop just discussed when jointly optimising body-plans and controllers, it is natural then to discuss how a computational budget should be balanced between the outer evolutionary loop and the inner learning loop. The results shown in figure 8 shed some light on this by varying the budget assigned to the learning from 100 to 200 evaluations. The smaller learning budget delivers a faster bootstrap in both environments. It is also clear that using the archive results in lower variance, particularly noticeable when using the smallest learning budgets. However, the budget of 200 evaluations gives more consistent results over the environments and the two variants. Also, 200 evaluations is the necessary minimum budget to have NIP-ES to its full potential  (see supplementary materials). So, the choice of budget is dependant on the learning algorithm used in MELAI. Also, it is worth remarking that the decision regarding how to split this budget is influenced by whether one is working in simulation or on physical robots: in simulation, generating a body-plan has negligible cost whereas in reality, producing a physical robot can take weeks . In contrast, evaluations are cheap in both environments hence this may influence the choice. Finally, many design choices made in this work are aiming to match the present method with our physical system . In particular, NIPES and the controller archive reduce the number of evaluations needed to reach a satisfactory solution. Of course, the present framework cannot be applied directly on the real robotic platform. Indeed, on the photo-taxis task in the arena, MELAI needs about 15000 evaluations shared among 100 body-plans tested to reach a robots fulfilling the task. In future work, hybrid methods using both simulated and real robots will be investigated.\n\nReference markers found: [18]\n\nContext windows for each [ref]:\n[ref]18: is easy to learn a controller. This issue is a common issue in evolutionary robotics and it is even accentuated by the joint optimisation of body-plan and controllers. In the work of Cheney et al. [ref]18, this issue is explained by the fact that promising body-plans for which it takes longer to learn a controller are dropped by the EA. One of their latter works  proposed the morphological\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 18,\n            \"titles\": [\n                \"Scalable Co-Optimization of Morphology and Control in Embodied Machines\",\n                \"Intelligence without reason\",\n                \"How the body shapes the way we think: a new view of intelligence\",\n                \"A scalable pipeline for designing reconfigurable organisms\",\n                \"Evolutionary developmental robotics: Improving morphology and control of physical robots\",\n                \"Compositional pattern producing networks: A novel abstraction of development\",\n                \"On pros and cons of evolving topologies with novelty search\",\n                \"The triangle of life: Evolving robots in real-time and real-space\",\n                \"If it evolves it needs to learn\",\n                \"Bootstrapping artificial evolution to design robots for autonomous fabrication\",\n                \"Sample and time efficient policy learning with cma-es and bayesian optimisation\",\n                \"Brains, bodies, and beyond: Competitive co-evolution of robot controllers, morphologies and environments\",\n                \"Overcoming initial convergence in multi-objective evolution of robot control and morphology using a two-phase approach\",\n                \"Real-World Evolution Adapts Robot Morphology and Control to Hardware Limitations\",\n                \"Environmental Adaptation of Robot Morphology and Control through Real-world Evolution\",\n                \"Design of a walking machine structure using evolutionary strategies\",\n                \"Embodied Intelligence via Learning and Evolution\",\n                \"Data-efficient learning of morphology and controller for a microrobot\",\n                \"On the difficulty of co-optimizing morphology and control in evolved virtual creatures\",\n                \"Evolving neural networks through augmenting topologies\",\n                \"Evolving 3d morphology and behavior by competition\",\n                \"Generative representations for the automated design of modular physical robots\",\n                \"Search space analysis of evolvable robot morphologies\",\n                \"Evolving-controllers versus learning-controllers for morphologically evolvable robots\",\n                \"Lamarckian evolution of simulated modular robots\",\n                \"Learning with case-injected genetic algorithms\",\n                \"Memes as building blocks: a case study on evolutionary optimization+ transfer learning for routing problems\",\n                \"Illuminating search spaces by mapping elites\",\n                \"A comparison of three methods for selecting values of input variables in the analysis of output from a computer code\",\n                \"Hardware design for autonomous robot evolution\",\n                \"Finding structure in time\",\n                \"On a test of whether one of two random variables is stochastically larger than the other\",\n                \"A restart cma evolution strategy with increasing population size\",\n                \"The cma evolution strategy: a comparing review\",\n                \"The cma evolution strategy: A tutorial\",\n                \"Benchmarking a bi-population cma-es on the bbob-2009 function testbed\",\n                \"Abandoning objectives: Evolution through the search for novelty alone\",\n                \"Generated Reference Title 37 for [ref]18\",\n                \"Generated Reference Title 38 for [ref]18\",\n                \"Generated Reference Title 39 for [ref]18\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]18 based on the context and research area of Morpho-evolution with learning using a controller archive as an inheritance mechanism. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}