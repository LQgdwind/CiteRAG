{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Temporal Kernel Consistency for Blind Video Super-Resolution\n\nPaper Abstract: \n\nPaper Section Text:\nTemporal Kernel Estimation.\nWe first studied the effectiveness of taking multiple frames into account for kernel estimation.\nIn other words, instead of estimating kernels individually for each frame, we leveraged our key insight that the downsampling kernels of frames within a video are temporally consistent to achieve a faster and more accurate kernel estimation for videos.\nTo this end, we modified the estimator to take in multiple LR frames, {yt+i}i=−Ni=Nsubscriptsuperscriptsubscript𝑦𝑡𝑖𝑖𝑁𝑖𝑁\\{y_{t+i}\\}^{i=N}_{i=-N}, and generated their corresponding estimated kernels, {k^t+i(j)}i=−Ni=Nsubscriptsuperscriptsubscriptsuperscript^𝑘𝑗𝑡𝑖𝑖𝑁𝑖𝑁\\{\\hat{k}^{(j)}_{t+i}\\}^{i=N}_{i=-N}.\nWe then utilized the existing channel attention block in DAN by adopting an early fusion approach, which merges information at the beginning of the block, to exploit the inter-channel relationships not only between basic and conditional inputs, but also among temporal inputs.\nSpecifically, the features of the HR frames are concatenated with the LR features in every CRB in order to leverage the existing structure of DAN’s estimator without adding additional channels or layers as shown in the supplementary material (s.m. Fig. 1). We experimented with different number of input frames on the estimator, labelled as Est-α𝛼\\alpha where α𝛼\\alpha is the number of frames used for kernel estimation.\nLikewise, we labelled β𝛽\\beta as the number of frames used for restoration, Res-β𝛽\\beta.\nFor a fair comparison, here we used DAN’s restorer, β=1𝛽1\\beta=1, which is single-frame and therefore not including our adopted EDVR components.\nFig. 6 shows the distribution of kernel estimation errors of the aforementioned models in terms of the absolute sum of PCA difference between the estimated kernels and their respective ground truth kernels for all frames in each sequence found in REDS10.\nWe observed that independent kernel estimation per-frame can lead to a larger variance and numerous outliers as compared to temporal kernel estimation.\nNotably, temporal kernel estimation results in, on average, more accurate kernels for videos with high dynamicity, i.e. low kernel temporal consistency, while performs similarly for videos with high kernel temporal consistency.\nThe performance increase in kernel estimation, however, did not improve performance significantly in video restoration as shown in Table 1.\nThis phenomenon is also observed in recent blind iterative image SR works [ref]12  and these works reported that this was due to the restorer’s robustness to the kernel estimation errors of the estimator since they were jointly trained.\nAlthough having a more accurate kernel estimation did not drastically impact a single-frame video restoration performance, we show that it is essential at improving the performance of a multi-frame restoration approach. Incorporating Temporal Kernels for MFSR.\nThe performance gain of utilizing the temporal information of multiple frames is dependent on the accuracy of its motion estimation; an inaccurate flow can result in misaligned frames after motion compensation and thus artifacts in the restored video [ref]35  [ref]36 .\nAs shown in Sec. 5, performing motion compensation under the assumption of a fixed SR kernel directly on real-world videos can result in regular artifacts in the warped frames.\nTo mitigate this, instead of following the convention of employing motion compensation on the LR frames or features directly, we performed motion compensation on the LR frames after considering their corresponding kernels.\nSpecifically, we utilized the feature maps at the last restorer iteration as shown in Fig. 5 which embed both LR frame and the corresponding kernel features from the estimator, and then adopted EDVR for temporal alignment, fusion, and restoration as mentioned in Sec. 6.1.\nThis approach mitigates the problem of inaccurate motion compensation caused by kernel variation in real-world videos, but the restoration performance may still depend on the accuracy of estimated kernels; errors in kernel estimation would propagate and result in inaccurate motion compensation. To verify this, we first ran our multi-frame restorer, β={3,5}𝛽35\\beta=\\{3,5\\}, with a single-frame estimator, α=1𝛼1\\alpha=1 and compared it with running the multi-frame restorer together with the multi-frame estimator.\nThe results are shown in Table 1.\nAs expected, having a multi-frame restorer resulted in an improvement in video restoration similar to that of previous works     [ref]35.\nHowever, these per-frame estimator MFSR models did not perform as well as their temporal estimator counterparts.\nIn particular, although our per-frame estimator MFSR model utilized information from 555 frames (Est-1 + Res-5) to restore each frame, it did not outperform our temporal estimator MFSR model that only exploited information from 333 frames (Est-3 + Res-3).\nHence, we can conclude that the kernel mismatch errors incurred during kernel estimation propagated through the implicit motion compensation module of EDVR, affecting temporal alignment, fusion, and thus restoration.\nIn other words, more accurate estimated kernels through the temporal kernel estimator enable the multi-frame restorer to leverage temporal frame information better.\nTherefore, the interplay between accurate kernel estimation and motion compensation is the key to utilize temporal kernel consistency for video restoration. Comparisons with Previous Works.\nWe compared our approach, with existing works on both our test set REDS10 and real-world videos taken from the Something-Something dataset.\nSpecifically, we considered state-of-the-art MFSR methods, TDAN [ref]36 and EDVR , blind image-based SR methods, IKC [ref]12 and DAN , and a recently proposed blind MSFR approach, DBVSR . From the quantitative and qualitative comparisons based on REDS10 (Table. 2 & Fig. 7) and real-world qualitative examples (Fig. 8), we observe that existing MFSR approaches are lacking due to kernel mismatch, affecting both motion compensation and video restoration as shown in Sec. 5.\nBoth TDAN and EDVR, in particular, were trained using the fixed bicubic degradation assumption and DBVSR assumed a fixed temporally uniform kernel.\nBlind SISR approaches, on the other hand, restore each frame independently and hence perform slightly better than existing MFSR approaches.\nOur approach, which exploits kernel temporal consistency for accurate kernel estimation and mitigates the effects of kernel mismatch on motion compensation, leads to a dominant solution for real-world video restoration.\nWe provided additional examples in the supplementary material (s.m. Fig. 5 & Fig. 6).\n\nReference markers found: [12]\n\nContext windows for each [ref]:\n[ref]12: increase in kernel estimation, however, did not improve performance significantly in video restoration as shown in Table 1.\nThis phenomenon is also observed in recent blind iterative image SR works [ref]12  and these works reported that this was due to the restorer’s robustness to the kernel estimation errors of the estimator since they were jointly trained.\nAlthough having a more accurate\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 12,\n            \"titles\": [\n                \"Closed-loop Matters: Dual Regression Networks for Single Image Super-Resolution\",\n                \"Fast, Accurate, and Lightweight Super-Resolution with Cascading Residual Network\",\n                \"A database and evaluation methodology for optical flow\",\n                \"Blind Super-Resolution Kernel Estimation using an Internal-GAN\",\n                \"Toward real-world single image super-resolution: A new benchmark and a new model\",\n                \"Deformable convolutional networks\",\n                \"Image super-resolution using deep convolutional networks\",\n                \"Accelerating the Super-Resolution Convolutional Neural Network\",\n                \"Accurate blur models vs. image priors in single image super-resolution\",\n                \"Fast and robust multiframe super resolution\",\n                \"Generative adversarial nets\",\n                \"The “something something” video database for learning and evaluating visual common sense\",\n                \"Blind Super-Resolution With Iterative Kernel Correction\",\n                \"FlowNet 2.0: Evolution of Optical Flow Estimation with Deep Networks\",\n                \"Spatial Transformer Networks\",\n                \"Deep video super-resolution network using dynamic upsampling filters without explicit motion compensation\",\n                \"Video super-resolution with convolutional neural networks\",\n                \"Adam: A method for stochastic optimization\",\n                \"Journey Towards Tiny Perceptual Super-Resolution\",\n                \"Video super-resolution via deep draft-ensemble learning\",\n                \"On bayesian adaptive video super resolution\",\n                \"Robust video super-resolution with learned temporal dynamics\",\n                \"Unfolding the alternating optimization for blind super resolution\",\n                \"Handling motion blur in multi-frame super-resolution\",\n                \"End-to-End Learning of Video Super-Resolution with Motion Compensation\",\n                \"Nonparametric blind super-resolution\",\n                \"Ntire 2019 challenge on video deblurring and super-resolution: Dataset and study\",\n                \"Optical flow estimation using a spatial pyramid network\",\n                \"Frame-recurrent video super-resolution\",\n                \"Deep blind video super-resolution\",\n                \"Real-Time Single Image and Video Super-Resolution Using an Efficient Sub-Pixel Convolutional Neural Network\",\n                \"“Zero-Shot” Super-Resolution using Deep Internal Learning\",\n                \"Efficient Residual Dense Block Search for Image Super-Resolution\",\n                \"Pwc-net: Cnns for optical flow using pyramid, warping, and cost volume\",\n                \"Detail-revealing Deep Video Super-resolution\",\n                \"TDAN: Temporally Deformable Alignment Network for Video Super-Resolution\",\n                \"EDVR: Video Restoration with Enhanced Deformable Convolutional Networks\",\n                \"Image quality assessment: from error visibility to structural similarity\",\n                \"Zooming Slow-Mo: Fast and Accurate One-Stage Space-Time Video Super-Resolution\",\n                \"Video Enhancement with Task-Oriented Flow\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]12 based on the context and research area of Temporal Kernel Consistency for Blind Video Super-Resolution. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}