{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Temporalising Unique Characterisability and Learnability of Ontology-Mediated Queries\n\nPaper Abstract: \n\nPaper Section Text:\nBy a relational signature we mean in this paper any non-empty finite set, Ïƒğœ\\sigma, of unary and binary predicate symbols, typically denoted A,Bğ´ğµA,B and P,Rğ‘ƒğ‘…P,R, respectively. A Ïƒğœ\\sigma-data instance, ğ’œğ’œ\\mathcal{A}, is any non-empty finite set of atoms of the form Aâ€‹(a)ğ´ğ‘A(a) and Pâ€‹(a,b)ğ‘ƒğ‘ğ‘P(a,b) with A,PâˆˆÏƒğ´ğ‘ƒğœA,P\\in\\sigma and individual names (or constants) a,bğ‘ğ‘a,b, and also âŠ¤(a)topğ‘\\top(a), which simply says that the domain contains the individual ağ‘a. We denote by indâ€‹(ğ’œ)indğ’œ\\textit{ind}(\\mathcal{A}) the set of individual names inÂ ğ’œğ’œ\\mathcal{A} and by Pâˆ’superscriptğ‘ƒP^{-} the inverse of Pğ‘ƒP (with Pâˆ’âˆ’=Psuperscriptğ‘ƒabsentğ‘ƒP^{--}=P), assuming that Pâˆ’â€‹(a,b)âˆˆğ’œsuperscriptğ‘ƒğ‘ğ‘ğ’œP^{-}(a,b)\\in\\mathcal{A} iff Pâ€‹(b,a)âˆˆğ’œğ‘ƒğ‘ğ‘ğ’œP(b,a)\\in\\mathcal{A}. We assume that Sğ‘†S ranges over binary predicates and their inverses. A pointed data instance is a pair (ğ’œ,a)ğ’œğ‘(\\mathcal{A},a) with aâˆˆindâ€‹(ğ’œ)ğ‘indğ’œa\\in\\textit{ind}(\\mathcal{A}). In general, an ontology, ğ’ªğ’ª\\mathcal{O}, is a finite set of first-order (FO) sentences over the given signature Ïƒğœ\\sigma. Ontologies and data instances are interpreted in structures â„=(Î”â„,â‹…â„)â„superscriptÎ”â„superscriptâ‹…â„\\mathcal{I}=(\\Delta^{\\mathcal{I}},\\cdot^{\\mathcal{I}}) with domain Î”â„â‰ âˆ…superscriptÎ”â„\\Delta^{\\mathcal{I}}\\neq\\emptyset, Aâ„âŠ†Î”â„superscriptğ´â„superscriptÎ”â„A^{\\mathcal{I}}\\subseteq\\Delta^{\\mathcal{I}} for unary Ağ´A, Pâ„âŠ†Î”â„Ã—Î”â„superscriptğ‘ƒâ„superscriptÎ”â„superscriptÎ”â„P^{\\mathcal{I}}\\subseteq\\Delta^{\\mathcal{I}}\\times\\Delta^{\\mathcal{I}} for binary Pğ‘ƒP,\nand aâ„âˆˆÎ”â„superscriptğ‘â„superscriptÎ”â„a^{\\mathcal{I}}\\in\\Delta^{\\mathcal{I}} for individual names ağ‘a. As usual in database theory, we assume that aâ„â‰ bâ„superscriptğ‘â„superscriptğ‘â„a^{\\mathcal{I}}\\not=b^{\\mathcal{I}} for distinct a,bğ‘ğ‘a,b; moreover, to simplify notation, we adopt the standard name assumption and interpret each individual name by itself, i.e., take aâ„=asuperscriptğ‘â„ğ‘a^{\\mathcal{I}}=a. Thus, â„â„\\mathcal{I} is a model of a data instance ğ’œğ’œ\\mathcal{A} if aâˆˆAâ„ğ‘superscriptğ´â„a\\in A^{\\mathcal{I}} and (a,b)âˆˆPâ„ğ‘ğ‘superscriptğ‘ƒâ„(a,b)\\in P^{\\mathcal{I}}, for all Aâ€‹(a)âˆˆğ’œğ´ğ‘ğ’œA(a)\\in\\mathcal{A} and Pâ€‹(a,b)âˆˆğ’œğ‘ƒğ‘ğ‘ğ’œP(a,b)\\in\\mathcal{A} (remember that âŠ¤â„=Î”â„\\top^{\\mathcal{I}}=\\Delta^{\\mathcal{I}}). â„â„\\mathcal{I} is a model of an ontology ğ’ªğ’ª\\mathcal{O} if all sentences in ğ’ªğ’ª\\mathcal{O} are true in â„â„\\mathcal{I}. ğ’ªğ’ª\\mathcal{O} and ğ’œğ’œ\\mathcal{A} are satisfiable if they have a model. The concrete ontology languages we deal with in this paper are certain members of the DL-Lite family, ğ’œâ€‹â„’â€‹ğ’â€‹â„‹â€‹â„ğ’œâ„’ğ’â„‹â„\\mathcal{ALCHI}, â„°â€‹â„’â€‹â„‹â€‹â„â€‹â„±â„°â„’â„‹â„â„±\\mathcal{ELHIF}, and some fragments thereof. For the readerâ€™s convenience, we define these languages below (in FO-terms): â€‹ (aka DL-Litecoreâ„±subscriptsuperscriptDL-Liteâ„±core\\textsl{DL-Lite}^{\\mathcal{F}}_{\\textit{core}}Â ) allows axioms of the following forms: where basic concepts Bâ€‹(x)ğµğ‘¥B(x) are either Aâ€‹(x)ğ´ğ‘¥A(x) or âˆƒyâ€‹Sâ€‹(x,y)ğ‘¦ğ‘†ğ‘¥ğ‘¦\\exists y\\,S(x,y). In the DL parlance, the first two axioms inÂ (1) are written as BâŠ‘Bâ€²square-image-of-or-equalsğµsuperscriptğµâ€²B\\sqsubseteq B^{\\prime} and BâŠ“Bâ€²âŠ‘âŠ¥square-image-of-or-equalssquare-intersectionğµsuperscriptğµâ€²bottomB\\sqcap B^{\\prime}\\sqsubseteq\\bot and called a concept inclusion (CI) and concept disjointness constraint, respectively. The third axiom, written â‰¥2â€‹SâŠ‘âŠ¥absent2ğ‘†square-image-of-or-equalsbottom\\geq 2\\,S\\sqsubseteq\\bot or funâ€‹(S)funğ‘†\\text{fun}(S) in DL, states that relation Sâˆ’superscriptğ‘†S^{-} is functional, and so is called a functionality constraint. â€‹ is a fragment of DL-Liteâ„±subscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}}, in which CIs BâŠ‘Bâ€²square-image-of-or-equalsğµsuperscriptğµâ€²B\\sqsubseteq B^{\\prime} cannot have Bâ€²=âˆƒSsuperscriptğµâ€²ğ‘†B^{\\prime}=\\exists S with functional Sâˆ’superscriptğ‘†S^{-}. â€‹ (aka DL-Litecoreâ„‹superscriptsubscriptDL-Litecoreâ„‹\\textsl{DL-Lite}_{\\textit{core}}^{\\mathcal{H}}Â ) is obtained from DL-Liteâ„±subscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}} by disallowing the functionality constraint inÂ (1) and adding axioms of the form known as role inclusions and often written as SâŠ‘Sâ€²square-image-of-or-equalsğ‘†superscriptğ‘†â€²S\\sqsubseteq S^{\\prime}. â€‹[ref]12 has the same role inclusions as inÂ (2) but more expressive concept inclusions âˆ€xâ€‹(C1â€‹(x)â†’C2â€‹(x))for-allğ‘¥â†’subscriptğ¶1ğ‘¥subscriptğ¶2ğ‘¥\\forall x\\,(C_{1}(x)\\to C_{2}(x)), in which the concepts Cisubscriptğ¶ğ‘–C_{i} are defined inductively starting from atoms âŠ¤(x)topğ‘¥\\top(x) (which is always true) and Aâ€‹(x)ğ´ğ‘¥A(x) and using the constructors Câ€‹(x)âˆ§Câ€²â€‹(x)ğ¶ğ‘¥superscriptğ¶â€²ğ‘¥C(x)\\land C^{\\prime}(x), Â¬Câ€‹(x)ğ¶ğ‘¥\\neg C(x), and âˆƒyâ€‹(Sâ€‹(x,y)âˆ§Câ€‹(y))ğ‘¦ğ‘†ğ‘¥ğ‘¦ğ¶ğ‘¦\\exists y\\,(S(x,y)\\land C(y)), for a fresh yğ‘¦yâ€”or CâŠ“Câ€²square-intersectionğ¶superscriptğ¶â€²C\\sqcap C^{\\prime}, Â¬Cğ¶\\neg C, and âˆƒS.Cformulae-sequenceğ‘†ğ¶\\exists S.C in DL terms. â€‹[ref]12 has role inclusionsÂ (2), functionality constrains, and concept inclusions with concepts built from atoms and âŠ¥bottom\\bot using âˆ§\\land and âˆƒyâ€‹(Sâ€‹(x,y)âˆ§Câ€‹(y))ğ‘¦ğ‘†ğ‘¥ğ‘¦ğ¶ğ‘¦\\exists y\\,(S(x,y)\\land C(y)) only. â„°â€‹â„’â€‹â„±â€‹â„âŠ¥â„°â„’â„±superscriptâ„bottom\\mathcal{ELFI}^{\\bot} is the fragment of â„°â€‹â„’â€‹â„‹â€‹â„â€‹â„±âŠ¥â„°â„’â„‹â„superscriptâ„±bottom\\mathcal{ELHIF}^{\\bot} without role inclusions. We reserve the character â„’â„’\\mathcal{L} to denote an ontology language. The most general query language over the object domain we consider in this paper consists of conjunctive queries (CQs) ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) over the given signature Ïƒğœ\\sigma with a single answer variable xğ‘¥x. We usually think of ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) as the set of its atoms and denote by varâ€‹(ğ’’)varğ’’\\textit{var}({\\bm{q}}) the set of individual variables in ğ’’ğ’’{\\bm{q}}. We say that ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) is satisfiable wrtÂ an ontology ğ’ªğ’ª\\mathcal{O} if the set ğ’ªâˆª{ğ’’â€‹(x)}ğ’ªğ’’ğ‘¥\\mathcal{O}\\cup\\{{\\bm{q}}(x)\\} has a model.\nThe set of predicate symbols in ğ’’ğ’’{\\bm{q}} is denoted by sigâ€‹(ğ’’)sigğ’’\\textit{sig}({\\bm{q}}).\nThe restriction of ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) to a set Vğ‘‰V of variables is the CQ that is obtained from ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) by omitting the atoms with a variable not in Vğ‘‰V. Given a CQ ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x), an ontology ğ’ªğ’ª\\mathcal{O}, and a data instance ğ’œğ’œ\\mathcal{A}, we say that aâˆˆindâ€‹(ğ’œ)ğ‘indğ’œa\\in\\textit{ind}(\\mathcal{A}) is a (certain) answer to ğªğª{\\bm{q}} over ğ’œğ’œ\\mathcal{A} wrtÂ ğ’ªğ’ª\\mathcal{O} and write ğ’ª,ğ’œâŠ§ğ’’â€‹(a)modelsğ’ªğ’œğ’’ğ‘\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}(a) if â„âŠ§ğ’’â€‹(a)modelsâ„ğ’’ğ‘\\mathcal{I}\\models{\\bm{q}}(a) for all models â„â„\\mathcal{I} of ğ’ªğ’ª\\mathcal{O} and ğ’œğ’œ\\mathcal{A}. Recall that âˆ…,ğ’œâŠ§ğ’’â€‹(a)modelsğ’œğ’’ğ‘\\emptyset,\\mathcal{A}\\models{\\bm{q}}(a) iff there is function h:varâ€‹(ğ’’)â†’ğ’œ:â„â†’varğ’’ğ’œh\\colon\\textit{var}({\\bm{q}})\\to\\mathcal{A} such that hâ€‹(x)=aâ„ğ‘¥ğ‘h(x)=a, Aâ€‹(y)âˆˆğ’’ğ´ğ‘¦ğ’’A(y)\\in{\\bm{q}} implies Aâ€‹(hâ€‹(y))âˆˆğ’œğ´â„ğ‘¦ğ’œA(h(y))\\in\\mathcal{A}, and Pâ€‹(y,z)âˆˆğ’’ğ‘ƒğ‘¦ğ‘§ğ’’P(y,z)\\in{\\bm{q}} implies Pâ€‹(hâ€‹(y),hâ€‹(z))âˆˆğ’œğ‘ƒâ„ğ‘¦â„ğ‘§ğ’œP(h(y),h(z))\\in\\mathcal{A}. Such a function hâ„h is called a homomorphism from ğ’’ğ’’{\\bm{q}} to ğ’œğ’œ\\mathcal{A}, written h:ğ’’â†’ğ’œ:â„â†’ğ’’ğ’œh\\colon{\\bm{q}}\\to\\mathcal{A}; hâ„h is surjective if hâ€‹(varâ€‹(ğ’’))=indâ€‹(ğ’œ)â„varğ’’indğ’œh(\\textit{var}({\\bm{q}}))=\\textit{ind}(\\mathcal{A}). We say that a CQ ğ’’1â€‹(x)subscriptğ’’1ğ‘¥{\\bm{q}}_{1}(x) is contained in a CQ ğ’’2â€‹(x)subscriptğ’’2ğ‘¥{\\bm{q}}_{2}(x) wrtÂ an ontology ğ’ªğ’ª\\mathcal{O} and write ğ’’1âŠ§ğ’ªğ’’2subscriptmodelsğ’ªsubscriptğ’’1subscriptğ’’2{\\bm{q}}_{1}\\models_{\\mathcal{O}}{\\bm{q}}_{2} if ğ’ª,ğ’œâŠ§ğ’’1â€‹(a)modelsğ’ªğ’œsubscriptğ’’1ğ‘\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}_{1}(a) implies ğ’ª,ğ’œâŠ§ğ’’2â€‹(a)modelsğ’ªğ’œsubscriptğ’’2ğ‘\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}_{2}(a), for any data instance ğ’œğ’œ\\mathcal{A} and any aâˆˆindâ€‹(ğ’œ)ğ‘indğ’œa\\in\\textit{ind}(\\mathcal{A}). If ğ’’1âŠ§ğ’ªğ’’2subscriptmodelsğ’ªsubscriptğ’’1subscriptğ’’2{\\bm{q}}_{1}\\models_{\\mathcal{O}}{\\bm{q}}_{2} and ğ’’2âŠ§ğ’ªğ’’1subscriptmodelsğ’ªsubscriptğ’’2subscriptğ’’1{\\bm{q}}_{2}\\models_{\\mathcal{O}}{\\bm{q}}_{1}, we say that ğ’’1subscriptğ’’1{\\bm{q}}_{1} and ğ’’2subscriptğ’’2{\\bm{q}}_{2} are equivalent wrtÂ ğ’ªğ’ª\\mathcal{O}, writing ğ’’1â‰¡ğ’ªğ’’2subscriptğ’ªsubscriptğ’’1subscriptğ’’2{\\bm{q}}_{1}\\equiv_{\\mathcal{O}}{\\bm{q}}_{2}. For ğ’ª=âˆ…ğ’ª\\mathcal{O}=\\emptyset, we often write ğ’’1â‰¡ğ’’2subscriptğ’’1subscriptğ’’2{\\bm{q}}_{1}\\equiv{\\bm{q}}_{2} instead of ğ’’1â‰¡âˆ…ğ’’2subscriptsubscriptğ’’1subscriptğ’’2{\\bm{q}}_{1}\\equiv_{\\emptyset}{\\bm{q}}_{2}.\nWe call ğ’’1subscriptğ’’1{\\bm{q}}_{1} and ğ’’2subscriptğ’’2{\\bm{q}}_{2} compatible wrtÂ ğ’ªğ’ª\\mathcal{O} if ğ’’1âˆ§ğ’’2subscriptğ’’1subscriptğ’’2{\\bm{q}}_{1}\\wedge{\\bm{q}}_{2} is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}. Two smaller query languages we need are â„°â€‹â„’â€‹â„â„°â„’â„\\mathcal{ELI}-queries (or ELIQs, for short) that can be defined by the grammar and â„°â€‹â„’â„°â„’\\mathcal{EL}-queries (or ELQs), which are ELIQs without inverses Pâˆ’superscriptğ‘ƒP^{-}. Semantically, ğ’’ğ’’{\\bm{q}} has the same meaning as the tree-shaped CQ ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) that is defined inductively starting from atoms âŠ¤(x)topğ‘¥\\top(x) and Aâ€‹(x)ğ´ğ‘¥A(x) and using the constructors âˆƒyâ€‹(Sâ€‹(x,y)âˆ§ğ’’â€‹(y))ğ‘¦ğ‘†ğ‘¥ğ‘¦ğ’’ğ‘¦\\exists y\\,(S(x,y)\\land{\\bm{q}}(y)), for a fresh yğ‘¦y, and ğ’’â€‹(x)âˆ§ğ’’â€²â€‹(x)ğ’’ğ‘¥superscriptğ’’â€²ğ‘¥{\\bm{q}}(x)\\land{\\bm{q}}^{\\prime}(x). The only free (i.e., answer) variable in ğ’’ğ’’{\\bm{q}} is xğ‘¥x. We reserve the character ğ’¬ğ’¬\\mathcal{Q} for denoting a class of queries with answer variable xğ‘¥x such that whenever ğ’’1,ğ’’2âˆˆğ’¬subscriptğ’’1subscriptğ’’2ğ’¬{\\bm{q}}_{1},{\\bm{q}}_{2}\\in\\mathcal{Q}, then ğ’’1âˆ§ğ’’2âˆˆğ’¬subscriptğ’’1subscriptğ’’2ğ’¬{\\bm{q}}_{1}\\land{\\bm{q}}_{2}\\in\\mathcal{Q}; by ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma} we denote the class of those queries in ğ’¬ğ’¬\\mathcal{Q} that are built from predicates in Ïƒğœ\\sigma. The classes of all Ïƒğœ\\sigma-ELIQs and Ïƒğœ\\sigma-ELQs are denoted by ELIQÏƒ and ELQÏƒ, respectively. It will be convenient to include the â€˜inconsistency queryâ€™ âŠ¥(x)bottomğ‘¥\\bot(x) into all of our query classes. By definition, we have ğ’ª,ğ’œâŠ§âŠ¥(a)modelsğ’ªğ’œbottomğ‘\\mathcal{O},\\mathcal{A}\\models\\bot(a) iff ğ’ªğ’ª\\mathcal{O} and ğ’œğ’œ\\mathcal{A} are inconsistent. We say that an ontology ğ’ªğ’ª\\mathcal{O} admits containment reduction if, for any CQ ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x), there is a pointed data instance (ğ’’^,a)^ğ’’ğ‘(\\hat{{\\bm{q}}},a) such that the following conditions hold: ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O} iff ğ’ªğ’ª\\mathcal{O} and ğ’’^^ğ’’\\hat{{\\bm{q}}} are satisfiable; there is a surjective homomorphism h:ğ’’â†’ğ’’^:â„â†’ğ’’^ğ’’h\\colon{\\bm{q}}\\to\\hat{{\\bm{q}}} with hâ€‹(x)=aâ„ğ‘¥ğ‘h(x)=a; if ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}, then for every CQ ğ’’â€²â€‹(x)superscriptğ’’â€²ğ‘¥{\\bm{q}}^{\\prime}(x), we have ğ’’âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime} iff ğ’ª,ğ’’^âŠ§ğ’’â€²â€‹(a)modelsğ’ª^ğ’’superscriptğ’’â€²ğ‘\\mathcal{O},\\hat{{\\bm{q}}}\\models{\\bm{q}}^{\\prime}(a). An ontology language â„’â„’\\mathcal{L} is said to admit containment reduction if every â„’â„’\\mathcal{L}-ontology does. If (ğ’’^,a)^ğ’’ğ‘(\\hat{{\\bm{q}}},a) is computable in polynomial time for every ğ’ªğ’ª\\mathcal{O} in â„’â„’\\mathcal{L}, we say that â„’â„’\\mathcal{L} admits tractable containment reduction. In the next theorem, we illustrate this definition by a few examples. (1)1(1) FO without equality admits tractable containment reduction; in particular, both DL-Liteâ„‹subscriptDL-Liteâ„‹\\textsl{DL-Lite}_{\\mathcal{H}} and ğ’œâ€‹â„’â€‹ğ’â€‹â„‹â€‹â„ğ’œâ„’ğ’â„‹â„\\mathcal{ALCHI} admits tractable containment reduction. (2)2(2) DL-Liteâ„±subscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}} admits tractable containment reduction. (3)3(3) The ontology ğ’ªğ’ª\\mathcal{O} with the single axiom (or ğ’ª={â‰¥3PâŠ‘âŠ¥}\\mathcal{O}=\\{\\geq 3\\,P\\sqsubseteq\\bot\\} in the DL parlance) does not admit containment reduction. (1) We use the following factÂ [15, Proposition 5.9]: for any FO-ontology ğ’ªğ’ª\\mathcal{O} without =, any CQ ğ’’ğ’’{\\bm{q}}, and any pointed data instances ğ’œ1,a1subscriptğ’œ1subscriptğ‘1\\mathcal{A}_{1},a_{1} and ğ’œ2,a2subscriptğ’œ2subscriptğ‘2\\mathcal{A}_{2},a_{2}, if there is a homomorphism h:ğ’œ1â†’ğ’œ2:â„â†’subscriptğ’œ1subscriptğ’œ2h\\colon\\mathcal{A}_{1}\\to\\mathcal{A}_{2} with hâ€‹(a1)=a2â„subscriptğ‘1subscriptğ‘2h(a_{1})=a_{2}, then ğ’ª,ğ’œ1âŠ§ğ’’â€‹(a1)modelsğ’ªsubscriptğ’œ1ğ’’subscriptğ‘1\\mathcal{O},\\mathcal{A}_{1}\\models{\\bm{q}}(a_{1}) implies ğ’ª,ğ’œ2âŠ§ğ’’â€‹(a2)modelsğ’ªsubscriptğ’œ2ğ’’subscriptğ‘2\\mathcal{O},\\mathcal{A}_{2}\\models{\\bm{q}}(a_{2}). Let (ğ’’^â€‹(x),a)^ğ’’ğ‘¥ğ‘(\\hat{{\\bm{q}}}(x),a) be induced by ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x), that is, obtained from ğ’’ğ’’{\\bm{q}} by replacing its variables by distinct constants, with xğ‘¥x replaced by ağ‘a.\nSuppose ğ’ª,ğ’’^âŠ§ğ’’â€²modelsğ’ª^ğ’’superscriptğ’’â€²\\mathcal{O},\\hat{{\\bm{q}}}\\models{\\bm{q}}^{\\prime} and ğ’ª,ğ’œâŠ§ğ’’â€‹(a)modelsğ’ªğ’œğ’’ğ‘\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}(a) but ğ’ª,ğ’œâŠ§Ì¸ğ’’â€²â€‹(a)not-modelsğ’ªğ’œsuperscriptğ’’â€²ğ‘\\mathcal{O},\\mathcal{A}\\not\\models{\\bm{q}}^{\\prime}(a). Take a model â„â„\\mathcal{I} witnessing ğ’ª,ğ’œâŠ§Ì¸ğ’’2â€‹(a)not-modelsğ’ªğ’œsubscriptğ’’2ğ‘\\mathcal{O},\\mathcal{A}\\not\\models{\\bm{q}}_{2}(a). Then\nâ„âŠ§ğ’’1â€‹(a)modelsâ„subscriptğ’’1ğ‘\\mathcal{I}\\models{\\bm{q}}_{1}(a) and this is witnessed by a homomorphism h:ğ’’1â†’â„:â„â†’subscriptğ’’1â„h:{\\bm{q}}_{1}\\rightarrow\\mathcal{I}. Take the image hâ€‹(ğ’’1)â„subscriptğ’’1h({\\bm{q}}_{1}). Then ğ’ª,hâ€‹(ğ’’1)^âŠ§Ì¸ğ’’2â€‹(x)not-modelsğ’ª^â„subscriptğ’’1subscriptğ’’2ğ‘¥\\mathcal{O},\\widehat{h({\\bm{q}}_{1})}\\not\\models{\\bm{q}}_{2}(x) is witnessed by â„â„\\mathcal{I}, and so ğ’ª,ğ’’^1âŠ§Ì¸ğ’’2â€‹(x)not-modelsğ’ªsubscript^ğ’’1subscriptğ’’2ğ‘¥\\mathcal{O},\\hat{{\\bm{q}}}_{1}\\not\\models{\\bm{q}}_{2}(x), which is a contradiction. (2) Let ğ’ªğ’ª\\mathcal{O} be a DL-Liteâ„±subscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}} ontology. Given a CQ ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x), define an equivalence relation âˆ¼similar-to\\sim on varâ€‹(ğ’’)varğ’’\\textit{var}({\\bm{q}}) as the transitive closure of the following relation: yâˆ¼â€²zsuperscriptsimilar-toâ€²ğ‘¦ğ‘§y\\sim^{\\prime}z iff there is uâˆˆvarâ€‹(ğ’’)ğ‘¢varğ’’u\\in\\textit{var}({\\bm{q}}) such that Sâ€‹(u,y),Sâ€‹(u,z)âˆˆğ’’ğ‘†ğ‘¢ğ‘¦ğ‘†ğ‘¢ğ‘§ğ’’S(u,y),S(u,z)\\in{\\bm{q}}, for a functional Sğ‘†S in ğ’ªğ’ª\\mathcal{O}. Let ğ’’/âˆ¼{\\bm{q}}/_{\\sim} be obtained by identifying (glueing together) all of the variables in each equivalence class y/âˆ¼y/_{\\sim}. Clearly, ğ’’/âˆ¼(x/âˆ¼){\\bm{q}}/_{\\sim}(x/_{\\sim}) is a homomorphic image of ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) and ğ’’(x)â‰¡ğ’ªğ’’/âˆ¼(x/âˆ¼){\\bm{q}}(x)\\equiv_{\\mathcal{O}}{\\bm{q}}/_{\\sim}(x/_{\\sim}). We define (ğ’’^,a)^ğ’’ğ‘(\\hat{{\\bm{q}}},a) as the pointed data instance induced by ğ’’/âˆ¼(x/âˆ¼){\\bm{q}}/_{\\sim}(x/_{\\sim}). Conditions (cr1) and (cr2) are obvious, and (cr3) follows from the fact that ğ’’/âˆ¼âŠ§ğ’ªğ’’â€²/âˆ¼{\\bm{q}}/_{\\sim}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime}/_{\\sim} iff ğ’’/âˆ¼âŠ§ğ’ªâ€²ğ’’â€²/âˆ¼{\\bm{q}}/_{\\sim}\\models_{\\mathcal{O}^{\\prime}}{\\bm{q}}^{\\prime}/_{\\sim}, where ğ’ªâ€²superscriptğ’ªâ€²\\mathcal{O}^{\\prime} is obtained from ğ’ªğ’ª\\mathcal{O} by omitting all of its functionality constraints, which is in the scope of part (1). (3) Consider the CQ ğ’’â€‹(x)={Pâ€‹(x,yi),Aiâ€‹(yi)âˆ£i=1,2,3}ğ’’ğ‘¥conditional-setğ‘ƒğ‘¥subscriptğ‘¦ğ‘–subscriptğ´ğ‘–subscriptğ‘¦ğ‘–ğ‘–123{\\bm{q}}(x)=\\{P(x,y_{i}),A_{i}(y_{i})\\mid i=1,2,3\\} and suppose there is a suitable pointed data instance (ğ’’^,a)^ğ’’ğ‘(\\hat{{\\bm{q}}},a). As ğ’ªğ’ª\\mathcal{O} and the data instance induced by ğ’’ğ’’{\\bm{q}} are not satisfiable and in view of (cr2), ğ’’^^ğ’’\\hat{{\\bm{q}}} contains at most three individuals, say, ğ’’^={Pâ€‹(a,b),A1â€‹(b),A2â€‹(b),Pâ€‹(a,c),A3â€‹(c)}^ğ’’ğ‘ƒğ‘ğ‘subscriptğ´1ğ‘subscriptğ´2ğ‘ğ‘ƒğ‘ğ‘subscriptğ´3ğ‘\\hat{{\\bm{q}}}=\\{P(a,b),A_{1}(b),A_{2}(b),P(a,c),A_{3}(c)\\}. But then, by (cr3), ğ’’â€²â€‹(x)={Pâ€‹(x,y),A1â€‹(y),A2â€‹(y),Pâ€‹(x,z),A3â€‹(z)}superscriptğ’’â€²ğ‘¥ğ‘ƒğ‘¥ğ‘¦subscriptğ´1ğ‘¦subscriptğ´2ğ‘¦ğ‘ƒğ‘¥ğ‘§subscriptğ´3ğ‘§{\\bm{q}}^{\\prime}(x)=\\{P(x,y),A_{1}(y),A_{2}(y),P(x,z),A_{3}(z)\\} should satisfy ğ’’âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime}, which not the case as witnessed by ğ’œ={Pâ€‹(a,b),A1â€‹(b),Pâ€‹(a,c),A2â€‹(c),A3â€‹(c)}ğ’œğ‘ƒğ‘ğ‘subscriptğ´1ğ‘ğ‘ƒğ‘ğ‘subscriptğ´2ğ‘subscriptğ´3ğ‘\\mathcal{A}=\\{P(a,b),A_{1}(b),P(a,c),A_{2}(c),A_{3}(c)\\} because ğ’ª,ğ’œâŠ§ğ’’â€‹(a)modelsğ’ªğ’œğ’’ğ‘\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}(a) but ğ’ª,ğ’œâŠ§Ì¸ğ’’â€²â€‹(a)not-modelsğ’ªğ’œsuperscriptğ’’â€²ğ‘\\mathcal{O},\\mathcal{A}\\not\\models{\\bm{q}}^{\\prime}(a).\nâˆ In what follows, we only consider ontology languages that admit containment reduction and assume that (ğ’’^,a)^ğ’’ğ‘(\\hat{{\\bm{q}}},a) is a pointed data instance satisfying (cr1)â€“(cr3) for given ğ’’ğ’’{\\bm{q}} and ğ’ªğ’ª\\mathcal{O}. An example set is a pair E=(E+,Eâˆ’)ğ¸superscriptğ¸superscriptğ¸E=(E^{+},E^{-}), where E+superscriptğ¸E^{+} and Eâˆ’superscriptğ¸E^{-} are finite sets of pointed data instances (ğ’Ÿ,a)ğ’Ÿğ‘(\\mathcal{D},a). A CQ ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) fits Eğ¸E wrtÂ ğ’ªğ’ª\\mathcal{O} if ğ’ª,ğ’Ÿ+âŠ§ğ’’â€‹(a+)modelsğ’ªsuperscriptğ’Ÿğ’’superscriptğ‘\\mathcal{O},\\mathcal{D}^{+}\\models{\\bm{q}}(a^{+}) and ğ’ª,ğ’Ÿâˆ’âŠ§Ì¸ğ’’â€‹(aâˆ’)not-modelsğ’ªsuperscriptğ’Ÿğ’’superscriptğ‘\\mathcal{O},\\mathcal{D}^{-}\\not\\models{\\bm{q}}(a^{-}), for all (ğ’Ÿ+,a+)âˆˆE+superscriptğ’Ÿsuperscriptğ‘superscriptğ¸(\\mathcal{D}^{+},a^{+})\\in E^{+} and (ğ’Ÿâˆ’,aâˆ’)âˆˆEâˆ’superscriptğ’Ÿsuperscriptğ‘superscriptğ¸(\\mathcal{D}^{-},a^{-})\\in E^{-}. We say that Eğ¸E uniquely characterises ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within a given class ğ’¬ğ’¬\\mathcal{Q} of queries if ğ’’ğ’’{\\bm{q}} fits Eğ¸E and ğ’’â‰¡ğ’ªğ’’â€²subscriptğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\equiv_{\\mathcal{O}}{\\bm{q}}^{\\prime}, for any ğ’’â€²âˆˆğ’¬superscriptğ’’â€²ğ’¬{\\bm{q}}^{\\prime}\\in\\mathcal{Q} fitting Eğ¸E.\nNote that if E+=âˆ…superscriptğ¸E^{+}=\\emptyset, then ğ’’â‰¡ğ’ªâŠ¥subscriptğ’ªğ’’bottom{\\bm{q}}\\equiv_{\\mathcal{O}}\\bot, and so ğ’’ğ’’{\\bm{q}} is not satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}. We call a unique characterisation E=(E+,Eâˆ’)ğ¸superscriptğ¸superscriptğ¸E=(E^{+},E^{-}) of ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} singular+ if E+={(ğ’’^,a)}superscriptğ¸^ğ’’ğ‘E^{+}=\\{(\\hat{{\\bm{q}}},a)\\}. Suppose ğ’ªğ’ª\\mathcal{O} admits containment reduction, ğªâˆˆğ’¬ğªğ’¬{\\bm{q}}\\in\\mathcal{Q} is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O} and has a unique characterisation E=(E+,Eâˆ’)ğ¸superscriptğ¸superscriptğ¸E=(E^{+},E^{-}) wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}. Then Eâ€²=(({ğª^,a)},Eâˆ’)E^{\\prime}=((\\{\\hat{{\\bm{q}}},a)\\},E^{-}) is a unique characterisation of ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}, too.\nThus, every uniquely characterisable ğªâˆˆğ’¬ğªğ’¬{\\bm{q}}\\in\\mathcal{Q} within ğ’¬ğ’¬\\mathcal{Q} wrtÂ an ontology admitting containment reduction has a singular+characterisation. To show that Eâ€²superscriptğ¸â€²E^{\\prime} is as required, we first observe that ğ’’ğ’’{\\bm{q}} fits Eâ€²superscriptğ¸â€²E^{\\prime} by (cr1) and (cr3). Suppose ğ’’â€²â‰¢ğ’ªğ’’subscriptnot-equivalent-toğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\not\\equiv_{\\mathcal{O}}{\\bm{q}} for some ğ’’â€²âˆˆğ’¬superscriptğ’’â€²ğ’¬{\\bm{q}}^{\\prime}\\in\\mathcal{Q}. We show that then either ğ’ª,ğ’’^âŠ§Ì¸ğ’’â€²not-modelsğ’ª^ğ’’superscriptğ’’â€²\\mathcal{O},\\hat{{\\bm{q}}}\\not\\models{\\bm{q}}^{\\prime} or ğ’ª,ğ’ŸâŠ§ğ’’â€²modelsğ’ªğ’Ÿsuperscriptğ’’â€²\\mathcal{O},\\mathcal{D}\\models{\\bm{q}}^{\\prime} for some ğ’ŸâˆˆEâˆ’ğ’Ÿsuperscriptğ¸\\mathcal{D}\\in E^{-}.\nLet ğ’’âŠ§Ì¸ğ’ªğ’’â€²subscriptnot-modelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\not\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime}. Then ğ’ª,ğ’’^âŠ§Ì¸ğ’’â€²not-modelsğ’ª^ğ’’superscriptğ’’â€²\\mathcal{O},\\hat{{\\bm{q}}}\\not\\models{\\bm{q}}^{\\prime} by (cr3). Let ğ’’âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime} and ğ’’â€²âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}. Then ğ’ª,ğ’ŸâŠ§ğ’’â€²modelsğ’ªğ’Ÿsuperscriptğ’’â€²\\mathcal{O},\\mathcal{D}\\models{\\bm{q}}^{\\prime} for all ğ’ŸâˆˆE+ğ’Ÿsuperscriptğ¸\\mathcal{D}\\in E^{+}, and so ğ’ª,ğ’ŸâŠ§ğ’’â€²modelsğ’ªğ’Ÿsuperscriptğ’’â€²\\mathcal{O},\\mathcal{D}\\models{\\bm{q}}^{\\prime}, for some ğ’ŸâˆˆEâˆ’ğ’Ÿsuperscriptğ¸\\mathcal{D}\\in E^{-}, because Eğ¸E is a unique characterisation of ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O}.\nâˆ We now give two sufficient conditions of singular+characterisability: the existence of frontiers and the existence of split-partners. Let ğ’ªğ’ª\\mathcal{O} be an ontology, ğ’¬ğ’¬\\mathcal{Q} a class of queries, and ğ’’âˆˆğ’¬ğ’’ğ’¬{\\bm{q}}\\in\\mathcal{Q} a satisfiable query wrtÂ ğ’ªğ’ª\\mathcal{O}. A frontier of ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q} is any set â„±ğ’’âŠ†ğ’¬subscriptâ„±ğ’’ğ’¬\\mathcal{F}_{{\\bm{q}}}\\subseteq\\mathcal{Q} such that ğ’’âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime} and ğ’’â€²âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}, for all ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}}; if ğ’’âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime} for a ğ’’â€²â€²âˆˆğ’¬superscriptğ’’â€²â€²ğ’¬{\\bm{q}}^{\\prime\\prime}\\in\\mathcal{Q},\nthen ğ’’â€²â€²âŠ§ğ’ªğ’’subscriptmodelsğ’ªsuperscriptğ’’â€²â€²ğ’’{\\bm{q}}^{\\prime\\prime}\\models_{\\mathcal{O}}{\\bm{q}} or there is ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} with ğ’’â€²âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªsuperscriptğ’’â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime}. (Note that if ğ’’â‰¡ğ’ªâŠ¤subscriptğ’ªğ’’top{\\bm{q}}\\equiv_{\\mathcal{O}}\\top, then â„±ğ’’=âˆ…subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}}=\\emptyset.) An ontology ğ’ªğ’ª\\mathcal{O} is said to admit (finite) frontiers within ğ’¬ğ’¬\\mathcal{Q} if every ğ’’âˆˆğ’¬ğ’’ğ’¬{\\bm{q}}\\in\\mathcal{Q} satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O} has a (finite) frontier wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}. Further, if such frontiers can be computed in polynomial time, we say that ğ’ªğ’ª\\mathcal{O} admits polynomial-time computable frontiers. Suppose ğ’¬ğ’¬\\mathcal{Q} is a class of queries, an ontology ğ’ªğ’ª\\mathcal{O} admits containment reduction, ğªâˆˆğ’¬ğªğ’¬{\\bm{q}}\\in\\mathcal{Q} is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}, and â„±ğªsubscriptâ„±ğª\\mathcal{F}_{{\\bm{q}}} is a finite frontier of ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}. Then ({(ğª^,a)},{(ğ«^,a)âˆ£ğ«âˆˆâ„±ğª})^ğªğ‘conditional-set^ğ«ğ‘ğ«subscriptâ„±ğª(\\{(\\hat{{\\bm{q}}},a)\\},\\{(\\hat{\\bm{r}},a)\\mid\\bm{r}\\in\\mathcal{F}_{{\\bm{q}}}\\}) is a singular+characterisation of ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}. By (cr2), ğ’ª,ğ’’^âŠ§ğ’’â€‹(a)modelsğ’ª^ğ’’ğ’’ğ‘\\mathcal{O},\\hat{{\\bm{q}}}\\models{\\bm{q}}(a).\nTo show ğ’ª,ğ’“^âŠ§Ì¸ğ’’â€‹(a)not-modelsğ’ª^ğ’“ğ’’ğ‘\\mathcal{O},\\hat{\\bm{r}}\\not\\models{\\bm{q}}(a) for all ğ’“âˆˆâ„±ğ’’ğ’“subscriptâ„±ğ’’\\bm{r}\\in\\mathcal{F}_{{\\bm{q}}}, we observe that ğ’“âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªğ’“ğ’’\\bm{r}\\not\\models_{\\mathcal{O}}{\\bm{q}} by the definition of â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}}, so ğ’“â€‹(x)ğ’“ğ‘¥\\bm{r}(x) is consistent with ğ’ªğ’ª\\mathcal{O} and by (cr3) for ğ’“ğ’“\\bm{r}, from which ğ’ª,ğ’“^âŠ§Ì¸ğ’’â€‹(a)not-modelsğ’ª^ğ’“ğ’’ğ‘\\mathcal{O},\\hat{\\bm{r}}\\not\\models{\\bm{q}}(a). Thus, ğ’’ğ’’{\\bm{q}} fits Eğ¸E. Suppose ğ’’â€²âˆˆğ’¬superscriptğ’’â€²ğ’¬{\\bm{q}}^{\\prime}\\in\\mathcal{Q} and ğ’’â‰¢ğ’ªğ’’â€²subscriptnot-equivalent-toğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\not\\equiv_{\\mathcal{O}}{\\bm{q}}^{\\prime}. We show that either ğ’ª,ğ’’^âŠ§Ì¸ğ’’â€²not-modelsğ’ª^ğ’’superscriptğ’’â€²\\mathcal{O},\\hat{{\\bm{q}}}\\not\\models{\\bm{q}}^{\\prime} or ğ’ª,ğ’“^âŠ§ğ’’â€²modelsğ’ª^ğ’“superscriptğ’’â€²\\mathcal{O},\\hat{\\bm{r}}\\models{\\bm{q}}^{\\prime} for some ğ’“âˆˆâ„±ğ’’ğ’“subscriptâ„±ğ’’\\bm{r}\\in\\mathcal{F}_{{\\bm{q}}}. If ğ’’âŠ§Ì¸ğ’ªğ’’â€²subscriptnot-modelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\not\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime}, then, since ğ’ªğ’ª\\mathcal{O} admits containment reduction and ğ’’â€‹(x)ğ’’ğ‘¥{\\bm{q}}(x) is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}, we obtain ğ’ª,ğ’’^âŠ§Ì¸ğ’’â€²not-modelsğ’ª^ğ’’superscriptğ’’â€²\\mathcal{O},\\hat{{\\bm{q}}}\\not\\models{\\bm{q}}^{\\prime} by (cr3).\nSo suppose ğ’’âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime} and ğ’’â€²âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}. As â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}} is a frontier of ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O}, there is ğ’“âˆˆâ„±ğ’’ğ’“subscriptâ„±ğ’’\\bm{r}\\in\\mathcal{F}_{{\\bm{q}}} with ğ’“âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’“superscriptğ’’â€²\\bm{r}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime}. If ğ’“â€‹(x)ğ’“ğ‘¥\\bm{r}(x) is unsatisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}, then ğ’ªğ’ª\\mathcal{O} and ğ’“^^ğ’“\\hat{\\bm{r}} are unsatisfiable by (cr1), and so ğ’ª,ğ’“^âŠ§ğ’’â€²modelsğ’ª^ğ’“superscriptğ’’â€²\\mathcal{O},\\hat{\\bm{r}}\\models{\\bm{q}}^{\\prime}. And if ğ’“â€‹(x)ğ’“ğ‘¥\\bm{r}(x) is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}, we obtain ğ’ª,ğ’“^âŠ§ğ’’â€²â€‹(a)modelsğ’ª^ğ’“superscriptğ’’â€²ğ‘\\mathcal{O},\\hat{\\bm{r}}\\models{\\bm{q}}^{\\prime}(a) by (cr3).\nâˆ The two main ontology languages that admit polynomial-time computable frontiers within ELIQ are DL-Liteâ„‹subscriptDL-Liteâ„‹\\textsl{DL-Lite}_{\\mathcal{H}} and DL-Liteâ„±âˆ’superscriptsubscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}}^{-}, whereas DL-Liteâ„±subscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}} itself does not admit finite ELIQ-frontiersÂ . By TheoremÂ 8 and LemmaÂ 1, we then obtain: If an ELIQ ğªğª{\\bm{q}} is satisfiable wrtÂ a DL-Liteâ„‹subscriptDL-Liteâ„‹\\textsl{DL-Lite}_{\\mathcal{H}} or DL-Liteâ„±âˆ’superscriptsubscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}}^{-} ontology ğ’ªğ’ª\\mathcal{O}, then ğªğª{\\bm{q}} has a polysize singular+characterisation wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQ. We also require the following observation on singleton frontiers. A query ğ’“âˆˆğ’¬ğ’“ğ’¬\\bm{r}\\in\\mathcal{Q} is called meet-reducibleÂ  (or conjunct) wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q} if there are ğ’“1,ğ’“2âˆˆğ’¬subscriptğ’“1subscriptğ’“2ğ’¬\\bm{r}_{1},\\bm{r}_{2}\\in\\mathcal{Q} such that (i)ğ‘–(i) If an ontology ğ’ªğ’ª\\mathcal{O} admits frontiers within ğ’¬ğ’¬\\mathcal{Q}, then ğªâˆˆğ’¬ğªğ’¬{\\bm{q}}\\in\\mathcal{Q} is meet-reducible wrt ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q} iff |â„±ğª|â‰¥2subscriptâ„±ğª2|\\mathcal{F}_{{\\bm{q}}}|\\geq 2 provided that, for any distinct ğªâ€²,ğªâ€²â€²âˆˆâ„±ğªsuperscriptğªâ€²superscriptğªâ€²â€²subscriptâ„±ğª{\\bm{q}}^{\\prime},{\\bm{q}}^{\\prime\\prime}\\in\\mathcal{F}_{{\\bm{q}}}, we have ğªâ€²âŠ§Ì¸ğ’ªğªâ€²â€²subscriptnot-modelsğ’ªsuperscriptğªâ€²superscriptğªâ€²â€²{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime}. (iâ€‹i)ğ‘–ğ‘–(ii) If an ontology ğ’ªğ’ª\\mathcal{O} admits singular+characterisations within ğ’¬ğ’¬\\mathcal{Q}, then, for any meet-reducible ğªâˆˆğ’¬ğªğ’¬{\\bm{q}}\\in\\mathcal{Q} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}, we have |ğ’©ğª|â‰¥2subscriptğ’©ğª2|\\mathcal{N}_{{\\bm{q}}}|\\geq 2 in every singular+ characterisation ({ğª^},ğ’©ğª)^ğªsubscriptğ’©ğª(\\{\\hat{{\\bm{q}}}\\},\\mathcal{N}_{{\\bm{q}}}) of ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}. (i,â‡)ğ‘–â‡(i,\\,\\Leftarrow) Let ğ’“1,ğ’“2âˆˆâ„±ğ’’subscriptğ’“1subscriptğ’“2subscriptâ„±ğ’’\\bm{r}_{1},\\bm{r}_{2}\\in\\mathcal{F}_{{\\bm{q}}} be distinct. Consider ğ’“=ğ’“1âˆ§ğ’“2ğ’“subscriptğ’“1subscriptğ’“2\\bm{r}=\\bm{r}_{1}\\land\\bm{r}_{2}. If ğ’’â‰¢ğ’ªğ’“subscriptnot-equivalent-toğ’ªğ’’ğ’“{\\bm{q}}\\not\\equiv_{\\mathcal{O}}\\bm{r}, then there is ğ’“â€²âˆˆâ„±ğ’’superscriptğ’“â€²subscriptâ„±ğ’’\\bm{r}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} with ğ’“â€²âŠ§ğ’ªğ’“subscriptmodelsğ’ªsuperscriptğ’“â€²ğ’“\\bm{r}^{\\prime}\\models_{\\mathcal{O}}\\bm{r}, and so ğ’“â€²âŠ§ğ’ªğ’“isubscriptmodelsğ’ªsuperscriptğ’“â€²subscriptğ’“ğ‘–\\bm{r}^{\\prime}\\models_{\\mathcal{O}}\\bm{r}_{i}, which is impossible. (i,â‡’)ğ‘–â‡’(i,\\,\\Rightarrow) Suppose ğ’’â‰¡ğ’ªğ’’1âˆ§ğ’’2subscriptğ’ªğ’’subscriptğ’’1subscriptğ’’2{\\bm{q}}\\equiv_{\\mathcal{O}}{\\bm{q}}_{1}\\land{\\bm{q}}_{2} and ğ’’â‰¢ğ’ªğ’’isubscriptnot-equivalent-toğ’ªğ’’subscriptğ’’ğ‘–{\\bm{q}}\\not\\equiv_{\\mathcal{O}}{\\bm{q}}_{i}, for i=1,2ğ‘–12i=1,2. Then there are ğ’“iâˆˆâ„±ğ’’subscriptğ’“ğ‘–subscriptâ„±ğ’’\\bm{r}_{i}\\in\\mathcal{F}_{{\\bm{q}}} with ğ’“iâ‰¢ğ’ªğ’’isubscriptnot-equivalent-toğ’ªsubscriptğ’“ğ‘–subscriptğ’’ğ‘–\\bm{r}_{i}\\not\\equiv_{\\mathcal{O}}{\\bm{q}}_{i}. Clearly, ğ’“1subscriptğ’“1\\bm{r}_{1} and ğ’“2subscriptğ’“2\\bm{r}_{2} are distinct because otherwise ğ’“iâŠ§ğ’ªğ’’subscriptmodelsğ’ªsubscriptğ’“ğ‘–ğ’’\\bm{r}_{i}\\models_{\\mathcal{O}}{\\bm{q}}. (iâ€‹i)ğ‘–ğ‘–(ii) Suppose ğ’’â‰¡ğ’ªğ’’1âˆ§ğ’’2subscriptğ’ªğ’’subscriptğ’’1subscriptğ’’2{\\bm{q}}\\equiv_{\\mathcal{O}}{\\bm{q}}_{1}\\land{\\bm{q}}_{2} and ğ’’â‰¢ğ’ªğ’’isubscriptnot-equivalent-toğ’ªğ’’subscriptğ’’ğ‘–{\\bm{q}}\\not\\equiv_{\\mathcal{O}}{\\bm{q}}_{i}, for i=1,2ğ‘–12i=1,2. If ğ’©ğ’’={ğ’“^}subscriptğ’©ğ’’^ğ’“\\mathcal{N}_{{\\bm{q}}}=\\{\\hat{\\bm{r}}\\}, then ğ’ª,ğ’“^âŠ§ğ’’imodelsğ’ª^ğ’“subscriptğ’’ğ‘–\\mathcal{O},\\hat{\\bm{r}}\\models{\\bm{q}}_{i}, for i=1,2ğ‘–12i=1,2, because if ğ’ª,ğ’“^âŠ§Ì¸ğ’’inot-modelsğ’ª^ğ’“subscriptğ’’ğ‘–\\mathcal{O},\\hat{\\bm{r}}\\not\\models{\\bm{q}}_{i}, then ğ’’isubscriptğ’’ğ‘–{\\bm{q}}_{i} would fit ({ğ’’^},ğ’©ğ’’)^ğ’’subscriptğ’©ğ’’(\\{\\hat{{\\bm{q}}}\\},\\mathcal{N}_{{\\bm{q}}}), and so equivalent to ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O}, which is impossible.\nâˆ (i)ğ‘–(i) Deciding whether an ELIQ ğªğª{\\bm{q}} is meet-reducible wrtÂ to a DL-Liteâ„±âˆ’superscriptsubscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}}^{-}-ontology can be done in polynomial time. (iâ€‹i)ğ‘–ğ‘–(ii) Deciding whether an ELIQ ğªğª{\\bm{q}} is meet-reducible wrtÂ to a DL-Liteâ„‹subscriptDL-Liteâ„‹\\textsl{DL-Lite}_{\\mathcal{H}}-ontology is NP-complete. (i)ğ‘–(i) We first compute a frontier â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}} of ğ’’ğ’’{\\bm{q}} in polynomial timeÂ . Then we remove from â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}} every ğ’’â€²â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime\\prime} for which there is a different ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} with ğ’’â€²âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªsuperscriptğ’’â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime}. This can also be done in polynomial time because query containment in DL-Liteâ„±subscriptDL-Liteâ„±\\textsl{DL-Lite}_{\\mathcal{F}} is tractable. It remains to use LemmaÂ 3 (i)ğ‘–(i) to check if the resulting set is a singleton. (iâ€‹i)ğ‘–ğ‘–(ii) Consider the ontologies ğ’ªğ’ª\\mathcal{O}, ABox {A0â€‹(a)}subscriptğ´0ğ‘\\{A_{0}(a)\\}, and â„°â€‹â„’â€‹â„â„°â„’â„\\mathcal{ELI}-queries ğ’’ğ’’{\\bm{q}} constructed in the proof ofÂ [32, Theorem 1] for Boolean CNFs. As shown in that proof, the problem ğ’ª,A0â€‹(a)âŠ§ğ’’â€‹(a)modelsğ’ªsubscriptğ´0ğ‘ğ’’ğ‘\\mathcal{O},A_{0}(a)\\models{\\bm{q}}(a) is NP-hard. If we take copies ğ’ªâ€²superscriptğ’ªâ€²\\mathcal{O}^{\\prime}\nand ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} by replacing all predicates except A0subscriptğ´0A_{0} by fresh predicates, then\nğ’’âˆ§ğ’’â€²ğ’’superscriptğ’’â€²{\\bm{q}}\\wedge{\\bm{q}}^{\\prime} is a lone conjunct iff ğ’ªâˆªğ’ªâ€²,A0â€‹(a)âŠ§Ì¸ğ’’â€‹(a)not-modelsğ’ªsuperscriptğ’ªâ€²subscriptğ´0ğ‘ğ’’ğ‘\\mathcal{O}\\cup\\mathcal{O}^{\\prime},A_{0}(a)\\not\\models{\\bm{q}}(a).\nâˆ We next introduce splittings (aka homomorphism dualities). Suppose ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma} is a class of Ïƒğœ\\sigma-queries, for a finite signature Ïƒğœ\\sigma of predicate symbols, ğ’ªğ’ª\\mathcal{O} an ontology in the signature Ïƒğœ\\sigma, and QâŠ†ğ’¬Ïƒğ‘„superscriptğ’¬ğœQ\\subseteq\\mathcal{Q}^{\\sigma} is a finite set queries. A set ğ’®â€‹(Q)ğ’®ğ‘„\\mathcal{S}(Q) of pointed Ïƒğœ\\sigma-data instances (ğ’œ,a)ğ’œğ‘(\\mathcal{A},a) is called a split-partner for Qğ‘„Q wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma} if, for all ğ’’â€²âˆˆğ’¬Ïƒsuperscriptğ’’â€²superscriptğ’¬ğœ{\\bm{q}}^{\\prime}\\in\\mathcal{Q}^{\\sigma}, we have An ontology language â„’â„’\\mathcal{L} is said to have general split-partners within ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma} if all finite sets of ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma}-queries have split partners wrtÂ any â„’â„’\\mathcal{L}-ontology in the signature Ïƒğœ\\sigma. If this holds for all singleton subsets of ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma}, we say that â„’â„’\\mathcal{L} has split-partners within ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma}. We illustrate the notion of split-partner by a few examples, the last of which shows that without the restriction to a finite signature Ïƒğœ\\sigma, split-partners almost never exist. (i)ğ‘–(i) Let ğ’ªğ’ª\\mathcal{O} be any ontology such that ğ’œğ’œ\\mathcal{A} and ğ’ªğ’ª\\mathcal{O} are satisfiable for all data instances ğ’œğ’œ\\mathcal{A}; for example, ğ’ª={AâŠ‘B}ğ’ªsquare-image-of-or-equalsğ´ğµ\\mathcal{O}=\\{A\\sqsubseteq B\\}. Let ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma} be any class of Ïƒğœ\\sigma-CQs, for some signature Ïƒğœ\\sigma. Then the split-partner ğ’®âŠ¥subscriptğ’®bottom\\mathcal{S}_{\\bot} of âŠ¥(x)bottomğ‘¥\\bot(x) wrtÂ ğ’ªğ’ª\\mathcal{O} in ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma} is the set Clearly, ğ’ª,â„¬ÏƒâŠ§ğ’’modelsğ’ªsubscriptâ„¬ğœğ’’\\mathcal{O},\\mathcal{B}_{\\sigma}\\models{\\bm{q}}, for any ğ’’âˆˆğ’¬Ïƒğ’’superscriptğ’¬ğœ{\\bm{q}}\\in\\mathcal{Q}^{\\sigma} different from âŠ¥bottom\\bot. (iâ€‹i)ğ‘–ğ‘–(ii) For ğ’ª={AâŠ“BâŠ‘âŠ¥}ğ’ªsquare-image-of-or-equalssquare-intersectionğ´ğµbottom\\mathcal{O}=\\{A\\sqcap B\\sqsubseteq\\bot\\} and Ïƒ={A,B}ğœğ´ğµ\\sigma=\\{A,B\\}, we have ğ’®âŠ¥={{Aâ€‹(a)},{Bâ€‹(a)}}subscriptğ’®bottomğ´ğ‘ğµğ‘\\mathcal{S}_{\\bot}=\\{\\{A(a)\\},\\ \\{B(a)\\}\\}. (iâ€‹iâ€‹i)ğ‘–ğ‘–ğ‘–(iii) There does not exist a split-partner for Q={Aâ€‹(x)}ğ‘„ğ´ğ‘¥Q=\\{A(x)\\} wrtÂ the empty ontology ğ’ªğ’ª\\mathcal{O} within ELIQ. To show this, observe that Bâ€‹(x)âŠ§Ì¸ğ’ªAâ€‹(x)subscriptnot-modelsğ’ªğµğ‘¥ğ´ğ‘¥B(x)\\not\\models_{\\mathcal{O}}A(x) for any unary predicate Bâ‰ Ağµğ´B\\not=A. Hence,\nas any data instance ğ’œğ’œ\\mathcal{A} is finite, there is no finite set ğ’®â€‹({Aâ€‹(x)})ğ’®ğ´ğ‘¥\\mathcal{S}(\\{A(x)\\}) satisfying (3). In contrast, for frontiers and unique characterisations, restrictions to sets of predicate symbols containing all symbols in the query and ontology do not make any difference. Indeed, let Ïƒğœ\\sigma contain all symbols in ğ’ªğ’ª\\mathcal{O} and ğ’’ğ’’{\\bm{q}}. Then, for any class ğ’¬ğ’¬\\mathcal{Q} of queries, a set â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}} is a frontier for ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q} if it is a frontier for ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within the restriction of ğ’¬ğ’¬\\mathcal{Q} to Ïƒğœ\\sigma. The reason is that if ğ’’âŠ§ğ’ªğ’’â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime} for a CQ ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} then ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} does not contain any symbols not in ğ’’ğ’’{\\bm{q}} or ğ’ªğ’ª\\mathcal{O} if ğ’’ğ’’{\\bm{q}} is satisfiable wrt ğ’ªğ’ª\\mathcal{O}.\nThe same holds for characterisations Eğ¸E of ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O}. ğ’œâ€‹â„’â€‹ğ’â€‹â„‹â€‹â„ğ’œâ„’ğ’â„‹â„\\mathcal{ALCHI} has general split-partners within ELIQÏƒâ€‹, which can be computed in exponential time.\n Suppose a finite set QâŠ†ELIQÏƒğ‘„superscriptELIQğœQ\\subseteq\\text{ELIQ}^{\\sigma} and an ğ’œâ€‹â„’â€‹ğ’â€‹â„‹â€‹â„ğ’œâ„’ğ’â„‹â„\\mathcal{ALCHI}-ontology ğ’ªğ’ª\\mathcal{O} in the signature Ïƒğœ\\sigma are given. Let subğ’ª,Qsubscriptsubğ’ªğ‘„\\textit{sub}_{\\mathcal{O},Q} be the closure under single negation of the set of subconcepts of concepts in Qğ‘„Q and ğ’ªğ’ª\\mathcal{O}. A type for ğ’ªğ’ª\\mathcal{O} is any maximal subset tpâŠ†subğ’ª,Qtpsubscriptsubğ’ªğ‘„\\textit{tp}\\subseteq\\textit{sub}_{\\mathcal{O},Q} consistent with ğ’ªğ’ª\\mathcal{O}. Let ğ‘»ğ‘»{\\bm{T}} be the set of all types for ğ’ªğ’ª\\mathcal{O}.\nDefine a Ïƒğœ\\sigma-data instance ğ’œğ’œ\\mathcal{A} with indâ€‹(ğ’œ)=ğ‘»indğ’œğ‘»\\textit{ind}(\\mathcal{A})={\\bm{T}}, Aâ€‹(tp)âˆˆğ’œğ´tpğ’œA(\\textit{tp})\\in\\mathcal{A} for all concept names AâˆˆÏƒğ´ğœA\\in\\sigma and tp such that Aâˆˆtpğ´tpA\\in\\textit{tp}, and Pâ€‹(tp,tpâ€²)âˆˆğ’œğ‘ƒtpsuperscripttpâ€²ğ’œP(\\textit{tp},\\textit{tp}^{\\prime})\\in\\mathcal{A} for all role names PâˆˆÏƒğ‘ƒğœP\\in\\sigma, tp and tpâ€²superscripttpâ€²\\textit{tp}^{\\prime} such that tp and tpâ€²superscripttpâ€²\\textit{tp}^{\\prime} can be satisfied by the domain elements of a model of ğ’ªğ’ª\\mathcal{O} that are related via Pğ‘ƒP. We consider an interpretation â„ğ’œsubscriptâ„ğ’œ\\mathcal{I}_{\\mathcal{A}} with Î”â„ğ’œ={indâ€‹(ğ’œ)}superscriptÎ”subscriptâ„ğ’œindğ’œ\\Delta^{\\mathcal{I}_{\\mathcal{A}}}=\\{\\textit{ind}(\\mathcal{A})\\}, Aâ„ğ’œ={tpâˆ£Aâ€‹(tp)âˆˆğ’œ}superscriptğ´subscriptâ„ğ’œconditional-settpğ´tpğ’œA^{\\mathcal{I}_{\\mathcal{A}}}=\\{\\textit{tp}\\mid A(\\textit{tp})\\in\\mathcal{A}\\} for concept names AâˆˆÏƒğ´ğœA\\in\\sigma, Aâ„ğ’œ=âˆ…superscriptğ´subscriptâ„ğ’œA^{\\mathcal{I}_{\\mathcal{A}}}=\\emptyset for Aâˆ‰Ïƒğ´ğœA\\not\\in\\sigma, Pâ„ğ’œ={(tp,tpâ€²)âˆ£Pâ€‹(tp,tpâ€²)âˆˆğ’œ}superscriptğ‘ƒsubscriptâ„ğ’œconditional-settpsuperscripttpâ€²ğ‘ƒtpsuperscripttpâ€²ğ’œP^{\\mathcal{I}_{\\mathcal{A}}}=\\{(\\textit{tp},\\textit{tp}^{\\prime})\\mid P(\\textit{tp},\\textit{tp}^{\\prime})\\in\\mathcal{A}\\} for role names PâˆˆÏƒğ‘ƒğœP\\in\\sigma, Pâ„ğ’œ=âˆ…superscriptğ‘ƒsubscriptâ„ğ’œP^{\\mathcal{I}_{\\mathcal{A}}}=\\emptyset for Pâˆ‰Ïƒğ‘ƒğœP\\not\\in\\sigma. It can be readily checked that, for any ğ’’âˆˆğ’¬Ïƒğ’’superscriptğ’¬ğœ{\\bm{q}}\\in\\mathcal{Q}^{\\sigma}, Let Q={ğ’’1,â€¦,ğ’’n}ğ‘„subscriptğ’’1â€¦subscriptğ’’ğ‘›Q=\\{{\\bm{q}}_{1},\\dots,{\\bm{q}}_{n}\\} and let ğ’œnsuperscriptğ’œğ‘›\\mathcal{A}^{n} be the nğ‘›n-times direct product of ğ’œğ’œ\\mathcal{A}. Set We proveÂ (3) for an arbitrary ğ’’â€²âˆˆğ’¬Ïƒsuperscriptğ’’â€²superscriptğ’¬ğœ{\\bm{q}}^{\\prime}\\in\\mathcal{Q}^{\\sigma}. For the (â‡’)â‡’(\\Rightarrow) direction, suppose ğ’ª,ğ’œnâŠ§ğ’’â€²â€‹(tpâ†’)modelsğ’ªsuperscriptğ’œğ‘›superscriptğ’’â€²â†’tp\\mathcal{O},\\mathcal{A}^{n}\\models{\\bm{q}}^{\\prime}(\\vec{\\textit{tp}}) for some (ğ’œn,tpâ†’)âˆˆğ’®â€‹(Q)superscriptğ’œğ‘›â†’tpğ’®ğ‘„(\\mathcal{A}^{n},\\vec{\\textit{tp}})\\in\\mathcal{S}(Q) and tpâ†’=(tp1,â€¦,tpn)â†’tpsubscripttp1â€¦subscripttpğ‘›\\vec{\\textit{tp}}=(\\textit{tp}_{1},\\dots,\\textit{tp}_{n}). Fix iâˆˆ{1,â€¦,n}ğ‘–1â€¦ğ‘›i\\in\\{1,\\dots,n\\}. Observe that the projection map hâ€‹((tp1â€²,â€¦,tpnâ€²))=tpiâ€²â„superscriptsubscripttp1â€²â€¦superscriptsubscripttpğ‘›â€²superscriptsubscripttpğ‘–â€²h((\\textit{tp}_{1}^{\\prime},\\dots,\\textit{tp}_{n}^{\\prime}))=\\textit{tp}_{i}^{\\prime} for (tp1â€²,â€¦,tpnâ€²)âˆˆğ‘»nsuperscriptsubscripttp1â€²â€¦superscriptsubscripttpğ‘›â€²superscriptğ‘»ğ‘›(\\textit{tp}_{1}^{\\prime},\\dots,\\textit{tp}_{n}^{\\prime})\\in{\\bm{T}}^{n} is a homomorphism from ğ’œnsuperscriptğ’œğ‘›\\mathcal{A}^{n} to ğ’œğ’œ\\mathcal{A} such that hâ€‹(tâ€‹pâ†’)=tpiâ„â†’ğ‘¡ğ‘subscripttpğ‘–h(\\vec{tp})=\\textit{tp}_{i}. As in the proof of LemmaÂ 1 (1)1(1), we obtain ğ’ª,ğ’œâŠ§ğ’’â€²â€‹(tpi)modelsğ’ªğ’œsuperscriptğ’’â€²subscripttpğ‘–\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}^{\\prime}(\\textit{tp}_{i}). Recall that Â¬ğ’’iâˆˆtpisubscriptğ’’ğ‘–subscripttpğ‘–\\neg{\\bm{q}}_{i}\\in\\textit{tp}_{i}. Then, byÂ (5), we have â„ğ’œ,tpiâŠ§ğ’’â€²modelssubscriptâ„ğ’œsubscripttpğ‘–superscriptğ’’â€²\\mathcal{I}_{\\mathcal{A}},\\textit{tp}_{i}\\models{\\bm{q}}^{\\prime}, â„ğ’œ,tpiâŠ§Ì¸ğ’’inot-modelssubscriptâ„ğ’œsubscripttpğ‘–subscriptğ’’ğ‘–\\mathcal{I}_{\\mathcal{A}},\\textit{tp}_{i}\\not\\models{\\bm{q}}_{i}, and so usingÂ (4) we obtain ğ’’â€²âŠ§Ì¸ğ’ªğ’’isubscriptnot-modelsğ’ªsuperscriptğ’’â€²subscriptğ’’ğ‘–{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}_{i}. For the opposite direction, suppose ğ’’â€²âŠ§Ì¸ğ’ªğ’’isubscriptnot-modelsğ’ªsuperscriptğ’’â€²subscriptğ’’ğ‘–{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}_{i} for all 1â‰¤iâ‰¤n1ğ‘–ğ‘›1\\leq i\\leq n. It follows that, for each iğ‘–i, there exists tpiâˆˆğ‘»subscripttpğ‘–ğ‘»\\textit{tp}_{i}\\in{\\bm{T}} such that ğ’’â€²,Â¬ğ’’iâˆˆtpisuperscriptğ’’â€²subscriptğ’’ğ‘–subscripttpğ‘–{\\bm{q}}^{\\prime},\\neg{\\bm{q}}_{i}\\in\\textit{tp}_{i}. Let tpâ†’=(tp1,â€¦,tpn)â†’tpsubscripttp1â€¦subscripttpğ‘›\\vec{\\textit{tp}}=(\\textit{tp}_{1},\\dots,\\textit{tp}_{n}). Clearly, (ğ’œn,tâ€‹pâ†’)âˆˆğ’®â€‹(Q)superscriptğ’œğ‘›â†’ğ‘¡ğ‘ğ’®ğ‘„(\\mathcal{A}^{n},\\vec{tp})\\in\\mathcal{S}(Q) and it remains to show that ğ’ª,ğ’œnâŠ§ğ’’â€²â€‹(tpâ†’)modelsğ’ªsuperscriptğ’œğ‘›superscriptğ’’â€²â†’tp\\mathcal{O},\\mathcal{A}^{n}\\models{\\bm{q}}^{\\prime}(\\vec{\\textit{tp}}). Observe that, for each tpisubscripttpğ‘–\\textit{tp}_{i}, byÂ (5), there exists a homomorphism hisubscriptâ„ğ‘–h_{i} that maps ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} into â„ğ’œsubscriptâ„ğ’œ\\mathcal{I}_{\\mathcal{A}} with its root mapped to tpisubscripttpğ‘–\\textit{tp}_{i}. By the construction of â„ğ’œsubscriptâ„ğ’œ\\mathcal{I}_{\\mathcal{A}}, the same holds for ğ’œğ’œ\\mathcal{A} in place of â„Asubscriptâ„ğ´\\mathcal{I}_{A}. Because ğ’œnsuperscriptğ’œğ‘›\\mathcal{A}^{n} is a direct product, there exists a homomorphism that maps ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} into ğ’œnsuperscriptğ’œğ‘›\\mathcal{A}^{n} with its root mapped to tâ€‹pâ†’â†’ğ‘¡ğ‘\\vec{tp}. Thus, ğ’œnâŠ§ğ’’â€²â€‹(tpâ†’)modelssuperscriptğ’œğ‘›superscriptğ’’â€²bold-â†’tp\\mathcal{A}^{n}\\models{\\bm{q}}^{\\prime}(\\bm{\\vec{\\textit{tp}}}).\nâˆ Our second sufficient condition of unique characterisability is as follows: Suppose ğ’¬ğ’¬\\mathcal{Q} is a class of queries, ğ’ªğ’ª\\mathcal{O} an ontology that admits containment reduction, ğªâˆˆğ’¬ğªğ’¬{\\bm{q}}\\in\\mathcal{Q} is satisfiable wrtÂ ğ’ªğ’ª\\mathcal{O}, and Ïƒğœ\\sigma is a signature containing the predicate symbols in ğªğª{\\bm{q}} and ğ’ªğ’ª\\mathcal{O}. If ğ’®ğªsubscriptğ’®ğª\\mathcal{S}_{{\\bm{q}}} is a split-partner for {ğª}ğª\\{{\\bm{q}}\\} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬Ïƒsuperscriptğ’¬ğœ\\mathcal{Q}^{\\sigma}, then ({(ğª^,a)},ğ’®ğª)^ğªğ‘subscriptğ’®ğª(\\{(\\hat{{\\bm{q}}},a)\\},\\mathcal{S}_{{\\bm{q}}}) is a singular+characterisation of ğªğª{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ğ’¬ğ’¬\\mathcal{Q}. Clearly, ğ’’ğ’’{\\bm{q}} fits Eğ¸E as ğ’ª,ğ’’^âŠ§ğ’’â€‹(a)modelsğ’ª^ğ’’ğ’’ğ‘\\mathcal{O},\\hat{{\\bm{q}}}\\models{\\bm{q}}(a) and ğ’ª,ğ’œâŠ§Ì¸ğ’’â€‹(a)not-modelsğ’ªğ’œğ’’ğ‘\\mathcal{O},\\mathcal{A}\\not\\models{\\bm{q}}(a) for any (ğ’œ,a)âˆˆğ’®ğ’’ğ’œğ‘subscriptğ’®ğ’’(\\mathcal{A},a)\\in\\mathcal{S}_{{\\bm{q}}} as otherwise ğ’’âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªğ’’ğ’’{\\bm{q}}\\not\\models_{\\mathcal{O}}{\\bm{q}}. Now, suppose ğ’’â€²â‰¢ğ’ªğ’’subscriptnot-equivalent-toğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\not\\equiv_{\\mathcal{O}}{\\bm{q}}. If ğ’’â€²âŠ§ğ’ªğ’’subscriptmodelsğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}, then ğ’’âŠ§Ì¸ğ’ªğ’’â€²subscriptnot-modelsğ’ªğ’’superscriptğ’’â€²{\\bm{q}}\\not\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime}, and so ğ’ª,ğ’’^âŠ§Ì¸ğ’’â€²â€‹(a)not-modelsğ’ª^ğ’’superscriptğ’’â€²ğ‘\\mathcal{O},\\hat{{\\bm{q}}}\\not\\models{\\bm{q}}^{\\prime}(a). Hence ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} does not fit Eğ¸E. If ğ’’â€²âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}, then there exists (ğ’œ,a)âˆˆğ’®ğ’’ğ’œğ‘subscriptğ’®ğ’’(\\mathcal{A},a)\\in\\mathcal{S}_{{\\bm{q}}} with ğ’ª,ğ’œâŠ§ğ’’â€²â€‹(a)modelsğ’ªğ’œsuperscriptğ’’â€²ğ‘\\mathcal{O},\\mathcal{A}\\models{\\bm{q}}^{\\prime}(a), and so again ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} does not fit Eğ¸E.\nâˆ As a consequence of TheoremÂ 10,Â 11 and LemmaÂ 1, we obtain the following: If ğªâˆˆELIQÏƒğªsuperscriptELIQğœ{\\bm{q}}\\in\\text{ELIQ}^{\\sigma} is satisfiable wrtÂ an ğ’œâ€‹â„’â€‹ğ’â€‹â„‹â€‹â„ğ’œâ„’ğ’â„‹â„\\mathcal{ALCHI}-ontology ğ’ªğ’ª\\mathcal{O} in a signature Ïƒğœ\\sigma, then ğªğª{\\bm{q}} has a singular+characterisation wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQÏƒ. The sufficient conditions for singular+characterisations of TheoremsÂ 8 andÂ 11 use the notions of frontier and split-partner, respectively. We now give examples showing that there are rather simple queries (and ontologies) with frontiers but no split-partners and vice versa. Hence these two notions are not equivalent. The query witnessing that frontiers can exist where split-partners do not exist provides a counterexample even if one admits frontiers containing CQs.\nIn more detail, a CQ-frontier for an ELIQ ğ’’ğ’’{\\bm{q}} wrtÂ to an ontology ğ’ªğ’ª\\mathcal{O} is a set â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}} of CQs such that if ğ’’â€²âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªsuperscriptğ’’â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime}, for a CQ ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} and an ELIQ ğ’’â€²â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime\\prime}, then ğ’’âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime} and ğ’’â€²â€²âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsuperscriptğ’’â€²â€²ğ’’{\\bm{q}}^{\\prime\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}; if ğ’’âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªğ’’superscriptğ’’â€²â€²{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime} and ğ’’â€²â€²âŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsuperscriptğ’’â€²â€²ğ’’{\\bm{q}}^{\\prime\\prime}\\not\\models_{\\mathcal{O}}{\\bm{q}}, for an ELIQ ğ’’â€²â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime\\prime},\nthen there exists ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} such that ğ’’â€²âŠ§ğ’ªğ’’â€²â€²subscriptmodelsğ’ªsuperscriptğ’’â€²superscriptğ’’â€²â€²{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}^{\\prime\\prime}. Clearly standard ELIQ frontiers defined above are also CQ-frontiers. â„°â€‹â„’â„°â„’\\mathcal{EL} does not admit finite CQ-frontiers within ELIQ. We show that the query ğ’’=Aâˆ§Bğ’’ğ´ğµ{\\bm{q}}=A\\wedge B does not have a finite CQ-frontier wrtÂ the ontology within ELIQs. Suppose otherwise. Let â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}} be such a CQ-frontier.\nConsider the ELIQs ğ’“n,m=âˆƒRnâ€‹âˆƒRâˆ’m.Bformulae-sequencesubscriptğ’“ğ‘›ğ‘šsuperscriptğ‘…ğ‘›superscriptsuperscriptğ‘…ğ‘šğµ\\bm{r}_{n,m}=\\exists R^{n}\\exists{R^{-}}^{m}.B with n>m>0ğ‘›ğ‘š0n>m>0. Clearly, ğ’’âŠ§Ì¸ğ’ªğ’“n,msubscriptnot-modelsğ’ªğ’’subscriptğ’“ğ‘›ğ‘š{\\bm{q}}\\not\\models_{\\mathcal{O}}\\bm{r}_{n,m}, and so ğ’“n,msubscriptğ’“ğ‘›ğ‘š\\bm{r}_{n,m} cannot be entailed wrtÂ ğ’ªğ’ª\\mathcal{O} by any CQ in â„±ğ’’subscriptâ„±ğ’’\\mathcal{F}_{{\\bm{q}}}. Thus, if ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} and Bâ€‹(x)ğµğ‘¥B(x) is in ğ’’â€²â€‹(x)superscriptğ’’â€²ğ‘¥{\\bm{q}}^{\\prime}(x), then we cannot have an Rğ‘…R-cycle in ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} reachable from xğ‘¥x along an Rğ‘…R-path as otherwise we would have ğ’’â€²âŠ§ğ’ªğ’“n,msubscriptmodelsğ’ªsuperscriptğ’’â€²subscriptğ’“ğ‘›ğ‘š{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}\\bm{r}_{n,m} for suitable n,mğ‘›ğ‘šn,m. Consider now the ELIQs ğ’’n=Bâˆ§âˆƒRn.âŠ¤formulae-sequencesubscriptğ’’ğ‘›ğµsuperscriptğ‘…ğ‘›top{\\bm{q}}_{n}=B\\wedge\\exists R^{n}.\\top,\nfor all nâ‰¥1ğ‘›1n\\geq 1. Clearly, ğ’’âŠ§ğ’ªğ’’nsubscriptmodelsğ’ªğ’’subscriptğ’’ğ‘›{\\bm{q}}\\models_{\\mathcal{O}}{\\bm{q}}_{n}. As ğ’’nâŠ§Ì¸ğ’ªğ’’subscriptnot-modelsğ’ªsubscriptğ’’ğ‘›ğ’’{\\bm{q}}_{n}\\not\\models_{\\mathcal{O}}{\\bm{q}}, infinitely many ğ’’nsubscriptğ’’ğ‘›{\\bm{q}}_{n} are entailed by some ğ’’â€²âˆˆâ„±ğ’’superscriptğ’’â€²subscriptâ„±ğ’’{\\bm{q}}^{\\prime}\\in\\mathcal{F}_{{\\bm{q}}} wrt ğ’ªğ’ª\\mathcal{O}. Take such a ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime}. Since Bâ€‹(x)âˆˆğ’’â€²ğµğ‘¥superscriptğ’’â€²B(x)\\in{\\bm{q}}^{\\prime} because of ğ’’â€²âŠ§ğ’ªğ’’nsubscriptmodelsğ’ªsuperscriptğ’’â€²subscriptğ’’ğ‘›{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}_{n}, no Rğ‘…R-cycle is reachable from xğ‘¥x via an Rğ‘…R-path in ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime}.\nNote also that no yğ‘¦y with Aâ€‹(y)âˆˆğ’’â€²ğ´ğ‘¦superscriptğ’’â€²A(y)\\in{\\bm{q}}^{\\prime} can be reached from xğ‘¥x along an Rğ‘…R-path as otherwise ğ’’â€²âŠ§ğ’ªBâˆ§âˆƒRk.Aformulae-sequencesubscriptmodelsğ’ªsuperscriptğ’’â€²ğµsuperscriptğ‘…ğ‘˜ğ´{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}B\\wedge\\exists R^{k}.A for some kâ‰¥0ğ‘˜0k\\geq 0 and, since Bâˆ§âˆƒRk.AâŠ§ğ’ªğ’’formulae-sequenceğµsuperscriptğ‘…ğ‘˜subscriptmodelsğ’ªğ´ğ’’B\\wedge\\exists R^{k}.A\\models_{\\mathcal{O}}{\\bm{q}} by the second axiom in ğ’ªğ’ª\\mathcal{O}, we would have ğ’’â€²âŠ§ğ’ªğ’’subscriptmodelsğ’ªsuperscriptğ’’â€²ğ’’{\\bm{q}}^{\\prime}\\models_{\\mathcal{O}}{\\bm{q}}. To derive a contradiction, we show now that there is an Rğ‘…R-path of any length nğ‘›n starting at xğ‘¥x in ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime}. Suppose this is not the case. Let nğ‘›n be the length of a longest Rğ‘…R-path starting at xğ‘¥x in ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime}. We construct a model â„â„\\mathcal{I} of ğ’ªğ’ª\\mathcal{O} and ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} refuting ğ’’n+lsubscriptğ’’ğ‘›ğ‘™{\\bm{q}}_{n+l}, for any lâ‰¥1ğ‘™1l\\geq 1. Define â„â„\\mathcal{I} by taking Î”â„=varâ€‹(ğ’’â€²)âˆª{d1,d2,â€¦}superscriptÎ”â„varsuperscriptğ’’â€²subscriptğ‘‘1subscriptğ‘‘2â€¦\\Delta^{\\mathcal{I}}=\\textit{var}({\\bm{q}}^{\\prime})\\cup\\{d_{1},d_{2},\\dots\\}, for fresh disubscriptğ‘‘ğ‘–d_{i}; aâˆˆBâ„ğ‘superscriptğµâ„a\\in B^{\\mathcal{I}} if Bâ€‹(a)âˆˆğ’’â€²ğµğ‘superscriptğ’’â€²B(a)\\in{\\bm{q}}^{\\prime}; aâˆˆAâ„ğ‘superscriptğ´â„a\\in A^{\\mathcal{I}} if there is an Rğ‘…R-path in ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} from ağ‘a to some yğ‘¦y with Aâ€‹(y)âˆˆğ’’â€²ğ´ğ‘¦superscriptğ’’â€²A(y)\\in{\\bm{q}}^{\\prime} or a=diğ‘subscriptğ‘‘ğ‘–a=d_{i} for some iğ‘–i; (a,b)âˆˆRâ„ğ‘ğ‘superscriptğ‘…â„(a,b)\\in R^{\\mathcal{I}} if Râ€‹(a,b)âˆˆğ’’â€²ğ‘…ğ‘ğ‘superscriptğ’’â€²R(a,b)\\in{\\bm{q}}^{\\prime} or there is an Rğ‘…R-path in ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} from ağ‘a to some yğ‘¦y with Aâ€‹(y)âˆˆğ’’â€²ğ´ğ‘¦superscriptğ’’â€²A(y)\\in{\\bm{q}}^{\\prime} and b=d1ğ‘subscriptğ‘‘1b=d_{1}, or a=diğ‘subscriptğ‘‘ğ‘–a=d_{i} and b=di+1ğ‘subscriptğ‘‘ğ‘–1b=d_{i+1}. By the construction and the fact that no yğ‘¦y with Aâ€‹(y)âˆˆğ’’â€²ğ´ğ‘¦superscriptğ’’â€²A(y)\\in{\\bm{q}}^{\\prime} can be reached from xğ‘¥x along an rğ‘Ÿr-path, â„â„\\mathcal{I} is a model of ğ’ªğ’ª\\mathcal{O} and ğ’’â€²superscriptğ’’â€²{\\bm{q}}^{\\prime} refuting ğ’’n+lsubscriptğ’’ğ‘›ğ‘™{\\bm{q}}_{n+l}.\nâˆ On the other hand, the following set of pointed data instances is a split-partner of {ğ’’}ğ’’\\{{\\bm{q}}\\} wrtÂ ğ’ªğ’ª\\mathcal{O} from the proof of TheoremÂ 13 within ELIQ{A,B,R}; here all arrows are assumed to be labelled with Rğ‘…R:\n \nağ‘aAğ´Abğ‘bA,Bğ´ğµA,Bağ‘aBğµBbğ‘bA,Bğ´ğµA,B There exist a DL-Liteâ„±âˆ’subscriptsuperscriptDL-Liteâ„±\\textsl{DL-Lite}^{-}_{\\mathcal{F}} ontology ğ’ªğ’ª\\mathcal{O}, a query ğªğª{\\bm{q}} and a signature Ïƒğœ\\sigma such that {ğª}ğª\\{{\\bm{q}}\\} does not have a finite split-partner wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQÏƒ. Consider ğ’’=Ağ’’ğ´{\\bm{q}}=A and ğ’ª={funâ€‹(P),funâ€‹(Pâˆ’),BâŠ“âˆƒPâˆ’âŠ‘âŠ¥}ğ’ªsquare-image-of-or-equalsfunğ‘ƒfunsuperscriptğ‘ƒsquare-intersectionğµsuperscriptğ‘ƒbottom\\mathcal{O}=\\{\\text{fun}(P),\\text{fun}(P^{-}),B\\sqcap\\exists P^{-}\\sqsubseteq\\bot\\}. We show that Q={ğ’’}ğ‘„ğ’’Q=\\{{\\bm{q}}\\} does not have a finite split partner wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQ{A,B,P}. Suppose otherwise and ğ’®â€‹(Q)ğ’®ğ‘„\\mathcal{S}(Q) is such a split-partner. Then there is (ğ’œ,a)âˆˆğ’®â€‹(Q)ğ’œğ‘ğ’®ğ‘„(\\mathcal{A},a)\\in\\mathcal{S}(Q) with ğ’ª,ğ’œâŠ§BâŠ“âˆƒPn.âŠ¤(a)formulae-sequencemodelsğ’ªğ’œsquare-intersectionğµsuperscriptğ‘ƒğ‘›topğ‘\\mathcal{O},\\mathcal{A}\\models B\\sqcap\\exists P^{n}.\\top(a) for all sufficiently large nğ‘›n because\nBâŠ“âˆƒPn.âŠ¤âŠ§Ì¸ğ’ªAB\\sqcap\\exists P^{n}.\\top\\not\\models_{\\mathcal{O}}A. Then ğ’œğ’œ\\mathcal{A} must contain nğ‘›n nodes if ğ’ªğ’ª\\mathcal{O} and ğ’œğ’œ\\mathcal{A} are satisfiable, so ğ’®â€‹(Q)ğ’®ğ‘„\\mathcal{S}(Q) is infinite. On the other hand, {âŠ¤}top\\{\\top\\} is a frontier for Ağ´A wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQ.\nâˆ Our final example in this section combines the examples of the two previous theorems and shows that even by taking\nfrontiers and splittings together we do not obtain a universal method for constructing singular+unique characterisations. Consider the ELIQ ğ’’=Aâˆ§Bğ’’ğ´ğµ{\\bm{q}}=A\\wedge B and the â„°â€‹â„’â€‹â„±â€‹â„âŠ¥â„°â„’â„±superscriptâ„bottom\\mathcal{ELFI}^{\\bot}-ontology It can be shown in the same way as above that ğ’’ğ’’{\\bm{q}} has no frontier wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQ and that ğ’’ğ’’{\\bm{q}} does not have any split-partner wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQ{A,B,R,P,E}. However, a singular+unique characterisation of ğ’’ğ’’{\\bm{q}} wrt ğ’ªğ’ª\\mathcal{O} within ELIQ is obtained by taking E+={ğ’’^}superscriptğ¸^ğ’’E^{+}=\\{\\hat{{\\bm{q}}}\\}\nand Eâˆ’superscriptğ¸E^{-} the same as in ExampleÂ 2. (To show the latter one only has to observe that Eâˆ’superscriptğ¸E^{-} is a split-partner of ğ’’ğ’’{\\bm{q}} wrtÂ ğ’ªğ’ª\\mathcal{O} within ELIQ{A,B,R} and that ğ’ª,ğ’’^âŠ§Ì¸ğ’“not-modelsğ’ª^ğ’’ğ’“\\mathcal{O},\\hat{{\\bm{q}}}\\not\\models\\bm{r} for any ğ’“ğ’“\\bm{r} containing any of the symbols Pğ‘ƒP or Eğ¸E.)\n\nReference markers found: [12]\n\nContext windows for each [ref]:\n[ref]12: by disallowing the functionality constraint inÂ (1) and adding axioms of the form known as role inclusions and often written as SâŠ‘Sâ€²square-image-of-or-equalsğ‘†superscriptğ‘†â€²S\\sqsubseteq S^{\\prime}. â€‹[ref]12 has the same role inclusions as inÂ (2) but more expressive concept inclusions âˆ€xâ€‹(C1â€‹(x)â†’C2â€‹(x))for-allğ‘¥â†’subscriptğ¶1ğ‘¥subscriptğ¶2ğ‘¥\\forall x\\,(C_{1}(x)\\to C_{2}(x)), in which the concepts\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 12,\n            \"titles\": [\n                \"The Complexity of Reverse Engineering Problems for Conjunctive Queries\",\n                \"Learning i/o automata\",\n                \"Characterizing schema mappings via data examples\",\n                \"Learning regular sets from queries and counterexamples\",\n                \"Queries and concept learning\",\n                \"The exact complexity of the first-order logic definability problem\",\n                \"The DL-Lite family and relations\",\n                \"Ontology-mediated query answering over temporal data: A survey\",\n                \"First-Order Rewritability of Ontology-Mediated Queries in Linear Temporal Logic\",\n                \"First-order rewritability and complexity of two-dimensional temporal ontology-mediated queries\",\n                \"A cookbook for temporal conceptual data modelling with description logics\",\n                \"Temporal query entailment in the description logic SHQ\",\n                \"An Introduction to Description Logics\",\n                \"First Order-Rewritability and Containment of Conjunctive Queries in Horn Description Logics\",\n                \"Ontology-based data access: A study through disjunctive datalog, CSP, and MMSNP\",\n                \"Temporal query answering in the description logic EL\",\n                \"Tractable reasoning and efficient query answering in description logics: The DL-Lite family\",\n                \"Learning interpretable models expressed in linear temporal logic\",\n                \"Active learning for extended finite state machines\",\n                \"Model Theory\",\n                \"The Complexity of Learning Linear Temporal Formulas from Examples\",\n                \"Unique Characterisability and Learnability of Temporal Instance Queries\",\n                \"Reverse Engineering of Temporal Queries Mediated by LTL Ontologies\",\n                \"Actively Learning Concepts and Conjunctive Queries under â„°â¢â„’^ğ‘Ÿ -Ontologies\",\n                \"Exact learning of ELI queries in the presence of dl-lite-horn ontologies\",\n                \"Frontiers and exact learning of ELI queries under dl-lite ontologies\",\n                \"Learning description logic concepts: When can positive and negative examples be separated?\",\n                \"Temporalized EL ontologies for accessing temporal data: Complexity of atomic queries\",\n                \"Reverse engineering queries in ontology-enriched systems: The case of expressive Horn description logic ontologies\",\n                \"Active automata learning in practice - an annotated bibliography of the years 2011 to 2016\",\n                \"Logical Separability of Labeled Data Examples under Ontologies\",\n                \"On (in)tractability of OBDA with OWL 2 QL\",\n                \"Schema Mappings and Data Examples: Deriving Syntax from Semantics (Invited Talk)\",\n                \"Exact Learning of Lightweight Description Logic Ontologies\",\n                \"Concept learning in description logics using refinement operators\",\n                \"General ltl specification mining (t)\",\n                \"Reverse engineering database queries from examples: State-of-the-art, challenges, and research opportunities\",\n                \"Equational bases and nonmodular lattice varieties\",\n                \"Learning linear temporal properties\",\n                \"Learning description logic ontologies: Five approaches. where do they stand?\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]12 based on the context and research area of Temporalising Unique Characterisability and Learnability of Ontology-Mediated Queries. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}