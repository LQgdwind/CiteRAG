{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Some Remarks on Palindromic Periodicities\n\nPaper Abstract: \n\nPaper Section Text:\nIn this section, we prove that for certain classes of words the fractional root is always symmetric. As we saw in the previous section, this implies in particular that these words are palindromic periodicities. A contiguous block in a word w𝑤w is called a factor of w𝑤w.\nRecall that an infinite binary word is called Sturmian\nif it has exactly n+1fragmentsn1n+1 distinct factors of length n𝑛n, for all n≥0fragmentsn0n\\geq 0. A finite binary word is called Sturmian if it is a factor of an infinite Sturmian word. A finite Sturmian word u𝑢u is a central word if 0u0fragments0u00u0, 0u1fragments0u10u1, 1u0fragments1u01u0 and 1u1fragments1u11u1 are all Sturmian words. Central words are palindromes. A finite Sturmian word is standard if it is of the form u01fragmentsu01u01 or u10fragmentsu10u10, where u𝑢u is a central word. In particular, the words u01fragmentsu01u01 and u10fragmentsu10u10 are conjugates and therefore a standard word is a conjugate of its reversal, i.e., it is symmetric. We prove the following result, originally conjectured by the second author. Every nonempty factor of a Sturmian word is a palindromic periodicity. A finite word is Sturmian if and only if its fractional root is a conjugate of a standard Sturmian word  and every standard Sturmian word is a conjugate of its reversal . Therefore, every finite Sturmian word has a symmetric fractional root, and hence it is a palindromic periodicity.\n∎ Notice that not every palindromic periodicity is a factor of a Sturmian word, with 001100110011 being a smallest example. A word is trapezoidal  (or stiff ) if it has at most k+1fragmentsk1k+1 distinct factors of length k𝑘k for every k𝑘k. Notice that trapezoidal words are binary words by definition. Finite Sturmian words are trapezoidal, but there are trapezoidal words that are not Sturmian (e.g., 001100110011). The structure of non-Sturmian trapezoidal words was described by D’Alessandro . Recall that a binary word w𝑤w is not Sturmian if and only if there exists a word u𝑢u such that both 0u0fragments0u00u0 and 1u1fragments1u11u1 are factors of w𝑤w . The pair (0u0,1u1)fragments(0u0,1u1)(0u0,1u1) is called a pathological pair. Moreover, it is possible to prove that the word u𝑢u in a pathological pair of minimal length is a central word .\nLet w𝑤w be a binary word that is not Sturmian. Then w𝑤w is trapezoidal if and only if w=pqfragmentswpqw=pq, where the fractional roots of pRfragmentsp𝑅p^{R} and q𝑞q are z0u0fragmentszfragments0u0z_{0u0} and z1u1fragmentszfragments1u1z_{1u1}. Moreover, p𝑝p and q𝑞q are Sturmian words. The word w=00001010fragmentsw00001010w=00001010 is trapezoidal but not Sturmian. Its pathological pair of minimal length is (000,101)fragments(000,101)(000,101), so that z000=0fragmentsz0000z_{000}=0 and z101=10fragmentsz10110z_{101}=10. The word w𝑤w can be written as w=pqfragmentswpqw=pq, with p=0000fragmentsp0000p=0000 and q=1010fragmentsq1010q=1010, where zpR=z000fragmentszfragmentsp𝑅z000z_{p^{R}}=z_{000} and zq=z101fragmentsz𝑞z101z_{q}=z_{101}. Every trapezoidal word has a symmetric fractional root; hence it is a palindromic periodicity. Let w𝑤w be a trapezoidal word. Since for Sturmian words the statement is true by Theorem 2, we can suppose that w𝑤w is not Sturmian. By the characterization of non-Sturmian trapezoidal words, w𝑤w contains a pathological pair of minimal length (0u0,1u1)fragments(0u0,1u1)(0u0,1u1) and can be written as w=pqfragmentswpqw=pq, where the fractional roots of pRfragmentsp𝑅p^{R} and q𝑞q are z0u0fragmentszfragments0u0z_{0u0} and z1u1fragmentszfragments1u1z_{1u1}. Then the fractional root zwfragmentsz𝑤z_{w} of w𝑤w is a conjugate of a word z′fragmentsz′z^{\\prime} of the form (z0u0R)n(z1u1)mfragments(zfragments0u0𝑅)𝑛(zfragments1u1)𝑚(z_{0u0}^{R})^{n}(z_{1u1})^{m} or (z1u1R)n(z0u0)mfragments(zfragments1u1𝑅)𝑛(zfragments0u0)𝑚(z_{1u1}^{R})^{n}(z_{0u0})^{m} for some n,m≥1fragmentsn,m1n,m\\geq 1. By known properties of central words, it is possible to prove that every word of this form is symmetric. Hence, zwfragmentsz𝑤z_{w} is symmetric, too.\n∎ The word w=010001000100010010010010010fragmentsw010001000100010010010010010w=010001000100010010010010010 is a non-Sturmian trapezoidal word. Its fractional root is zw=010001000100010010010010fragmentsz𝑤010001000100010010010010z_{w}=010001000100010010010010 (and we have w=zw010fragmentswz𝑤010w=z_{w}010).\nThe pathological pair of minimal length of w𝑤w is (0001000,1001001)=(0u0,1u1)fragments(0001000,1001001)(0u0,1u1)(0001000,1001001)=(0u0,1u1), where u=00100fragmentsu00100u=00100. The fractional root of 0u0fragments0u00u0 is z0u0=0001fragmentszfragments0u00001z_{0u0}=0001, while the fractional root of 1u1fragments1u11u1 is z1u1=100fragmentszfragments1u1100z_{1u1}=100. The word zwfragmentsz𝑤z_{w} is a conjugate of z′=100010001000100100100100=(1000)3(100)4=(z0u0R)3(z1u1)4fragmentsz′100010001000100100100100(1000)3(100)4(zfragments0u0𝑅)3(zfragments1u1)4z^{\\prime}=100010001000100100100100=(1000)^{3}(100)^{4}=(z_{0u0}^{R})^{3}(z_{1u1})^{4}. The word z′=1000100010001⋅00100100100fragmentsz′1000100010001⋅00100100100z^{\\prime}=1000100010001\\cdot 00100100100 is symmetric, and hence zwfragmentsz𝑤z_{w} is symmetric. The classes of Sturmian, trapezoidal, having symmetric fractional root, and palindromic periodicity form a strict inclusion hierarchy within the set of all finite binary words, as illustrated in Figure 1. Recall that a word of length n𝑛n contains at most n𝑛n nonempty distinct palindromic factors. A word of length n𝑛n is called rich if it contains n𝑛n distinct palindromic factors [ref]16. Every trapezoidal word is rich. But there are rich words that are not palindromic periodicities, e.g., 001011001011001011. On the other hand, there are palindromic periodicities that are not rich, a shortest example being 001001101011001001101011001001101011.\nThis is\nillustrated in Figure 2. However, if a word is rich and closed, then it is a palindromic periodicity. A word is called closed  (or periodic-like ) if it has length 111 or it has a factor that appears only as a prefix and as a suffix, i.e., without internal occurrences. For example, 000000, 011001100110 and 010100101001010 are closed, while 010101, 001000100010 and 010100101010010101001 are not. If a word is rich and closed, then it is a palindromic periodicity. In , Bucci, de Luca, and De Luca proved that if a word is rich and closed, then its fractional root is symmetric. Hence it is a palindromic periodicity.\n∎ Notice that the language of rich words is factorial (closed under taking factors) while the language of palindromic periodicities is not. Let us now consider larger alphabets. Recall that an infinite word is episturmian if its set of finite factors is closed under reversal and it has at most one left special factor (i.e., a factor that occurs preceded by at least two different letters) of each length. Moreover, an episturmian word is standard if all of its left special factors are prefixes of it. Episturmian words are a generalization of Sturmian words to larger alphabets. See  for a survey. Every nonempty prefix of a standard episturmian word is a palindromic periodicity. In , de Luca and De Luca proved that for every nonempty prefix w𝑤w of a standard episturmian word, the fractional root of w𝑤w is symmetric. Hence w𝑤w is a palindromic periodicity.\n∎ In particular, then, all nonempty prefixes of the Tribonacci word, the fixed point of the morphism\n0→01fragments0→010\\rightarrow 01, 1→02fragments1→021\\rightarrow 02, 2→0fragments2→02\\rightarrow 0, are palindromic periodicities. However, not all factors of the Tribonacci word are palindromic periodicities, 102102102 being a smallest example. See Section 5.5 for more discussion. The Burrows–Wheeler Transform (BWT) of a word w𝑤w is the word obtained by concatenating the last letters of the conjugates of w𝑤w sorted in lexicographic order. For example, if w=0120fragmentsw0120w=0120, the list of sorted conjugates of w𝑤w is {0012,0120,1200,2001}fragments{0012,0120,1200,2001}\\{0012,0120,1200,2001\\}, so the BWT of w𝑤w is 200120012001. By definition, the BWT of w𝑤w is the same as the BWT of any conjugate of w𝑤w. A word over the ordered alphabet Σ={0,1,…,k−1}fragmentsΣ{0,1,…,k1}\\Sigma=\\{0,1,\\ldots,k-1\\} is said to have perfectly clustered BWT if BWT(w)fragmentsBWT(w)\\operatorname{BWT}(w) belongs to (k−1)∗⋯1∗0∗fragments(k1)⋯10(k-1)^{*}\\cdots 1^{*}0^{*}. It is known that a binary word has perfectly clustered BWT if and only if it is a (power of) a standard Sturmian word . Over the ternary alphabet {0,1,2}fragments{0,1,2}\\{0,1,2\\}, words with perfectly clustered BWT are related to the three-distance theorem [ref]2. In , Puglisi and the third author proved that if a ternary word has perfectly clustered BWT, then it is symmetric. In particular, then, it is a palindromic periodicity.\n\nReference markers found: [16]\n\nContext windows for each [ref]:\n[ref]16: in Figure 1. Recall that a word of length n𝑛n contains at most n𝑛n nonempty distinct palindromic factors. A word of length n𝑛n is called rich if it contains n𝑛n distinct palindromic factors [ref]16. Every trapezoidal word is rich. But there are rich words that are not palindromic periodicities, e.g., 001011001011001011. On the other hand, there are palindromic periodicities that are not\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 16,\n            \"titles\": [\n                \"On the Combinatorics of Palindromes and Antipalindromes\",\n                \"On Tribonacci sequences\",\n                \"On the three-distance theorem\",\n                \"Words with many palindrome pair factors\",\n                \"On the palindromic complexity of infinite words\",\n                \"Logic and p-recognizable sets of integers\",\n                \"Enumeration and structure of trapezoidal words\",\n                \"Rich and periodic-like words\",\n                \"Periodic-like words, periodicity, and boxes\",\n                \"Sequences with minimal block growth\",\n                \"A combinatorial problem on trapezoidal words\",\n                \"Number representations and dragon curves–I, II\",\n                \"A classification of trapezoidal words\",\n                \"On the least number of palindromes contained in an infinite word\",\n                \"Uniqueness theorems for periodic functions\",\n                \"Episturmian words: a survey\",\n                \"Palindromic richness\",\n                \"Arithmetics and combinatorics of words of low complexity\",\n                \"On the number of words in the language {w∈Σ∗∣w=wR}2\",\n                \"On the combinatorics of finite words\",\n                \"Some characterizations of Sturmian words\",\n                \"Pseudopalindrome closure operators in free monoids\",\n                \"Some combinatorial properties of Sturmian words\",\n                \"Burrows-Wheeler transform and Sturmian words\",\n                \"Automatic theorem proving in Walnut\",\n                \"Some theorems on Fourier coefficients\",\n                \"The Logical Approach To Automatic Sequences: Exploring Combinatorics on Words with Walnut, Vol. 482 of London Math. Soc. Lecture Note Series\",\n                \"Extremal problems for polynomials and power series\",\n                \"Palindromic periodicities\",\n                \"Words with simple Burrows-Wheeler transforms\",\n                \"The On-Line Encyclopedia of Integer Sequences\",\n                \"Generated Reference Title 31 for [ref]16\",\n                \"Generated Reference Title 32 for [ref]16\",\n                \"Generated Reference Title 33 for [ref]16\",\n                \"Generated Reference Title 34 for [ref]16\",\n                \"Generated Reference Title 35 for [ref]16\",\n                \"Generated Reference Title 36 for [ref]16\",\n                \"Generated Reference Title 37 for [ref]16\",\n                \"Generated Reference Title 38 for [ref]16\",\n                \"Generated Reference Title 39 for [ref]16\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]16 based on the context and research area of Some Remarks on Palindromic Periodicities. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}