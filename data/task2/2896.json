{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Hierarchical Skills for Efficient Exploration\n\nPaper Abstract: \n\nPaper Section Text:\nAfter a low-level policy πlosuperscript𝜋lo\\pi^{\\rm lo} has been obtained via unsupervised pre-training, we employ it to construct a full hierarchical policy\nπ​(a|s)=πf​(F|s)​πg​(g|s,F)​πlo​(a|sp,F,g)𝜋conditional𝑎𝑠superscript𝜋fconditional𝐹𝑠superscript𝜋gconditional𝑔𝑠𝐹superscript𝜋loconditional𝑎superscript𝑠𝑝𝐹𝑔\\pi(a|s)=\\pi^{\\rm f}(F|s)\\pi^{\\rm g}(g|s,F)\\pi^{\\rm lo}(a|s^{p},F,g).\nThe hierarchical policy is applied to downstream tasks, where we are supplied with a reward signal and state observations 𝒮=𝒮p∪𝒮+𝒮superscript𝒮psuperscript𝒮\\mathcal{S}=\\mathcal{S}^{\\rm p}\\cup\\mathcal{S}^{+}.\nWhile different frequencies may be considered for acting with πfsuperscript𝜋f\\pi^{\\rm f} and πgsuperscript𝜋g\\pi^{\\rm g}, in this work both high-level actions are selected in lock-step.\nFor jointly learning πfsuperscript𝜋f\\pi^{\\rm f} and πgsuperscript𝜋g\\pi^{\\rm g}, we extend the SAC algorithm to incorporate the factored action space ℱ×𝒢ℱ𝒢\\mathcal{F}\\times\\mathcal{G} . In particular, it is necessary to extend SAC to deal with a joint discrete and continuous action space, which we describe below (see Appendix D for further details and pseudo-code for high-level policy training). We formulate our extension with a shared critic Q​(s,F,g)𝑄𝑠𝐹𝑔Q(s,F,g), incorporating both factors of the action space.\nQ​(s,F,g)𝑄𝑠𝐹𝑔Q(s,F,g) is trained to minimize the soft Bellman residual [18, Eq. 5], with the soft value function V​(s)𝑉𝑠V(s) including entropy terms for both policies.\nSince πfsuperscript𝜋f\\pi^{\\rm f} outputs a distribution over discrete actions (to select from available goal spaces), we compute its entropy in closed form instead of using the log-likelihood of the sampled action as for πgsuperscript𝜋g\\pi^{\\rm g}.\nWe employ separate temperatures α𝛼\\alpha and βFsuperscript𝛽𝐹\\beta^{F} for the goal space policy as well as for each corresponding goal policy; βFsuperscript𝛽𝐹\\beta^{F} are normalized to account for varying action dimensions across goal spaces. Compared to the usual SAC objective for continuous actions, we subtract log⁡|ℱ|ℱ\\log|\\cal F| from the entropy to ensure a negative contribution to the reward. This matches the sign of the entropy penalty from πgsuperscript𝜋g\\pi^{\\rm g}, which is negative in standard hyper-parameter settings111The entropy for continuous actions sampled from a Gaussian distribution can be negative since it is based on probability densities. . Otherwise, the entropy terms for discrete and continuous actions may cancel each other in Q-function targets computed from V​(s)𝑉𝑠V(s). The policy loss [18, Eq. 7] is likewise modified to include both entropy terms.\nParameterizing the policies with ϕitalic-ϕ\\phi and ψ𝜓\\psi and the Q-function with ρ𝜌\\rho, we obtain where the replay buffer is denoted with B𝐵B.\nThe scalar-valued entropy temperatures are updated automatically during learning to maintain target entropies ℋ¯fsuperscript¯ℋ𝑓\\operatorname{\\overline{\\mathcal{H}}}^{f} and ℋ¯gsuperscript¯ℋ𝑔\\operatorname{\\overline{\\mathcal{H}}}^{g} for both πfsuperscript𝜋f\\pi^{\\rm f} and πgsuperscript𝜋g\\pi^{\\rm g}.\nThe following losses are minimized at each training step: We implement temporal abstraction by selecting high-level actions with a reduced frequency.\nThis incurs a reduction in available training data since, when taking a high-level action every c𝑐c steps in an N𝑁N-step episode, we obtain only N/c𝑁𝑐N/c high-level transitions.\nTo leverage all available transitions gathered during training, we adopt the step-conditioned critic proposed by Whitney et al. [ref]52 in our SAC formulation.\nThe Q-function receives an additional input 0≤i≤c0𝑖𝑐0\\leq i\\leq c marking the number of steps from the last high-level action, and is trained to minimize a modified soft Bellman residual: As in [ref]52, Q​(s,F,g,0)𝑄𝑠𝐹𝑔0Q(s,F,g,0) is used when computing V​(s)𝑉𝑠V(s) and the policy loss Jπf,g​(ϕ,ψ)subscript𝐽superscript𝜋𝑓𝑔italic-ϕ𝜓J_{\\pi^{f,g}}(\\phi,\\psi). The factorized high-level action space of HSD-3 has previously been studied as parameterized action spaces [ref]28 [ref]51, albeit with a small number of discrete actions and not in the context of hierarchical RL.\nA possible application of Soft Actor-Critic is described in Delalleau et al. ; our approach differs in that we (a) compute the soft value function as a weighted sum over all discrete actions, and (b) opt for two separately parameterized actors and a shared critic.\nThese design choices proved to be more effective in initial experiments.\n\nReference markers found: [52]\n\nContext windows for each [ref]:\n[ref]52: an N𝑁N-step episode, we obtain only N/c𝑁𝑐N/c high-level transitions.\nTo leverage all available transitions gathered during training, we adopt the step-conditioned critic proposed by Whitney et al. [ref]52 in our SAC formulation.\nThe Q-function receives an additional input 0≤i≤c0𝑖𝑐0\\leq i\\leq c marking the number of steps from the last high-level action, and is trained to minimize a modified\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 52,\n            \"titles\": [\n                \"Hierarchical Reinforcement Learning by Discovering Intrinsic Options\",\n                \"Variational Option Discovery Algorithms\",\n                \"OPAL: Offline Primitive Discovery for Accelerating Offline Reinforcement Learning\",\n                \"The Option-Critic Architecture\",\n                \"Neuronlike adaptive elements that can solve difficult learning control problems\",\n                \"OpenAI Gym\",\n                \"Explore, Discover and Learn: Unsupervised Discovery of State-Covering Skills\",\n                \"Similarity estimation techniques from rounding algorithms\",\n                \"Feudal Reinforcement Learning\",\n                \"Discrete and Continuous Action Representation for Practical RL in Video Games\",\n                \"Hierarchical Reinforcement Learning with the MAXQ Value Function Decomposition\",\n                \"Swing-twist decomposition in Clifford algebra\",\n                \"Benchmarking Deep Reinforcement Learning for Continuous Control\",\n                \"Diversity is All You Need: Learning Skills without a Reward Function\",\n                \"Learning and executing generalized robot plans\",\n                \"Stochastic Neural Networks for Hierarchical Reinforcement Learning\",\n                \"Divide-and-Conquer Reinforcement Learning\",\n                \"Variational Intrinsic Control\",\n                \"Soft Actor-Critic Algorithms and Applications\",\n                \"Learning an Embedding Space for Transferable Robot Skills\",\n                \"Emergence of Locomotion Behaviours in Rich Environments\",\n                \"The utility of temporal abstraction in reinforcement learning\",\n                \"Adam: A Method for Stochastic Optimization\",\n                \"Building Portable Options: Skill Transfer in Reinforcement Learning\",\n                \"Sub-Policy Adaptation for Hierarchical Reinforcement Learning\",\n                \"Planning in Learned Latent Action Spaces for Generalizable Legged Locomotion\",\n                \"A Laplacian Framework for Option Discovery in Reinforcement Learning\",\n                \"Hierarchical RL Using an Ensemble of Proprioceptive Periodic Policies\",\n                \"Reinforcement Learning with Parameterized Actions\",\n                \"Learning human behaviors from motion capture by adversarial imitation\",\n                \"Hierarchical visuomotor control of humanoids\",\n                \"Neural probabilistic motor primitives for humanoid control\",\n                \"Catch & Carry: Reusable Neural Controllers for Vision-Guided Whole-Body Tasks\",\n                \"Data-Efficient Hierarchical Reinforcement Learning\",\n                \"Near-Optimal Representation Learning for Hierarchical Reinforcement Learning\",\n                \"Why Does Hierarchy (Sometimes) Work So Well in Reinforcement Learning?\",\n                \"MCP: Learning Composable Hierarchical Control with Multiplicative Compositional Policies\",\n                \"Accelerating Reinforcement Learning with Learned Skill Priors\",\n                \"Composing Task-Agnostic Policies with Deep Reinforcement Learning\",\n                \"Learning by Playing – Solving Sparse Reward Tasks from Scratch\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]52 based on the context and research area of Hierarchical Skills for Efficient Exploration. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}