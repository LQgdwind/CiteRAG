{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Pointwise Distance Distributions of periodic point sets\n\nPaper Abstract: \n\nPaper Section Text:\nThis paper resolves the long-standing challenge of ambiguous data representation for periodic structures that model all solid crystalline materials (crystals).\nAny real crystal is best modeled as a periodic set SâŠ‚â„nğ‘†superscriptâ„ğ‘›S\\subset\\mathbb{R}^{n} of points at all atomic centers, whose positions have a physical meaning and are determined via X-ray diffraction patterns.\nEdges between points are excluded because they only abstractly represent inter-atomic bonds that depend on thresholds for distances and angles . The simplest example is a lattice Î›âŠ‚â„nÎ›superscriptâ„ğ‘›\\Lambda\\subset\\mathbb{R}^{n} consisting of all integer linear combinations of a basis whose vectors span a unit cell Uğ‘ˆU, whose translational copies are shown in Fig.Â 1 only for convenience. Materials discovery still relies on trial-and-error because periodic crystals are traditionally represented by non-invariants (descriptors with false negatives) or discontinuous invariants such as symmetry groups that break down under tiny perturbations.\nThese conventional descriptions cannot identify fraudulent structures in experimental datasets that keep depositing numerous (near-)duplicates without reliable tools for justified comparisons .\nThe ambiguity challenge will be rigorously stated in ProblemÂ 1.1 as a classification of periodic sets up to isometry preserving the rigid form of crystals. Fig.Â 1 illustrates the first obstacle: the same lattice can be generated by infinitely many different bases or unit cells.\nSo distinguishing only lattices up to isometry is already non-trivial.\nThen any periodic point set Sğ‘†S is a sum Î›+M={uâ†’+vâ†’:uâˆˆÎ›,vâˆˆM}Î›ğ‘€conditional-setâ†’ğ‘¢â†’ğ‘£formulae-sequenceğ‘¢Î›ğ‘£ğ‘€\\Lambda+M=\\{\\vec{u}+\\vec{v}\\,:\\,u\\in\\Lambda,v\\in M\\}, where a motif Mğ‘€M is a finite set of points in the basis of Uğ‘ˆU.\nAny lattice Î›Î›\\Lambda is considered as a periodic set with a 1-point motif M={p}ğ‘€ğ‘M=\\{p\\}.\nA single point pğ‘p can be arbitrarily chosen in a unit cell Uğ‘ˆU as in the first two pictures of Fig.Â 1.\nBasis vectors of Uğ‘ˆU and atomic coordinates of motif points (atomic centers) in Mğ‘€M form a conventional Crystallographic Information File (CIF).\nFig.Â 2Â (left) shows the ambiguity of the CIF pair (Î›,M)Î›ğ‘€(\\Lambda,M) even if a basis of Uğ‘ˆU is fixed.\nThe recent work by Edelsbrunner et al  initiated a new research area in classifications of periodic point sets up to isometry.\nAn isometry of Euclidean space â„nsuperscriptâ„ğ‘›\\mathbb{R}^{n} is any map that maintains inter-point distances.\nAny orientation-preserving isometry can be realized as a continuous rigid motion, for example any composition of translations and rotations in â„3superscriptâ„3\\mathbb{R}^{3}.\nThis equivalence is most natural for periodic point sets that represent real rigid structures. Crystals can be reliably distinguished up to isometry only by an isometry invariant that takes the same value on all isometric sets, hence having no false negatives.\nIf a descriptor allows false negatives, we can make no reliable conclusions because equivalent objects can have different representations as in Fig.Â 1 and 2Â (left).\nHence, non-invariants such as edge-lengths and angles of a unit cell, or coordinates of motif points in a cell basis cannot be used to justifiably compare crystals .\nIt suffices to classify up to isometry including mirror reflections.\nAs a linear map, an isometry fğ‘“f reverses orientation if the determinant det(v1,â€¦,vn)subscriptğ‘£1â€¦subscriptğ‘£ğ‘›\\det(v_{1},\\dots,v_{n}) of basis vectors has the same sign as det(fâ€‹(v1),â€¦,fâ€‹(vn))ğ‘“subscriptğ‘£1â€¦ğ‘“subscriptğ‘£ğ‘›\\det(f(v_{1}),\\dots,f(v_{n})). The traditional approach to identify a periodic crystal is to use its conventional or reduced cell [45, sectionÂ 9.3].\nThis reduced cell has been known to be discontinuous under perturbations [ref]1 even for lattices when a motif Mğ‘€M is a single point.\nMore formally, [24, sectionÂ 1] and [33, TheoremÂ 15] proved that a continuous reduced cell cannot be defined for all lattices.\nFor more general periodic sets, discontinuity of many past discrete invariants such as symmetry groups becomes clearer in Fig.Â 2Â (right) showing that even real-valued invariants struggle to continuously quantify the similarity between nearly sets.\nThe minimum volume of a cell Uğ‘ˆU can easily double, while the density (the number or mass of points divided by the cell volume) remains constant under perturbations of points. The continuous isometry classification of periodic sets has been an open problem since 1980 [ref]1. Find a function Iğ¼I on all periodic sets of unlabeled points in â„nsuperscriptâ„ğ‘›\\mathbb{R}^{n} such that (1.1a) invariance :\nif any periodic point sets Sâ‰…Qğ‘†ğ‘„S\\cong Q are isometric in â„nsuperscriptâ„ğ‘›\\mathbb{R}^{n}, then Iâ€‹(S)=Iâ€‹(Q)ğ¼ğ‘†ğ¼ğ‘„I(S)=I(Q), so the invariant Iğ¼I has no false negatives; (1.1b)\ncompleteness :\nif Iâ€‹(S)=Iâ€‹(Q)ğ¼ğ‘†ğ¼ğ‘„I(S)=I(Q) for any periodic point sets S,Qğ‘†ğ‘„S,Q, then Sâ‰…Qğ‘†ğ‘„S\\cong Q are isometric, so the invariant Iğ¼I has no false positives; (1.1c) metric :\na distance dğ‘‘d between values of Iğ¼I satisfies all axioms;\n1) dâ€‹(I1,I2)=0ğ‘‘subscriptğ¼1subscriptğ¼20d(I_{1},I_{2})=0 if and only if I1=I2subscriptğ¼1subscriptğ¼2I_{1}=I_{2}, 2) symmetry dâ€‹(I1,I2)=dâ€‹(I2,I1)ğ‘‘subscriptğ¼1subscriptğ¼2ğ‘‘subscriptğ¼2subscriptğ¼1d(I_{1},I_{2})=d(I_{2},I_{1}), 3) triangle inequality\ndâ€‹(I1,I3)â‰¤dâ€‹(I1,I2)+dâ€‹(I2,I3)ğ‘‘subscriptğ¼1subscriptğ¼3ğ‘‘subscriptğ¼1subscriptğ¼2ğ‘‘subscriptğ¼2subscriptğ¼3d(I_{1},I_{3})\\leq d(I_{1},I_{2})+d(I_{2},I_{3}); (1.1d) continuity :\nif Qğ‘„Q is obtained from a periodic set SâŠ‚â„nğ‘†superscriptâ„ğ‘›S\\subset\\mathbb{R}^{n} by shifting each point of Sğ‘†S by at most Îµğœ€\\varepsilon, then dâ€‹(Iâ€‹(S),Iâ€‹(Q))â‰¤Câ€‹Îµğ‘‘ğ¼ğ‘†ğ¼ğ‘„ğ¶ğœ€d(I(S),I(Q))\\leq C\\varepsilon for a fixed constant Cğ¶C and any such periodic point sets S,QâŠ‚â„nğ‘†ğ‘„superscriptâ„ğ‘›S,Q\\subset\\mathbb{R}^{n}; (1.1e)\ncomputability : the invariant Iğ¼I, the metric dğ‘‘d and verification of Iâ€‹(S)=Iâ€‹(Q)ğ¼ğ‘†ğ¼ğ‘„I(S)=I(Q) should be computed in a near-linear time in the number of motif points of periodic sets for a fixed dimension nğ‘›n; (1.1f)\ninverse design : any periodic point set SâŠ‚â„nğ‘†superscriptâ„ğ‘›S\\subset\\mathbb{R}^{n} can be reconstructed from its invariant Iâ€‹(S)ğ¼ğ‘†I(S).\n â– â– \\blacksquare ProblemÂ 1.1 is the ultimate Data Science challenge for all periodic crystals Sğ‘†S whose non-invariant input (a cell basis and a motif) should be transformed into a complete invariant Iâ€‹(S)ğ¼ğ‘†I(S), which uniquely and unambiguously represents any Sğ‘†S.\nSuch a complete invariant can be considered as a materials genome  or a DNA-type code that also allows an explicit reconstruction for any periodic crystal. For example, Computer Vision tries to identify humans and other objects such as road signs by using pixel-based images as input.\nSimilar to other real objects, any periodic crystal can be given by (infinitely) many inputs.\nProblemÂ 1.1 is an example of the data ambiguity challenge for almost any application that needs to uniquely identify a real object.\nBiology has partially solved this challenge by a DNA code, though a living creature cannot be easily created from a given code.\nConditionÂ (1.1f) goes further and requires a full reconstruction of a periodic crystal Sğ‘†S from its DNA-style code Iâ€‹(S)ğ¼ğ‘†I(S). The proposed solution to ProblemÂ 1.1 is the isometry invariant Iğ¼I called the Pointwise Distance Distribution PDDPDD\\mathrm{PDD}.\nTheoremsÂ 3.2,Â 4.3,Â 5.1 ,Â 4.4 prove that PDDPDD\\mathrm{PDD} satisfies all conditions of ProblemÂ 1.1, even (1.1b) at least for generic sets.\nMore exactly, TheoremÂ 4.4 shows that\nany periodic point set SâŠ‚â„nğ‘†superscriptâ„ğ‘›S\\subset\\mathbb{R}^{n} in general position can be explicitly reconstructed from PDD and lattice invariants. The strength of PDDPDD\\mathrm{PDD} was experimentally checked for all 660K+ periodic crystals in the worldâ€™s largest Cambridge Structural Database (CSD).\nDespite the CSD being curated to contain only real and distinct structures , the new invariants identified several pairs of duplicates.\nAll the underlying publications are now being investigated for data integrity by five journals, see details in sectionÂ 6. ProblemÂ 1.1 is stated in the hardest scenario when points are unordered and unlabeled because many real crystals have identical compositions.\nFor example, diamond and graphite (whose 2-dimensional layer is famous graphene) consist of pure carbon but have vastly different physical properties. ConditionsÂ (1.1cd) for a continuous metric are stronger than a complete classification in (1.1ab):\ndetecting an isometry gives a discontinuous metric dâ€‹(S,Q)=1ğ‘‘ğ‘†ğ‘„1d(S,Q)=1 (or another positive number) for all non-isometric Sâ‰…Ì¸Qğ‘†ğ‘„S\\not\\cong Q even if S,Qğ‘†ğ‘„S,Q are near duplicates as in Fig.Â 2Â (right).\nContinuity under perturbations is practically important because atoms vibrate, and any real measurement of a crystal produces slightly different coordinates of its unit cell and motif.\nAny simulation of periodic structures introduces floating point errors because of inevitable approximations by iterative optimization. Thousands of near-duplicates are routinely produced, though only a few structures are synthesized.\nFive real structures of 5679 predicted on a supercomputer over 12 weeks are a typical example .\nThis â€˜embarrassment of over-predictionâ€™ wastes resources and time to run simulations and then analyze results, often by visual inspection, because there were no invariants that resolve ProblemÂ 1.1. Computability conditionÂ (1.1e) avoids the trivial function Iâ€‹(S)=Sğ¼ğ‘†ğ‘†I(S)=S in ProblemÂ 1.1.\nInverse design in (1.1f) allows one to replace the traditional blind sampling (of ambiguous cells and motifs leading to (near-)duplicates via optimization) with a guided exploration of the crystal space parameterized by complete and reversible invariants.\nSectionÂ 2 shows that the state-of-the-art tools remain stuck with conditions (1.1ab) while the new invariants satisfy the stronger practical requirements (1.1cdef).\n\nReference markers found: [1]\n\nContext windows for each [ref]:\n[ref]1: The traditional approach to identify a periodic crystal is to use its conventional or reduced cell [45, sectionÂ 9.3].\nThis reduced cell has been known to be discontinuous under perturbations [ref]1 even for lattices when a motif Mğ‘€M is a single point.\nMore formally, [24, sectionÂ 1] and [33, TheoremÂ 15] proved that a continuous reduced cell cannot be defined for all lattices.\nFor more\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 1,\n            \"titles\": [\n                \"Introduction to Periodic Geometry and Topology\",\n                \"A perturbation stable cell comparison technique\",\n                \"Algorithms for continuous metrics on periodic crystals\",\n                \"An isometry classification of periodic point sets\",\n                \"Density functions of periodic sequences\",\n                \"On representing chemical environments\",\n                \"Atom-centered symmetry functions for constructing high-dimensional neural network potentials\",\n                \"Shape matching and object recognition using shape contexts\",\n                \"Better living through coordination chemistry: A descriptive study of a prolific papermill that combines crystallography and medicine\",\n                \"Regular and multi-regular t-bonded systems\",\n                \"On reconstructing n-point configurations from the distribution of distances or areas\",\n                \"Testing the congruence of d-dimensional point sets\",\n                \"Geographic-style maps for 2-dimensional lattices\",\n                \"Welcome to a continuous world of 3-dimensional lattices\",\n                \"The csd drug subset: The changing chemistry and crystallography of small molecule pharmaceuticals\",\n                \"Compack: a program for identifying crystal structure similarity using distances\",\n                \"The earth moverâ€™s distance: Lower bounds and invariance under translation\",\n                \"Low-dimensional lattices. vi. voronoi reduction of three-dimensional lattices\",\n                \"Structure determination from powder diffraction data, volume 13\",\n                \"New frontiers for the materials genome initiative\",\n                \"Regular t-bonded systems in R3\",\n                \"Multiregular point systems\",\n                \"Linearly Converging Quasi Branch and Bound Algorithms for Global Rigid Registration\",\n                \"The Density Fingerprint of a Periodic Point Set\",\n                \"Voronoi diagrams and arrangements\",\n                \"The mergegram of a dendrogram and its stability\",\n                \"Isometry invariant shape recognition of projectively perturbed point clouds by the mergegram extending 0D persistence\",\n                \"New compressed cover tree for k-nearest neighbor search (phd thesis)\",\n                \"A new compressed cover tree guarantees a near linear parameterized complexity for all k-nearest neighbors search in metric spaces\",\n                \"Paired compressed cover trees guarantee a near linear parametrized complexity for all ğ‘˜-nearest neighbors search in an arbitrary metric space\",\n                \"Functional materials discovery using energyâ€“structure maps\",\n                \"The Cambridge Structural Database\",\n                \"Average minimum distances of periodic point sets\",\n                \"Point registration via efficient convex relaxation\",\n                \"Integral invariants for robust geometry processing\",\n                \"Geometrical bijections in discrete lattices\",\n                \"Go-ICP: A Globally Optimal Solution to 3D ICP Point-Set Registration\",\n                \"Fast and robust comparison of probability measures in heterogeneous spaces\",\n                \"Integral invariants for shape matching\",\n                \"Completeness of Atomic Structure Representations\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]1 based on the context and research area of Pointwise Distance Distributions of periodic point sets. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}