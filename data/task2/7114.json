{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Computing Balanced Solutions for Large International Kidney Exchange Schemes When Cycle Length Is Unbounded\n\nPaper Abstract: \n\nPaper Section Text:\nIn this paper, we introduce a new class of cooperative games called partitioned permutation games, which are closely related to the known classes of permutation games and partitioned matching games (introduced at AAMAS 2019 ). Both partitioned matching games and partitioned permutation games have immediate applications in international kidney exchange. Before defining these games, we first explain this application area. Kidney Exchange.\nThe most effective treatment for kidney failure is transplanting a kidney from a deceased or living donor, with better long-term outcomes in the latter case. However, a kidney from a family member or friend might be medically incompatible and could easily be rejected by the patient’s body. Therefore, many countries are running national Kidney Exchange Programmes (KEPs) . In a KEP, all patient-donor pairs are placed together in one pool.\nIf for two patient-donor pairs (p,d)𝑝𝑑(p,d) and (p′,d′)superscript𝑝′superscript𝑑′(p^{\\prime},d^{\\prime}), it holds that d𝑑d and p𝑝p are incompatible, as well as d′superscript𝑑′d^{\\prime} with p′superscript𝑝′p^{\\prime}, then d𝑑d and d′superscript𝑑′d^{\\prime} could donate a kidney to p′superscript𝑝′p^{\\prime} and p𝑝p, respectively. This is a 222-way exchange. We now generalize a 222-way exchange. We model a pool of patient-donor pairs as a directed graph G=(V,A)𝐺𝑉𝐴G=(V,A) (the compatibility graph) in which V𝑉V consists of the patient-donor pairs, and A𝐴A consists of every arc (u,v)𝑢𝑣(u,v) such that the donor of u𝑢u is compatible with the patient of v𝑣v. In a directed cycle C=u1​u2​…​uk​u1𝐶subscript𝑢1subscript𝑢2…subscript𝑢𝑘subscript𝑢1C=u_{1}u_{2}\\ldots u_{k}u_{1}, for some k≥2𝑘2k\\geq 2, the kidney of the donor of uisubscript𝑢𝑖u_{i} could be given to the patient of ui+1subscript𝑢𝑖1u_{i+1} for every i∈{1,…,k+1}𝑖1…𝑘1i\\in\\{1,\\ldots,k+1\\}, with uk+1:=u1assignsubscript𝑢𝑘1subscript𝑢1u_{k+1}:=u_{1}. This is a k𝑘k-way exchange using the exchange cycle C𝐶C.\nTo prevent exchange cycles from breaking (and a patient from losing their willing donor), hospitals perform the k𝑘k transplants in a k𝑘k-way exchange simultaneously. Hence,\nKEPs impose a bound ℓℓ\\ell (the exchange bound) on the maximum length of an exchange cycle, typically 2≤ℓ≤52ℓ52\\leq\\ell\\leq 5. An ℓℓ\\ell-cycle packing of G𝐺G is\na set 𝒞𝒞{\\mathcal{C}} of directed cycles, each of length at most ℓℓ\\ell, that are pairwise vertex-disjoint; if ℓ=∞ℓ\\ell=\\infty, we also say that 𝒞𝒞{\\mathcal{C}} is a cycle packing.\nThe size of 𝒞𝒞{\\mathcal{C}} is the number of arcs that belong to a cycle in 𝒞𝒞{\\mathcal{C}}. KEPs operate in rounds.\nA solution for round r𝑟r is an ℓℓ\\ell-cycle packing in the corresponding compatibility graph Grsuperscript𝐺𝑟G^{r}. The goal is to help as many patients as possible in each round. Hence, to maximize the number of transplants in round r𝑟r, we seek for an optimal solution, that is, a maximum ℓℓ\\ell-cycle packing of Grsuperscript𝐺𝑟G^{r}, i.e., one that has maximum size.\nAfter a round, some patients have received a kidney or died, and other patient-donor pairs may have arrived, resulting in a new compatibility graph Gr+1superscript𝐺𝑟1G^{r+1} for round r+1𝑟1r+1. The main computational issue for KEPs is how to find an optimal solution in each round. If ℓ=2ℓ2\\ell=2, we can transform, by keeping the “double” arcs, a computability graph G𝐺G into an undirected graph D=(V,E)𝐷𝑉𝐸D=(V,E)\nas follows. For every u,v∈V𝑢𝑣𝑉u,v\\in V, we have u​v∈E𝑢𝑣𝐸uv\\in E if and only if (u,v)∈A𝑢𝑣𝐴(u,v)\\in A and (v,u)∈A𝑣𝑢𝐴(v,u)\\in A. It then remains to compute, in polynomial time, a maximum matching in D𝐷D.\nIf we set ℓ=∞ℓ\\ell=\\infty, a well-known trick works (see e.g. ). We transform G𝐺G into a bipartite graph H𝐻H with partition classes V𝑉V and V′superscript𝑉′V^{\\prime}, where V′superscript𝑉′V^{\\prime} is a copy of V𝑉V. For each u∈V𝑢𝑉u\\in V and its copy u′∈V′superscript𝑢′superscript𝑉′u^{\\prime}\\in V^{\\prime}, we add the edge u​u′𝑢superscript𝑢′uu^{\\prime} with weight 00. For each (u,v)∈A𝑢𝑣𝐴(u,v)\\in A, we add the edge u​v𝑢𝑣uv with weight 111. Now it remains to find in polynomial time a maximum weight perfect matching in H𝐻H. However, for any constant ℓ≥3ℓ3\\ell\\geq 3, the situation changes, as shown by Abraham, Blum and Sandholm . If ℓ=2ℓ2\\ell=2 or ℓ=∞ℓ\\ell=\\infty, we can find an optimal solution for a KEP round in polynomial time; else this is NP-hard. International Kidney Exchange.\nAs merging pools of national KEPs leads to better outcomes, the focus nowadays lies on forming an international KEP (IKEP), e.g. Austria and the Czech Republic 7; Denmark, Norway and Sweden; and Italy, Portugal and Spain . Apart from ethical, legal and logistic issues (all beyond our scope), there is now a new and highly non-trivial issue that needs to be addressed: How can we ensure long-term stability of an IKEP? If countries are not treated fairly, they may leave the IKEP, and it could even happen that each country runs their own national KEP again. Example. Let G𝐺G be the compatibility graph from Figure 1. Then a total of five kidney transplants is possible if the exchange cycle C=a​b​d​e​c​a𝐶𝑎𝑏𝑑𝑒𝑐𝑎C=abdeca is used. In that case, countries 111, 222 and 333 receive three, two and zero kidney transplants, respectively. ∎ Cooperative Game Theory\nconsiders\nfair distributions of common profit if all parties involved collaborate with each other. Before describing its role in our setting, we first give some terminology. A (cooperative) game is a pair (N,v)𝑁𝑣(N,v), where N𝑁N is a set of n𝑛n players and v:2N→ℝ:𝑣→superscript2𝑁ℝv:2^{N}\\to\\mathbb{R}\nis a value function with v​(∅)=0𝑣0v(\\emptyset)=0. A subset S⊆N𝑆𝑁S\\subseteq N is a coalition. If for every possible partition (S1,…,Sr)subscript𝑆1…subscript𝑆𝑟(S_{1},\\ldots,S_{r}) of N𝑁N it holds that v​(N)≥v​(S1)+⋯+v​(Sr)𝑣𝑁𝑣subscript𝑆1⋯𝑣subscript𝑆𝑟v(N)\\geq v(S_{1})+\\cdots+v(S_{r}), then players will benefit most by forming the grand coalition N𝑁N. The problem is then how to fairly distribute v​(N)𝑣𝑁v(N) amongst the players of N𝑁N. An allocation is a vector x∈ℝN𝑥superscriptℝ𝑁x\\in\\mathbb{R}^{N} with x​(N)=v​(N)𝑥𝑁𝑣𝑁x(N)=v(N) (we write x​(S)=∑p∈Sxp𝑥𝑆subscript𝑝𝑆subscript𝑥𝑝x(S)=\\sum_{p\\in S}x_{p} for S⊆N𝑆𝑁S\\subseteq N).\nA solution concept prescribes a set of fair allocations for a game (N,v)𝑁𝑣(N,v). Here, the notion of fairness depends on context. The solution concepts we consider are the Banzhaf value, Shapley value, nucleolus, benefit value, contribution value (see Section 4) and the core. They all prescribe a unique allocation except for the core, which consists of all allocations x∈ℝN𝑥superscriptℝ𝑁x\\in\\mathbb{R}^{N} with x​(S)≥v​(S)𝑥𝑆𝑣𝑆x(S)\\geq v(S) for every S⊆N𝑆𝑁S\\subseteq N. Core allocations ensure N𝑁N is stable, as no subset S𝑆S will benefit from forming their own coalition. But a core may be empty. We now define some relevant games. For a directed graph G=(V,A)𝐺𝑉𝐴G=(V,A) and subset S⊆V𝑆𝑉S\\subseteq V, we let G​[S]=(S,{(u,v)∈A|u,v∈S})𝐺delimited-[]𝑆𝑆conditional-set𝑢𝑣𝐴𝑢𝑣𝑆G[S]=(S,\\{(u,v)\\in A\\;|\\;u,v\\in S\\}) be the subgraph of G𝐺G induced by S𝑆S. An ℓℓ\\ell-permutation game on a graph G=(V,E)𝐺𝑉𝐸G=(V,E) is the game (N,v)𝑁𝑣(N,v), where N=V𝑁𝑉N=V and for S⊆N𝑆𝑁S\\subseteq N, the value v​(S)𝑣𝑆v(S) is the maximum size of an ℓℓ\\ell-cycle packing of G​[S]𝐺delimited-[]𝑆G[S]. Two special cases are well studied. We obtain a matching game if ℓ=2ℓ2\\ell=2, which may have an empty core (e.g. when G𝐺G is a triangle) and a permutation game if ℓ=∞ℓ\\ell=\\infty, whose core is always nonempty . In the remainder, we differentiate between the sets N𝑁N (of players in the game) and V𝑉V (of vertices in the underlying graph G𝐺G). That is, we associate each player i∈N𝑖𝑁i\\in N with a distinct subset Visubscript𝑉𝑖V_{i} of V𝑉V.\nA partitioned ℓℓ\\ell-permutation game on a directed graph G=(V,A)𝐺𝑉𝐴G=(V,A) with a partition (V1,…,Vn)subscript𝑉1…subscript𝑉𝑛(V_{1},\\ldots,V_{n}) of V𝑉V is the game (N,v)𝑁𝑣(N,v), where N={1,…,n}𝑁1…𝑛N=\\{1,\\ldots,n\\}, and for S⊆N𝑆𝑁S\\subseteq N, the value v​(S)𝑣𝑆v(S) is the maximum size of an ℓℓ\\ell-cycle packing of G​[⋃i∈SVi]𝐺delimited-[]subscript𝑖𝑆subscript𝑉𝑖G[\\bigcup_{i\\in S}V_{i}].\nWe obtain a partitioned matching game [ref]7  if ℓ=2ℓ2\\ell=2, and a partitioned permutation game if ℓ=∞ℓ\\ell=\\infty. The width of (N,v)𝑁𝑣(N,v) is the width of (V1,…,Vn)subscript𝑉1…subscript𝑉𝑛(V_{1},\\ldots,V_{n}), which is c=max⁡{|Vi|| 1≤i≤n}𝑐conditionalsubscript𝑉𝑖1𝑖𝑛c=\\max\\{|V_{i}|\\;|\\;1\\leq i\\leq n\\}. See Figure 1 for an example. The Model. For a round of an IKEP with exchange bound ℓℓ\\ell, let (N,v)𝑁𝑣(N,v) be the partitioned ℓℓ\\ell-permutation game defined on the compatibility graph G=(V,A)𝐺𝑉𝐴G=(V,A), where N={1,…,n}𝑁1…𝑛N=\\{1,\\ldots,n\\} is the set of countries in the IKEP, and V𝑉V is partitioned into subsets V1,…,Vnsubscript𝑉1…subscript𝑉𝑛V_{1},\\ldots,V_{n} such that for every p∈N𝑝𝑁p\\in N, Vpsubscript𝑉𝑝V_{p} consists of the patient-donor pairs of country p𝑝p. We say that (N,v)𝑁𝑣(N,v) is the associated game for G𝐺G.\nWe can now make use of a solution concept 𝒮𝒮{\\mathcal{S}} for (N,v)𝑁𝑣(N,v) to obtain a fair initial allocation y𝑦y, where ypsubscript𝑦𝑝y_{p} prescribes the initial number of kidney transplants country p𝑝p should receive in this round (possibly, ypsubscript𝑦𝑝y_{p} is not an integer, but as we shall see this is not relevant). To ensure IKEP stability, we use the model of Klimentova et al. , which is a credit-based system. For round r≥1𝑟1r\\geq 1, let Grsuperscript𝐺𝑟G^{r} be the computability graph with associated game (Nr,vr)superscript𝑁𝑟superscript𝑣𝑟(N^{r},v^{r}); let yrsuperscript𝑦𝑟y^{r} be the initial allocation (as prescribed by some solution concept 𝒮𝒮{\\mathcal{S}}); and let cr:Nr→ℝ:superscript𝑐𝑟→superscript𝑁𝑟ℝc^{r}:N^{r}\\to\\mathbb{R} be a credit function, which satisfies ∑p∈Nrcpr=0\\sum_{p\\in N{{}^{r}}}c^{r}_{p}=0; if r=1𝑟1r=1, we set cr≡0superscript𝑐𝑟0c^{r}\\equiv 0.\nFor p∈N𝑝𝑁p\\in N, we set xpr:=ypr+cprassignsubscriptsuperscript𝑥𝑟𝑝subscriptsuperscript𝑦𝑟𝑝subscriptsuperscript𝑐𝑟𝑝x^{r}_{p}:=y^{r}_{p}+c^{r}_{p} to obtain the target allocation xrsuperscript𝑥𝑟x^{r} for round r𝑟r (which is indeed an allocation, as yrsuperscript𝑦𝑟y^{r} is an allocation and ∑p∈Ncpr=0subscript𝑝𝑁superscriptsubscript𝑐𝑝𝑟0\\sum_{p\\in N}c_{p}^{r}=0). We choose some maximum ℓℓ\\ell-cycle packing 𝒞𝒞{\\mathcal{C}} of Grsuperscript𝐺𝑟G^{r} as optimal solution for round r𝑟r (out of possibly exponentially many optimal solutions).\nLet sp​(𝒞)subscript𝑠𝑝𝒞s_{p}({\\mathcal{C}}) be the number of kidney transplants for patients in country p𝑝p (with donors both from p𝑝p and other countries). For p∈N𝑝𝑁p\\in N, we set cpr+1:=xpr−sp​(𝒞)assignsubscriptsuperscript𝑐𝑟1𝑝subscriptsuperscript𝑥𝑟𝑝subscript𝑠𝑝𝒞c^{r+1}_{p}:=x^{r}_{p}-s_{p}({\\mathcal{C}}) to get the credit function cr+1superscript𝑐𝑟1c^{r+1} for round r+1𝑟1r+1 (note that ∑p∈Ncpr+1=0subscript𝑝𝑁superscriptsubscript𝑐𝑝𝑟10\\sum_{p\\in N}c_{p}^{r+1}=0). For round r+1𝑟1r+1,\na new initial allocation yr+1superscript𝑦𝑟1y^{r+1} is prescribed by 𝒮𝒮{\\mathcal{S}} for the associated game (Nr+1,vr+1)superscript𝑁𝑟1superscript𝑣𝑟1(N^{r+1},v^{r+1}). For every p∈N𝑝𝑁p\\in N, we set xpr+1:=ypr+1+cpr+1assignsuperscriptsubscript𝑥𝑝𝑟1superscriptsubscript𝑦𝑝𝑟1superscriptsubscript𝑐𝑝𝑟1x_{p}^{r+1}:=y_{p}^{r+1}+c_{p}^{r+1}, and we repeat the process. Apart from specifying the solution concept 𝒮𝒮{\\mathcal{S}}, we must also determine how to choose in each round a maximum ℓℓ\\ell-cycle packing 𝒞𝒞{\\mathcal{C}} (optimal solution) of the corresponding compatibility graph G𝐺G. We will choose 𝒞𝒞{\\mathcal{C}}, such that the vector s​(𝒞)𝑠𝒞s({\\mathcal{C}}), with entries sp​(𝒞)subscript𝑠𝑝𝒞s_{p}({\\mathcal{C}}), is closest to the target allocation x𝑥x for the round under consideration. To explain our distance measures, let |xp−sp​(𝒞)|subscript𝑥𝑝subscript𝑠𝑝𝒞|x_{p}-s_{p}({\\mathcal{C}})| be the deviation of country p𝑝p from its target xpsubscript𝑥𝑝x_{p} if 𝒞𝒞{\\mathcal{C}} is chosen out of all optimal solutions. We order the deviations |xp−sp​(𝒞)|subscript𝑥𝑝subscript𝑠𝑝𝒞|x_{p}-s_{p}({\\mathcal{C}})| non-increasingly as a vector d​(𝒞)=(|xp1−sp1​(𝒞)|,…,|xpn−spn​(𝒞)|)𝑑𝒞subscript𝑥subscript𝑝1subscript𝑠subscript𝑝1𝒞…subscript𝑥subscript𝑝𝑛subscript𝑠subscript𝑝𝑛𝒞d({\\mathcal{C}})=(|x_{p_{1}}-s_{p_{1}}({\\mathcal{C}})|,\\dots,|x_{p_{n}}-s_{p_{n}}({\\mathcal{C}})|).\nWe say 𝒞𝒞{\\mathcal{C}} is strongly close to x𝑥x if d​(𝒞)𝑑𝒞d({\\mathcal{C}}) is lexicographically minimal over all optimal solutions. If we only minimize d1​(𝒞)=maxp∈N⁡{|xp−sp​(𝒞)|}subscript𝑑1𝒞subscript𝑝𝑁subscript𝑥𝑝subscript𝑠𝑝𝒞d_{1}({\\mathcal{C}})=\\max_{p\\in N}\\{|x_{p}-s_{p}({\\mathcal{C}})|\\} over all optimal solutions, we obtain a weakly close optimal solution. If an optimal solution is strongly close, it is weakly close, but the reverse might not be true. Both measures have been used, see below. Related Work. Benedek et al.  proved the following theorem for ℓ=2ℓ2\\ell=2 (the “matching” case); in contrast, Biró et al.  showed that it is NP-hard to find a weakly close maximum matching even for |N|=2𝑁2|N|=2 once the games are defined on edge-weighted graphs. For partitioned matching games, the problem of finding an optimal solution that is strongly close to a given target allocation x𝑥x is polynomial-time solvable. Benedek et al.  used the algorithm of Theorem 1.2 to perform simulations for up to fifteen countries for ℓ=2ℓ2\\ell=2. As initial allocations, they used the Shapley value, nucleolus, benefit value and contribution value, with the Shapley value yielding the best results (together with the Banzhaf value in the full version  of ).\nThis is in line with the results of Klimentova et al.  and Biró et al. 1 for ℓ=3ℓ3\\ell=3. Due to Theorem 1.1, the simulations in 1  are for up to four countries and use weakly close optimal solutions. For ℓ=2ℓ2\\ell=2, we refer to  for an alternative model based on so-called selection ratios using lower and upper target numbers. IKEPs have also been modelled as non-cooperative games in the consecutive matching setting, which has 222-phase rounds: national pools in phase 1 and a merged pool for unmatched patient-donor pairs in phase 2; see 9 8  for some results in this setting. Fairness (versus optimality) issues are also studied for national KEPs, in particular in the US, which is different from Europe (our setting). Namely, hospitals in the US are more independent and are given positive credits to register their easy-to-match patient-donor pairs to one of the three national KEPs, and negative credits for registering their hard-to-match pairs. The US setting is extensively studied    6 7 0, but beyond the scope of our paper. Our Results.\nWe consider partitioned permutation games and IKEPs, so we assume ℓ=∞ℓ\\ell=\\infty. This assumption is not realistic in kidney exchange, but has also been made for national KEPs to obtain general results of theoretical\ninterest [ref]5 4 5 4 and may have wider applications (e.g. in financial clearing).\nWe also aim to research how stability and total number of kidney transplants are affected when moving from one extreme (ℓ=2ℓ2\\ell=2) to the other (ℓ=∞ℓ\\ell=\\infty).\nAs such our paper consists of a theoretical and experimental part. We start with our theoretical results (Section 2).\nPermutation games, i.e. partitioned permutation games of width 111, have a nonempty core , and a core allocation can be found in polynomial\ntime 1.\nWe generalize these two results to partitioned permutation games of any width c𝑐c, and also show a dichotomy for testing core membership, which is in contrast with the dichotomy for\npartitioned matching games, where the complexity jump happens at c=3𝑐3c=3 . The core of every partitioned permutation game is non-empty, and it is possible to find a core allocation in polynomial time.\nMoreover, for partitioned permutation games of fixed width c𝑐c, the problem of deciding if an allocation is in the core\nis polynomial-time solvable if c=1𝑐1c=1 and coNP-complete if c≥2𝑐2c\\geq 2. Due to Theorem 1.1, we cannot hope to generalize Theorem 1.2 to hold for any constant ℓ≥3ℓ3\\ell\\geq 3. Nevertheless, Theorem 1.1 leaves open the question if Theorem 1.2 is true for ℓ=∞ℓ\\ell=\\infty (the “cycle packing” case) instead of only for ℓ=2ℓ2\\ell=2 (the “matching” case). We show that the answer to this question is no (assuming 𝖯≠𝖭𝖯𝖯𝖭𝖯{\\sf P}\\neq{\\sf NP}). For partitioned permutation games\neven of width 222,\nthe problem of finding an optimal solution that is weakly or strongly close to a given target allocation x𝑥x is NP-hard. Our last theoretical result is a randomized XP algorithm with parameter n𝑛n. As we shall prove, derandomizing it requires solving the notorious Exact Perfect Matching problem in polynomial time.\nThe complexity status of the latter problem is still open since its introduction by Papadimitriou and Yannakakis 2 in 1982. For a partitioned permutation game (N,v)𝑁𝑣(N,v) on a directed graph G=(V,A)𝐺𝑉𝐴G=(V,A), the problem of finding an optimal solution that is weakly or strongly close to a given target allocation x𝑥x can be solved by a randomized algorithm in |A|O​(n)superscript𝐴𝑂𝑛|A|^{O(n)} time. Our theoretical results which highlighted severe computational limitations, and we now turn to our simulations. These are guided by our theoretical results.\nNamely, we note that the algorithm in Theorem 1.5 is neither practical\nfor instances of realistic size (which we aim for) nor acceptable in the setting of kidney exchange due to being a randomized algorithm.\nTherefore and also due to Theorem 1.4,\nwe formulate the problems of computing a weakly or strongly close optimal solution as integer linear programs, as described in Section 3. This enables us to use an ILP solver. We still exploit the fact that for ℓ=∞ℓ\\ell=\\infty (Theorem 1.1) we can find optimal solutions and values v​(S)𝑣𝑆v(S) in polynomial time. In this way we can perform, in Section 4, simulations for IKEPs up to ten countries, so more than the four countries in the simulations for ℓ=3ℓ3\\ell=3 1 , but less than the fifteen countries in the simulations for ℓ=2ℓ2\\ell=2 . For the initial allocations we use two easy-to-compute solution concepts: the benefit value and contribution value, and three hard-to-compute solution concepts: the Banzhaf value, Shapley value, and nucleolus. Our simulations show, just like those for , that a credit system using strongly close optimal solutions makes an IKEP the most balanced\nwithout decreasing the overall number of transplants. The exact improvement is determined by the choice of solution concept. Our simulations indicate that the Banzhaf value yields the best results: on average, a deviation of up to 0.90% from the target allocation.\nMoreover, moving from ℓ=2ℓ2\\ell=2 to ℓ=∞ℓ\\ell=\\infty yields on average 46% more kidney transplants\n(using the same simulation instances generated by the data generator 3). However, the exchange cycles may be very large, in particular in the starting round.\n\nReference markers found: [7]\n\nContext windows for each [ref]:\n[ref]7: N, the value v​(S)𝑣𝑆v(S) is the maximum size of an ℓℓ\\ell-cycle packing of G​[⋃i∈SVi]𝐺delimited-[]subscript𝑖𝑆subscript𝑉𝑖G[\\bigcup_{i\\in S}V_{i}].\nWe obtain a partitioned matching game [ref]7  if ℓ=2ℓ2\\ell=2, and a partitioned permutation game if ℓ=∞ℓ\\ell=\\infty. The width of (N,v)𝑁𝑣(N,v) is the width of (V1,…,Vn)subscript𝑉1…subscript𝑉𝑛(V_{1},\\ldots,V_{n}), which is\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 7,\n            \"titles\": [\n                \"The Complexity of Matching Games: A Survey\",\n                \"T.: Clearing algorithms for barter exchange markets: enabling nationwide kidney exchanges. Proceedings EC 2007 pp. 295–304 (2007)\",\n                \"Clearing algorithms for barter exchange markets: enabling nationwide kidney exchanges\",\n                \"Mix and match: A strategyproof mechanism for multi-hospital kidney exchange\",\n                \"New challenges in multihospital kidney exchange\",\n                \"Free riding and participation in large scale, multi-hospital kidney exchange\",\n                \"Optimal Kidney Exchange with Immunosuppressants\",\n                \"International kidney exchange scheme\",\n                \"Computing balanced solutions for large international kidney exchange schemes\",\n                \"Finding and verifying the nucleolus of cooperative games\",\n                \"Compensation scheme with Shapley value for multi-country kidney exchange programmes\",\n                \"Building kidney exchange programmes in Europe – an overview of exchange practice and activities\",\n                \"Generalized matching games for international kidney exchange\",\n                \"Shapley-scarf housing markets: Respecting improvement, integer programming, and kidney exchange\",\n                \"Maximum weight cycle packing in directed graphs, with application to kidney exchange programs\",\n                \"Opting Into Optimal Matchings\",\n                \"Czech-Austrian kidney paired donation: first european cross-border living donor kidney exchange\",\n                \"A theoretical and computational equilibria analysis of a multi-player kidney exchange program\",\n                \"Nash equilibria in the two-player kidney exchange game\",\n                \"New insights on integer-programming models for the kidney exchange problem\",\n                \"Assignment games and permutation games\",\n                \"New algorithms for hierarchical optimisation in kidney exchange programmes\",\n                \"Improved instance generation for kidney exchange programmes\",\n                \"LEMON - an open source C++ graph template library\",\n                \"Position-indexed formulations for kidney exchange\",\n                \"Planarizing gadgets for perfect matching do not exist\",\n                \"Strategy-proof and efficient kidney exchange using a credit mechanism\",\n                \"On the complexity of comparing evolutionary trees\",\n                \"Spr distance computation for unrooted trees\",\n                \"Weighted voting doesn’t work: A mathematical analysis\",\n                \"Fairness models for multi-agent kidney exchange programmes\",\n                \"The complexity of restricted spanning tree problems\",\n                \"Kidney matching tools data set generator\",\n                \"Kidney exchange\",\n                \"The nucleolus of a characteristic function game\",\n                \"A value for n𝑛n-person games\",\n                \"Identifying optimal strategies in kidney exchange games is σ2psubscriptsuperscript𝜎𝑝2\\\\sigma^{p}_{2}-complete\",\n                \"Fair pairwise exchange among groups\",\n                \"Permutation games: another class of totally balanced games\",\n                \"Design and analysis of multi-hospital kidney exchange mechanisms using random graphs\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]7 based on the context and research area of Computing Balanced Solutions for Large International Kidney Exchange Schemes When Cycle Length Is Unbounded. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}