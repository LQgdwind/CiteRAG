{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: The Complexity of Resilience Problems via Valued Constraint Satisfaction Problems\n\nPaper Abstract: \n\nPaper Section Text:\nConjunctive queries might not have a finite dual (see Example 8.3), but unions of connected conjunctive queries always have a countably infinite dual. Cherlin, Shelah and Shi  showed that\nin this case we may even find a dual with an oligomorphic automorphism group (see Theorem 8.14 below). This is the key insight to phrase resilience problems as VCSPs for valued structures with oligomorphic automorphism groups. The not necessarily connected case again\nreduces to the connected case by Corollary 8.7. In Theorem 8.14 below we state a variant of a theorem of Cherlin, Shelah, and Shi  (also see  [ref]28 ).\nIf 𝔅𝔅{\\mathfrak{B}} is a structure, we write 𝔅pp​(m)subscript𝔅pp𝑚{\\mathfrak{B}}_{\\text{pp}(m)} for the expansion of 𝔅𝔅{\\mathfrak{B}} by all relations that can be defined with a connected primitive positive formula (see Remark 8.5)\nwith at most m𝑚m variables, at least one free variable, and without equality.\nFor a union of conjunctive queries μ𝜇\\mu over the signature τ𝜏\\tau, we write |μ|𝜇|\\mu| for the maximum of the number of variables of each conjunctive query in μ𝜇\\mu, the maximal arity of τ𝜏\\tau, and 2. For every union μ𝜇\\mu of connected conjunctive queries over a finite relational signature τ𝜏\\tau there exists a τ𝜏\\tau-structure 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu} such that the following statements hold: (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)} is homogeneous. Age⁡(𝔅pp​(|μ|))Agesubscript𝔅pp𝜇\\operatorname{Age}({\\mathfrak{B}}_{\\text{pp}(|\\mu|)}) is the class of all substructures of structures of the form 𝔄pp​(|μ|)subscript𝔄pp𝜇{\\mathfrak{A}}_{\\text{pp}(|\\mu|)} for a finite structure 𝔄𝔄{\\mathfrak{A}} that satisfies ¬μ𝜇\\neg\\mu. A countable\nτ𝜏\\tau-structure 𝔄𝔄{\\mathfrak{A}} satisfies ¬μ𝜇\\neg\\mu if and only if it embeds into 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu}. 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu} is finitely bounded. Aut⁡(𝔅μ)Autsubscript𝔅𝜇\\operatorname{Aut}({\\mathfrak{B}}_{\\mu}) is oligomorphic. (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)} is finitely bounded. The construction of a structure 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu}\nwith the given properties\nfollows from a proof of Hubička and Nešetřil [ref]28  of the theorem of Cherlin, Shelah, and Shi , and can be found in [5, Theorem 4.3.8].\nProperties (1), (2) and property (3) restricted to finite structures 𝔄𝔄{\\mathfrak{A}} are explicitly stated in [5, Theorem 4.3.8].\nProperty (3) restricted to finite structures clearly implies property (4). Property (5) holds because homogeneous structures with a finite relational signature have an oligomorphic automorphism group.\nProperty (3) for countable structures now follows from [5, Lemma 4.1.7]. Since we are not aware of a reference for (6) in the literature, we present a proof here. Let σ𝜎\\sigma be the signature of (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}.\nWe claim that the following universal σ𝜎\\sigma-sentence ψ𝜓\\psi describes the structures in the age of\n(𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}.\nIf ϕitalic-ϕ\\phi is a σ𝜎\\sigma-sentence, then ϕ′superscriptitalic-ϕ′\\phi^{\\prime} denotes the τ𝜏\\tau-sentence obtained from ϕitalic-ϕ\\phi by replacing every occurrence of R​(x¯)𝑅¯𝑥R(\\bar{x}), for R∈σ∖τ𝑅𝜎𝜏R\\in\\sigma\\setminus\\tau,\nby the primitive positive τ𝜏\\tau-formula η​(x¯)𝜂¯𝑥\\eta(\\bar{x}) for which R𝑅R was introduced in (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}.\nThen ψ𝜓\\psi\nis a conjunction\nof all σ𝜎\\sigma-sentences ¬ϕitalic-ϕ\\neg\\phi such that ϕitalic-ϕ\\phi is primitive positive,\nϕ′superscriptitalic-ϕ′\\phi^{\\prime} has at most |μ|𝜇|\\mu| variables, and ϕ′superscriptitalic-ϕ′\\phi^{\\prime} implies μ𝜇\\mu.\nClearly, there are finitely many conjuncts of this form. Suppose that 𝔄∈Age(𝔅μ)pp​(|μ|){\\mathfrak{A}}\\in\\operatorname{Age}({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}.\nThen 𝔄𝔄{\\mathfrak{A}} satisfies each conjunct ¬ϕitalic-ϕ\\neg\\phi of ψ𝜓\\psi, because otherwise 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu} satisfies ϕ′superscriptitalic-ϕ′\\phi^{\\prime}, and thus satisfies μ𝜇\\mu, contrary to our assumptions. The interesting direction is that if a finite σ𝜎\\sigma-structure 𝔄𝔄{\\mathfrak{A}} satisfies ψ𝜓\\psi, then 𝔄𝔄{\\mathfrak{A}} embeds into (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}.\nLet ϕitalic-ϕ\\phi be the canonical query of 𝔄𝔄{\\mathfrak{A}}.\nLet 𝔄′superscript𝔄′{\\mathfrak{A}}^{\\prime} be the canonical database of the τ𝜏\\tau-formula ϕ′superscriptitalic-ϕ′\\phi^{\\prime}.\nSuppose for contradiction that 𝔄′⊧μmodelssuperscript𝔄′𝜇{\\mathfrak{A}}^{\\prime}\\models\\mu.\nLet χ𝜒\\chi be a minimal subformula of ϕitalic-ϕ\\phi such that\nthe canonical database of χ𝜒\\chi models μ𝜇\\mu.\nThen χ𝜒\\chi has at most |μ|𝜇|\\mu| variables and implies μ𝜇\\mu, and hence ¬χ𝜒\\neg\\chi is a conjunct of of ψ𝜓\\psi which is not satisfied by 𝔄𝔄{\\mathfrak{A}}, a contradiction to our assumptions.\nTherefore, 𝔄′⊧¬μmodelssuperscript𝔄′𝜇{\\mathfrak{A}}^{\\prime}\\models\\neg\\mu and by Property (2), we have that 𝔄pp​(|μ|)′subscriptsuperscript𝔄′pp𝜇{\\mathfrak{A}}^{\\prime}_{\\text{pp}(|\\mu|)}\nhas an embedding f𝑓f into (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}. We claim that the restriction of f𝑓f to the elements of 𝔄𝔄{\\mathfrak{A}} is an embedding of 𝔄𝔄{\\mathfrak{A}} into (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}. Clearly, if 𝔄⊧R​(x¯)models𝔄𝑅¯𝑥{\\mathfrak{A}}\\models R(\\bar{x}) for some relation R𝑅R that has been introduced for a primitive positive formula η𝜂\\eta, then 𝔄′superscript𝔄′{\\mathfrak{A}}^{\\prime} satisfies η​(x¯)𝜂¯𝑥\\eta(\\bar{x}),\nand hence 𝔅μ⊧η​(f​(x¯))modelssubscript𝔅𝜇𝜂𝑓¯𝑥{\\mathfrak{B}}_{\\mu}\\models\\eta(f(\\bar{x})), which in turn implies that\n(𝔅μ)pp​(|μ|)⊧R​(f​(x¯))modelssubscriptsubscript𝔅𝜇pp𝜇𝑅𝑓¯𝑥({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}\\models R(f(\\bar{x})) as desired.\nConversely, if (𝔅μ)pp​(|μ|)⊧R​(f​(x¯))modelssubscriptsubscript𝔅𝜇pp𝜇𝑅𝑓¯𝑥({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}\\models R(f(\\bar{x})), then\n𝔄pp​(|μ|)′⊧R​(x¯)modelssubscriptsuperscript𝔄′pp𝜇𝑅¯𝑥{\\mathfrak{A}}^{\\prime}_{\\text{pp}(|\\mu|)}\\models R(\\bar{x}), and hence 𝔄′⊧η​(x¯)modelssuperscript𝔄′𝜂¯𝑥{\\mathfrak{A}}^{\\prime}\\models\\eta(\\bar{x}).\nThis in turn implies that 𝔄⊧R​(x¯)models𝔄𝑅¯𝑥{\\mathfrak{A}}\\models R(\\bar{x}).\nSince the restriction of f𝑓f and its inverse preserve the relations from τ𝜏\\tau trivially, we conclude that 𝔄𝔄{\\mathfrak{A}} embeds into (𝔅μ)pp​(|μ|)subscriptsubscript𝔅𝜇pp𝜇({\\mathfrak{B}}_{\\mu})_{\\text{pp}(|\\mu|)}.\n∎ By Properties (1) and (6) of Theorem 8.14, 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu} is always a reduct of a finitely bounded homogeneous structure. For short, we write ΓμsubscriptΓ𝜇\\Gamma_{\\mu} for Γ​(𝔅μ,∅)Γsubscript𝔅𝜇\\Gamma({\\mathfrak{B}}_{\\mu},\\emptyset) and Γμ,σsubscriptΓ𝜇𝜎\\Gamma_{\\mu,\\sigma} for Γ​(𝔅μ,σ)Γsubscript𝔅𝜇𝜎\\Gamma({\\mathfrak{B}}_{\\mu},\\sigma), see Definition 8.10.\nFor some queries μ𝜇\\mu, the structure 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu} can be replaced by a simpler structure ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu}. This will be\nconvenient for some examples that we consider later, because the structure ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} is finitely bounded and homogeneous itself and hence admits the application of Theorem 7.17.\nTo define the respective class of queries, we need the following definition. The Gaifman graph of a\nrelational structure 𝔄𝔄{\\mathfrak{A}}\nis the undirected graph with vertex set A𝐴A where a,b∈A𝑎𝑏𝐴a,b\\in A are adjacent if and only if a≠b𝑎𝑏a\\neq b and there exists a tuple in a relation of 𝔄𝔄{\\mathfrak{A}} that contains both a𝑎a and b𝑏b. The Gaifman graph of a conjunctive query is the Gaifman graph of the canonical database of that query. For every union μ𝜇\\mu of connected conjunctive queries over a finite relational signature τ𝜏\\tau such that the Gaifman graph of each of the conjunctive queries in μ𝜇\\mu is complete, there exists a countable τ𝜏\\tau-structure ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} such that the following statements hold: ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} is homogeneous. Age⁡(ℭμ)Agesubscriptℭ𝜇\\operatorname{Age}({\\mathfrak{C}}_{\\mu}) is the class of all finite structures 𝔄𝔄{\\mathfrak{A}} that satisfy ¬μ𝜇\\neg\\mu. Moreover, ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} is finitely bounded, Aut⁡(ℭμ)Autsubscriptℭ𝜇\\operatorname{Aut}({\\mathfrak{C}}_{\\mu}) is oligomorphic, and a countable τ𝜏\\tau-structure satisfies ¬μ𝜇\\neg\\mu if and only if it embeds into ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu}. Let 𝔄1subscript𝔄1{\\mathfrak{A}}_{1} and 𝔄2subscript𝔄2{\\mathfrak{A}}_{2} be finite τ𝜏\\tau-structures that satisfy ¬μ𝜇\\neg\\mu such that the substructure induced by A1∩A2subscript𝐴1subscript𝐴2A_{1}\\cap A_{2} in 𝔄1subscript𝔄1{\\mathfrak{A}}_{1} and 𝔄2subscript𝔄2{\\mathfrak{A}}_{2} is the same. Since the Gaifman graph of each of the conjunctive queries in μ𝜇\\mu is complete, the union of the structures 𝔄1subscript𝔄1{\\mathfrak{A}}_{1} and 𝔄2subscript𝔄2{\\mathfrak{A}}_{2} satisfies ¬μ𝜇\\neg\\mu as well. By Fraïssé’s Theorem (see, e.g., )\nthere is a countable homogeneous τ𝜏\\tau-structure ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} such that Age⁡(ℭμ)Agesubscriptℭ𝜇\\operatorname{Age}({\\mathfrak{C}}_{\\mu}) is the class of all finite structures that satisfy ¬μ𝜇\\neg\\mu; this shows that ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} is finitely bounded.\nHomogeneous structures with finite relational signature clearly have an oligomorphic automorphism group.\nFor the final statement, see [5, Lemma 4.1.7].\n∎ Note that ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} is homomorphically equivalent to 𝔅μsubscript𝔅𝜇{\\mathfrak{B}}_{\\mu} by [5, Lemma 4.1.7]. Therefore, Γ​(ℭμ,σ)Γsubscriptℭ𝜇𝜎\\Gamma({\\mathfrak{C}}_{\\mu},\\sigma) is homomorphically equivalent to Γμ,σsubscriptΓ𝜇𝜎\\Gamma_{\\mu,\\sigma} for any σ⊆τ𝜎𝜏\\sigma\\subseteq\\tau. The following proposition follows straightforwardly from the definitions and provides a valued constraint satisfaction problem that is polynomial-time equivalent to the resilience problem for μ𝜇\\mu, similar to Theorem 8.11. The resilience problem for a\nunion of connected conjunctive queries μ𝜇\\mu\nwhere the relations\nfrom σ⊆τ𝜎𝜏\\sigma\\subseteq\\tau\nare exogenous\nis polynomial-time equivalent to\nVCSP⁡(Γ​(𝔅,σ))VCSPΓ𝔅𝜎\\operatorname{VCSP}(\\Gamma({\\mathfrak{B}},\\sigma)) for any dual 𝔅𝔅{\\mathfrak{B}} of μ𝜇\\mu; in particular, to VCSP⁡(Γμ,σ)VCSPsubscriptΓ𝜇𝜎\\operatorname{VCSP}(\\Gamma_{\\mu,\\sigma}). Let 𝔅𝔅{\\mathfrak{B}} be a dual of μ𝜇\\mu.\nFor every bag database 𝔄𝔄{\\mathfrak{A}} over signature τ𝜏\\tau and with exogenous relations from σ𝜎\\sigma,\nlet ϕitalic-ϕ\\phi\nbe the\nτ𝜏\\tau-expression\nobtained by adding atomic τ𝜏\\tau-expressions S​(x1,…,xn)𝑆subscript𝑥1…subscript𝑥𝑛S(x_{1},\\dots,x_{n}) according to the multiplicity of the tuples (x1,…,xn)subscript𝑥1…subscript𝑥𝑛(x_{1},\\dots,x_{n}) in S𝔄superscript𝑆𝔄S^{{\\mathfrak{A}}} for all S∈τ𝑆𝜏S\\in\\tau.\nNote that ϕitalic-ϕ\\phi can be computed in polynomial time.\nThen the resilience of 𝔄𝔄{\\mathfrak{A}} with respect to μ𝜇\\mu\nis at most u𝑢u if and only if (ϕ,u)italic-ϕ𝑢(\\phi,u) has a solution over\nΓ​(𝔅,σ)Γ𝔅𝜎\\Gamma({\\mathfrak{B}},\\sigma). To prove a polynomial-time reduction in the other direction,\nlet ϕitalic-ϕ\\phi be a τ𝜏\\tau-expression. We construct a bag database 𝔄𝔄{\\mathfrak{A}} with signature τ𝜏\\tau. The domain of 𝔄𝔄{\\mathfrak{A}} are the variables that appear in ϕitalic-ϕ\\phi and for every S∈τ𝑆𝜏S\\in\\tau\nand tuple (x1,…,xn)∈S𝔄subscript𝑥1…subscript𝑥𝑛superscript𝑆𝔄(x_{1},\\dots,x_{n})\\in S^{{\\mathfrak{A}}}, its multiplicity in 𝔄𝔄{\\mathfrak{A}} is the\nnumber of times that\n(x1,…,xn)subscript𝑥1…subscript𝑥𝑛(x_{1},\\dots,x_{n}) in S𝔄superscript𝑆𝔄S^{{\\mathfrak{A}}} occurs as a summand of ϕitalic-ϕ\\phi.\nThe relations S𝔄superscript𝑆𝔄S^{{\\mathfrak{A}}} with S∈σ𝑆𝜎S\\in\\sigma are exogenous in 𝔄𝔄{\\mathfrak{A}}, the remaining ones are endogenous.\nAgain, 𝔄𝔄{\\mathfrak{A}} can be computed in polynomial time and the resilience of 𝔄𝔄{\\mathfrak{A}} with respect to μ𝜇\\mu is at most u𝑢u if and only if (ϕ,u)italic-ϕ𝑢(\\phi,u) has a solution over Γ​(𝔅,σ)Γ𝔅𝜎\\Gamma({\\mathfrak{B}},\\sigma).\n∎ In  one may find a seemingly more general notion of exogenous tuples, where in a single relation there might be both endogenous and exogenous tuples. Using Proposition 8.16 and Lemma 4.7, however, we can show that classifying the complexity of resilience problems according to our original definition also entails a classification of this variant. Let μ𝜇\\mu be a union of conjunctive queries with the signature τ𝜏\\tau, let σ⊆τ𝜎𝜏\\sigma\\subseteq\\tau, and let ρ⊆τ∖σ𝜌𝜏𝜎\\rho\\subseteq\\tau\\setminus\\sigma. Suppose we would like to model the resilience problem for μ𝜇\\mu where the relations in σ𝜎\\sigma are exogenous and the relations in ρ𝜌\\rho might contain both endogenous and exogenous tuples. Let 𝔅𝔅{\\mathfrak{B}} be a dual of μ𝜇\\mu and ΓΓ\\Gamma be the expansion of Γ​(𝔅,σ)Γ𝔅𝜎\\Gamma({\\mathfrak{B}},\\sigma) where for every relational symbol R∈ρ𝑅𝜌R\\in\\rho, there is also a relation (Rx)Γ=R𝔅superscriptsuperscript𝑅𝑥Γsuperscript𝑅𝔅(R^{x})^{\\Gamma}=R^{{\\mathfrak{B}}}, i.e., a classical relation that takes values 00 and ∞\\infty. The resilience problem for μ𝜇\\mu with exogenous tuples specified as above is polynomial-time equivalent to VCSP⁡(Γ)VCSPΓ\\operatorname{VCSP}(\\Gamma) by analogous reductions as in Proposition 8.16.\nNote that (Rx)Γ=Opt⁡(RΓ​(𝔅,σ))superscriptsuperscript𝑅𝑥ΓOptsuperscript𝑅Γ𝔅𝜎(R^{x})^{\\Gamma}=\\operatorname{Opt}\\big{(}R^{\\Gamma({\\mathfrak{B}},\\sigma)}\\big{)} for every R∈ρ𝑅𝜌R\\in\\rho, and therefore by Lemma 4.7, VCSP⁡(Γ)VCSPΓ\\operatorname{VCSP}(\\Gamma) is polynomial-time equivalent to VCSP⁡(Γ​(𝔅,σ))VCSPΓ𝔅𝜎\\operatorname{VCSP}(\\Gamma({\\mathfrak{B}},\\sigma)) and thus to the resilience problem for μ𝜇\\mu where the relations in σ𝜎\\sigma are exogeneous and the relations in τ∖σ𝜏𝜎\\tau\\setminus\\sigma are purely endogeneous. This justifies the restriction to our setting for exogenous tuples. Moreover, the same argument shows that if resilience of μ𝜇\\mu with all tuples endogenous is in P, then all variants of resilience of μ𝜇\\mu with exogenous tuples are in P as well. Similarly as in Example 8.13, Proposition 8.16 can be combined with the tractability results for VCSPs from Section 7 that use fractional polymorphisms to prove tractability of resilience problems. We revisit Example 8.3. Consider the conjunctive query\n∃x,y,z​(R​(x,y)∧S​(x,y,z))𝑥𝑦𝑧𝑅𝑥𝑦𝑆𝑥𝑦𝑧\\exists x,y,z\\,(R(x,y)\\wedge S(x,y,z)) over the signature τ={R,S}𝜏𝑅𝑆\\tau=\\{R,S\\}.\nNote that the Gaifman graph of μ𝜇\\mu is complete; let ℭμsubscriptℭ𝜇{\\mathfrak{C}}_{\\mu} be the structure from Theorem 8.15. We construct a binary pseudo cyclic canonical fractional polymorphism of Γ​(ℭμ,∅)Γsubscriptℭ𝜇\\Gamma({\\mathfrak{C}}_{\\mu},\\emptyset).\nLet 𝔐𝔐{\\mathfrak{M}} be the τ𝜏\\tau-structure with\ndomain (Cμ)2superscriptsubscript𝐶𝜇2(C_{\\mu})^{2}\nand where ((b11,b12),(b21,b22))∈R𝔐subscriptsuperscript𝑏11subscriptsuperscript𝑏21subscriptsuperscript𝑏12subscriptsuperscript𝑏22superscript𝑅𝔐((b^{1}_{1},b^{2}_{1}),(b^{1}_{2},b^{2}_{2}))\\in R^{{\\mathfrak{M}}} if and only if\n(b11,b21)∈Rℭμsubscriptsuperscript𝑏11subscriptsuperscript𝑏12superscript𝑅subscriptℭ𝜇(b^{1}_{1},b^{1}_{2})\\in R^{{\\mathfrak{C}}_{\\mu}} and\n(b12,b22)∈Rℭμsubscriptsuperscript𝑏21subscriptsuperscript𝑏22superscript𝑅subscriptℭ𝜇(b^{2}_{1},b^{2}_{2})\\in R^{{\\mathfrak{C}}_{\\mu}}, and ((b11,b12),(b21,b22),(b31,b32))∈S𝔐subscriptsuperscript𝑏11subscriptsuperscript𝑏21subscriptsuperscript𝑏12subscriptsuperscript𝑏22subscriptsuperscript𝑏13subscriptsuperscript𝑏23superscript𝑆𝔐((b^{1}_{1},b^{2}_{1}),(b^{1}_{2},b^{2}_{2}),(b^{1}_{3},b^{2}_{3}))\\in S^{{\\mathfrak{M}}} if and only if\n(b11,b21,b31)∈Sℭμsubscriptsuperscript𝑏11subscriptsuperscript𝑏12subscriptsuperscript𝑏13superscript𝑆subscriptℭ𝜇(b^{1}_{1},b^{1}_{2},b^{1}_{3})\\in S^{{\\mathfrak{C}}_{\\mu}} or\n(b12,b22,b32)∈Sℭμsubscriptsuperscript𝑏21subscriptsuperscript𝑏22subscriptsuperscript𝑏23superscript𝑆subscriptℭ𝜇(b^{2}_{1},b^{2}_{2},b^{2}_{3})\\in S^{{\\mathfrak{C}}_{\\mu}}. Similarly, let 𝔑𝔑{\\mathfrak{N}} be the τ𝜏\\tau-structure with\ndomain (Cμ)2superscriptsubscript𝐶𝜇2(C_{\\mu})^{2}\nand where ((b11,b12),(b21,b22))∈R𝔑subscriptsuperscript𝑏11subscriptsuperscript𝑏21subscriptsuperscript𝑏12subscriptsuperscript𝑏22superscript𝑅𝔑((b^{1}_{1},b^{2}_{1}),(b^{1}_{2},b^{2}_{2}))\\in R^{{\\mathfrak{N}}} if and only if\n(b11,b21)∈Rℭμsubscriptsuperscript𝑏11subscriptsuperscript𝑏12superscript𝑅subscriptℭ𝜇(b^{1}_{1},b^{1}_{2})\\in R^{{\\mathfrak{C}}_{\\mu}} or\n(b12,b22)∈Rℭμsubscriptsuperscript𝑏21subscriptsuperscript𝑏22superscript𝑅subscriptℭ𝜇(b^{2}_{1},b^{2}_{2})\\in R^{{\\mathfrak{C}}_{\\mu}}, and ((b11,b12),(b21,b22),(b31,b32))∈S𝔑subscriptsuperscript𝑏11subscriptsuperscript𝑏21subscriptsuperscript𝑏12subscriptsuperscript𝑏22subscriptsuperscript𝑏13subscriptsuperscript𝑏23superscript𝑆𝔑((b^{1}_{1},b^{2}_{1}),(b^{1}_{2},b^{2}_{2}),(b^{1}_{3},b^{2}_{3}))\\in S^{{\\mathfrak{N}}} if and only if\n(b11,b21,b31)∈Sℭμsubscriptsuperscript𝑏11subscriptsuperscript𝑏12subscriptsuperscript𝑏13superscript𝑆subscriptℭ𝜇(b^{1}_{1},b^{1}_{2},b^{1}_{3})\\in S^{{\\mathfrak{C}}_{\\mu}} and\n(b12,b22,b32)∈Sℭμsubscriptsuperscript𝑏21subscriptsuperscript𝑏22subscriptsuperscript𝑏23superscript𝑆subscriptℭ𝜇(b^{2}_{1},b^{2}_{2},b^{2}_{3})\\in S^{{\\mathfrak{C}}_{\\mu}}. Note that 𝔐⊧̸μnot-models𝔐𝜇{\\mathfrak{M}}\\not\\models\\mu and hence\nthere exists an embedding f:𝔐→ℭμ:𝑓→𝔐subscriptℭ𝜇f\\colon{\\mathfrak{M}}\\to{\\mathfrak{C}}_{\\mu}.\nSimilarly, there\nexists an embedding g:𝔑→ℭμ:𝑔→𝔑subscriptℭ𝜇g\\colon{\\mathfrak{N}}\\to{\\mathfrak{C}}_{\\mu}.\nClearly, both f𝑓f and g𝑔g regarded as operations on the set Cμsubscript𝐶𝜇C_{\\mu} are pseudo cyclic (but in general not cyclic) and canonical with respect to Aut⁡(ℭμ)Autsubscriptℭ𝜇\\operatorname{Aut}({\\mathfrak{C}}_{\\mu}) (see Claim 6 in Proposition 8.22 for a detailed argument of this type). Let ω𝜔\\omega be the fractional operation given by ω​(f)=12𝜔𝑓12\\omega(f)=\\frac{1}{2} and ω​(g)=12𝜔𝑔12\\omega(g)=\\frac{1}{2}.\nThen ω𝜔\\omega is a binary fractional polymorphism of Γ:=Γ​(ℭμ,∅)assignΓΓsubscriptℭ𝜇\\Gamma:=\\Gamma({\\mathfrak{C}}_{\\mu},\\emptyset):\nfor b1,b2∈(Cμ)2superscript𝑏1superscript𝑏2superscriptsubscript𝐶𝜇2b^{1},b^{2}\\in(C_{\\mu})^{2} we have so ω𝜔\\omega improves R𝑅R, and similarly we see that ω𝜔\\omega improves S𝑆S. We proved that the corresponding valued structure has a binary canonical pseudo cyclic fractional polymorphism. By Theorem 7.17 and 8.16, this reproves the results from [ref]21 (without multiplicities) and  (with multiplicities) that the resilience problem for this query is in P.\n\nReference markers found: [28]\n\nContext windows for each [ref]:\n[ref]28: groups. The not necessarily connected case again\nreduces to the connected case by Corollary 8.7. In Theorem 8.14 below we state a variant of a theorem of Cherlin, Shelah, and Shi  (also see  [ref]28 ).\nIf 𝔅𝔅{\\mathfrak{B}} is a structure, we write 𝔅pp​(m)subscript𝔅pp𝑚{\\mathfrak{B}}_{\\text{pp}(m)} for the expansion of 𝔅𝔅{\\mathfrak{B}} by all relations that can be defined with a connected\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 28,\n            \"titles\": [\n                \"Bag Query Containment and Information Theory\",\n                \"Correlation clustering\",\n                \"Absorbing subalgebras, cyclic terms and the constraint satisfaction problem\",\n                \"The Wonderland of Reflections\",\n                \"Cores of countably categorical structures\",\n                \"Complexity of Infinite-Domain Constraint Satisfaction\",\n                \"The complexity of equality constraint languages\",\n                \"Piecewise linear valued CSPs solvable by linear programming relaxation\",\n                \"A dichotomy for first-order reducts of unary structures\",\n                \"Constraint satisfaction with countable homogeneous templates\",\n                \"Projective clone homomorphisms\",\n                \"A dichotomy theorem for nonuniform CSPs\",\n                \"Symmetries in Constraint Satisfaction: Weisfeiler-Leman Invariance and Promise Problems\",\n                \"View-based query processing and constraint satisfaction\",\n                \"Optimization of real conjunctive queries\",\n                \"Universal graphs with forbidden subgraphs and algebraic closure\",\n                \"An algebraic theory of complexity for discrete optimization\",\n                \"An algebraic characterisation of complexity for valued constraints\",\n                \"Parameterized Algorithms\",\n                \"Homomorphisms and structural properties of relational systems\",\n                \"A Characterization of the Complexity of Resilience and Responsibility for Self-join-free Conjunctive Queries\",\n                \"The complexity of resilience and responsibility for self-join-free conjunctive queries\",\n                \"New Results for the Complexity of Resilience for Binary Conjunctive Queries with Self-Joins\",\n                \"A Galois connection for weighted (relational) clones of infinite size\",\n                \"A guide to NP-completeness\",\n                \"A new approach to the maximum-flow problem\",\n                \"A shorter model theory\",\n                \"Universal structures with forbidden homomorphisms\",\n                \"Homomorphism and embedding universal structures for restricted classes\",\n                \"Solving hard cut problems via flow-augmentation\",\n                \"Directed flow-augmentation\",\n                \"Testing the complexity of a valued CSP language\",\n                \"The complexity of general-valued CSPs\",\n                \"The power of linear programming for general-valued CSPs\",\n                \"Algebraic Properties of Valued Constraint Satisfaction Problem\",\n                \"The Complexity of Valued CSPs\",\n                \"A characterisation of first-order constraint satisfaction problems\",\n                \"A Unified Approach for Resilience and Causal Responsibility with Integer Linear Programming (ILP) and LP Relaxations\",\n                \"The complexity of causality and responsibility for query answers and non-answers\",\n                \"Cores over Ramsey structures\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]28 based on the context and research area of The Complexity of Resilience Problems via Valued Constraint Satisfaction Problems. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}