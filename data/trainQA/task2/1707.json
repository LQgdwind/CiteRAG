{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Surface Warping Incorporating Machine Learning Assisted Domain Likelihood Estimation: A New Paradigm in Mine Geology Modelling and Automation\n\nPaper Abstract: \n\nPaper Section Text:\nThe general problem considered in this paper is the application of machine learning (ML) classifiers to geochemical data and using the ML probability estimates to improve the fidelity of geological boundaries represented by mesh surfaces. A notable feature is the use of machine learning as a component within a complex system, instead of applying ML directly to solve a stand-alone classification   or regression  [ref]4 problem which is often seen in computing and geoscience literature . This synergy means the system needs to integrate surface warping — the principal focus of this work — with block model structure adaptation strategies  and probabilistic inferencing techniques  for grade estimation  to reap the benefits. Performance improvement is obtained via a warping process (spatial algorithm) which manipulates vertices on the mesh surfaces to maximize the posterior given observations. It builds on a Bayesian approach to surface warping from  which demonstrated that an inaccurate surface (one that misrepresents the true location of a geological boundary) can have significant ramifications for grade estimation in mining due to the impact it has on the spatial structure and inferencing ability of a grade block model. In that work, it was shown that surface vertices can be adjusted based on geochemical measurements to maximize the positional integrity of the geological boundaries implied by the surfaces. An example of this is illustrated in Fig. 1. This was accomplished by computing the maximum a posteriori (MAP) solution which involved finding spatial corrections, or optimal displacement vectors, for the mesh vertices that minimize discrepancies between the surface in question and a set of observations. The known quantities include the location 𝐱∈ℝ3𝐱superscriptℝ3\\mathbf{x}\\in\\mathbb{R}^{3} and spatial extent 𝜹=[0,0,h]⊂ℝ3𝜹00ℎsuperscriptℝ3\\boldsymbol{\\delta}=\\left[0,0,h\\right]\\subset\\mathbb{R}^{3} of each assay sample (jointly represented as spatial information 𝐬𝐬\\mathbf{s}), the chemical composition 𝐜∈ℝK𝐜superscriptℝ𝐾\\mathbf{c}\\in\\mathbb{R}^{K} and the spatial structure of geological domains, 𝒢𝒢\\mathcal{G}.111The spatial structure of geological domains for a typical mine is illustrated in 0; see also animation in Appendix G in the supplementary material for . For each sample, its optimal displacement 𝐝∈ℝ3𝐝superscriptℝ3\\mathbf{d}\\in\\mathbb{R}^{3} is to be estimated. The prior knowledge captured by 𝒢𝒢\\mathcal{G} pertains to boundaries that separate individual geozones g∈ℤ𝑔ℤg\\in\\mathbb{Z} to which a sample belongs. The full procedure is described in  but in essence, the problem may be stated as arg​max𝐝⁡p​(𝐝∣𝐜,𝐬)subscriptargmax𝐝𝑝conditional𝐝𝐜𝐬\\operatorname*{arg\\,max}_{\\mathbf{d}}p(\\mathbf{d}\\!\\mid\\!\\mathbf{c},\\mathbf{s}) and the main result can be distilled as where the simplification in (2) results from conditional independence (𝐜⟂⟂𝐝,𝐬∣g)(\\mathbf{c}\\perp\\!\\!\\!\\perp\\mathbf{d},\\mathbf{s}\\mid g) which is a justifiable assumption. In subsequent studies, Balamurali experimented with using p​(g∣𝐜)𝑝conditional𝑔𝐜p(g\\!\\mid\\!\\mathbf{c}) in lieu of p​(𝐜∣g)𝑝conditional𝐜𝑔p(\\mathbf{c}\\!\\mid\\!g) and observed similarly satisfactory delineation of mineralized and non-mineralized material (for instance, separation of high grade/blended ore and waste) using the warped boundaries. A motivation of this paper is to investigate why this is. The principal objectives are to (i) provide some insight into the validity of the p​(g∣𝐜)𝑝conditional𝑔𝐜p(g\\!\\mid\\!\\mathbf{c}) discriminative learning approach through an alternative derivation, thus offering a different perspective to  and (ii) demonstrate that machine learning techniques can be deployed in a Bayesian surface warping framework to assist with the estimation of geozone likelihood in a flexible, data-driven way. Their performance will be systematically evaluated and verified through a series of experiments. For clarity, the terms in equation (2) are interpreted as follows. p​(𝐜∣g)𝑝conditional𝐜𝑔p(\\mathbf{c}\\!\\mid\\!g) denotes the observation likelihood of chemical composition 𝐜𝐜\\mathbf{c} in a given geozone g𝑔g, whereas p​(g,𝐝∣𝐬)𝑝𝑔conditional𝐝𝐬p(g,\\mathbf{d}\\!\\mid\\!\\mathbf{s}) represents a spatial prior that considers the displacement and geozone likelihood given the sample location and extent. An interesting observation is that the chemical and spatial attributes are clearly separated. In practice, L​(y​(𝐜)∣g)𝐿conditional𝑦𝐜𝑔L(y(\\mathbf{c})\\!\\mid\\!g) is used instead of p​(𝐜∣g)𝑝conditional𝐜𝑔p(\\mathbf{c}\\!\\mid\\!g), where y​(𝐜)𝑦𝐜y(\\mathbf{c}) represents a categorical label obtained from a ℝK→ℤ→superscriptℝ𝐾ℤ\\mathbb{R}^{K}\\rightarrow\\mathbb{Z} chemistry classification table called y-charts. These labels generally correspond to mineralogical groupings or destination tags in mining since the excavated materials will be sorted eventually based on chemical and material properties.222Material properties, e.g. whether the rock is hard or friable, lumpy or fine, viscous or powdery, are important considerations for downstream ore processing. For instance, viscous materials can cause clogging to equipments in the processing plant. Typically, 2 to 8 categorical labels are used for y​(𝐜)𝑦𝐜y(\\mathbf{c}). The geological setting, estimated ore reserve, market conditions, ore production and blending considerations are all factors that may influence how these categories, y​(𝐜)𝑦𝐜y(\\mathbf{c}), are defined. In terms of geology, the extensive flat lying martite–goethite ores (formed by supergene enrichment in the Brockman Iron Formations 1) typically contain 60 to 63% Fe while channel iron deposits (which account for up to 40% of the total iron ore mined from the Hamersley Province in Western Australia) contain 56 to 58% Fe. In this context, ore with <<50% Fe is treated as waste 0. For this work, the authors adopt the following definitions for y​(𝐜)𝑦𝐜y(\\mathbf{c}) based on the composition of hydrated and mineralized regions observed by 0. The criteria for HG (high grade), BL (blended), LG (low grade) iron ore and W (waste) are defined as (Fe ≥\\geq 60%), (55%≤Fe<60%percent55Fepercent6055\\%\\leq\\text{Fe}<60\\%), (50%≤Fe<55%percent50Fepercent5550\\%\\leq\\text{Fe}<55\\%) and (Fe << 50%) accordingly. Sub-categories BLS, BLA (similarly for LGS, LGA), where S=siliceous and A=aluminous, are defined as Al2O3 << 3% and (3≤3absent3\\leq Al2O3 << 6%) respectively. Although the rules here are fixed, in reality, these thresholds can vary depending on the deposit and are revised periodically — and therein lies the problem. These rules have to be handcrafted and maintained by experts for all deposits, pits and geozone combinations, potentially numbered in the hundreds or thousands. Thus, it would be constructive, for both productivity and generalizability, to automatically deduce a ℝK→ℤ→superscriptℝ𝐾ℤ\\mathbb{R}^{K}\\rightarrow\\mathbb{Z} chemistry-to-geozone mapping, that is, developing the general capability to compute p​(g∣𝐜)𝑝conditional𝑔𝐜p(g\\!\\mid\\!\\mathbf{c}) given 𝐜𝐜\\mathbf{c} is observed. This paper is organized as follows. Section 2 provides the background to contextualize this work and discusses displacement estimation which is crucial for understanding surface warping. To set the foundation, the problem is formulated in Sect. 3. Machine learning (ML) techniques and issues relating to domain classification are described in Sect. 4. Subsequently, ML-driven domain likelihood estimation is integrated into a real system, surface warping performance is evaluated and discussed in Sect. 5. The utility of data transformation and spatial information are considered in Sect. 6; this is followed with concluding remarks in Sect. 7. Extended analysis is given in Appendix A to provide a more holistic perspective of this work: (i) connections with geostatistics are explored in relation to GP (Gaussian Process) kernel-based grade estimation; (ii) large scale validation results are presented to demonstrate the efficacy of the ML approach beyond a single surface.\n\nReference markers found: [4]\n\nContext windows for each [ref]:\n[ref]4: by mesh surfaces. A notable feature is the use of machine learning as a component within a complex system, instead of applying ML directly to solve a stand-alone classification   or regression  [ref]4 problem which is often seen in computing and geoscience literature . This synergy means the system needs to integrate surface warping — the principal focus of this work — with block model\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 4,\n            \"titles\": [\n                \"Machine Learning for the Geosciences: Challenges and Opportunities\",\n                \"A machine learning framework for drill-core mineral mapping using hyperspectral and high-resolution mineralogical data fusion\",\n                \"Geochemical characterisation of rock hydration processes using t-sne\",\n                \"A hybrid neural networks-fuzzy logic-genetic algorithm for grade estimation\",\n                \"A machine learning approach for material type logging and chemical assaying from autonomous measure-while-drilling (MWD) data [DOI: 10.1007/s11004-021-09970-w]\",\n                \"Modelling orebody structures: Block merging algorithms and block model spatial restructuring strategies given mesh surfaces of geological boundaries [DOI: 10.5311/josis.2020.21.582] [Available at: arxiv:2001.04023]\",\n                \"A sparse covariance function for exact gaussian process inference in large datasets\",\n                \"A non-parametric Bayesian framework for automatic block estimation\",\n                \"Bayesian surface warping approach for rectifying geological boundaries using displacement likelihood and evidence from geochemical assays [DOI: 10.1145/3476979] [Available at: arxiv:2005.14427]\",\n                \"Mineral resource estimation of the Brockman 4 iron ore deposit in the Pilbara region\",\n                \"Iron formation-hosted iron ores in the Hamersley Province of Western Australia\",\n                \"Scikit-learn: Machine learning in python\",\n                \"Dual coordinate descent methods for logistic regression and maximum entropy models\",\n                \"Algorithm 778: L-BFGS-B: Fortran subroutines for large-scale bound-constrained optimization\",\n                \"Naive Bayes classifiers\",\n                \"Sequence based prediction of DNA-binding proteins based on hybrid feature selection using random forest and Gaussian naive Bayes\",\n                \"An efficient instance selection algorithm for k nearest neighbor regression\",\n                \"LIBSVM: A library for support vector machines\",\n                \"Probabilistic outputs for support vector machines and comparisons to regularized likelihood methods\",\n                \"Support-vector networks\",\n                \"Greedy function approximation: a gradient boosting machine\",\n                \"The Elements of Statistical Learning: Data Mining, Inference, and Prediction\",\n                \"Connectionist learning procedures\",\n                \"Understanding the difficulty of training deep feedforward neural networks\",\n                \"Delving deep into rectifiers: Surpassing human-level performance on ImageNet classification\",\n                \"Adam: A method for stochastic optimization\",\n                \"Random forests\",\n                \"Obtaining calibrated probability estimates from decision trees and naive Bayesian classifiers\",\n                \"Transforming classifier scores into accurate multiclass probability estimates\",\n                \"Sample truncation strategies for outlier removal in geochemical data: The MCD robust distance approach versus t-SNE ensemble clustering\",\n                \"Verification of forecasts expressed in terms of probability\",\n                \"A data-based power transformation for compositional data\",\n                \"Silhouettes: a graphical aid to the interpretation and validation of cluster analysis\",\n                \"Finally, a correlation coefficient that tells the geochemical truth\",\n                \"Geostatistics for compositional data: An overview\",\n                \"Isometric logratio transformations for compositional data analysis\",\n                \"The isometric logratio transformation in compositional data analysis: a practical evaluation, Economics Working Paper Series\",\n                \"Empirical observations on the effects of data transformation in machine learning classification of geological domains\",\n                \"Visual SLAM: why filter?\",\n                \"A data mining approach to validating drill hole logging data in pilbara iron ore exploration\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]4 based on the context and research area of Surface Warping Incorporating Machine Learning Assisted Domain Likelihood Estimation: A New Paradigm in Mine Geology Modelling and Automation. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}