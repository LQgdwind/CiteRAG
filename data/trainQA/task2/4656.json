{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Counting Subgraphs in Somewhere Dense Graphs1footnote 11footnote 1This research was funded in whole, or in part, by EPSRC grant EP/V032305/1. For the purpose of Open Access, the authors have applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. All data is provided in full in the results section of this paper.\n\nPaper Abstract: \n\nPaper Section Text:\nWe study the following subgraph counting problem: given two graphs Hğ»H and GğºG, compute the number of copies of Hğ»H in GğºG. For several decades this problem has received widespread attention from the theoretical community, leading to a rich algorithmic toolbox that draws from different techniquesÂ  [ref]3   and to deep structural results in parameterised complexity theoryÂ  7. Since it was discovered that subgraph counts reveal global properties of complex networksÂ  , subgraph counting has also found several applications in fields such as biologyÂ   geneticsÂ [ref]58, phylogenyÂ , and data miningÂ .\nUnfortunately, the subgraph counting problem is in general intractable, since it contains as special cases hard problems such as Clique. This does not mean however that the problem is always intractable; it just means that it is tractable when the pattern Hğ»H is restricted to certain graph families. Identifying these families of patterns that are efficiently countable has been a key question for the last twenty years. A long stream of research eventually showed that, unless standard conjectures fail, subgraph counting is tractable only for very restricted families of patternsÂ  2     7  9. To circumvent this â€œwall of intractabilityâ€, in this work we restrict both the family of the pattern Hğ»H and the family of the host GğºG. Formally, given two classes of graphs â„‹â„‹\\mathcal{H} and ğ’¢ğ’¢\\mathcal{G}, we study the problems #â€‹Subâ€‹(â„‹â†’ğ’¢)#Subâ†’â„‹ğ’¢\\#\\textsc{Sub}(\\mathcal{H}\\to\\mathcal{G}), #â€‹IndSubâ€‹(â„‹â†’ğ’¢)#IndSubâ†’â„‹ğ’¢\\#\\textsc{IndSub}(\\mathcal{H}\\to\\mathcal{G}), and #â€‹Homâ€‹(â„‹â†’ğ’¢)#Homâ†’â„‹ğ’¢\\#\\textsc{Hom}(\\mathcal{H}\\to\\mathcal{G}), defined as follows. For all of them, the input is a pair (H,G)ğ»ğº(H,G) with Hâˆˆâ„‹ğ»â„‹H\\in\\mathcal{H} and Gâˆˆğ’¢ğºğ’¢G\\in\\mathcal{G}. The outputs are respectively the number of subgraphs of GğºG isomorphic to Hğ»H, denoted by #â€‹ğ–²ğ—ğ–»â€‹(Hâ†’G)#ğ–²ğ—ğ–»â†’ğ»ğº\\#\\mathsf{Sub}(H\\to G), the number of induced subgraphs of GğºG isomorphic to Hğ»H, denoted by #â€‹ğ–¨ğ—‡ğ–½ğ–²ğ—ğ–»â€‹(Hâ†’G)#ğ–¨ğ—‡ğ–½ğ–²ğ—ğ–»â†’ğ»ğº\\#\\mathsf{IndSub}(H\\to G), and the number of homomorphisms (edge-preserving maps) from Hğ»H to GğºG, denoted by #â€‹ğ–§ğ—ˆğ—†â€‹(Hâ†’G)#ğ–§ğ—ˆğ—†â†’ğ»ğº\\#\\mathsf{Hom}(H\\to G).\nOur goal is to determine for which â„‹â„‹\\mathcal{H} and ğ’¢ğ’¢\\mathcal{G} these three problems are tractable. To formalize what we mean by tractable, we adopt the framework of parameterized complexityÂ 1: we say that a problem is fixed-parameter tractable, or in the class FPTFPT\\mathrm{FPT}, if it is solvable in time fâ€‹(|H|)â‹…|G|Oâ€‹(1)â‹…ğ‘“ğ»superscriptğºğ‘‚1f(|H|)\\cdot|G|^{O(1)} for some computable function fğ‘“f (see SectionÂ 2 for a complete introduction). For instance, we consider as tractable a running time of 2Oâ€‹(|H|)â‹…|G|â‹…superscript2ğ‘‚ğ»ğº2^{O(|H|)}\\cdot|G| but not one of |G|Oâ€‹(|H|)superscriptğºğ‘‚ğ»|G|^{O(|H|)}. This captures the intuition that Hğ»H is â€œsmallâ€ compared to GğºG, and is the main theoretical framework for subgraph countingÂ . Thus, the goal of this work is understanding the fixed-parameter tractability of #â€‹Subâ€‹(â„‹â†’ğ’¢)#Subâ†’â„‹ğ’¢\\#\\textsc{Sub}(\\mathcal{H}\\to\\mathcal{G}), #â€‹IndSubâ€‹(â„‹â†’ğ’¢)#IndSubâ†’â„‹ğ’¢\\#\\textsc{IndSub}(\\mathcal{H}\\to\\mathcal{G}), and #â€‹Homâ€‹(â„‹â†’ğ’¢)#Homâ†’â„‹ğ’¢\\#\\textsc{Hom}(\\mathcal{H}\\to\\mathcal{G}) as a function of â„‹â„‹\\mathcal{H} and ğ’¢ğ’¢\\mathcal{G}. Moreover, when those problems are not fixed-parameter tractable we aim to show that they are hard for the complexity class #â€‹Wâ€‹#Wdelimited-[]1\\#\\mathrm{W}, which can be thought of as the equivalent of NPNP\\mathrm{NP} for parameterized counting. We first briefly discuss which properties of ğ’¢ğ’¢\\mathcal{G} are worthy of attention. When ğ’¢ğ’¢\\mathcal{G} is the class of all graphs, it is well known that each of the three problems is either FPTFPT\\mathrm{FPT} or #â€‹Wâ€‹#W\\#\\mathrm{W}\\text{}-hard depending on whether certain structural parameters of â„‹â„‹\\mathcal{H} (such as treewidth or vertex cover number) are bounded or not.\nThus, when ğ’¢ğ’¢\\mathcal{G} is the class of all graphs, the problem is solved.\nHowever, when ğ’¢ğ’¢\\mathcal{G} is arbitrary, no such characterization is known. This is partly due to the fact that â€œnaturalâ€ structural properties related to subgraph counting are harder to find for ğ’¢ğ’¢\\mathcal{G} than for â„‹â„‹\\mathcal{H}; subgraph counting algorithms themselves usually exploit the structure of Hğ»H but not that of GğºG (think of tree decompositions).\nThere is however one deep structural property that, if held by ğ’¢ğ’¢\\mathcal{G}, yields tractability: the property of being nowhere dense, introduced by NeÅ¡etÅ™il and Ossona de MendezÂ . In a nutshell ğ’¢ğ’¢\\mathcal{G} is nowhere dense if, for all râˆˆâ„•0ğ‘Ÿsubscriptâ„•0r\\in\\mathbb{N}_{0}, its members do not contain as subgraphs the rğ‘Ÿr-subdivisions of arbitrarily large cliques; it can be shown that this generalizes several natural definitions of sparsity, including having bounded degree or bounded local treewidth, or excluding some topological minor.\nIn a remarkable result, NeÅ¡etÅ™il and Ossona de Mendez proved:222In the realm of decision problems, an even more general meta-theorem is known for first-order model-checking on nowhere dense graphsÂ . If ğ’¢ğ’¢\\mathcal{G} is nowhere dense then #â€‹Homâ€‹(â„‹â†’ğ’¢)#Homâ†’â„‹ğ’¢\\#\\textsc{Hom}(\\mathcal{H}\\to\\mathcal{G}), #â€‹Subâ€‹(â„‹â†’ğ’¢)#Subâ†’â„‹ğ’¢\\#\\textsc{Sub}(\\mathcal{H}\\to\\mathcal{G}), and #â€‹IndSubâ€‹(â„‹â†’ğ’¢)#IndSubâ†’â„‹ğ’¢\\#\\textsc{IndSub}(\\mathcal{H}\\to\\mathcal{G}) are fixed-parameter tractable and can be solved in time\nfâ€‹(|H|)â‹…|Vâ€‹(G)|1+oâ€‹(1)â‹…ğ‘“ğ»superscriptğ‘‰ğº1ğ‘œ1f(|H|)\\cdot|V(G)|^{1+o(1)} for some computable function fğ‘“f. Thus the case that ğ’¢ğ’¢\\mathcal{G} is nowhere dense is closed, and we can focus on its complement â€” the case where ğ’¢ğ’¢\\mathcal{G} is somewhere dense. Hence the question studied in this work is: when are #â€‹Subâ€‹(â„‹â†’ğ’¢)#Subâ†’â„‹ğ’¢\\#\\textsc{Sub}(\\mathcal{H}\\to\\mathcal{G}), #â€‹IndSubâ€‹(â„‹â†’ğ’¢)#IndSubâ†’â„‹ğ’¢\\#\\textsc{IndSub}(\\mathcal{H}\\to\\mathcal{G}), and #â€‹Homâ€‹(â„‹â†’ğ’¢)#Homâ†’â„‹ğ’¢\\#\\textsc{Hom}(\\mathcal{H}\\to\\mathcal{G}) fixed-parameter tractable, provided ğ’¢ğ’¢\\mathcal{G} is somewhere dense?\n\nReference markers found: [3]\n\nContext windows for each [ref]:\n[ref]3: copies of Hğ»H in GğºG. For several decades this problem has received widespread attention from the theoretical community, leading to a rich algorithmic toolbox that draws from different techniquesÂ  [ref]3   and to deep structural results in parameterised complexity theoryÂ  7. Since it was discovered that subgraph counts reveal global properties of complex networksÂ  , subgraph counting has also\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 3,\n            \"titles\": [\n                \"Counting Subgraphs in Degenerate Graphs\",\n                \"Interpreting nowhere dense graph classes as a classical notion of model theory\",\n                \"Biomolecular network motif counting and discovery by color coding\",\n                \"Color-Coding\",\n                \"Linear Time Subgraph Counting, Graph Degeneracy, and the Chasm at Size Six\",\n                \"Near-Linear Time Homomorphism Counting in Bounded Degeneracy Graphs: The Barrier of Long Induced Cycles\",\n                \"Twin-width I: tractable FO model checking\",\n                \"Exact and Approximate Pattern Counting in Degenerate Graphs: New Algorithms, Hardness Results, and Complexity Dichotomies\",\n                \"Path coupling: A technique for proving rapid mixing in markov chains\",\n                \"Counting Answers to Existential Positive Queries: A Complexity Classification\",\n                \"Tight lower bounds for certain parameterized NP-hard problems\",\n                \"Strong computational lower bounds via parameterized complexity\",\n                \"Understanding the Complexity of Induced Subgraph Isomorphisms\",\n                \"Counting matchings of size k is W[1]-hard\",\n                \"The simple, little and slow things count: On parameterized counting complexity\",\n                \"A fixed-parameter perspective on #BIS\",\n                \"Homomorphisms are a good basis for counting small subgraphs\",\n                \"Counting edge-injective homomorphisms and matchings on restricted graph classes\",\n                \"Complexity of counting subgraphs: only the boundedness of the vertex-cover number counts\",\n                \"Parameterizing the permanent: Hardness for fixed excluded minors\",\n                \"Parameterized Algorithms\",\n                \"The complexity of counting homomorphisms seen from the other side\",\n                \"Counting H-colorings of partial k-trees\",\n                \"Graph Theory (5th Edition)\",\n                \"Counting Induced Subgraphs: An Algebraic Approach to #W[1]-Hardness\",\n                \"Testing first-order properties for subclasses of sparse graphs\",\n                \"The Parameterized Complexity of Counting Problems\",\n                \"Parameterized Complexity Theory\",\n                \"Counting Small Induced Subgraphs with Hereditary Properties\",\n                \"FO Model Checking on Posets of Bounded Width\",\n                \"A new perspective on FO model checking of dense graph classes\",\n                \"FO model checking of interval graphs\",\n                \"First order logic and twin-width in tournaments and dense oriented graphs\",\n                \"The complexity of counting colourings and independent sets in sparse graphs and hypergraphs\",\n                \"Deciding first-order properties of nowhere dense graphs\",\n                \"On tree width, bramble size, and expansion\",\n                \"On the complexity of SAT\",\n                \"The parameterised complexity of counting connected subgraphs and graph motifs\",\n                \"A polynomial-time approximation algorithm for the permanent of a matrix with nonnegative entries\",\n                \"Topological network alignment uncovers biological function and phylogeny\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]3 based on the context and research area of Counting Subgraphs in Somewhere Dense Graphs1footnote 11footnote 1This research was funded in whole, or in part, by EPSRC grant EP/V032305/1. For the purpose of Open Access, the authors have applied a CC BY public copyright licence to any Author Accepted Manuscript version arising from this submission. All data is provided in full in the results section of this paper.. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}