{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: An Algorithmic Meta Theorem for Homomorphism Indistinguishability\n\nPaper Abstract: \n\nPaper Section Text:\nIn 1967, Lovász  proved that two graphs G𝐺G and H𝐻H are isomorphic if and only if they are homomorphism indistinguishable over all graphs, i.e. they admit the same number of homomorphisms from every graph F𝐹F.\nSubsequently, many graph isomorphism relaxations have been characterised as homomorphism indistinguishability relations.\nFor example, two graphs are quantum isomorphic if and only if they are homomorphism indistinguishable over all planar graphs [ref]32.\nMoreover, two graphs satisfy the same sentences in k𝑘k-variable first-order logic with counting quantifiers if and only if they are homomorphism indistinguishable over all graphs of treewidth less than k𝑘k 0 .\nA substantial list of similar results characterises notions from quantum information [ref]32 , finite model theory 0  , convex optimisation   ,\nalgebraic graph theory  ,\nmachine learning   , and category theory  \nas homomorphism indistinguishability relations. The wealth of such examples motivates a more principled study of homomorphism indistinguishability   [ref]39.\nFrom a computational perspective, the central question on homomorphism indistinguishability concerns the complexity and computability of the following decision problem [36, Question 9]: \n\nHomInd(ℱℱ\\mathcal{F})\nInput: Graphs G𝐺G and H𝐻H.\nQuestion: Are G𝐺G and H𝐻H homomorphism indistinguishable over ℱℱ\\mathcal{F}?\n Here, we consider the graph class ℱℱ\\mathcal{F} to be fixed and not part of the input.\nThe graphs G𝐺G and H𝐻H may be arbitrary graphs and do not necessary have to be in ℱℱ\\mathcal{F}.\nTypically, the graph class ℱℱ\\mathcal{F} is infinite.\nThus, the trivial approach to HomInd(ℱℱ\\mathcal{F}) of checking whether G𝐺G and H𝐻H have the same number of homomorphisms from every F∈ℱ𝐹ℱF\\in\\mathcal{F} does not even render HomInd(ℱℱ\\mathcal{F}) decidable. In general, the understanding of HomInd(ℱℱ\\mathcal{F}) is limited and does not go beyond a short list of examples.\nFor arguably artificial graph classes ℱℱ\\mathcal{F}, HomInd(ℱℱ\\mathcal{F}) can be arbitrarily hard  [ref]39.\nHowever, even for natural graph classes ℱℱ\\mathcal{F} the complexity-theoretic landscape of HomInd(ℱℱ\\mathcal{F}) is diverse: For the class 𝒢𝒢\\mathcal{G} of all graphs, HomInd(𝒢𝒢\\mathcal{G}) is graph isomorphism ,\na problem representing a long standing complexity-theoretic challenge and currently only known to be in quasi-polynomial time .\nFor the class 𝒫𝒫\\mathcal{P} of all planar graphs, HomInd(𝒫𝒫\\mathcal{P}) is undecidable [ref]32.\nFor the class 𝒦𝒦\\mathcal{K} of all cliques,\nHomInd(𝒦𝒦\\mathcal{K}) is decidable, yet 𝖢=​𝖯subscript𝖢𝖯\\mathsf{C}_{=}\\mathsf{P}-hard .\nFinally, for the class 𝒯​𝒲k𝒯subscript𝒲𝑘\\mathcal{TW}_{k} of all graphs of treewidth at most k𝑘k, HomInd(𝒯​𝒲k𝒯subscript𝒲𝑘\\mathcal{TW}_{k}) can be solved in polynomial time using the well-known k𝑘k-dimensional Weisfeiler–Leman algorithm 0 . In this work, we generalise the last example by establishing that HomInd(ℱℱ\\mathcal{F}) is tractable for every recognisable graph class ℱℱ\\mathcal{F} of bounded treewidth thus giving the first general algorithm for deciding homomorphism indistinguishability. Let k≥1𝑘1k\\geq 1.\nIf ℱℱ\\mathcal{F} is a k𝑘k-recognisable graph class of treewidth at most k−1𝑘1k-1\nthen HomInd(ℱℱ\\mathcal{F}) is in coRP. Spelled out, Theorem 1.1 asserts that there exists a randomised algorithm for HomInd(ℱℱ\\mathcal{F}) which always runs in polynomial time, accepts all YES-instances and incorrectly accepts NO-instances with probability less than one half.\nRecognisability is a notion arising in the context of Courcelle’s theorem  on model checking, cf. Definition 2.10.\nCourcelle showed that every graph class definable in counting monadic second-order logic 𝖢𝖬𝖲𝖮2subscript𝖢𝖬𝖲𝖮2\\mathsf{CMSO}_{2} is recognisable.\nThis subsumes graph classes defined by forbidden (induced) subgraphs and minors, and by the Robertson–Seymour Theorem, all minor-closed graph classes. Thereby, Theorem 1.1 applies to e.g. the class of graphs of bounded branchwidth,\nk𝑘k-outerplanar graphs,\nand the class of trees of bounded degree.\nThe theorem also applies to the\ngraph classes arising in homomorphism indistinguishability characterisations for the Lasserre semidefinite programming hierarchy .\nIn this way, we answer a question raised in  affirmatively, cf. Theorem 8.1. The proof of Theorem 1.1 combines Courcelle’s graph algebras  with the homomorphism tensors from [ref]32 .\nGraph algebras comprise labelled graphs and operations on them such as series and parallel composition.\nHomomorphism tensors keep track of homomorphism counts of labelled graphs.\nWe show that recognisability and bounded treewidth guarantee that\nhomomorphism tensors yield finite-dimensional representations of suitable graph algebras which certify homomorphism indistinguishability and are efficiently computable. Observing that the dimension of the space of homomorphism tensors corresponds to the number of labels of the labelled graphs in the graph algebra which they represent, one might conjecture the following:\nThe problem HomInd(ℱℱ\\mathcal{F}) should be decidable if and only if the graph class ℱℱ\\mathcal{F} can be generated as family of labelled graphs with a bounded number of labels, cf. 10.1.\nIndeed, for planar graphs 𝒫𝒫\\mathcal{P}, the result [ref]32 of Mančinska and Roberson requires an unbounded number of labels and characterises homomorphism indistinguishability over 𝒫𝒫\\mathcal{P} as the existence of some infinite-dimensional operator.\nIntuitively, HomInd(𝒫𝒫\\mathcal{P}) is undecidable as it requires solving an infinite-dimensional system of equations.\nOur Theorem 1.1 makes the other direction of this vague argument precise:\nWe show that if the number of labels is bounded (e.g. the graph class has bounded treewidth) then considering finite-dimensional spaces suffices, rendering the problem tractable. Theorem 1.1 can be strengthened in several ways.\nFirstly, the connection to Courcelle’s theorem motivates considering the following parametrised problem: \n\nHomInd\nInput: Graphs G𝐺G, H𝐻H, a 𝖢𝖬𝖲𝖮2subscript𝖢𝖬𝖲𝖮2\\mathsf{CMSO}_{2}-sentence φ𝜑\\varphi, an integer k𝑘k.\nParameter: |φ|+k𝜑𝑘|\\varphi|+k.\nQuestion: Are G𝐺G and H𝐻H homomorphism indistinguishable over ℱφ,k≔{graph ​F∣F⊧φ​ and ​tw⁡F≤k−1}≔subscriptℱ𝜑𝑘conditional-setgraph 𝐹models𝐹𝜑 and tw𝐹𝑘1\\mathcal{F}_{\\varphi,k}\\coloneqq\\{\\text{graph }F\\mid F\\models\\varphi\\text{ and }\\operatorname{tw}F\\leq k-1\\}?\n The logical sentence φ𝜑\\varphi allows the graph class to be specified as part of the input.\nWe generalise Theorem 1.1 as follows: There exists a computable function f:ℕ→ℕ:𝑓→ℕℕf\\colon\\mathbb{N}\\to\\mathbb{N} and a randomised algorithm for HomInd of runtime f​(|φ|+k)​nO​(k)𝑓𝜑𝑘superscript𝑛𝑂𝑘f(|\\varphi|+k)n^{O(k)} for n≔max⁡{|V​(G)|,|V​(H)|}≔𝑛𝑉𝐺𝑉𝐻n\\coloneqq\\max\\{|V(G)|,|V(H)|\\} which accepts all YES-instances and accepts NO-instances with probability less than one half. While Theorem 1.1 does not depend on Courcelle’s work beyond the notion of recognisability, Theorem 1.2 uses his result asserting that given a 𝖢𝖬𝖲𝖮2subscript𝖢𝖬𝖲𝖮2\\mathsf{CMSO}_{2}-sentence φ𝜑\\varphi and k∈ℕ𝑘ℕk\\in\\mathbb{N} a finite automaton can be computed which accepts width-k𝑘k tree-decomposed graphs satisfying φ𝜑\\varphi.\nBased on this automaton,\nour algorithm for Theorem 1.2 computes a basis for finite-dimensional vector spaces of homomorphism tensors associated to each of its states. Theorem 1.1 is significant in light of the fact that HomInd(ℱℱ\\mathcal{F}) was previously not even known to be decidable for most graph classes ℱℱ\\mathcal{F} in its scope.\nDespite that,\nit would be desirable to eliminate the need for randomness.\nWe accomplish this for a large range of graph classes: Let k≥1𝑘1k\\geq 1.\nIf ℱℱ\\mathcal{F} is a k𝑘k-recognisable graph class of pathwidth at most k−1𝑘1k-1\nthen HomInd(ℱℱ\\mathcal{F}) is in polynomial time. Furthermore, we show similarly to Theorem 1.2 that the analogue of HomInd with pathwidth instead of treewidth admits a deterministic algorithm of runtime f​(|φ|+k)​nO​(k)𝑓𝜑𝑘superscript𝑛𝑂𝑘f(|\\varphi|+k)n^{O(k)}, cf. Theorem 7.2. Equipped with the parametrised perspective offered by HomInd, we finally consider lower bounds on the complexity of this problem.\nFirstly, we show that it is coW-hard and that the runtime of the algorithm that yielded Theorem 1.3 is optimal under the Exponential Time Hypothesis (ETH). HomInd is coW-hard under fpt-reductions.\nUnless ETH fails, there is no algorithm for HomInd that runs in time f​(|φ|+k)​no​(|φ|+k)𝑓𝜑𝑘superscript𝑛𝑜𝜑𝑘f(|\\varphi|+k)n^{o(|\\varphi|+k)} for any computable function f:ℕ→ℕ:𝑓→ℕℕf\\colon\\mathbb{N}\\to\\mathbb{N}. Secondly, we show that, when disregarding the parametrisation, HomInd is coNP-hard. We do so by showing coNP-hardness of the following problem involving the Weisfeiler–Leman (WL) algorithm.\nTheorem 1.5 is a first step towards resolving a problem posed by Berkholz : Is the decision problem in Theorem 1.5 EXPTIME-complete? The problem of deciding given graphs G𝐺G and H𝐻H and an integer k∈ℕ𝑘ℕk\\in\\mathbb{N} whether G𝐺G and H𝐻H are k𝑘k-WL indistinguishable is coNP-hard under polynomial-time many-one reductions. WL is an important heuristic in graph isomorphism and tightly related to notions in finite model theory  and graph neural networks   .\nThe best known algorithm for WL runs in time O​(k2​nk+1​log⁡n)𝑂superscript𝑘2superscript𝑛𝑘1𝑛O(k^{2}n^{k+1}\\log n) 8, which is exponential when regarding k𝑘k as part of the input.\nIt was shown that when k𝑘k is fixed then the problem is PTIME-complete 2.\nEstablishing lower bounds on the complexity of WL is a challenging problem   5.\n\nReference markers found: [32]\n\nContext windows for each [ref]:\n[ref]32: have been characterised as homomorphism indistinguishability relations.\nFor example, two graphs are quantum isomorphic if and only if they are homomorphism indistinguishable over all planar graphs [ref]32.\nMoreover, two graphs satisfy the same sentences in k𝑘k-variable first-order logic with counting quantifiers if and only if they are homomorphism indistinguishable over all graphs of\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 32,\n            \"titles\": [\n                \"Weisfeiler and Leman Go Neural: Higher-order Graph Neural Networks\",\n                \"Handbook of mathematical functions: with formulas, graphs, and mathematical tables\",\n                \"Discrete Density Comonads and Graph Parameters\",\n                \"PRIMES is in P\",\n                \"On the Expressive Power of Homomorphism Counts\",\n                \"Sherali-Adams Relaxations and Indistinguishability in Counting Logics\",\n                \"Quantum and non-signalling graph isomorphisms\",\n                \"Graph Isomorphism in Quasipolynomial Time [Extended Abstract]\",\n                \"Lower Bounds for Existential Pebble Games and k𝑘k-Consistency Tests\",\n                \"Tight Lower and Upper Bounds for the Complexity of Canonical Colour Refinement\",\n                \"A partial k𝑘k-arboretum of graphs with bounded treewidth\",\n                \"Treewidth for graphs with small chordality\",\n                \"Definability equals recognizability for graphs of bounded treewidth\",\n                \"The Complexity of Homomorphism Indistinguishability\",\n                \"An optimal lower bound on the number of variables for graph identification\",\n                \"The monadic second-order logic of graphs. I. Recognizable sets of finite graphs\",\n                \"Graph Structure and Monadic Second-Order Logic: A Language-Theoretic Approach\",\n                \"Parameterized Algorithms\",\n                \"Lovász-Type Theorems and Game Comonads\",\n                \"Lovász Meets Weisfeiler and Leman\",\n                \"On recognizing graphs by numbers of homomorphisms\",\n                \"Going Deep and Going Wide: Counting Logic and Homomorphism Indistinguishability over Graphs of Bounded Treedepth and Treewidth\",\n                \"Equivalence in Finite-Variable Logics is Complete for Polynomial Time\",\n                \"Counting Bounded Tree Depth Homomorphisms\",\n                \"The Logic of Graph Neural Networks\",\n                \"Compressing CFI Graphs and Lower Bounds for the Weisfeiler–Leman Refinements\",\n                \"Pebble Games and Linear Equations\",\n                \"Homomorphism Tensors and Linear Equations\",\n                \"Describing Graphs: A First-Order Approach to Graph Canonization\",\n                \"Limitations of Game Comonads for Invertible-Map Equivalence via Homomorphism Indistinguishability\",\n                \"Operations with structures\",\n                \"Large networks and graph limits\",\n                \"Quantum isomorphism is equivalent to equality of homomorphism counts from planar graphs\",\n                \"Elementary Methods in Number Theory, volume 195 of Graduate Texts in Mathematics\",\n                \"Homomorphism-Distinguishing Closedness for Graphs of Bounded Tree-Width, April 2023.\",\n                \"Oddomorphisms and homomorphism indistinguishability over graphs of bounded degree, June 2022.\",\n                \"Lasserre Hierarchy for Graph Isomorphism and Homomorphism Indistinguishability\",\n                \"Explicit Bounds for Some Functions of Prime Numbers\",\n                \"Logical Equivalences, Homomorphism Indistinguishability, and Forbidden Minors\",\n                \"How Powerful are Graph Neural Networks?\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]32 based on the context and research area of An Algorithmic Meta Theorem for Homomorphism Indistinguishability. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}