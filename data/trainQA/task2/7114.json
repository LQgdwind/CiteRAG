{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Computing Balanced Solutions for Large International Kidney Exchange Schemes When Cycle Length Is Unbounded\n\nPaper Abstract: \n\nPaper Section Text:\nIn this paper, we introduce a new class of cooperative games called partitioned permutation games, which are closely related to the known classes of permutation games and partitioned matching games (introduced at AAMAS 2019Â ). Both partitioned matching games and partitioned permutation games have immediate applications in international kidney exchange. Before defining these games, we first explain this application area. Kidney Exchange.\nThe most effective treatment for kidney failure is transplanting a kidney from a deceased or living donor, with better long-term outcomes in the latter case. However, a kidney from a family member or friend might be medically incompatible and could easily be rejected by the patientâ€™s body. Therefore, many countries are running national Kidney Exchange Programmes (KEPs)Â . In a KEP, all patient-donor pairs are placed together in one pool.\nIf for two patient-donor pairs (p,d)ğ‘ğ‘‘(p,d) and (pâ€²,dâ€²)superscriptğ‘â€²superscriptğ‘‘â€²(p^{\\prime},d^{\\prime}), it holds that dğ‘‘d and pğ‘p are incompatible, as well as dâ€²superscriptğ‘‘â€²d^{\\prime} with pâ€²superscriptğ‘â€²p^{\\prime}, then dğ‘‘d and dâ€²superscriptğ‘‘â€²d^{\\prime} could donate a kidney to pâ€²superscriptğ‘â€²p^{\\prime} and pğ‘p, respectively. This is a 222-way exchange. We now generalize a 222-way exchange. We model a pool of patient-donor pairs as a directed graph G=(V,A)ğºğ‘‰ğ´G=(V,A) (the compatibility graph) in which Vğ‘‰V consists of the patient-donor pairs, and Ağ´A consists of every arc (u,v)ğ‘¢ğ‘£(u,v) such that the donor ofÂ uğ‘¢u is compatible with the patient ofÂ vğ‘£v. In a directed cycle C=u1â€‹u2â€‹â€¦â€‹ukâ€‹u1ğ¶subscriptğ‘¢1subscriptğ‘¢2â€¦subscriptğ‘¢ğ‘˜subscriptğ‘¢1C=u_{1}u_{2}\\ldots u_{k}u_{1}, for some kâ‰¥2ğ‘˜2k\\geq 2, the kidney of the donor ofÂ uisubscriptğ‘¢ğ‘–u_{i} could be given to the patient ofÂ ui+1subscriptğ‘¢ğ‘–1u_{i+1} for every iâˆˆ{1,â€¦,k+1}ğ‘–1â€¦ğ‘˜1i\\in\\{1,\\ldots,k+1\\}, with uk+1:=u1assignsubscriptğ‘¢ğ‘˜1subscriptğ‘¢1u_{k+1}:=u_{1}. This is a kğ‘˜k-way exchange using the exchange cycleÂ Cğ¶C.\nTo prevent exchange cycles from breaking (and a patient from losing their willing donor), hospitals perform the kğ‘˜k transplants in a kğ‘˜k-way exchange simultaneously. Hence,\nKEPs impose a bound â„“â„“\\ell (the exchange bound) on the maximum length of an exchange cycle, typically 2â‰¤â„“â‰¤52â„“52\\leq\\ell\\leq 5. An â„“â„“\\ell-cycle packing of GğºG is\na setÂ ğ’ğ’{\\mathcal{C}} of directed cycles, each of length at mostÂ â„“â„“\\ell, that are pairwise vertex-disjoint; if â„“=âˆâ„“\\ell=\\infty, we also say that ğ’ğ’{\\mathcal{C}} is a cycle packing.\nThe size of ğ’ğ’{\\mathcal{C}} is the number of arcs that belong to a cycle in ğ’ğ’{\\mathcal{C}}. KEPs operate in rounds.\nA solution for roundÂ rğ‘Ÿr is an â„“â„“\\ell-cycle packing in the corresponding compatibility graph Grsuperscriptğºğ‘ŸG^{r}. The goal is to help as many patients as possible in each round. Hence, to maximize the number of transplants in roundÂ rğ‘Ÿr, we seek for an optimal solution, that is, a maximum â„“â„“\\ell-cycle packing of Grsuperscriptğºğ‘ŸG^{r}, i.e., one that has maximum size.\nAfter a round, some patients have received a kidney or died, and other patient-donor pairs may have arrived, resulting in a new compatibility graph Gr+1superscriptğºğ‘Ÿ1G^{r+1} for roundÂ r+1ğ‘Ÿ1r+1. The main computational issue for KEPs is how to find an optimal solution in each round. If â„“=2â„“2\\ell=2, we can transform, by keeping the â€œdoubleâ€ arcs, a computability graph GğºG into an undirected graph D=(V,E)ğ·ğ‘‰ğ¸D=(V,E)\nas follows. For every u,vâˆˆVğ‘¢ğ‘£ğ‘‰u,v\\in V, we have uâ€‹vâˆˆEğ‘¢ğ‘£ğ¸uv\\in E if and only if (u,v)âˆˆAğ‘¢ğ‘£ğ´(u,v)\\in A and (v,u)âˆˆAğ‘£ğ‘¢ğ´(v,u)\\in A. It then remains to compute, in polynomial time, a maximum matching in Dğ·D.\nIf we set â„“=âˆâ„“\\ell=\\infty, a well-known trick works (see e.g.Â ). We transform GğºG into a bipartite graph Hğ»H with partition classes Vğ‘‰V and Vâ€²superscriptğ‘‰â€²V^{\\prime}, where Vâ€²superscriptğ‘‰â€²V^{\\prime} is a copy of Vğ‘‰V. For each uâˆˆVğ‘¢ğ‘‰u\\in V and its copy uâ€²âˆˆVâ€²superscriptğ‘¢â€²superscriptğ‘‰â€²u^{\\prime}\\in V^{\\prime}, we add the edgeÂ uâ€‹uâ€²ğ‘¢superscriptğ‘¢â€²uu^{\\prime} with weightÂ 00. For each (u,v)âˆˆAğ‘¢ğ‘£ğ´(u,v)\\in A, we add the edge uâ€‹vğ‘¢ğ‘£uv with weightÂ 111. Now it remains to find in polynomial time a maximum weight perfect matching in Hğ»H. However, for any constant â„“â‰¥3â„“3\\ell\\geq 3, the situation changes, as shown by Abraham, Blum and SandholmÂ . If â„“=2â„“2\\ell=2 or â„“=âˆâ„“\\ell=\\infty, we can find an optimal solution for a KEP round in polynomial time; else this is NP-hard. International Kidney Exchange.\nAs merging pools of national KEPs leads to better outcomes, the focus nowadays lies on forming an international KEP (IKEP), e.g. Austria and the Czech RepublicÂ 7; Denmark, Norway and Sweden; and Italy, Portugal and SpainÂ . Apart from ethical, legal and logistic issues (all beyond our scope), there is now a new and highly non-trivial issue that needs to be addressed: How can we ensure long-term stability of an IKEP? If countries are not treated fairly, they may leave the IKEP, and it could even happen that each country runs their own national KEPÂ again. Example. Let GğºG be the compatibility graph from FigureÂ 1. Then a total of five kidney transplants is possible if the exchange cycle C=aâ€‹bâ€‹dâ€‹eâ€‹câ€‹ağ¶ğ‘ğ‘ğ‘‘ğ‘’ğ‘ğ‘C=abdeca is used. In that case, countries 111, 222 and 333 receive three, two and zero kidney transplants, respectively. âˆ Cooperative Game Theory\nconsiders\nfair distributions of common profit if all parties involved collaborate with each other. Before describing its role in our setting, we first give some terminology. A (cooperative) game is a pair (N,v)ğ‘ğ‘£(N,v), where Nğ‘N is a set of nğ‘›n players and v:2Nâ†’â„:ğ‘£â†’superscript2ğ‘â„v:2^{N}\\to\\mathbb{R}\nis a value function with vâ€‹(âˆ…)=0ğ‘£0v(\\emptyset)=0. A subset SâŠ†Nğ‘†ğ‘S\\subseteq N is a coalition. If for every possible partition (S1,â€¦,Sr)subscriptğ‘†1â€¦subscriptğ‘†ğ‘Ÿ(S_{1},\\ldots,S_{r}) of Nğ‘N it holds that vâ€‹(N)â‰¥vâ€‹(S1)+â‹¯+vâ€‹(Sr)ğ‘£ğ‘ğ‘£subscriptğ‘†1â‹¯ğ‘£subscriptğ‘†ğ‘Ÿv(N)\\geq v(S_{1})+\\cdots+v(S_{r}), then players will benefit most by forming the grand coalition Nğ‘N. The problem is then how to fairly distribute vâ€‹(N)ğ‘£ğ‘v(N) amongst the players of Nğ‘N. An allocation is a vector xâˆˆâ„Nğ‘¥superscriptâ„ğ‘x\\in\\mathbb{R}^{N} with xâ€‹(N)=vâ€‹(N)ğ‘¥ğ‘ğ‘£ğ‘x(N)=v(N) (we write xâ€‹(S)=âˆ‘pâˆˆSxpğ‘¥ğ‘†subscriptğ‘ğ‘†subscriptğ‘¥ğ‘x(S)=\\sum_{p\\in S}x_{p} for SâŠ†Nğ‘†ğ‘S\\subseteq N).\nA solution concept prescribes a set of fair allocations for a game (N,v)ğ‘ğ‘£(N,v). Here, the notion of fairness depends on context. The solution concepts we consider are the Banzhaf value, Shapley value, nucleolus, benefit value, contribution value (see SectionÂ 4) and the core. They all prescribe a unique allocation except for the core, which consists of all allocations xâˆˆâ„Nğ‘¥superscriptâ„ğ‘x\\in\\mathbb{R}^{N} with xâ€‹(S)â‰¥vâ€‹(S)ğ‘¥ğ‘†ğ‘£ğ‘†x(S)\\geq v(S) for every SâŠ†Nğ‘†ğ‘S\\subseteq N. Core allocations ensure Nğ‘N is stable, as no subset Sğ‘†S will benefit from forming their own coalition. But a core may beÂ empty. We now define some relevant games. For a directed graph G=(V,A)ğºğ‘‰ğ´G=(V,A) and subset SâŠ†Vğ‘†ğ‘‰S\\subseteq V, we let Gâ€‹[S]=(S,{(u,v)âˆˆA|u,vâˆˆS})ğºdelimited-[]ğ‘†ğ‘†conditional-setğ‘¢ğ‘£ğ´ğ‘¢ğ‘£ğ‘†G[S]=(S,\\{(u,v)\\in A\\;|\\;u,v\\in S\\}) be the subgraph of GğºG induced by Sğ‘†S. An â„“â„“\\ell-permutation game on a graphÂ G=(V,E)ğºğ‘‰ğ¸G=(V,E) is the game (N,v)ğ‘ğ‘£(N,v), where N=Vğ‘ğ‘‰N=V and for SâŠ†Nğ‘†ğ‘S\\subseteq N, the valueÂ vâ€‹(S)ğ‘£ğ‘†v(S) is the maximum size of an â„“â„“\\ell-cycle packing ofÂ Gâ€‹[S]ğºdelimited-[]ğ‘†G[S]. Two special cases are well studied. We obtain a matching game if â„“=2â„“2\\ell=2, which may have an empty core (e.g. when GğºG is a triangle) and a permutation game if â„“=âˆâ„“\\ell=\\infty, whose core is always nonemptyÂ . In the remainder, we differentiate between the sets Nğ‘N (of players in the game) and Vğ‘‰V (of vertices in the underlying graph GğºG). That is, we associate each playerÂ iâˆˆNğ‘–ğ‘i\\in N with a distinct subsetÂ Visubscriptğ‘‰ğ‘–V_{i} ofÂ Vğ‘‰V.\nA partitioned â„“â„“\\ell-permutation game on a directed graph G=(V,A)ğºğ‘‰ğ´G=(V,A) with a partition (V1,â€¦,Vn)subscriptğ‘‰1â€¦subscriptğ‘‰ğ‘›(V_{1},\\ldots,V_{n}) of Vğ‘‰V is the game (N,v)ğ‘ğ‘£(N,v), where N={1,â€¦,n}ğ‘1â€¦ğ‘›N=\\{1,\\ldots,n\\}, and for SâŠ†Nğ‘†ğ‘S\\subseteq N, the value vâ€‹(S)ğ‘£ğ‘†v(S) is the maximum size of an â„“â„“\\ell-cycle packing of Gâ€‹[â‹ƒiâˆˆSVi]ğºdelimited-[]subscriptğ‘–ğ‘†subscriptğ‘‰ğ‘–G[\\bigcup_{i\\in S}V_{i}].\nWe obtain a partitioned matching gameÂ [ref]7  if â„“=2â„“2\\ell=2, and a partitioned permutation game if â„“=âˆâ„“\\ell=\\infty. The width of (N,v)ğ‘ğ‘£(N,v) is the width of (V1,â€¦,Vn)subscriptğ‘‰1â€¦subscriptğ‘‰ğ‘›(V_{1},\\ldots,V_{n}), which is c=maxâ¡{|Vi||â€„1â‰¤iâ‰¤n}ğ‘conditionalsubscriptğ‘‰ğ‘–1ğ‘–ğ‘›c=\\max\\{|V_{i}|\\;|\\;1\\leq i\\leq n\\}. See FigureÂ 1 for an example. The Model. For a round of an IKEP with exchange boundÂ â„“â„“\\ell, let (N,v)ğ‘ğ‘£(N,v) be the partitioned â„“â„“\\ell-permutation game defined on the compatibility graph G=(V,A)ğºğ‘‰ğ´G=(V,A), where N={1,â€¦,n}ğ‘1â€¦ğ‘›N=\\{1,\\ldots,n\\} is the set of countries in the IKEP, and Vğ‘‰V is partitioned into subsets V1,â€¦,Vnsubscriptğ‘‰1â€¦subscriptğ‘‰ğ‘›V_{1},\\ldots,V_{n} such that for every pâˆˆNğ‘ğ‘p\\in N, Vpsubscriptğ‘‰ğ‘V_{p} consists of the patient-donor pairs of countryÂ pğ‘p. We say that (N,v)ğ‘ğ‘£(N,v) is the associated game for GğºG.\nWe can now make use of a solution concept ğ’®ğ’®{\\mathcal{S}} for (N,v)ğ‘ğ‘£(N,v) to obtain a fair initial allocationÂ yğ‘¦y, where ypsubscriptğ‘¦ğ‘y_{p} prescribes the initial number of kidney transplants countryÂ pğ‘p should receive in this round (possibly, ypsubscriptğ‘¦ğ‘y_{p} is not an integer, but as we shall see this is not relevant). To ensure IKEP stability, we use the model of Klimentova et al.Â , which is a credit-based system. For round râ‰¥1ğ‘Ÿ1r\\geq 1, let Grsuperscriptğºğ‘ŸG^{r} be the computability graph with associated game (Nr,vr)superscriptğ‘ğ‘Ÿsuperscriptğ‘£ğ‘Ÿ(N^{r},v^{r}); let yrsuperscriptğ‘¦ğ‘Ÿy^{r} be the initial allocation (as prescribed by some solution concept ğ’®ğ’®{\\mathcal{S}}); and let cr:Nrâ†’â„:superscriptğ‘ğ‘Ÿâ†’superscriptğ‘ğ‘Ÿâ„c^{r}:N^{r}\\to\\mathbb{R} be a credit function, which satisfies âˆ‘pâˆˆNrcpr=0\\sum_{p\\in N{{}^{r}}}c^{r}_{p}=0; if r=1ğ‘Ÿ1r=1, we set crâ‰¡0superscriptğ‘ğ‘Ÿ0c^{r}\\equiv 0.\nFor pâˆˆNğ‘ğ‘p\\in N, we set xpr:=ypr+cprassignsubscriptsuperscriptğ‘¥ğ‘Ÿğ‘subscriptsuperscriptğ‘¦ğ‘Ÿğ‘subscriptsuperscriptğ‘ğ‘Ÿğ‘x^{r}_{p}:=y^{r}_{p}+c^{r}_{p} to obtain the target allocation xrsuperscriptğ‘¥ğ‘Ÿx^{r} for roundÂ rğ‘Ÿr (which is indeed an allocation, as yrsuperscriptğ‘¦ğ‘Ÿy^{r} is an allocation and âˆ‘pâˆˆNcpr=0subscriptğ‘ğ‘superscriptsubscriptğ‘ğ‘ğ‘Ÿ0\\sum_{p\\in N}c_{p}^{r}=0). We choose some maximum â„“â„“\\ell-cycle packing ğ’ğ’{\\mathcal{C}} of Grsuperscriptğºğ‘ŸG^{r} as optimal solution for roundÂ rğ‘Ÿr (out of possibly exponentially many optimal solutions).\nLet spâ€‹(ğ’)subscriptğ‘ ğ‘ğ’s_{p}({\\mathcal{C}}) be the number of kidney transplants for patients in countryÂ pğ‘p (with donors both fromÂ pğ‘p and other countries). For pâˆˆNğ‘ğ‘p\\in N, we set cpr+1:=xprâˆ’spâ€‹(ğ’)assignsubscriptsuperscriptğ‘ğ‘Ÿ1ğ‘subscriptsuperscriptğ‘¥ğ‘Ÿğ‘subscriptğ‘ ğ‘ğ’c^{r+1}_{p}:=x^{r}_{p}-s_{p}({\\mathcal{C}}) to get the credit function cr+1superscriptğ‘ğ‘Ÿ1c^{r+1} for round r+1ğ‘Ÿ1r+1 (note that âˆ‘pâˆˆNcpr+1=0subscriptğ‘ğ‘superscriptsubscriptğ‘ğ‘ğ‘Ÿ10\\sum_{p\\in N}c_{p}^{r+1}=0). For roundÂ r+1ğ‘Ÿ1r+1,\na new initial allocationÂ yr+1superscriptğ‘¦ğ‘Ÿ1y^{r+1} is prescribed byÂ ğ’®ğ’®{\\mathcal{S}} for the associated game (Nr+1,vr+1)superscriptğ‘ğ‘Ÿ1superscriptğ‘£ğ‘Ÿ1(N^{r+1},v^{r+1}). For every pâˆˆNğ‘ğ‘p\\in N, we set xpr+1:=ypr+1+cpr+1assignsuperscriptsubscriptğ‘¥ğ‘ğ‘Ÿ1superscriptsubscriptğ‘¦ğ‘ğ‘Ÿ1superscriptsubscriptğ‘ğ‘ğ‘Ÿ1x_{p}^{r+1}:=y_{p}^{r+1}+c_{p}^{r+1}, and we repeat the process. Apart from specifying the solution conceptÂ ğ’®ğ’®{\\mathcal{S}}, we must also determine how to choose in each round a maximum â„“â„“\\ell-cycle packingÂ ğ’ğ’{\\mathcal{C}} (optimal solution) of the corresponding compatibility graphÂ GğºG. We will chooseÂ ğ’ğ’{\\mathcal{C}}, such that the vector sâ€‹(ğ’)ğ‘ ğ’s({\\mathcal{C}}), with entries spâ€‹(ğ’)subscriptğ‘ ğ‘ğ’s_{p}({\\mathcal{C}}), is closest to the target allocationÂ xğ‘¥x for the round under consideration. To explain our distance measures, let |xpâˆ’spâ€‹(ğ’)|subscriptğ‘¥ğ‘subscriptğ‘ ğ‘ğ’|x_{p}-s_{p}({\\mathcal{C}})| be the deviation of countryÂ pğ‘p from its target xpsubscriptğ‘¥ğ‘x_{p} if ğ’ğ’{\\mathcal{C}} is chosen out of all optimalÂ solutions. We order the deviations |xpâˆ’spâ€‹(ğ’)|subscriptğ‘¥ğ‘subscriptğ‘ ğ‘ğ’|x_{p}-s_{p}({\\mathcal{C}})| non-increasingly as a vector dâ€‹(ğ’)=(|xp1âˆ’sp1â€‹(ğ’)|,â€¦,|xpnâˆ’spnâ€‹(ğ’)|)ğ‘‘ğ’subscriptğ‘¥subscriptğ‘1subscriptğ‘ subscriptğ‘1ğ’â€¦subscriptğ‘¥subscriptğ‘ğ‘›subscriptğ‘ subscriptğ‘ğ‘›ğ’d({\\mathcal{C}})=(|x_{p_{1}}-s_{p_{1}}({\\mathcal{C}})|,\\dots,|x_{p_{n}}-s_{p_{n}}({\\mathcal{C}})|).\nWe say ğ’ğ’{\\mathcal{C}} is strongly close toÂ xğ‘¥x if dâ€‹(ğ’)ğ‘‘ğ’d({\\mathcal{C}}) is lexicographically minimal over all optimal solutions. If we only minimize d1â€‹(ğ’)=maxpâˆˆNâ¡{|xpâˆ’spâ€‹(ğ’)|}subscriptğ‘‘1ğ’subscriptğ‘ğ‘subscriptğ‘¥ğ‘subscriptğ‘ ğ‘ğ’d_{1}({\\mathcal{C}})=\\max_{p\\in N}\\{|x_{p}-s_{p}({\\mathcal{C}})|\\} over all optimal solutions, we obtain a weakly close optimal solution. If an optimal solution is strongly close, it is weakly close, but the reverse might not be true. Both measures have been used, see below. Related Work. Benedek et al.Â  proved the following theorem for â„“=2â„“2\\ell=2 (the â€œmatchingâ€ case); in contrast, BirÃ³ et al.Â  showed that it is NP-hard to find a weakly close maximum matching even for |N|=2ğ‘2|N|=2 once the games are defined on edge-weightedÂ graphs. For partitioned matching games, the problem of finding an optimal solution that is strongly close to a given target allocationÂ xğ‘¥x is polynomial-time solvable. Benedek et al.Â  used the algorithm of TheoremÂ 1.2 to perform simulations for up to fifteen countries for â„“=2â„“2\\ell=2. As initial allocations, they used the Shapley value, nucleolus, benefit value and contribution value, with the Shapley value yielding the best results (together with the Banzhaf value in the full versionÂ  ofÂ ).\nThis is in line with the results of Klimentova et al.Â  and BirÃ³ et al.Â 1 for â„“=3â„“3\\ell=3. Due to TheoremÂ 1.1, the simulations inÂ 1  are for up to four countries and use weakly close optimal solutions. For â„“=2â„“2\\ell=2, we refer toÂ  for an alternative model based on so-called selection ratios using lower and upper target numbers. IKEPs have also been modelled as non-cooperative games in the consecutive matching setting, which has 222-phase rounds: national pools in phaseÂ 1 and a merged pool for unmatched patient-donor pairs in phaseÂ 2; seeÂ 9 8  for some results in this setting. Fairness (versus optimality) issues are also studied for national KEPs, in particular in the US, which is different from Europe (our setting). Namely, hospitals in the US are more independent and are given positive credits to register their easy-to-match patient-donor pairs to one of the three national KEPs, and negative credits for registering their hard-to-match pairs. The US setting is extensively studiedÂ    6 7 0, but beyond the scope of our paper. Our Results.\nWe consider partitioned permutation games and IKEPs, so we assume â„“=âˆâ„“\\ell=\\infty. This assumption is not realistic in kidney exchange, but has also been made for national KEPs to obtain general results of theoretical\ninterestÂ [ref]5 4 5 4 and may have wider applications (e.g. in financial clearing).\nWe also aim to research how stability and total number of kidney transplantsÂ are affected when moving from one extreme (â„“=2â„“2\\ell=2) to the other (â„“=âˆâ„“\\ell=\\infty).\nAs such our paper consists of a theoretical and experimental part. We start with our theoretical results (SectionÂ 2).\nPermutation games, i.e. partitioned permutation games of widthÂ 111, have a nonempty coreÂ , and a core allocation can be found in polynomial\ntimeÂ 1.\nWe generalize these two results to partitioned permutation games of any widthÂ cğ‘c, and also show a dichotomy for testing core membership, which is in contrast with the dichotomy for\npartitioned matching games, where the complexity jump happens at c=3ğ‘3c=3Â . The core of every partitioned permutation game is non-empty, and it is possible to find a core allocation in polynomial time.\nMoreover, for partitioned permutation games of fixed widthÂ cğ‘c, the problem of deciding if an allocation is in the core\nis polynomial-time solvable if c=1ğ‘1c=1 and coNP-complete if câ‰¥2ğ‘2c\\geq 2. Due to TheoremÂ 1.1, we cannot hope to generalize TheoremÂ 1.2 to hold for any constant â„“â‰¥3â„“3\\ell\\geq 3. Nevertheless, TheoremÂ 1.1 leaves open the question if TheoremÂ 1.2 is true for â„“=âˆâ„“\\ell=\\infty (the â€œcycle packingâ€ case) instead of only for â„“=2â„“2\\ell=2 (the â€œmatchingâ€ case). We show that the answer to this question is no (assuming ğ–¯â‰ ğ–­ğ–¯ğ–¯ğ–­ğ–¯{\\sf P}\\neq{\\sf NP}). For partitioned permutation games\neven of widthÂ 222,\nthe problem of finding an optimal solution that is weakly or strongly close to a given target allocationÂ xğ‘¥x is NP-hard. Our last theoretical result is a randomized XPÂ algorithm with parameterÂ nğ‘›n. As we shall prove, derandomizing it requires solving the notorious Exact Perfect Matching problem in polynomial time.\nThe complexity status of the latter problem is still open since its introduction by Papadimitriou and YannakakisÂ 2 in 1982. For a partitioned permutation game (N,v)ğ‘ğ‘£(N,v) on a directed graph G=(V,A)ğºğ‘‰ğ´G=(V,A), the problem of finding an optimal solution that is weakly or strongly close to a given target allocationÂ xğ‘¥x can be solved by a randomized algorithm in |A|Oâ€‹(n)superscriptğ´ğ‘‚ğ‘›|A|^{O(n)} time. Our theoretical results which highlighted severe computational limitations, and we now turn to our simulations. These are guided by our theoretical results.\nNamely, we note that the algorithm in TheoremÂ 1.5 is neither practical\nfor instances of realistic size (which we aim for) nor acceptable in the setting of kidney exchange due to being a randomized algorithm.\nTherefore and also due to TheoremÂ 1.4,\nwe formulate the problems of computing a weakly or strongly close optimal solution as integer linear programs, as described in SectionÂ 3. This enables us to use an ILP solver. We still exploit the fact that for â„“=âˆâ„“\\ell=\\infty (TheoremÂ 1.1) we can find optimal solutions and valuesÂ vâ€‹(S)ğ‘£ğ‘†v(S) in polynomial time. In this way we can perform, in SectionÂ 4, simulations for IKEPs up to ten countries, so more than the four countries in the simulations for â„“=3â„“3\\ell=3Â 1 , but less than the fifteen countries in the simulations for â„“=2â„“2\\ell=2Â . For the initial allocations we use two easy-to-compute solution concepts: the benefit value and contribution value, and three hard-to-compute solution concepts: the Banzhaf value, Shapley value, and nucleolus. Our simulations show, just like those forÂ , that a credit system using strongly close optimal solutions makes an IKEP the most balanced\nwithout decreasing the overall number of transplants. The exact improvement is determined by the choice of solution concept. Our simulations indicate that the Banzhaf value yields the best results: on average, a deviation of up to 0.90% from the target allocation.\nMoreover, moving from â„“=2â„“2\\ell=2 to â„“=âˆâ„“\\ell=\\infty yields on average 46% more kidney transplants\n(using the same simulation instances generated by the data generatorÂ 3). However, the exchange cycles may be very large, in particular in the starting round.\n\nReference markers found: [7]\n\nContext windows for each [ref]:\n[ref]7: N, the value vâ€‹(S)ğ‘£ğ‘†v(S) is the maximum size of an â„“â„“\\ell-cycle packing of Gâ€‹[â‹ƒiâˆˆSVi]ğºdelimited-[]subscriptğ‘–ğ‘†subscriptğ‘‰ğ‘–G[\\bigcup_{i\\in S}V_{i}].\nWe obtain a partitioned matching gameÂ [ref]7  if â„“=2â„“2\\ell=2, and a partitioned permutation game if â„“=âˆâ„“\\ell=\\infty. The width of (N,v)ğ‘ğ‘£(N,v) is the width of (V1,â€¦,Vn)subscriptğ‘‰1â€¦subscriptğ‘‰ğ‘›(V_{1},\\ldots,V_{n}), which is\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 7,\n            \"titles\": [\n                \"The Complexity of Matching Games: A Survey\",\n                \"T.: Clearing algorithms for barter exchange markets: enabling nationwide kidney exchanges. Proceedings EC 2007 pp. 295â€“304 (2007)\",\n                \"Clearing algorithms for barter exchange markets: enabling nationwide kidney exchanges\",\n                \"Mix and match: A strategyproof mechanism for multi-hospital kidney exchange\",\n                \"New challenges in multihospital kidney exchange\",\n                \"Free riding and participation in large scale, multi-hospital kidney exchange\",\n                \"Optimal Kidney Exchange with Immunosuppressants\",\n                \"International kidney exchange scheme\",\n                \"Computing balanced solutions for large international kidney exchange schemes\",\n                \"Finding and verifying the nucleolus of cooperative games\",\n                \"Compensation scheme with Shapley value for multi-country kidney exchange programmes\",\n                \"Building kidney exchange programmes in Europe â€“ an overview of exchange practice and activities\",\n                \"Generalized matching games for international kidney exchange\",\n                \"Shapley-scarf housing markets: Respecting improvement, integer programming, and kidney exchange\",\n                \"Maximum weight cycle packing in directed graphs, with application to kidney exchange programs\",\n                \"Opting Into Optimal Matchings\",\n                \"Czech-Austrian kidney paired donation: first european cross-border living donor kidney exchange\",\n                \"A theoretical and computational equilibria analysis of a multi-player kidney exchange program\",\n                \"Nash equilibria in the two-player kidney exchange game\",\n                \"New insights on integer-programming models for the kidney exchange problem\",\n                \"Assignment games and permutation games\",\n                \"New algorithms for hierarchical optimisation in kidney exchange programmes\",\n                \"Improved instance generation for kidney exchange programmes\",\n                \"LEMON - an open source C++ graph template library\",\n                \"Position-indexed formulations for kidney exchange\",\n                \"Planarizing gadgets for perfect matching do not exist\",\n                \"Strategy-proof and efficient kidney exchange using a credit mechanism\",\n                \"On the complexity of comparing evolutionary trees\",\n                \"Spr distance computation for unrooted trees\",\n                \"Weighted voting doesnâ€™t work: A mathematical analysis\",\n                \"Fairness models for multi-agent kidney exchange programmes\",\n                \"The complexity of restricted spanning tree problems\",\n                \"Kidney matching tools data set generator\",\n                \"Kidney exchange\",\n                \"The nucleolus of a characteristic function game\",\n                \"A value for nğ‘›n-person games\",\n                \"Identifying optimal strategies in kidney exchange games is Ïƒ2psubscriptsuperscriptğœğ‘2\\\\sigma^{p}_{2}-complete\",\n                \"Fair pairwise exchange among groups\",\n                \"Permutation games: another class of totally balanced games\",\n                \"Design and analysis of multi-hospital kidney exchange mechanisms using random graphs\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]7 based on the context and research area of Computing Balanced Solutions for Large International Kidney Exchange Schemes When Cycle Length Is Unbounded. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}