{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Learning Inverse Rendering of Faces from Real-world Videos\n\nPaper Abstract: \n\nPaper Section Text:\nInverse rendering aims at estimating the components of an image in its formation process.\nAn image is often decomposed to three components, namely, albedo (reflectance properties), normal (shape attributes), and illumination , , , 4.\nInverse rendering has important applications in image analysis (e.g., scene segmentation and material recognition) and editing (e.g., photo relighting).\n In this paper, we consider inverse rendering of human face images because they belong to the most important class of images in vision and recognition tasks. Promising results have been achieved under constrained scenarios (e.g., on the well designed lighting stages[ref]11[ref]13). However, inverse rendering of in-the-wild face images remains an open problem due to complex variations in human face appearances, illumination conditions, and shadows. Moreover,\nthe lack of ground-truth decomposition components makes this task highly ill-posed.\nTo tackle this problem,\nsome hand-crafted priors (e.g., , ) have been introduced for each component to guide the decomposition. Unfortunately, these priors make strong assumptions on face attributes (e.g., strong shape and reflectance priors for Caucasians) that are tailored for specific tasks. Thus they do not generalize well to in-the-wild face images . Owing to the success of deep learning in many tasks, deep convolutional neural networks (CNNs) have recently been employed to address the problem of inverse rendering. For example,   employed CNNs to deal with this problem by training on synthetic data.\nAfter training on synthetic face image datasets, the network is applied on real face images to obtain different image modeling components.\nHowever, training only on synthetic data does not generalize well to real data since real face images contain much richer facial variations that cannot be captured by synthetic data (e.g., faces wearing glasses and/or makeup, faces with beard, etc).\nIt is thus very desirable to make use of real data for training.\nTo this end,  proposed to train on real face images with pseudo labels.\nHowever, results reported in  are far from satisfactory because the pseudo labels obtained from a network pre-trained on synthetic data cannot model complex variations in real face images. Instead of using static independent real images, images from different viewpoints or video sequences of the same scene have been used to reduce the gap between real and synthetic data for intrinsic decomposition of indoor and/or outdoor scenes (e.g., , 4, 5). Inspired by the above approach, in this work we consider the use of images from real face videos111We do not employ multi-view images because they do not provide additional lighting constraints. to bridge the domain gap because consistency constraints can be derived from different frames of the same person and they provide a stronger error measure in learning than the simple image reconstruction loss.\nOur approach is motivated by the key observation that the albedo and normal maps of two face frames in a same-person video only differ in pose and expression and that consistency of these maps can be derived. Specifically, we transform the components between frames to algin albedo and normal: the transformation of albedo is the displacement of corresponding pixels, while for normal it consists of displacement and change of directions.\nNote that such transformations cannot be achieved by traditional (e.g. optical flow) algorithm due to the texture-less nature of albedo and directional shifts in normal.\nAfter aligning one frame with another, we leverage the consistency constraint between their albedo and normal maps to regularize the decomposition procedure, leading to weakly supervised learning on real face images.\nThis way, the domain gap between real and synthetic face images is drastically reduced. Our experiments corroborates that the alignment (though not perfect) obtained by AlignNeta and AlignNetn can effectively improve the inverse rendering performance on real data. We also note that existing methods do not take into account high frequency details such as shadow and highlights, making the inverse rendering results less realistic.\nInstead of considering the inverse rendering problem as decomposing an image into three components, we treat it as decomposing an image into four components (albedo, normal, illumination, and residual).\nThe advantage of the additional residual map component in our new approach is that it leads to more realistic face images that maintain high frequency details induced by global illumination effects such as shadow and highlights.\nWe propose a learning framework called IlluRes-SfSNet to perform face image decomposition (into albedo, normal, illumination, and residual).\nWe train IlluRes-SfSNet on both real and synthetic data222We create two synthetic datasets (in addition to an existing one) to train our model., benefiting from both, and compute the albedo, normal, illumination components in a similar way to existing works (e.g., the SfSNet ). The residual map is obtained by subtracting the image with global illumination and the one that only contains local illumination.\nWe run extensive experiments to evaluate IlluRes-SfSNet on various benchmarks, obtaining much better results than the state-of-the-art. To summarize, our main contributions are threefold: The conceptual significance of introducing a consistency assumption of albedo and normal of the same person in a video. This consistency assumption led to the idea of weakly supervised training of our neural network model, hence bridging the domain gap between synthetic and real images. Our proposed dual CNN models AlignNeta and AlignNetn as workhorses for learning the alignment between albedo and normal maps of different frames in a same-person face video. After pretraining on synthetic data, they are applied to real data to align the predicted albedo and normal maps, enabling weakly supervised learning on real data. An IlluRes-SfSnet learning framework that seamlessly integrates SfSnet\n and Illumination Residual Net to predict a residual map, in addition to albedo, normal, and illumination, for better inverse rendering results than the state-of-the-art. Our current work opens doors to development of exciting applications such as relighting and albedo editing, for which we show some results in the end of the paper.\n\nReference markers found: [11]\n\nContext windows for each [ref]:\n[ref]11: because they belong to the most important class of images in vision and recognition tasks. Promising results have been achieved under constrained scenarios (e.g., on the well designed lighting stages[ref]11[ref]13). However, inverse rendering of in-the-wild face images remains an open problem due to complex variations in human face appearances, illumination conditions, and shadows. Moreover,\nthe\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 11,\n            \"titles\": [\n                \"Revisiting Deep Intrinsic Image Decompositions\",\n                \"Faceplusplus\",\n                \"Inverse rendering of faces with a 3d morphable model\",\n                \"Intrinsic scene properties from a single rgb-d image\",\n                \"Shape, Illumination, and Reflectance from Shading\",\n                \"Recovering intrinsic scene characteristics\",\n                \"A morphable model for the synthesis of 3d faces\",\n                \"Intrinsic decompositions for image editing\",\n                \"User-assisted intrinsic images\",\n                \"High resolution passive facial performance capture\",\n                \"A simple model for intrinsic image decomposition with depth cues\",\n                \"Acquiring the reflectance field of a human face\",\n                \"Multiview face capture using polarized spherical gradient illumination\",\n                \"DeepSketch2Face: A Deep Learning Based Sketching System for 3D Face and Caricature Modeling\",\n                \"Determining lightness from an image\",\n                \"Mitsuba renderer\",\n                \"3d face reconstruction from a single image using a single reference face shape\",\n                \"Multi-view inverse rendering under arbitrary illumination and albedo\",\n                \"A variational framework for retinex\",\n                \"Intrinsic decomposition of image sequences from local temporal variations\",\n                \"Estimation of 3d faces and illumination from single photographs using a bilineaur illumination model\",\n                \"Estimation of intrinsic image sequences from image+ depth video\",\n                \"DARN: a Deep Adversarial Residual Network for Intrinsic Image Decomposition\",\n                \"Intrinsic face image decomposition with human face priors\",\n                \"Learning Intrinsic Image Decomposition from Watching the World\",\n                \"Large-scale celebfaces attributes (celeba) dataset\",\n                \"Single image intrinsic decomposition without a single intrinsic image\",\n                \"VoxCeleb: a large-scale speaker identification dataset\",\n                \"Direct Intrinsics: Learning Albedo-Shading Decomposition by Convolutional Regression\",\n                \"A 3d face model for pose and illumination invariant face recognition\",\n                \"Recovering intrinsic images with a global sparsity prior on reflectance\",\n                \"Efficient global illumination for morphable models\",\n                \"Unrestricted Facial Geometry Reconstruction Using Image-to-Image Translation\",\n                \"Sfsnet: Learning shape, reflectance and illuminance of facesin the wildâ€™\",\n                \"Intrinsic image decomposition using optimization and user scribbles\",\n                \"The first facial landmark tracking in-the-wild challenge: Benchmark and results\",\n                \"Intrinsic images decomposition using a local and global sparse representation of reflectance\",\n                \"Neural face editing with intrinsic image disentangling\",\n                \"Recovering intrinsic images from a single image\",\n                \"FML: Face Model Learning from Videos\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]11 based on the context and research area of Learning Inverse Rendering of Faces from Real-world Videos. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}