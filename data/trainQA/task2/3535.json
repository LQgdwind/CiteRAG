{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Engineering the Neural Automatic Passenger Counter\n\nPaper Abstract: \n\nPaper Section Text:\nAssessment of passenger counts is of paramount importance for public transport agencies to plan, manage and evaluate their transit service. Over the past three decades, automatic passenger counting (APC) systems have played an increasingly important role in determining the number of passengers in public transport. They are used in the daily monitoring of operations, in long-term demand planning, as well as in revenue sharing within transport associations around the world, which is in the billions annually     by both ticket revenues, and public funds\n and directly affects services of general interest. Systematic over- or undercounts, so-called biases can thus lead to large unfairness and should thus be as small as possible. The VDV 457 is the prevalent standard that defines how APC systems are officially validated  . Modern APC systems are based on depth-sensing cameras mounted above doors in busses, trains, trams, and other vehicles of public transport (see Figure 1). The recorded 3D videos start with a door opening, passengers board and alight, sometimes pushing and carrying objects along like bicycles and baby buggies, and at the end of the video, the door closes again. This sequence of events is called a video of a door opening phase or in the following video for short.  introduce and evaluate the Neural Automated Passenger Counter (NAPC), a deep neural network based on a long short-term memory (LSTM) [ref]9 architecture . It is capable of learning automatic passenger counting tabula rasa from videos and total manual counts of e.g. boarding and alighting passengers at the end of each video. To illustrate this, the information there have been 2 boarding and 3 alighting passengers already is a label to an entire video, timestamps are not required. This property lowers the effort in acquiring the labels drastically over approaches like object detection 0 1 or even segmentation 2. Furthermore, the computational effort of the NAPC is comparably low to the aforementioned approaches. Training can thus be executed on consumer GPUs and inference even on legacy hardware systems, see Section III-E. We tried to improve the original NAPC architecture by changing popular hyperparameters like the learning rate, batch size, LSTM layer count and depth. What can be considered as a success is the introduction of learning rate decay (LRD): before, we have used a selection set to determine a suitable epoch. With LRD, we can pick the last epoch, making the process easier to handle. However, besides LRD, our results stayed inconclusive for months, so there was no improvement. Therefore, we switched our exploration to more fundamental parameters like various random seeds and training data selection. It is known from other fields like operation research 3 and recent findings for neural networks 4 as well that such seemingly minor choices can have even more impact than algorithms or other design decisions. Another challenge was the lack of a suitable metric, so over time, we created a new one with a universal approach: the test success chance. Finally, we did an evaluation on how stationary the NAPC is, determined a limit, and found yet another very universal approach to remove it. We organize the paper as follows: in Section II we introduce the methods we have used. These comprise efficient labeling, LRD, grid search, quantization, ensemble building, and simulative metrics. Then, we present challenges and our results in Section III. Finally draw a conclusion in Section IV.\n\nReference markers found: [9]\n\nContext windows for each [ref]:\n[ref]9: of a door opening phase or in the following video for short.  introduce and evaluate the Neural Automated Passenger Counter (NAPC), a deep neural network based on a long short-term memory (LSTM) [ref]9 architecture . It is capable of learning automatic passenger counting tabula rasa from videos and total manual counts of e.g. boarding and alighting passengers at the end of each video. To\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 9,\n            \"titles\": [\n                \"You Only Look Once: Unified, Real-Time Object Detection\",\n                \"ÖPNV-Bilanz 2018: erneuter Fahrgastrekord im Nahverkehr\",\n                \"ÖPNV-Bilanz 2019: Fahrgastzahlen mit leichtem Plus\",\n                \"Die ÖPNV-Bilanz des Corona-Jahres 2020\",\n                \"Verkehrsverbund Berlin-Brandenburg — Wikipedia, The Free Encyclopedia\",\n                \"Farebox recovery ratio — Wikipedia, The Free Encyclopedia\",\n                \"Validation of automatic passenger counting: introducing the t-test-induced equivalence test\",\n                \"Recommendations for the Appliction of APCSs within Public Transport and Regional Rail Transport, Version 2.1\",\n                \"NAPC: A Neural Algorithm for Automated Passenger Counting in Public Transport on a Privacy-Friendly Dataset\",\n                \"Long short-term memory\",\n                \"YOLOv4: Optimal Speed and Accuracy of Object Detection\",\n                \"Fully Convolutional Networks for Semantic Segmentation\",\n                \"An experimental comparison of periodic timetabling models\",\n                \"Individual differences among deep neural network models\",\n                \"A TOF-based automatic passenger counting approach in public transportation systems\",\n                \"Berlin-APC: A Privacy-Friendly Dataset for Automated Passenger Counting in Public Transport\",\n                \"Monotonicity results for h-discrete fractional operators and application\",\n                \"Fractional difference calculus, in Univalent functions, fractional calculus, and the applications (Koriyama, 1988), 139-152\",\n                \"An ARIMA-model-based approach to seasonal adjustment\",\n                \"Time series analysis: forecasting and control\",\n                \"The effects of quantization on multilayer neural networks\",\n                \"On the efficient representation and execution of deep acoustic models\",\n                \"On the quantization of recurrent neural networks\",\n                \"A Survey of Quantization Methods for Efficient Neural Network Inference\",\n                \"Imagenet classification with deep convolutional neural networks\",\n                \"Ensemble deep learning for regression and time series forecasting\",\n                \"Ensembling neural networks: many could be better than all\",\n                \"Bagging predictors\",\n                \"A decision-theoretic generalization of on-line learning and an application to boosting\",\n                \"Stacked generalization\",\n                \"An ensemble pruning primer\",\n                \"Ensemble Pruning based on Objection Maximization with a General Distributed Framework\",\n                \"Selective ensemble of decision trees\",\n                \"Non-Determinism in TensorFlow ResNets\",\n                \"Deep Residual Learning for Image Recognition\",\n                \"Deep Learning Determinism\",\n                \"Mixed Precision Training\",\n                \"TensorFlow: A system for large-scale machine learning\",\n                \"Array Programming with NumPy\",\n                \"Practical recommendations for gradient-based training of deep architectures\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]9 based on the context and research area of Engineering the Neural Automatic Passenger Counter. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}