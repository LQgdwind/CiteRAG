{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Shoving tubes through shapes gives a sufficient and efficient shape statistic\n\nPaper Abstract: \n\nPaper Section Text:\nIn his Sketch of a program [ref]20, Grothendieck discusses the need for a “tame topology” (“topologie modérée”): the definition of a topological space is so general that it allows for wild behaviour that makes one’s life unnecessarily complicated, if one’s aim is to study properties of geometric shapes invariant up to homeomorphism or homotopy.\nSuch a tame topology is provided by o-minimal structures, of which the ideas are already present in Grothendieck’s program, and which have been formalised by model theorists in the 1980s, to generalise properties of semi-algebraic sets of ℝn\\mathbb{R}^{n}, or subanalytic sets. Semi-algebraic sets are “tame spaces” because they are stable with respect to many desirable operations, such as taking unions, intersections, complements, projections or products. Thus, by taking repeated operations of this type one never encounters “wild” spaces, such as a topologist’s sine curve. Here we give a brief introduction to an o-minimal structure on the field of the reals ℝ\\mathbb{R}, which provides the right setting to compute integrals with respect to the Euler characteristic. In turn, Euler calculus will be a crucial ingredient in the investigation of the injectivity of our PHT\\mathrm{PHT}s. As references for o-minimal structures, we refer to the lecture notes in  and the monograph . A subset A⊂ℝnA\\subset\\mathbb{R}^{n} is called algebraic if it can be defined by a finite number of polynomial equations with coefficients in ℝ\\mathbb{R}: given S={p1,…,pk}⊂ℝ​[x1,…,xn]{S=\\{p_{1},\\dots,p_{k}\\}\\subset\\mathbb{R}[x_{1},\\dots,x_{n}]}, we can express AA as A subset A⊂ℝnA\\subset\\mathbb{R}^{n} is called semialgebraic if it can be expressed as finite unions, intersections and complements of solution sets of polynomial equations or inequalities. An o-minimal structure on the field ℝ\\mathbb{R} is given by a collection of sets {Sn}n∈ℕ≥1\\{S_{n}\\}_{n\\in\\mathbb{N}_{\\geq 1}} such that each SnS_{n} is a subset of the powerset\n𝒫​(ℝn)\\mathcal{P}(\\mathbb{R}^{n}) and furthermore, these sets satisfy the following properties: each SnS_{n} is closed under taking finite unions, intersections and complements. if A∈SnA\\in S_{n} and B∈SmB\\in S_{m} then A×B∈Sn+mA\\times B\\in S_{n+m}. if A∈Sn+1A\\in S_{n+1} and π:ℝn+1→ℝn\\pi\\colon\\mathbb{R}^{n+1}\\to\\mathbb{R}^{n} is the projection onto the first nn coordinates, then π​(A)∈Sn\\pi(A)\\in S_{n}. All algebraic subsets of ℝn\\mathbb{R}^{n} are elements of SnS_{n}. The elements of S1S_{1} are the finite unions of points and intervals. The elements of SnS_{n} are called definable subsets of ℝn\\mathbb{R}^{n}. A definable subset X⊂ℝnX\\subset\\mathbb{R}^{n} is constructible if it is compact.\nWe denote the set of constructible subsets of ℝn\\mathbb{R}^{n} by C​S​(ℝn)CS(\\mathbb{R}^{n}). Consider the semialgebraic subset SS defined by the inequality p​(x1,…,xn)>0p(x_{1},\\dots,x_{n})>0. Then we have that S=π​(A)S=\\pi(A) where A⊂ℝn+1A\\subset\\mathbb{R}^{n+1} is the algebraic set defined by xn+12​p​(x1,…,xn)−1=0x_{n+1}^{2}p(x_{1},\\dots,x_{n})-1=0 and π\\pi is the projection onto the first nn components. Thus, SS is definable, and therefore the same is true of finite unions, intersection, complements of subsets defined by finitely many polynomial equations and inequalities. Given P=𝔸+b∈𝔸​𝔾​(m,n)P=\\mathbb{A}+b\\in\\mathbb{AG}(m,n), its projection affine coordinates are given by (A,b0)∈ℝn×(n+1)(A,b_{0})\\in\\mathbb{R}^{n\\times(n+1)}, where AA is a symmetric idempotent matrix with trace equal to kk (or, equivalently, of rank equal to kk), and\nb0∈ℝnb_{0}\\in\\mathbb{R}^{n} is a vector orthogonal to 𝔸\\mathbb{A} and such that 𝔸+b=𝔸+b0\\mathbb{A}+b=\\mathbb{A}+b_{0}. Thus, there is a bijection see [28, Proposition 5.2] for more details. The set SS on the right-hand-side of Equation 3 is algebraic, since the conditions A2=AA^{2}=A, A=ATA=A^{T}, AT​b=0A^{T}b=0 and tr​(A)=k\\mathrm{tr}(A)=k are all polynomials.\nIn particular, 𝔸​𝔾​(m,n)\\mathbb{AG}(m,n) is definable. Given X⊂ℝnX\\subset\\mathbb{R}^{n}, we say that a function f:X→ℝmf\\colon X\\to\\mathbb{R}^{m} is definable if its graph is a definable subset of ℝn×ℝm\\mathbb{R}^{n}\\times\\mathbb{R}^{m}. Let X⊂ℝnX\\subset\\mathbb{R}^{n} be constructible, P∈𝔸​𝔾​(m,n)P\\in\\mathbb{AG}(m,n), and consider the function encoding the distance from mm-flats P∈𝔸​𝔾​(m,n)P\\in\\mathbb{AG}(m,n).\nGiven r∈ℝr\\in\\mathbb{R}, we consider the sublevel set Xr−​(dP)X^{-}_{r}(\\mathrm{d}_{P}) and express it as the intersection of XX together with the sublevel sets ℝnr−​(dP){\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P}) of the function dP:ℝn→ℝd_{P}\\colon\\mathbb{R}^{n}\\to\\mathbb{R} sending each point in ℝn\\mathbb{R}^{n} to its distance from the flat PP. First, let m=0m=0. Then ℝnr−​(dP){\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P}) is an nn-dimensional closed ball of radius rr centered at PP. Such a ball can be expressed as the solution set of the polynomial inequality ∑i=1n(xi−Pi)2≤r2\\sum_{i=1}^{n}(x_{i}-P_{i})^{2}\\leq r^{2}, and therefore is semialgebraic, compact and in particular constructible. Therefore the intersection Xr−​(dP)=X∩ℝnr−​(dP)X^{-}_{r}(\\mathrm{d}_{P})=X\\cap{\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P}) is constructible. Now let m=1m=1. For simplicity, assume first that PP is the line spanned by the vector e1e_{1}. Then ℝnr−​(dP){\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P}) is given by all points (x1,…,xn)(x_{1},\\dots,x_{n}) within distance rr from some point on the line.\nThus, the sublevel set consists of all points (x1,…,xn)∈ℝn(x_{1},\\dots,x_{n})\\in\\mathbb{R}^{n} such that x22+⋯+xn2≤r2x_{2}^{2}+\\dots+x_{n}^{2}\\leq r^{2}. Hence ℝnr−​(dP){\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P}) can be identified with the product P×BP\\times B where B={(0,x2,…,xn)∣x22+⋯+xn2≤r2}B=\\{(0,x_{2},\\dots,x_{n})\\mid x_{2}^{2}+\\dots+x_{n}^{2}\\leq r^{2}\\} is a ball of dimension n−1n-1. Thus, since PP is algebraic and BB is semialgebraic, P×BP\\times B is semialgebraic, and thus in particular definable. Therefore the intersection ℝnr−​(dP)=X∩(P×B){\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P})=X\\cap(P\\times B) is definable. A similar argument shows that for arbitrary line P∈𝔸​𝔾​(1,n)P\\in\\mathbb{AG}(1,n) the sublevel set ℝnr−​(dP){\\mathbb{R}^{n}}^{-}_{r}(\\mathrm{d}_{P}) can be expressed as X∩(P×B)X\\cap(P\\times B) where BB is an (n−1)(n-1)-dimensional closed ball. A similar argument allows to deduce the following characterisation for arbitrary m<nm<n. We have that where BrB_{r} is a closed (n−m)(n-m)-dimensional ball of radius rr. In particular, the graph of dPd_{P} can be written as where SrS_{r} is a sphere of radius rr and dimension n−mn-m. Since XX is compact, there exists rMr_{M} such that X⊂BrMX\\subset B_{r_{M}}. Thus, we can rewrite the graph as Furthermore, since the homeomorphism type of the (sub)level sets changes only finitely many times (see Lemma 4.12), one may identify the graph with the finite union for r0<⋯<rk∈[0,rM]r_{0}<\\dots<r_{k}\\in[0,r_{M}].\nThus dPd_{P} is definable.\nWe note that the description of the sublevel sets given here is suggestive of another interpretation of such sublevel sets as “discal” filtrations. One of the main tools in the study of definable sets is the fact that every definable set has a finite partition into definable subsets CiC_{i}, each homeomorphic to an open box (i.e., a cartesian product of open intervals), see [10, Theorem 2.10]. Such a partition is called “cylindrical definable cell decomposition”, and the sets CiC_{i} are called “cells”. For instance, a cylindral definable cell decomposition of ℝ\\mathbb{R} is given by a choice of finitely many points a1<⋯<aka_{1}<\\dots<a_{k}. The cells are the singletons {ai}\\{a_{i}\\} together with the open intervals delimited by these points. If additionally we assume that the definable subset is compact, we have the more common description via a triangulation: any constructible set has a finite triangulation. More precisely, one has the following: [10, Theorem 4.4], [14, Chapter 8]\nLet X⊂ℝnX\\subset\\mathbb{R}^{n} be constructible. Let C1,…,CkC_{1},\\dots,C_{k} be definable subsets of XX.\nThere exists a finite simplicial complex KK and a definable homeomorphism ϕ:|K|→X\\phi\\colon|K|\\to X such that each CiC_{i} can be written as ∪j=1ℓϕ​(σj)\\cup_{j=1}^{\\ell}\\phi(\\sigma_{j}) where σj\\sigma_{j} are open simplices of KK.\n\nReference markers found: [20]\n\nContext windows for each [ref]:\n[ref]20: In his Sketch of a program [ref]20, Grothendieck discusses the need for a “tame topology” (“topologie modérée”): the definition of a topological space is so general that it allows for wild behaviour that makes one’s life\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 20,\n            \"titles\": [\n                \"Persistence Diagram Bundles: A Multidimensional Generalization of Vineyards\",\n                \"Apple maps\",\n                \"Lectures on nn-categories and cohomology\",\n                \"Numerical methods for computing angles between linear subspaces\",\n                \"On the cohomology of real grassmann manifolds\",\n                \"Persistence stability for geometric complexes\",\n                \"Stability of persistence diagrams\",\n                \"Lipschitz functions have l p-stable persistence\",\n                \"Lipschitz functions have lpl_{p}-stable persistence\",\n                \"Vines and vineyards by updating persistence in linear time\",\n                \"An Introductionto O-minimal Geometry\",\n                \"Euler calculus with applications to signals and sensing\",\n                \"How many directions determine a shape and other sufficiency results for two topological transforms\",\n                \"Simplification of complexes for persistent homology computations\",\n                \"Tame Topology and O-minimal Structures\",\n                \"Persistent homology-a survey\",\n                \"Computational topology: An introduction\",\n                \"Persistent homology and Euler integral transforms\",\n                \"Elementary applied topology, volume 1\",\n                \"Google maps\",\n                \"Esquisse d’un programme\",\n                \"On the invertibility of euler integral transforms with hyperplanes and quadric hypersurfaces, 2023\",\n                \"Essai sur la géométrie à nn dimensions\",\n                \"Tropical coordinates on the space of persistence barcodes\",\n                \"A topological representation of branching neuronal morphologies\",\n                \"Time-optimal persistent homology representatives for univariate time series, 2024\",\n                \"Shape classification using local and global features\",\n                \"The grassmannian of affine subspaces\",\n                \"Euler measure as generalized cardinality\",\n                \"Über die Bestimmung von Funktionen durch ihre Integralwerte längs gewisser Mannigfaltigkeiten\",\n                \"Radon transforms on affine grassmannians\",\n                \"Tomography of constructible functions\",\n                \"Kalkül der abzählenden Geometrie\",\n                \"Wasserstein stability for persistence diagrams\",\n                \"On the Effectiveness of Persistent Homology\",\n                \"Persistent homology transform for modeling shapes and surfaces\",\n                \"The extended persistent homology transform of manifolds with boundary\",\n                \"Efficient computation of persistent homology for cubical data\",\n                \"Das asymptotische verteilungsgesetz der eigenwerte linearer partieller differentialgleichungen (mit einer anwendung auf die theorie der hohlraumstrahlung)\",\n                \"Schubert varieties and distances between subspaces of different dimensions\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]20 based on the context and research area of Shoving tubes through shapes gives a sufficient and efficient shape statistic. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}