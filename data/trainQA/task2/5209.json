{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Relative Timing Information and Orthology in Evolutionary Scenarios\n\nPaper Abstract: \n\nPaper Section Text:\nIn , we derived an algorithmic approach that recognizes\nLDT graphs and constructs a relaxed scenario ğ’®ğ’®\\mathscr{S} for (G<,Ïƒ)subscriptğºğœ(G_{{}_{<}},\\sigma) in\nthe positive case. Here, we adapt the algorithmic idea to the case that,\ninstead of (G<,Ïƒ)subscriptğºğœ(G_{{}_{<}},\\sigma), the graph 3-partition\nğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) is given, see\nAlgorithmÂ 1, which is illustrated in\nFigureÂ 9. As we shall see, the additional\ninformation can be leveraged to separate the construction of Sğ‘†S and Tğ‘‡T in\nsuch a way that a suitable species tree can be computed first using a\nwell-known approach. This then considerably simplifies the construction of\na corresponding gene tree Tğ‘‡T. More precisely, we construct the gene tree\nand its reconciliation with Sğ‘†S in a top-down fashion via a recursive\ndecomposition of Lğ¿L into subsets that is guided by ğ’¢ğ’¢\\mathscr{G} and Sğ‘†S. We\nfirst introduce three auxiliary graphs that we will use for this purpose. Let ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) be a graph 333-partition on vertex\nset Lğ¿L with coloring Ïƒ:Lâ†’M:ğœâ†’ğ¿ğ‘€\\sigma\\colon L\\to M and Sğ‘†S be a tree on Mğ‘€M.\nFor Lâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L and uâˆˆV0â€‹(S)ğ‘¢superscriptğ‘‰0ğ‘†u\\in V^{0}(S) such that\nÏƒâ€‹(Lâ€²)âŠ†Lâ€‹(Sâ€‹(u))ğœsuperscriptğ¿â€²ğ¿ğ‘†ğ‘¢\\sigma(L^{\\prime})\\subseteq L(S(u)), we define the auxiliary graphs on Lâ€²superscriptğ¿â€²L^{\\prime}: By construction, H2subscriptğ»2H_{2} is a subgraph of H1subscriptğ»1H_{1}. In particular, therefore,\nevery connected component of H2subscriptğ»2H_{2} is entirely included in some connected\ncomponent of H1subscriptğ»1H_{1}. In turn, one easily verifies that the connected\ncomponents of H3subscriptğ»3H_{3} are complete graphs. Moreover, H3subscriptğ»3H_{3} contains all edges\nof H2âˆ©G=subscriptğ»2subscriptğºH_{2}\\cap G_{{}_{=}} while there might be edges of G<â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{<}}[L^{\\prime}] that are not\ncontained in H3subscriptğ»3H_{3}. This implies that every connected\ncomponent of H3subscriptğ»3H_{3} is entirely included in some connected\ncomponent of H2subscriptğ»2H_{2}. We use the inclusion relation of the connected components to construct the\nlocal topology of Tğ‘‡T in a recursive manner, see\nFigureÂ 10 for an illustration of the following\ndescription. In each step, i.e., for some Lâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L and uSâˆˆVâ€‹(S)subscriptğ‘¢ğ‘†ğ‘‰ğ‘†u_{S}\\in V(S), we first construct a â€œlocal rootâ€ Ïâ€²superscriptğœŒâ€²\\rho^{\\prime}\n(cf.Â AlgorithmÂ 1, LineÂ 6). If\nuSsubscriptğ‘¢ğ‘†u_{S} is a leaf of Sğ‘†S (the base case of the recursion), we directly attach\nthe elements of Lâ€²superscriptğ¿â€²L^{\\prime} as children of Ïâ€²superscriptğœŒâ€²\\rho^{\\prime}\n(LinesÂ 8-11). On the other\nhand, if uSsubscriptğ‘¢ğ‘†u_{S} is an inner vertex, we create a new child of Ïâ€²superscriptğœŒâ€²\\rho^{\\prime} for\neach connected component of H1subscriptğ»1H_{1} in Line 15. For a\nspecific connected component Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1} (corresponding to child uisubscriptğ‘¢ğ‘–u_{i}\nof Ïâ€²superscriptğœŒâ€²\\rho^{\\prime}), we then add a new child vjsubscriptğ‘£ğ‘—v_{j} of uisubscriptğ‘¢ğ‘–u_{i} for each connected\ncomponent Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2} such that CjâŠ†Cisubscriptğ¶ğ‘—subscriptğ¶ğ‘–C_{j}\\subseteq C_{i} in Line\n18. We proceed similarly for the connected components\nCksubscriptğ¶ğ‘˜C_{k} of H3subscriptğ»3H_{3}, which necessarily are subsets of a specific connected\ncomponent Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2}. The vertex corresponding to Cksubscriptğ¶ğ‘˜C_{k} is the â€œlocal\nrootâ€ created in a recursive call operating on Cksubscriptğ¶ğ‘˜C_{k} as new subset of Lğ¿L\nand vSâˆˆchildSâ¡(uS)subscriptğ‘£ğ‘†subscriptchildğ‘†subscriptğ‘¢ğ‘†v_{S}\\in\\operatorname{child}_{S}(u_{S}) as new vertex of Sğ‘†S, which is chosen such that\nÏƒâ€‹(Ck)âŠ†Lâ€‹(Sâ€‹(uS))ğœsubscriptğ¶ğ‘˜ğ¿ğ‘†subscriptğ‘¢ğ‘†\\sigma(C_{k})\\subseteq L(S(u_{S})) in Line\n22. If Cj=Cisubscriptğ¶ğ‘—subscriptğ¶ğ‘–C_{j}=C_{i} or Ck=Cjsubscriptğ¶ğ‘˜subscriptğ¶ğ‘—C_{k}=C_{j}, then the\ncorresponding vertices visubscriptğ‘£ğ‘–v_{i} and vjsubscriptğ‘£ğ‘—v_{j}, respectively, have a single child.\nAs a consequence, the resulting tree Tâ€²superscriptğ‘‡â€²T^{\\prime} is in general not\nphylogenetic. The final gene tree Tğ‘‡T is then obtained by suppressing all\nvertices with a single child (Line 26). By definition, two vertices xğ‘¥x and yğ‘¦y are in the same connected component\nCksubscriptğ¶ğ‘˜C_{k} of the auxiliary graph H3subscriptğ»3H_{3} only if Ïƒâ€‹(x)ğœğ‘¥\\sigma(x) and Ïƒâ€‹(y)ğœğ‘¦\\sigma(y) are\ndescendants of the same child vSsubscriptğ‘£ğ‘†v_{S} of the species tree vertex uSsubscriptğ‘¢ğ‘†u_{S}. In\nparticular, we therefore can always find vSâˆˆchildSâ¡(uS)subscriptğ‘£ğ‘†subscriptchildğ‘†subscriptğ‘¢ğ‘†v_{S}\\in\\operatorname{child}_{S}(u_{S}) such that\nÏƒâ€‹(Ck)âŠ†Lâ€‹(Sâ€‹(vS))ğœsubscriptğ¶ğ‘˜ğ¿ğ‘†subscriptğ‘£ğ‘†\\sigma(C_{k})\\subseteq L(S(v_{S})) in LineÂ 22 of\nAlgorithmÂ 1. This guarantees that all colors appearing on\nthe vertices in Lâ€²superscriptğ¿â€²L^{\\prime} are descendants of the species tree vertex uSsubscriptğ‘¢ğ‘†u_{S} in\neach recursion step: In every recursion step of AlgorithmÂ 1, it holds\nÏƒâ€‹(Lâ€²)âŠ†Lâ€‹(Sâ€‹(us))ğœsuperscriptğ¿â€²ğ¿ğ‘†subscriptğ‘¢ğ‘ \\sigma(L^{\\prime})\\subseteq L(S(u_{s})). In particular, the auxiliary graphs\nH1subscriptğ»1H_{1}, H2subscriptğ»2H_{2}, and H3subscriptğ»3H_{3} are always well-defined. The recursion in AlgorithmÂ 1 can be thought of as a\ntree with the root being the top-level call of BuildGeneTree on\nLğ¿L and ÏSsubscriptğœŒğ‘†\\rho_{S} and leaves being the calls in which uSsubscriptğ‘¢ğ‘†u_{S} is a leaf of\nSğ‘†S. Note that, for some recursion steps Rğ‘…R on Lâ€²superscriptğ¿â€²L^{\\prime} and uSsubscriptğ‘¢ğ‘†u_{S}, all of its\nâ€œdescendant recursion stepsâ€ have input Lâ€²â€²superscriptğ¿â€²â€²L^{\\prime\\prime} and uSâ€²subscriptsuperscriptğ‘¢â€²ğ‘†u^{\\prime}_{S} satisfying\nLâ€²â€²âŠ†Lâ€²superscriptğ¿â€²â€²superscriptğ¿â€²L^{\\prime\\prime}\\subseteq L^{\\prime} and uSâ€²â‰ºSuSsubscriptprecedesğ‘†subscriptsuperscriptğ‘¢â€²ğ‘†subscriptğ‘¢ğ‘†u^{\\prime}_{S}\\prec_{S}u_{S}. Therefore, and because all\nleaves that are descendants of Ïâ€²superscriptğœŒâ€²\\rho^{\\prime} (created in Râ€²superscriptğ‘…â€²R^{\\prime}) must have been\nattached in some descendant recursion step of Rğ‘…R, we have\nLâ€‹(Tâ€²â€‹(Ïâ€²))âŠ†Lâ€²ğ¿superscriptğ‘‡â€²superscriptğœŒâ€²superscriptğ¿â€²L(T^{\\prime}(\\rho^{\\prime}))\\subseteq L^{\\prime}. In turn, all elements xâˆˆLâ€²ğ‘¥superscriptğ¿â€²x\\in L^{\\prime} are either\ndirectly attached to Ïâ€²superscriptğœŒâ€²\\rho^{\\prime} if uSsubscriptğ‘¢ğ‘†u_{S} is a leaf, or will eventually be\npassed down to a recursion step on a leaf lâ‰ºSuSsubscriptprecedesğ‘†ğ‘™subscriptğ‘¢ğ‘†l\\prec_{S}u_{S} because each\nxâˆˆLâ€²ğ‘¥superscriptğ¿â€²x\\in L^{\\prime} is in some connected component Cksubscriptğ¶ğ‘˜C_{k} of H3subscriptğ»3H_{3}, Cksubscriptğ¶ğ‘˜C_{k} is entirely\nincluded in a connected component Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2}, and Cjsubscriptğ¶ğ‘—C_{j} is entirely\nincluded in a connected component Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1}. In this â€œleaf recursion\nstepâ€, xğ‘¥x is therefore attached to some descendant of Ïâ€²superscriptğœŒâ€²\\rho^{\\prime}, implying\nLâ€²âŠ†Lâ€‹(Tâ€²â€‹(Ïâ€²))superscriptğ¿â€²ğ¿superscriptğ‘‡â€²superscriptğœŒâ€²L^{\\prime}\\subseteq L(T^{\\prime}(\\rho^{\\prime})). Therefore, we have Lâ€²=Lâ€‹(Tâ€²â€‹(Ïâ€²))superscriptğ¿â€²ğ¿superscriptğ‘‡â€²superscriptğœŒâ€²L^{\\prime}=L(T^{\\prime}(\\rho^{\\prime})). We can\napply very similar arguments to see that Lâ€‹(Tâ€²â€‹(ui))=Ciğ¿superscriptğ‘‡â€²subscriptğ‘¢ğ‘–subscriptğ¶ğ‘–L(T^{\\prime}(u_{i}))=C_{i} and\nLâ€‹(Tâ€²â€‹(vj))=Cjğ¿superscriptğ‘‡â€²subscriptğ‘£ğ‘—subscriptğ¶ğ‘—L(T^{\\prime}(v_{j}))=C_{j} hold for each connected component Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1} and Cjsubscriptğ¶ğ‘—C_{j}\nof H2subscriptğ»2H_{2} with corresponding vertices uisubscriptğ‘¢ğ‘–u_{i} and vjsubscriptğ‘£ğ‘—v_{j} created in\nLinesÂ 15 andÂ 18, respectively.\nClearly, contraction of the redundant vertices to obtain the final tree Tğ‘‡T\ndoes not change these relationship. We summarize these considerations as\nfollows: Let Tğ‘‡T be a tree returned by AlgorithmÂ 1 and uâˆˆV0â€‹(T)ğ‘¢superscriptğ‘‰0ğ‘‡u\\in V^{0}(T) be an inner vertex created in a recursion step on Lâ€²superscriptğ¿â€²L^{\\prime} and uSsubscriptğ‘¢ğ‘†u_{S}. If uğ‘¢u is a vertex Ïâ€²superscriptğœŒâ€²\\rho^{\\prime} created in LineÂ 6,\nthen Lâ€‹(Tâ€‹(u))=Lâ€²ğ¿ğ‘‡ğ‘¢superscriptğ¿â€²L(T(u))=L^{\\prime}. If uğ‘¢u is a vertex uisubscriptğ‘¢ğ‘–u_{i} created in LineÂ 15,\nthen Lâ€‹(Tâ€‹(u))=Ciğ¿ğ‘‡ğ‘¢subscriptğ¶ğ‘–L(T(u))=C_{i} where Cisubscriptğ¶ğ‘–C_{i} is the connected component of H1subscriptğ»1H_{1}\ncorresponding to uisubscriptğ‘¢ğ‘–u_{i}. If uğ‘¢u is a vertex vjsubscriptğ‘£ğ‘—v_{j} created in LineÂ 18,\nthen Lâ€‹(Tâ€‹(u))=Cjğ¿ğ‘‡ğ‘¢subscriptğ¶ğ‘—L(T(u))=C_{j} where Cjsubscriptğ¶ğ‘—C_{j} is the connected component of H2subscriptğ»2H_{2}\ncorresponding to vjsubscriptğ‘£ğ‘—v_{j}. In particular, every xâˆˆLâ€‹(Tâ€‹(u))ğ‘¥ğ¿ğ‘‡ğ‘¢x\\in L(T(u)) satisfies xâˆˆLâ€²ğ‘¥superscriptğ¿â€²x\\in L^{\\prime}. AlgorithmÂ 1 is a generalization of the\nalgorithm presented in  for the construction of a\nrelaxed scenario ğ’®ğ’®\\mathscr{S} for a given LDT graph (G,Ïƒ)ğºğœ(G,\\sigma). A key property\nof the algorithm is that the restriction of ğ’®ğ’®\\mathscr{S} to Sâ€‹(uS)ğ‘†subscriptğ‘¢ğ‘†S(u_{S}), i.e., the\nincomplete scenarios obtained for given uSsubscriptğ‘¢ğ‘†u_{S} satisfies the time\nconsistency constraints (S2) and (S3). The construction of ğ’®ğ’®\\mathscr{S}\nin AlgorithmÂ 1 differs from the procedure described in\n only by including in Vâ€‹(T)âˆ–(Lâ€‹(T)âˆª{0T})ğ‘‰ğ‘‡ğ¿ğ‘‡subscript0ğ‘‡V(T)\\setminus(L(T)\\cup\\{0_{T}\\}) the additional vertices uisubscriptğ‘¢ğ‘–u_{i} created in\nLineÂ 15. These satisfy Î¼â€‹(ui)=uSğœ‡subscriptğ‘¢ğ‘–subscriptğ‘¢ğ‘†\\mu(u_{i})=u_{S}. In the following\nline, we set Ï„Tâ€‹(ui)â†Ï„Sâ€‹(uS)â†subscriptğœğ‘‡subscriptğ‘¢ğ‘–subscriptğœğ‘†subscriptğ‘¢ğ‘†\\tau_{T}(u_{i})\\leftarrow\\tau_{S}(u_{S}). Hence, constraint (S2)\nremains satisfied and (S3) is void because Î¼â€‹(ui)âˆˆVâ€‹(S)ğœ‡subscriptğ‘¢ğ‘–ğ‘‰ğ‘†\\mu(u_{i})\\in V(S). One\neasily checks, furthermore, that the reconciliation map Î¼ğœ‡\\mu constructed\nin AlgorithmÂ 1 satisfies (S0)\n(LineÂ 27) and (S1)\n(LineÂ 11). ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) is a valid input for\nAlgorithmÂ 1 if (G<,G=,G>,Ïƒ)subscriptğºsubscriptğºsubscriptğºğœ(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) is a\n3-partition, G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}} are properly colored, G<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are\ncographs, and (â„›Sâ€‹(ğ’¢),â„±Sâ€‹(ğ’¢))subscriptâ„›ğ‘†ğ’¢subscriptâ„±ğ‘†ğ’¢(\\mathscr{R}_{S}(\\mathscr{G}),\\mathscr{F}_{S}(\\mathscr{G})) is consistent. Given a valid input ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) with vertex set\nLğ¿L, AlgorithmÂ 1 returns a relaxed scenario\nğ’®=(T,S,Ïƒ,Î¼,Ï„T,Ï„S)ğ’®ğ‘‡ğ‘†ğœğœ‡subscriptğœğ‘‡subscriptğœğ‘†\\mathscr{S}=(T,S,\\sigma,\\mu,\\tau_{T},\\tau_{S}) such that Lâ€‹(T)=Lğ¿ğ‘‡ğ¿L(T)=L. In order to keep this contribution self-contained, a detailed proof\nof LemmaÂ 23, which largely parallels the material in\n, is given in AppendixÂ Proof of LemmaÂ 23.\nâˆ We continue with a number of intermediate results that we will need to\nestablish the correctness of AlgorithmÂ 1. Let ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) with vertex set Lğ¿L be a valid input\nfor AlgorithmÂ 1. Consider a recursion step on\nLâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L and uSâˆˆV0â€‹(S)subscriptğ‘¢ğ‘†superscriptğ‘‰0ğ‘†u_{S}\\in V^{0}(S) of\nAlgorithmÂ 1. Then there are no x,yâˆˆLâ€²ğ‘¥ğ‘¦superscriptğ¿â€²x,y\\in L^{\\prime} in the\nsame connected component of H1subscriptğ»1H_{1} such that xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}) and\nlcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))=uSsubscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))=u_{S}. Assume for contradiction that, for some Lâ€²superscriptğ¿â€²L^{\\prime} and uSâˆˆV0â€‹(S)subscriptğ‘¢ğ‘†superscriptğ‘‰0ğ‘†u_{S}\\in V^{0}(S)\nappearing in the recursion, there is a connected component Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1}\nwith vertices x,yâˆˆCiğ‘¥ğ‘¦subscriptğ¶ğ‘–x,y\\in C_{i} and colors Xâ‰”Ïƒâ€‹(x)â‰”ğ‘‹ğœğ‘¥X\\coloneqq\\sigma(x) and\nYâ‰”Ïƒâ€‹(y)â‰”ğ‘Œğœğ‘¦Y\\coloneqq\\sigma(y) such that xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}) and lcaSâ¡(X,Y)=uSsubscriptlcağ‘†ğ‘‹ğ‘Œsubscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(X,Y)=u_{S}. By\nassumption, uSsubscriptğ‘¢ğ‘†u_{S} is an interior vertex and thus Xâ‰ Yğ‘‹ğ‘ŒX\\neq Y. Since the\ninput G>subscriptğºG_{{}_{>}} is a cograph, the induced subgraph G>â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{>}}[L^{\\prime}] and its\ncomplement, which by construction equals H1=G<â€‹[Lâ€²]âˆªG=â€‹[Lâ€²]subscriptğ»1subscriptğºdelimited-[]superscriptğ¿â€²subscriptğºdelimited-[]superscriptğ¿â€²H_{1}=G_{{}_{<}}[L^{\\prime}]\\cup G_{{}_{=}}[L^{\\prime}], are\nalso cographs (cf.Â Prop.Â 1). Consider a shortest path Pğ‘ƒP in H1subscriptğ»1H_{1} connecting xğ‘¥x and yğ‘¦y, which\nexists since x,yâˆˆCiğ‘¥ğ‘¦subscriptğ¶ğ‘–x,y\\in C_{i}. Since G>â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{>}}[L^{\\prime}] and H1subscriptğ»1H_{1} are edge-disjoint\nand xâ€‹yâˆˆEâ€‹(G>â€‹[Lâ€²])ğ‘¥ğ‘¦ğ¸subscriptğºdelimited-[]superscriptğ¿â€²xy\\in E(G_{{}_{>}}[L^{\\prime}]), Pğ‘ƒP contains at least 333 vertices. Since H1subscriptğ»1H_{1}\nis a cograph and thus does not contain induced P4subscriptğ‘ƒ4P_{4}s, Pğ‘ƒP contains at\nmost 333 vertices. Hence, Pğ‘ƒP is of the form xâˆ’zâˆ’yğ‘¥ğ‘§ğ‘¦x-z-y and we have xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}) and xâ€‹z,yâ€‹zâˆ‰Eâ€‹(G>)ğ‘¥ğ‘§ğ‘¦ğ‘§ğ¸subscriptğºxz,yz\\notin E(G_{{}_{>}}). Therefore, and since G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}}\nare properly colored, we have Zâ‰”Ïƒâ€‹(z)âˆ‰{X,Y}â‰”ğ‘ğœğ‘§ğ‘‹ğ‘ŒZ\\coloneqq\\sigma(z)\\notin\\{X,Y\\}, and\nthus X,Y,Zğ‘‹ğ‘Œğ‘X,Y,Z are pairwise distinct colors. By Prop.Â 2,\nXâ€‹Y|Zâˆˆâ„›Sâ€‹(ğ’¢)conditionalğ‘‹ğ‘Œğ‘subscriptâ„›ğ‘†ğ’¢XY|Z\\in\\mathscr{R}_{S}(\\mathscr{G}). Taken together, the latter arguments and the\nconstruction of Sğ‘†S in LineÂ 1 imply that Sğ‘†S displays the\ninformative triple Xâ€‹Y|Zconditionalğ‘‹ğ‘Œğ‘XY|Z. Since x,y,zâˆˆLâ€²ğ‘¥ğ‘¦ğ‘§superscriptğ¿â€²x,y,z\\in L^{\\prime}, we have X,Y,ZâˆˆLâ€‹(Sâ€‹(us))ğ‘‹ğ‘Œğ‘ğ¿ğ‘†subscriptğ‘¢ğ‘ X,Y,Z\\in L(S(u_{s})) by Obs.Â 2. In particular, therefore,\nZâª¯SuSsubscriptprecedes-or-equalsğ‘†ğ‘subscriptğ‘¢ğ‘†Z\\preceq_{S}u_{S}. Thus Xâ€‹Y|Zconditionalğ‘‹ğ‘Œğ‘XY|Z implies that lcaSâ¡(X,Y)â‰ºSuSsubscriptprecedesğ‘†subscriptlcağ‘†ğ‘‹ğ‘Œsubscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(X,Y)\\prec_{S}u_{S}; a\ncontradiction.\nâˆ Let ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) with vertex set Lğ¿L be a valid input\nfor AlgorithmÂ 1. Consider a recursion step on\nLâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L and uSâˆˆV0â€‹(S)subscriptğ‘¢ğ‘†superscriptğ‘‰0ğ‘†u_{S}\\in V^{0}(S) of\nAlgorithmÂ 1. Then, for all x,yâˆˆLâ€²ğ‘¥ğ‘¦superscriptğ¿â€²x,y\\in L^{\\prime} that are\ncontained in the same connected component of H2subscriptğ»2H_{2} but in distinct\nconnected components of H3subscriptğ»3H_{3}, it holds xâ€‹yâˆˆEâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{<}}). Suppose that, for some Lâ€²superscriptğ¿â€²L^{\\prime} and uSâˆˆV0â€‹(S)subscriptğ‘¢ğ‘†superscriptğ‘‰0ğ‘†u_{S}\\in V^{0}(S) appearing in the\nrecursion, there is a connected component Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2} with x,yâˆˆCjğ‘¥ğ‘¦subscriptğ¶ğ‘—x,y\\in C_{j} such that xğ‘¥x and yğ‘¦y are in distinct connected components of H3subscriptğ»3H_{3}.\nIn addition, suppose for contradiction that xâ€‹yâˆ‰Eâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\notin E(G_{{}_{<}}). We may\nassume w.l.o.g.Â that xğ‘¥x and yğ‘¦y have minimal distance in H2subscriptğ»2H_{2}, i.e.,\nthere are no vertices xâ€²,yâ€²âˆˆCjsuperscriptğ‘¥â€²superscriptğ‘¦â€²subscriptğ¶ğ‘—x^{\\prime},y^{\\prime}\\in C_{j} such that xâ€²superscriptğ‘¥â€²x^{\\prime} and yâ€²superscriptğ‘¦â€²y^{\\prime} are in\ndistinct connected components of H3subscriptğ»3H_{3}, xâ€²â€‹yâ€²âˆ‰Eâ€‹(G<)superscriptğ‘¥â€²superscriptğ‘¦â€²ğ¸subscriptğºx^{\\prime}y^{\\prime}\\notin E(G_{{}_{<}}), and in\naddition the distance of xâ€²superscriptğ‘¥â€²x^{\\prime} and yâ€²superscriptğ‘¦â€²y^{\\prime} in H2subscriptğ»2H_{2} is smaller than that of\nxğ‘¥x and yğ‘¦y. Set Xâ‰”Ïƒâ€‹(x)â‰”ğ‘‹ğœğ‘¥X\\coloneqq\\sigma(x) and Yâ‰”Ïƒâ€‹(y)â‰”ğ‘Œğœğ‘¦Y\\coloneqq\\sigma(y) and\nlet Cxsubscriptğ¶ğ‘¥C_{x} and Cysubscriptğ¶ğ‘¦C_{y} be the connected components of H3subscriptğ»3H_{3} that contain xğ‘¥x\nand yğ‘¦y, respectively. By Obs.Â 2, we have\nÏƒâ€‹(Lâ€²)âŠ†Lâ€‹(Sâ€‹(uS))ğœsuperscriptğ¿â€²ğ¿ğ‘†subscriptğ‘¢ğ‘†\\sigma(L^{\\prime})\\subseteq L(S(u_{S})). This and the fact that xğ‘¥x and yğ‘¦y are\nin distinct connected components of H3subscriptğ»3H_{3} but in the same connected\ncomponent Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2} implies that Xâª¯SvXsubscriptprecedes-or-equalsğ‘†ğ‘‹subscriptğ‘£ğ‘‹X\\preceq_{S}v_{X} and Yâª¯SvYsubscriptprecedes-or-equalsğ‘†ğ‘Œsubscriptğ‘£ğ‘ŒY\\preceq_{S}v_{Y} for two distinct children vX,vYâˆˆchildSâ¡(uS)subscriptğ‘£ğ‘‹subscriptğ‘£ğ‘Œsubscriptchildğ‘†subscriptğ‘¢ğ‘†v_{X},v_{Y}\\in\\operatorname{child}_{S}(u_{S}). In\nparticular, we have Xâ‰ Yğ‘‹ğ‘ŒX\\neq Y and lcaSâ¡(X,Y)=uSsubscriptlcağ‘†ğ‘‹ğ‘Œsubscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(X,Y)=u_{S}. Moreover, by\nconstruction, every connected component of H2subscriptğ»2H_{2} is contained in a\nconnected component of H1subscriptğ»1H_{1} and thus, xğ‘¥x and yğ‘¦y are in the same\nconnected component of H1subscriptğ»1H_{1}. The latter two arguments together with\nLemmaÂ 24 imply xâ€‹yâˆ‰Eâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\notin E(G_{{}_{>}}). In summary, we\ntherefore have xâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}). Consider a shortest path Pğ‘ƒP connecting xğ‘¥x and yğ‘¦y in H2subscriptğ»2H_{2}, which\nexists since x,yâˆˆCjğ‘¥ğ‘¦subscriptğ¶ğ‘—x,y\\in C_{j}. By construction, xâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) and\nlcaSâ¡(X,Y)=uSsubscriptlcağ‘†ğ‘‹ğ‘Œsubscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(X,Y)=u_{S} imply that xâ€‹yâˆ‰Eâ€‹(H2)ğ‘¥ğ‘¦ğ¸subscriptğ»2xy\\notin E(H_{2}) and thus Pğ‘ƒP contains at\nleast 333 vertices. Let zâˆˆCjâˆ–{x,y}ğ‘§subscriptğ¶ğ‘—ğ‘¥ğ‘¦z\\in C_{j}\\setminus\\{x,y\\} be the neighbor of\nxğ‘¥x in Pğ‘ƒP. We consider the two possibilities (a) xâ€‹zâˆˆEâ€‹(G=)ğ‘¥ğ‘§ğ¸subscriptğºxz\\in E(G_{{}_{=}}) and (b)\nxâ€‹zâˆˆEâ€‹(G<)ğ‘¥ğ‘§ğ¸subscriptğºxz\\in E(G_{{}_{<}}). Note that Xâ‰ Ïƒâ€‹(z)â‰•Zğ‘‹ğœğ‘§â‰•ğ‘X\\neq\\sigma(z)\\eqqcolon Z holds in both\ncases since G=subscriptğºG_{{}_{=}} and G<subscriptğºG_{{}_{<}} are properly colored. In CaseÂ (a), we must have Zâª¯SvXsubscriptprecedes-or-equalsğ‘†ğ‘subscriptğ‘£ğ‘‹Z\\preceq_{S}v_{X} since xâ€‹zğ‘¥ğ‘§xz is an edge in\nH2subscriptğ»2H_{2}. This implies that Zâ‰ Yğ‘ğ‘ŒZ\\neq Y (and thus X,Y,Zğ‘‹ğ‘Œğ‘X,Y,Z are pairwise\ndistinct) and lcaSâ¡(Y,Z)=uSsubscriptlcağ‘†ğ‘Œğ‘subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(Y,Z)=u_{S}. Based on the latter arguments, Sğ‘†S must\ndisplay the triple Xâ€‹Z|Yconditionalğ‘‹ğ‘ğ‘ŒXZ|Y. Suppose that yâ€‹zâˆ‰Eâ€‹(G=)ğ‘¦ğ‘§ğ¸subscriptğºyz\\notin E(G_{{}_{=}}). Together\nwith xâ€‹y,xâ€‹zâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ‘¥ğ‘§ğ¸subscriptğºxy,xz\\in E(G_{{}_{=}}), we have Xâ€‹Z|Yâˆˆâ„±Sconditionalğ‘‹ğ‘ğ‘Œsubscriptâ„±ğ‘†XZ|Y\\in\\mathscr{F}_{S} and thus, by\nconstruction of Sğ‘†S in LineÂ 1, Sğ‘†S cannot display Xâ€‹Z|Yconditionalğ‘‹ğ‘ğ‘ŒXZ|Y;\na contradiction. Hence, yâ€‹zâˆˆEâ€‹(G=)ğ‘¦ğ‘§ğ¸subscriptğºyz\\in E(G_{{}_{=}}) must hold. Since Zâª¯SvXsubscriptprecedes-or-equalsğ‘†ğ‘subscriptğ‘£ğ‘‹Z\\preceq_{S}v_{X} and Yâª¯SvYsubscriptprecedes-or-equalsğ‘†ğ‘Œsubscriptğ‘£ğ‘ŒY\\preceq_{S}v_{Y}, we have yâ€‹zâˆ‰Eâ€‹(H3)ğ‘¦ğ‘§ğ¸subscriptğ»3yz\\notin E(H_{3}). Note that connected\ncomponents in H3subscriptğ»3H_{3} are complete graphs. Hence, yâ€‹zâˆ‰Eâ€‹(H3)ğ‘¦ğ‘§ğ¸subscriptğ»3yz\\notin E(H_{3}) implies\nthat yğ‘¦y and zğ‘§z are in distinct connected components of H3subscriptğ»3H_{3}. However,\nthe distance of yğ‘¦y and zğ‘§z in H2subscriptğ»2H_{2} is strictly smaller than that of xğ‘¥x\nand yğ‘¦y (because zğ‘§z is closer to yğ‘¦y than xğ‘¥x in the shortest path Pğ‘ƒP);\na contradiction to our choice of xğ‘¥x and yğ‘¦y. In summary, CaseÂ (a)\ntherefore cannot occur. In CaseÂ (b) we have xâ€‹zâˆˆEâ€‹(G<)ğ‘¥ğ‘§ğ¸subscriptğºxz\\in E(G_{{}_{<}}). If yâ€‹zâˆˆEâ€‹(G<)ğ‘¦ğ‘§ğ¸subscriptğºyz\\in E(G_{{}_{<}}), then Yâ‰ Zğ‘Œğ‘Y\\neq Z\n(because G<subscriptğºG_{{}_{<}} is properly colored) and, by definition, Xâ€‹Y|Zâˆˆâ„›Sconditionalğ‘‹ğ‘Œğ‘subscriptâ„›ğ‘†XY|Z\\in\\mathscr{R}_{S}. By construction in LineÂ 1, the species tree Sğ‘†S\ndisplays Xâ€‹Y|Zconditionalğ‘‹ğ‘Œğ‘XY|Z. Together with X,Y,ZâˆˆLâ€‹(Sâ€‹(uS))ğ‘‹ğ‘Œğ‘ğ¿ğ‘†subscriptğ‘¢ğ‘†X,Y,Z\\in L(S(u_{S})) by\nObs.Â 2, this contradicts that lcaSâ¡(X,Y)=uSsubscriptlcağ‘†ğ‘‹ğ‘Œsubscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(X,Y)=u_{S}.\nSimilarly, if yâ€‹zâˆˆEâ€‹(G=)ğ‘¦ğ‘§ğ¸subscriptğºyz\\in E(G_{{}_{=}}), then Sğ‘†S displays neither of the forbidden\ntriples Xâ€‹Y|Zconditionalğ‘‹ğ‘Œğ‘XY|Z and Yâ€‹Z|Xconditionalğ‘Œğ‘ğ‘‹YZ|X. Hence, Sğ‘†S displays Xâ€‹Z|Yconditionalğ‘‹ğ‘ğ‘ŒXZ|Y or\nS|XYZS_{|XYZ} is the star tree on the three colors. In both cases, we\nhave lcaSâ¡(Y,Z)=lcaSâ¡(X,Y)=uSsubscriptlcağ‘†ğ‘Œğ‘subscriptlcağ‘†ğ‘‹ğ‘Œsubscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(Y,Z)=\\operatorname{lca}_{S}(X,Y)=u_{S}. In particular, therefore yğ‘¦y and zğ‘§z\nare in distinct connected components of H3subscriptğ»3H_{3}. As argued before, the\ndistance of yğ‘¦y and zğ‘§z is smaller than that of xğ‘¥x and yğ‘¦y. Taken\ntogether the latter arguments again contradict our choice of xğ‘¥x and yğ‘¦y,\nand thus yâ€‹zâˆˆEâ€‹(G>)ğ‘¦ğ‘§ğ¸subscriptğºyz\\in E(G_{{}_{>}}) is left as the only remaining choice. In summary, only case (b) xâ€‹zâˆˆEâ€‹(G<)ğ‘¥ğ‘§ğ¸subscriptğºxz\\in E(G_{{}_{<}}) is possible, which in particular\nimplies yâ€‹zâˆˆEâ€‹(G>)ğ‘¦ğ‘§ğ¸subscriptğºyz\\in E(G_{{}_{>}}). Therefore, we have yâ€‹zâˆ‰Eâ€‹(H2)ğ‘¦ğ‘§ğ¸subscriptğ»2yz\\notin E(H_{2}) and thus the\npath Pğ‘ƒP contains at least 444 vertices. Thus, consider the neighbor\nwâˆˆCjâˆ–{x,y,z}ğ‘¤subscriptğ¶ğ‘—ğ‘¥ğ‘¦ğ‘§w\\in C_{j}\\setminus\\{x,y,z\\} of yğ‘¦y in Pğ‘ƒP and set Wâ‰”Ïƒâ€‹(w)â‰”ğ‘Šğœğ‘¤W\\coloneqq\\sigma(w). We can apply analogous arguments for x,y,wğ‘¥ğ‘¦ğ‘¤x,y,w as we have used\nfor x,y,zğ‘¥ğ‘¦ğ‘§x,y,z to exclude the case (aâ€™) yâ€‹wâˆˆEâ€‹(G=)ğ‘¦ğ‘¤ğ¸subscriptğºyw\\in E(G_{{}_{=}}) and, in case (bâ€™)\nyâ€‹wâˆˆEâ€‹(G<)ğ‘¦ğ‘¤ğ¸subscriptğºyw\\in E(G_{{}_{<}}), we obtain xâ€‹wâˆˆEâ€‹(G>)ğ‘¥ğ‘¤ğ¸subscriptğºxw\\in E(G_{{}_{>}}) as the only possibility. Taking the latter arguments together, it remains to consider the case xâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}), xâ€‹z,yâ€‹wâˆˆEâ€‹(G<)ğ‘¥ğ‘§ğ‘¦ğ‘¤ğ¸subscriptğºxz,yw\\in E(G_{{}_{<}}), and xâ€‹w,yâ€‹zâˆˆEâ€‹(G>)ğ‘¥ğ‘¤ğ‘¦ğ‘§ğ¸subscriptğºxw,yz\\in E(G_{{}_{>}}). Since G<subscriptğºG_{{}_{<}} and\nG>subscriptğºG_{{}_{>}} are cographs, we have zâ€‹wâˆˆEâ€‹(G=)ğ‘§ğ‘¤ğ¸subscriptğºzw\\in E(G_{{}_{=}}) because otherwise xâˆ’zâˆ’wâˆ’yğ‘¥ğ‘§ğ‘¤ğ‘¦x-z-w-y or\nxâˆ’wâˆ’zâˆ’yğ‘¥ğ‘¤ğ‘§ğ‘¦x-w-z-y would be an induced P4subscriptğ‘ƒ4P_{4} in G<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}}, respectively. Now, xğ‘¥x and wğ‘¤w must be in the same connected component of H3subscriptğ»3H_{3}, as\notherwise xâ€‹wâˆ‰Eâ€‹(G<)ğ‘¥ğ‘¤ğ¸subscriptğºxw\\notin E(G_{<}) and the fact that xğ‘¥x and wğ‘¤w are at a\nshorter distance than xğ‘¥x and yğ‘¦y in H2subscriptğ»2H_{2} would contradict our choice of\nxğ‘¥x and yğ‘¦y. Likewise, yğ‘¦y and zğ‘§z are in the same connected component\nof H3subscriptğ»3H_{3} since yâ€‹zâˆ‰Eâ€‹(G<)ğ‘¦ğ‘§ğ¸subscriptğºyz\\notin E(G_{<}) and they are closer than xğ‘¥x and yğ‘¦y in\nH2subscriptğ»2H_{2}. It follows that wğ‘¤w and zğ‘§z are in distinct connected components\nof H3subscriptğ»3H_{3}, again yielding a contradiction since they are closer than xğ‘¥x\nand yğ‘¦y in H2subscriptğ»2H_{2} and wâ€‹zâˆ‰Eâ€‹(G<)ğ‘¤ğ‘§ğ¸subscriptğºwz\\notin E(G_{<}). In summary, therefore, we have\nxâ€‹yâˆˆEâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{<}}).\nâˆ The following result is a consequence of LemmaÂ 25\nand will be helpful later on. Let ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) with vertex set Lğ¿L be a valid\ninput for AlgorithmÂ 1. Consider a recursion step on\nLâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L and uSâˆˆV0â€‹(S)subscriptğ‘¢ğ‘†superscriptğ‘‰0ğ‘†u_{S}\\in V^{0}(S) of\nAlgorithmÂ 1. If xâ€‹yâˆˆEâ€‹(H1)âˆ–Eâ€‹(H2)ğ‘¥ğ‘¦ğ¸subscriptğ»1ğ¸subscriptğ»2xy\\in E(H_{1})\\setminus E(H_{2}), then\nxğ‘¥x and yğ‘¦y are in distinct connected components of H2subscriptğ»2H_{2}. Suppose xâ€‹yâˆˆEâ€‹(H1)âˆ–Eâ€‹(H2)ğ‘¥ğ‘¦ğ¸subscriptğ»1ğ¸subscriptğ»2xy\\in E(H_{1})\\setminus E(H_{2}). By construction of the auxiliary\ngraphs, this implies that xâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) and there is no vâˆˆchildSâ¡(uS)ğ‘£subscriptchildğ‘†subscriptğ‘¢ğ‘†v\\in\\operatorname{child}_{S}(u_{S}) such that Ïƒâ€‹(x),Ïƒâ€‹(y)â‰ºSvsubscriptprecedesğ‘†ğœğ‘¥ğœğ‘¦ğ‘£\\sigma(x),\\sigma(y)\\prec_{S}v. The latter\nin particular yields that xâ€‹yâˆ‰Eâ€‹(H3)ğ‘¥ğ‘¦ğ¸subscriptğ»3xy\\notin E(H_{3}). This, together with the\nfact that H3subscriptğ»3H_{3} is a graph whose connected components are complete\ngraphs, implies that xğ‘¥x and yğ‘¦y are in distinct connected components of\nH3subscriptğ»3H_{3}. We can now use LemmaÂ 25 to conclude that\nxğ‘¥x and yğ‘¦y must also be in distinct connected components of H2subscriptğ»2H_{2} as\notherwise we would obtain xâ€‹yâˆˆEâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{<}}); a contradiction.\nâˆ We are now in the position to demonstrate that AlgorithmÂ 1\nis correct. Let ğ’¢ğ’¢\\mathscr{G} be a valid input for\nAlgorithmÂ 1. Then, AlgorithmÂ 1\nreturns a relaxed scenario ğ’®=(T,S,Ïƒ,Î¼,Ï„T,Ï„S)ğ’®ğ‘‡ğ‘†ğœğœ‡subscriptğœğ‘‡subscriptğœğ‘†\\mathscr{S}=(T,S,\\sigma,\\mu,\\tau_{T},\\tau_{S}) that explains\nğ’¢ğ’¢\\mathscr{G}. Let ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) be a valid input with vertex set Lğ¿L\nfor AlgorithmÂ 1. By LemmaÂ 23,\nAlgorithmÂ 1 returns a relaxed scenario\nğ’®=(T,S,Ïƒ,Î¼,Ï„T,Ï„S)ğ’®ğ‘‡ğ‘†ğœğœ‡subscriptğœğ‘‡subscriptğœğ‘†\\mathscr{S}=(T,S,\\sigma,\\mu,\\tau_{T},\\tau_{S}) such that Lâ€‹(T)=Lğ¿ğ‘‡ğ¿L(T)=L.\nWe continue with showing that ğ’®ğ’®\\mathscr{S} explains ğ’¢ğ’¢\\mathscr{G}. Consider two distinct vertices x,yâˆˆL=Lâ€‹(T)ğ‘¥ğ‘¦ğ¿ğ¿ğ‘‡x,y\\in L=L(T) and their last common\nancestor lcaTâ¡(x,y)subscriptlcağ‘‡ğ‘¥ğ‘¦\\operatorname{lca}_{T}(x,y). Let Lâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L and uSâˆˆVâ€‹(S)subscriptğ‘¢ğ‘†ğ‘‰ğ‘†u_{S}\\in V(S) be the\ninput of the recursive call of BuildGeneTree in which\nlcaTâ¡(x,y)subscriptlcağ‘‡ğ‘¥ğ‘¦\\operatorname{lca}_{T}(x,y) was created. By Obs.Â 2\nandÂ 3, we have Ïƒâ€‹(Lâ€²)âŠ†Lâ€‹(Sâ€‹(us))ğœsuperscriptğ¿â€²ğ¿ğ‘†subscriptğ‘¢ğ‘ \\sigma(L^{\\prime})\\subseteq L(S(u_{s})) and\nx,yâˆˆLâ€²ğ‘¥ğ‘¦superscriptğ¿â€²x,y\\in L^{\\prime}, respectively, and therefore lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))âª¯SuSsubscriptprecedes-or-equalsğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))\\preceq_{S}u_{S}. Moreover, time consistency yields Ï„Sâ€‹(lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y)))â‰¤Ï„Sâ€‹(uS)subscriptğœğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğœğ‘†subscriptğ‘¢ğ‘†\\tau_{S}(\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y)))\\leq\\tau_{S}(u_{S}). The vertex lcaTâ¡(x,y)subscriptlcağ‘‡ğ‘¥ğ‘¦\\operatorname{lca}_{T}(x,y) has been created in\nexactly one of the following three locations in the algorithm: (a) in\nLineÂ 6, (b)Â in LineÂ 15, and (c)Â in\nLineÂ 18. In CaseÂ (a), lcaTâ¡(x,y)subscriptlcağ‘‡ğ‘¥ğ‘¦\\operatorname{lca}_{T}(x,y) equals Ïâ€²superscriptğœŒâ€²\\rho^{\\prime} in the recursion step of\ninterest. Suppose first that uSsubscriptğ‘¢ğ‘†u_{S} is a leaf of Sğ‘†S and thus\nÏƒâ€‹(x)=Ïƒâ€‹(y)=uSğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\sigma(x)=\\sigma(y)=u_{S}. Hence, we have xâ€‹yâˆˆEâ€‹(G>â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{>}}(\\mathscr{S})) by\nCor.Â 1 and xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}), since G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}} are\nproperly colored. Now suppose that uSsubscriptğ‘¢ğ‘†u_{S} is not a leaf. Then\nlcaTâ¡(x,y)=Ïâ€²subscriptlcağ‘‡ğ‘¥ğ‘¦superscriptğœŒâ€²\\operatorname{lca}_{T}(x,y)=\\rho^{\\prime} implies that xğ‘¥x and yğ‘¦y lie in distinct connected\ncomponents of the auxiliary graph H1subscriptğ»1H_{1} and thus xâ€‹yâˆ‰Eâ€‹(H1)ğ‘¥ğ‘¦ğ¸subscriptğ»1xy\\notin E(H_{1}). By\nconstruction of this graph, the latter yields xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}). Moreover,\nwe have set Ï„Tâ€‹(Ïâ€²)=Ï„Sâ€‹(uS)+Ïµ>Ï„Sâ€‹(uS)subscriptğœğ‘‡superscriptğœŒâ€²subscriptğœğ‘†subscriptğ‘¢ğ‘†italic-Ïµsubscriptğœğ‘†subscriptğ‘¢ğ‘†\\tau_{T}(\\rho^{\\prime})=\\tau_{S}(u_{S})+\\epsilon>\\tau_{S}(u_{S}). Together with\nlcaTâ¡(x,y)=Ïâ€²subscriptlcağ‘‡ğ‘¥ğ‘¦superscriptğœŒâ€²\\operatorname{lca}_{T}(x,y)=\\rho^{\\prime}, this implies Ï„Sâ€‹(lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y)))â‰¤Ï„Sâ€‹(uS)<Ï„Tâ€‹(lcaTâ¡(x,y))subscriptğœğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğœğ‘†subscriptğ‘¢ğ‘†subscriptğœğ‘‡subscriptlcağ‘‡ğ‘¥ğ‘¦\\tau_{S}(\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y)))\\leq\\tau_{S}(u_{S})<\\tau_{T}(\\operatorname{lca}_{T}(x,y)) and thus xâ€‹yâˆˆEâ€‹(G>â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{>}}(\\mathscr{S})). In CaseÂ (b), uSsubscriptğ‘¢ğ‘†u_{S} is an inner vertex of Sğ‘†S and lcaTâ¡(x,y)subscriptlcağ‘‡ğ‘¥ğ‘¦\\operatorname{lca}_{T}(x,y) equals\nuisubscriptğ‘¢ğ‘–u_{i}. We have set Ï„Tâ€‹(lcaTâ¡(x,y))=Ï„Tâ€‹(ui)=Ï„Sâ€‹(uS)subscriptğœğ‘‡subscriptlcağ‘‡ğ‘¥ğ‘¦subscriptğœğ‘‡subscriptğ‘¢ğ‘–subscriptğœğ‘†subscriptğ‘¢ğ‘†\\tau_{T}(\\operatorname{lca}_{T}(x,y))=\\tau_{T}(u_{i})=\\tau_{S}(u_{S}). By\nconstruction, moreover, xğ‘¥x and yğ‘¦y must be in the same connected\ncomponent Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1} but in distinct connected components of H2subscriptğ»2H_{2}.\nHence, we have xâ€‹yâˆ‰Eâ€‹(H2)ğ‘¥ğ‘¦ğ¸subscriptğ»2xy\\notin E(H_{2}) which implies xâ€‹yâˆ‰Eâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\notin E(G_{{}_{<}}) by the\nconstruction of H2subscriptğ»2H_{2}. Suppose first lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))=uSsubscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))=u_{S}. Then xâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) as otherwise it would hold xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}); a\ncontradiction to LemmaÂ 24. Moreover, we have\nÏ„Tâ€‹(lcaTâ¡(x,y))=Ï„Sâ€‹(uS)=Ï„Sâ€‹(lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y)))subscriptğœğ‘‡subscriptlcağ‘‡ğ‘¥ğ‘¦subscriptğœğ‘†subscriptğ‘¢ğ‘†subscriptğœğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦\\tau_{T}(\\operatorname{lca}_{T}(x,y))=\\tau_{S}(u_{S})=\\tau_{S}(\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))) and thus\nxâ€‹yâˆˆEâ€‹(G=â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{=}}(\\mathscr{S})). Now suppose lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))â‰ºSuSsubscriptprecedesğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))\\prec_{S}u_{S} and thus, by time consistency, Ï„Sâ€‹(lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y)))<Ï„Sâ€‹(uS)=Ï„Tâ€‹(lcaTâ¡(x,y))subscriptğœğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğœğ‘†subscriptğ‘¢ğ‘†subscriptğœğ‘‡subscriptlcağ‘‡ğ‘¥ğ‘¦\\tau_{S}(\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y)))<\\tau_{S}(u_{S})=\\tau_{T}(\\operatorname{lca}_{T}(x,y)). This yields xâ€‹yâˆˆEâ€‹(G>â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{>}}(\\mathscr{S})).\nMoreover, from lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))â‰ºSuSsubscriptprecedesğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))\\prec_{S}u_{S}, we conclude\nthat Ïƒâ€‹(x),Ïƒâ€‹(y)âª¯Swsubscriptprecedes-or-equalsğ‘†ğœğ‘¥ğœğ‘¦ğ‘¤\\sigma(x),\\sigma(y)\\preceq_{S}w for some child wâˆˆchildSâ¡(uS)ğ‘¤subscriptchildğ‘†subscriptğ‘¢ğ‘†w\\in\\operatorname{child}_{S}(u_{S}). Therefore, we must have xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}) since otherwise\nxâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) would imply that xâ€‹yâˆˆEâ€‹(H2)ğ‘¥ğ‘¦ğ¸subscriptğ»2xy\\in E(H_{2}). In CaseÂ (c), uSsubscriptğ‘¢ğ‘†u_{S} is an inner vertex of Sğ‘†S and lcaTâ¡(x,y)subscriptlcağ‘‡ğ‘¥ğ‘¦\\operatorname{lca}_{T}(x,y) equals\nvjsubscriptğ‘£ğ‘—v_{j}. We have set Ï„Tâ€‹(lcaTâ¡(x,y))=Ï„Tâ€‹(vj)=Ï„Sâ€‹(uS)âˆ’Ïµ<Ï„Sâ€‹(uS)subscriptğœğ‘‡subscriptlcağ‘‡ğ‘¥ğ‘¦subscriptğœğ‘‡subscriptğ‘£ğ‘—subscriptğœğ‘†subscriptğ‘¢ğ‘†italic-Ïµsubscriptğœğ‘†subscriptğ‘¢ğ‘†\\tau_{T}(\\operatorname{lca}_{T}(x,y))=\\tau_{T}(v_{j})=\\tau_{S}(u_{S})-\\epsilon<\\tau_{S}(u_{S}). By construction, moreover, xğ‘¥x and yğ‘¦y must be in the same\nconnected component Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2} (and thus also in the same connected\ncomponent Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1}) but in distinct connected components of H3subscriptğ»3H_{3}.\nThis immediately implies (i) that xâ€‹yâˆˆEâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{<}}) by\nLemmaÂ 25 and (ii), by construction of H3subscriptğ»3H_{3}, that\nÏƒâ€‹(x)ğœğ‘¥\\sigma(x) and Ïƒâ€‹(y)ğœğ‘¦\\sigma(y) lie below distinct children of uSsubscriptğ‘¢ğ‘†u_{S}. In\nparticular, therefore, we have lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))=uSsubscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))=u_{S} and\nthus Ï„Sâ€‹(lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y)))=Ï„Sâ€‹(uS)>Ï„Tâ€‹(lcaTâ¡(x,y))subscriptğœğ‘†subscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğœğ‘†subscriptğ‘¢ğ‘†subscriptğœğ‘‡subscriptlcağ‘‡ğ‘¥ğ‘¦\\tau_{S}(\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y)))=\\tau_{S}(u_{S})>\\tau_{T}(\\operatorname{lca}_{T}(x,y)).\nThis implies xâ€‹yâˆˆEâ€‹(G<â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{<}}(\\mathscr{S})). In summary, we have shown that xâ€‹yâˆˆEâ€‹(G<)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{<}}) iff xâ€‹yâˆˆEâ€‹(G<â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{<}}(\\mathscr{S})),\nxâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) iff xâ€‹yâˆˆEâ€‹(G=â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{=}}(\\mathscr{S})), and xâ€‹yâˆˆEâ€‹(G>)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{>}}) iff xâ€‹yâˆˆEâ€‹(G>â€‹(ğ’®))ğ‘¥ğ‘¦ğ¸subscriptğºğ’®xy\\in E(G_{{}_{>}}(\\mathscr{S})). Since x,yâˆˆLğ‘¥ğ‘¦ğ¿x,y\\in L where chosen arbitrarily and L=Lâ€‹(T)ğ¿ğ¿ğ‘‡L=L(T),\nthis proves that the relaxed scenario ğ’®ğ’®\\mathscr{S} returned by the algorithm\nindeed explains the input ğ’¢ğ’¢\\mathscr{G}.\nâˆ As outlined in the proof of LemmaÂ 26, edges\nxâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) are considered only in Case (b) and we have lcaTâ¡(x,y)=uisubscriptlcağ‘‡ğ‘¥ğ‘¦subscriptğ‘¢ğ‘–\\operatorname{lca}_{T}(x,y)=u_{i} and lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))=uSsubscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))=u_{S}. In this case, we put\nÎ¼â€‹(ui)=uSğœ‡subscriptğ‘¢ğ‘–subscriptğ‘¢ğ‘†\\mu(u_{i})=u_{S} in LineÂ 16 of\nAlgorithmÂ 1. The reconciliation map Î¼ğœ‡\\mu therefore\nhas the following property: Let ğ’®ğ’®\\mathscr{S} be a scenario produced by AlgorithmÂ 1\nfor a valid input ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma). Then xâ€‹yâˆˆEâ€‹(G=)ğ‘¥ğ‘¦ğ¸subscriptğºxy\\in E(G_{{}_{=}}) implies Î¼â€‹(lcaTâ¡(x,y))=lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))ğœ‡subscriptlcağ‘‡ğ‘¥ğ‘¦subscriptlcağ‘†ğœğ‘¥ğœğ‘¦\\mu(\\operatorname{lca}_{T}(x,y))=\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y)). A main result of this section is the following characterization of\ngraph 333-partitions that derive from relaxed scenarios: A graph 333-partition ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) can be explained\nby a relaxed scenario if and only if G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}} are properly\ncolored, G<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are cographs, and (â„›Sâ€‹(ğ’¢),â„±Sâ€‹(ğ’¢))subscriptâ„›ğ‘†ğ’¢subscriptâ„±ğ‘†ğ’¢(\\mathscr{R}_{S}(\\mathscr{G}),\\mathscr{F}_{S}(\\mathscr{G})) is consistent. Suppose first that ğ’¢ğ’¢\\mathscr{G} can be explained by a relaxed scenario.\nThen G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}} are properly colored by Cor.Â 1,\nG<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are cographs by LemmasÂ 14\nandÂ 15, respectively, and (â„›Sâ€‹(ğ’¢),â„±Sâ€‹(ğ’¢))subscriptâ„›ğ‘†ğ’¢subscriptâ„±ğ‘†ğ’¢(\\mathscr{R}_{S}(\\mathscr{G}),\\mathscr{F}_{S}(\\mathscr{G})) is consistent by Prop.Â 2. Conversely,\nsuppose G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}} are properly colored, G<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are\ncographs, and (â„›Sâ€‹(ğ’¢),â„±Sâ€‹(ğ’¢))subscriptâ„›ğ‘†ğ’¢subscriptâ„±ğ‘†ğ’¢(\\mathscr{R}_{S}(\\mathscr{G}),\\mathscr{F}_{S}(\\mathscr{G})) is consistent. In this\ncase, ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) is a valid input for\nAlgorithmÂ 1 and LemmaÂ 26 implies\nthat AlgorithmÂ 1 returns a relaxed scenario that\nexplains ğ’¢ğ’¢\\mathscr{G}.\nâˆ This result implies almost immediately that the property of being\nexplainable by a relaxed scenario is hereditary: A graph 333-partition ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) with vertex set\nLğ¿L can be explained by a relaxed scenario if and only if ğ’¢|Lâ€²\\mathscr{G}_{|L^{\\prime}} can be explained by a relaxed scenario for all subsets\nLâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L. The if-part is clear as ğ’¢=ğ’¢|L\\mathscr{G}=\\mathscr{G}_{|L}. Conversely,\nsuppose that ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) is explained by a relaxed\nscenario ğ’®=(T,S,Ïƒ,Î¼,Ï„T,Ï„S)ğ’®ğ‘‡ğ‘†ğœğœ‡subscriptğœğ‘‡subscriptğœğ‘†\\mathscr{S}=(T,S,\\sigma,\\mu,\\tau_{T},\\tau_{S}) and let Lâ€²âŠ†Lsuperscriptğ¿â€²ğ¿L^{\\prime}\\subseteq L. By\nProp.Â 2, therefore, Sğ‘†S agrees with (â„›Sâ€‹(ğ’¢),â„±Sâ€‹(ğ’¢))subscriptâ„›ğ‘†ğ’¢subscriptâ„±ğ‘†ğ’¢(\\mathscr{R}_{S}(\\mathscr{G}),\\mathscr{F}_{S}(\\mathscr{G})). By Thm.Â 10, G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}}\nare properly colored and G<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are cographs. Now consider\nğ’¢|Lâ€²=(G<â€‹[Lâ€²],G=â€‹[Lâ€²],G>â€‹[Lâ€²],Ïƒ|Lâ€²)\\mathscr{G}_{|L^{\\prime}}=(G_{{}_{<}}[L^{\\prime}],G_{{}_{=}}[L^{\\prime}],G_{{}_{>}}[L^{\\prime}],\\sigma_{|L^{\\prime}}).\nClearly, the induced subgraphs G<â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{<}}[L^{\\prime}] and G=â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{=}}[L^{\\prime}] are also properly\ncolored. By Prop.Â 1, G<â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{<}}[L^{\\prime}] and G>â€‹[Lâ€²]subscriptğºdelimited-[]superscriptğ¿â€²G_{{}_{>}}[L^{\\prime}] are also\ncographs. By definition of the informative and forbidden triples in\nDef.Â 6 and the induced subgraph relationships,\nwe observe furthermore that â„›Sâ€‹(ğ’¢|Lâ€²)âŠ†â„›Sâ€‹(ğ’¢)\\mathscr{R}_{S}(\\mathscr{G}_{|L^{\\prime}})\\subseteq\\mathscr{R}_{S}(\\mathscr{G}) and â„±Sâ€‹(ğ’¢|Lâ€²)âŠ†â„±Sâ€‹(ğ’¢)\\mathscr{F}_{S}(\\mathscr{G}_{|L^{\\prime}})\\subseteq\\mathscr{F}_{S}(\\mathscr{G}).\nHence, Sğ‘†S displays all triples in â„›Sâ€‹(ğ’¢|Lâ€²)\\mathscr{R}_{S}(\\mathscr{G}_{|L^{\\prime}}) and none of\nthe triples in â„±Sâ€‹(ğ’¢|Lâ€²)\\mathscr{F}_{S}(\\mathscr{G}_{|L^{\\prime}}), which yields that\n(â„›Sâ€‹(ğ’¢|Lâ€²),â„±Sâ€‹(ğ’¢|Lâ€²))(\\mathscr{R}_{S}(\\mathscr{G}_{|L^{\\prime}}),\\mathscr{F}_{S}(\\mathscr{G}_{|L^{\\prime}})) is consistent. We\ncan now again apply Thm.Â 10 to conclude that\nğ’¢|Lâ€²\\mathscr{G}_{|L^{\\prime}} is explainable.\nâˆ Using the characterization in Thm.Â 10, we can\ndecide in polynomial time whether a graph 333-partition is explainable by a\nrelaxed scenario: It can be decided in Oâ€‹(|L|4â€‹logâ¡|L|)ğ‘‚superscriptğ¿4ğ¿O(|L|^{4}\\log|L|) time whether a\ngraph 333-partition ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) can be explained by a\nrelaxed scenario. It can be checked in Oâ€‹(|L|2)ğ‘‚superscriptğ¿2O(|L|^{2}) time whether G<subscriptğºG_{{}_{<}} and G=subscriptğºG_{{}_{=}} are\nproperly colored. It can be decided in in Oâ€‹(|L|+|E|)ğ‘‚ğ¿ğ¸O(|L|+|E|) time whether a graph G=(L,E)ğºğ¿ğ¸G=(L,E) is a cograph . In\nparticular, it can also be verified in Oâ€‹(|L|2)ğ‘‚superscriptğ¿2O(|L|^{2}) time that\nG<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are cographs. Extraction of â„›â‰”â„›Sâ€‹(ğ’¢)â‰”â„›subscriptâ„›ğ‘†ğ’¢\\mathscr{R}\\coloneqq\\mathscr{R}_{S}(\\mathscr{G})\nand â„±â‰”â„±Sâ€‹(ğ’¢)â‰”â„±subscriptâ„±ğ‘†ğ’¢\\mathscr{F}\\coloneqq\\mathscr{F}_{S}(\\mathscr{G}) according to\nDef.Â 6 requires Oâ€‹(|L|3)ğ‘‚superscriptğ¿3O(|L|^{3}). Let\nMâ€²âŠ†Msuperscriptğ‘€â€²ğ‘€M^{\\prime}\\subseteq M be the subset of colors that appear on the leaves of the\ntriples in â„›âˆªâ„±â„›â„±\\mathscr{R}\\cup\\mathscr{F}. By construction, we have |Mâ€²|âˆˆOâ€‹(|L|)superscriptğ‘€â€²ğ‘‚ğ¿|M^{\\prime}|\\in O(|L|). The algorithm MTT, which stands for\nmixed triplets problem restricted to trees and was described in\n[ref]29, constructs a tree on Mâ€²superscriptğ‘€â€²M^{\\prime} that agrees with (â„›,â„±)â„›â„±(\\mathscr{R},\\mathscr{F}), if\none exists, in Oâ€‹(|â„›|â‹…|Mâ€²|+|â„±|â‹…|Mâ€²|â€‹logâ¡|Mâ€²|+|Mâ€²|2â€‹logâ¡|Mâ€²|)ğ‘‚â‹…â„›superscriptğ‘€â€²â‹…â„±superscriptğ‘€â€²superscriptğ‘€â€²superscriptsuperscriptğ‘€â€²2superscriptğ‘€â€²O(|\\mathscr{R}|\\cdot|M^{\\prime}|+|\\mathscr{F}|\\cdot|M^{\\prime}|\\log|M^{\\prime}|+|M^{\\prime}|^{2}\\log|M^{\\prime}|)\ntime. This, together with |â„›|,|â„±|âˆˆOâ€‹(|L|3)â„›â„±ğ‘‚superscriptğ¿3|\\mathscr{R}|,|\\mathscr{F}|\\in O(|L|^{3}) and |Mâ€²|âˆˆOâ€‹(|L|)superscriptğ‘€â€²ğ‘‚ğ¿|M^{\\prime}|\\in O(|L|) implies that it can\nbe decided in Oâ€‹(|L|4â€‹logâ¡|L|)ğ‘‚superscriptğ¿4ğ¿O(|L|^{4}\\log|L|) whether (â„›,â„±)â„›â„±(\\mathscr{R},\\mathscr{F})\nis consistent.\nâˆ In particular, it can be decided in Oâ€‹(|L|4â€‹logâ¡|L|)ğ‘‚superscriptğ¿4ğ¿O(|L|^{4}\\log|L|)\nwhether ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) can be explained by a\nrelaxed scenario without explicit construction of such a scenario. We will\nshow in the following that the construction of relaxed scenarios is bounded\nby the same complexity. For simplicity, we will explicitly require that\nÏƒ:Lâ†’M:ğœâ†’ğ¿ğ‘€\\sigma\\colon L\\to M is surjective, i.e., that Ïƒâ€‹(L)=Mğœğ¿ğ‘€\\sigma(L)=M holds. One\neasily verifies, however, that the existence of â€œunused colorsâ€ in Mğ‘€M\nonly increases the size of the species tree Sğ‘†S (in particular, the number\nof leaves in Sğ‘†S that are attached to ÏSsubscriptğœŒğ‘†\\rho_{S}) but does not affect the\nexistence of a relaxed scenario that explains ğ’¢ğ’¢\\mathscr{G}. AlgorithmÂ 1 can be implemented to run in\nOâ€‹(|L|4â€‹logâ¡|L|)ğ‘‚superscriptğ¿4ğ¿O(|L|^{4}\\log|L|) time (for valid inputs\nğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) such that Ïƒğœ\\sigma is surjective). Let ğ’¢=(G<,G=,G>,Ïƒ)ğ’¢subscriptğºsubscriptğºsubscriptğºğœ\\mathscr{G}=(G_{{}_{<}},G_{{}_{=}},G_{{}_{>}},\\sigma) with vertex set Lğ¿L be a valid\ninput and surjective coloring Ïƒ:Lâ†’M:ğœâ†’ğ¿ğ‘€\\sigma\\colon L\\to M that is given as\ninput for AlgorithmÂ 1. By assumption, G<subscriptğºG_{{}_{<}} and\nG=subscriptğºG_{{}_{=}} are properly colored, G<subscriptğºG_{{}_{<}} and G>subscriptğºG_{{}_{>}} are cographs, and\n(â„›Sâ€‹(ğ’¢),â„±Sâ€‹(ğ’¢))subscriptâ„›ğ‘†ğ’¢subscriptâ„±ğ‘†ğ’¢(\\mathscr{R}_{S}(\\mathscr{G}),\\mathscr{F}_{S}(\\mathscr{G})) is consistent. Extraction of\nâ„›â‰”â„›Sâ€‹(ğ’¢)â‰”â„›subscriptâ„›ğ‘†ğ’¢\\mathscr{R}\\coloneqq\\mathscr{R}_{S}(\\mathscr{G}) and â„±â‰”â„±Sâ€‹(ğ’¢)â‰”â„±subscriptâ„±ğ‘†ğ’¢\\mathscr{F}\\coloneqq\\mathscr{F}_{S}(\\mathscr{G}) according to\nDef.Â 6 requires Oâ€‹(|L|3)ğ‘‚superscriptğ¿3O(|L|^{3}) operations.\nAs argued in the proof of CorollaryÂ 8, a tree Sğ‘†S on Mğ‘€M that\nagrees with (â„›,â„±)â„›â„±(\\mathscr{R},\\mathscr{F}) can be constructed in Oâ€‹(|L|4â€‹logâ¡|L|)ğ‘‚superscriptğ¿4ğ¿O(|L|^{4}\\log|L|) time using algorithm MTT [ref]29. A suitable time map Ï„Ssubscriptğœğ‘†\\tau_{S} can be constructed in Oâ€‹(|M|)=Oâ€‹(|L|)ğ‘‚ğ‘€ğ‘‚ğ¿O(|M|)=O(|L|) time by LemmaÂ 1. We can employ the LCA data structure described by\nBender et al.Â ,\nwhich pre-processes Sğ‘†S in Oâ€‹(|M|)=Oâ€‹(|L|)ğ‘‚ğ‘€ğ‘‚ğ¿O(|M|)=O(|L|) time to\nallow Oâ€‹(1)ğ‘‚1O(1)-query of the last common ancestor of pairs of vertices in\nSğ‘†S afterwards. In addition, we want to access the vertex\nwâˆˆchildSâ¡(u)ğ‘¤subscriptchildğ‘†ğ‘¢w\\in\\operatorname{child}_{S}(u) satisfying vâª¯Swsubscriptprecedes-or-equalsğ‘†ğ‘£ğ‘¤v\\preceq_{S}w for two given vertices\nu,vâˆˆVâ€‹(T)ğ‘¢ğ‘£ğ‘‰ğ‘‡u,v\\in V(T) with vâ‰ºSusubscriptprecedesğ‘†ğ‘£ğ‘¢v\\prec_{S}u. To achieve this, we pre-process Sğ‘†S as\nfollows: We first compute depthâ¡(v)depthğ‘£\\operatorname{depth}(v) for each vâˆˆVâ€‹(T)ğ‘£ğ‘‰ğ‘‡v\\in V(T), i.e., the\nnumber of edges on the path from the root to vğ‘£v in a top-down traversal\nof Sğ‘†S in Oâ€‹(|L|)ğ‘‚ğ¿O(|L|) time. The Level Ancestor (LA)\nProblem asks for the ancestor LAâ¡(v,d)LAğ‘£ğ‘‘\\operatorname{LA}(v,d) of a given vertex vğ‘£v that has\ndepth dğ‘‘d, and has solutions with Oâ€‹(|L|)ğ‘‚ğ¿O(|L|) pre-processing and\nOâ€‹(1)ğ‘‚1O(1) query time  . Hence, we can obtain the\ndesired vertex wğ‘¤w as LAâ¡(v,depthâ¡(u)+1)LAğ‘£depthğ‘¢1\\operatorname{LA}(v,\\operatorname{depth}(u)+1) in constant time. Since Ïƒâ€‹(Lâ€²)âŠ†Lâ€‹(Sâ€‹(uS))ğœsuperscriptğ¿â€²ğ¿ğ‘†subscriptğ‘¢ğ‘†\\sigma(L^{\\prime})\\subseteq L(S(u_{S})) always holds by\nObs.Â 2, every xâˆˆLğ‘¥ğ¿x\\in L appears at most once in a\nloop corresponding to LineÂ 9. Hence, the total\neffort of handling the cases where uSsubscriptğ‘¢ğ‘†u_{S} is a leaf is bounded by Oâ€‹(|L|)ğ‘‚ğ¿O(|L|). Consider now one execution of BuildGeneTree (without\nthe recursive calls) in which uSsubscriptğ‘¢ğ‘†u_{S} is not a leaf. Construction of the\nauxiliary graphs H1subscriptğ»1H_{1} and H2subscriptğ»2H_{2} is done in Oâ€‹(|Lâ€²|2)ğ‘‚superscriptsuperscriptğ¿â€²2O(|L^{\\prime}|^{2}), where\nthe condition Ïƒâ€‹(x),Ïƒâ€‹(y)â‰ºSvsubscriptprecedesğ‘†ğœğ‘¥ğœğ‘¦ğ‘£\\sigma(x),\\sigma(y)\\prec_{S}v for some vâˆˆchildSâ¡(uS)ğ‘£subscriptchildğ‘†subscriptğ‘¢ğ‘†v\\in\\operatorname{child}_{S}(u_{S}) in the construction of H2subscriptğ»2H_{2} is equivalent to querying the\nLCA data structure in Oâ€‹(1)ğ‘‚1O(1) time whether lcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))â‰ uSsubscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))\\neq u_{S}. The connected components of H1subscriptğ»1H_{1} can be obtained in Oâ€‹(|Lâ€²|+|Eâ€‹(H1)|)=Oâ€‹(|Lâ€²|2)ğ‘‚superscriptğ¿â€²ğ¸subscriptğ»1ğ‘‚superscriptsuperscriptğ¿â€²2O(|L^{\\prime}|+|E(H_{1})|)=O(|L^{\\prime}|^{2}) time using\nbreadth-first search. Since H2subscriptğ»2H_{2} is a subgraph of H1subscriptğ»1H_{1}, we can, for\neach connected component Cisubscriptğ¶ğ‘–C_{i} of H1subscriptğ»1H_{1}, determine the connected\ncomponents Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2} with CjâŠ†Cisubscriptğ¶ğ‘—subscriptğ¶ğ‘–C_{j}\\subseteq C_{i} again using\nbreadth-first search and only the vertices in Cisubscriptğ¶ğ‘–C_{i} as start vertices.\nThe overall effort for this is again bounded by Oâ€‹(|Lâ€²|+|Eâ€‹(H1)|)=Oâ€‹(|Lâ€²|2)ğ‘‚superscriptğ¿â€²ğ¸subscriptğ»1ğ‘‚superscriptsuperscriptğ¿â€²2O(|L^{\\prime}|+|E(H_{1})|)=O(|L^{\\prime}|^{2}). We can now, for each connected\ncomponent Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2}, construct the connected components Cksubscriptğ¶ğ‘˜C_{k} of\nH3subscriptğ»3H_{3} with CkâŠ†Cjsubscriptğ¶ğ‘˜subscriptğ¶ğ‘—C_{k}\\subseteq C_{j} by (i) adding the edge xâ€‹yğ‘¥ğ‘¦xy to H3subscriptğ»3H_{3} if\nlcaSâ¡(Ïƒâ€‹(x),Ïƒâ€‹(y))â‰ uSsubscriptlcağ‘†ğœğ‘¥ğœğ‘¦subscriptğ‘¢ğ‘†\\operatorname{lca}_{S}(\\sigma(x),\\sigma(y))\\neq u_{S} for all x,yâˆˆCjğ‘¥ğ‘¦subscriptğ¶ğ‘—x,y\\in C_{j} and (ii)\nperforming breadth-first search on H3subscriptğ»3H_{3} using only the vertices in Cjsubscriptğ¶ğ‘—C_{j}\nas start vertices. Again, the overall effort for these breadth-first\nsearches is bounded by Oâ€‹(|Lâ€²|2)ğ‘‚superscriptsuperscriptğ¿â€²2O(|L^{\\prime}|^{2}). The number of connected\ncomponent of the three graph H1subscriptğ»1H_{1}, H2subscriptğ»2H_{2}, and H3subscriptğ»3H_{3} is bounded by\nOâ€‹(|Lâ€²|)ğ‘‚superscriptğ¿â€²O(|L^{\\prime}|). For each connected component Cjsubscriptğ¶ğ‘—C_{j} of H2subscriptğ»2H_{2}, we\nhave to choose vSâˆ—âˆˆchildSâ¡(uS)subscriptsuperscriptğ‘£ğ‘†subscriptchildğ‘†subscriptğ‘¢ğ‘†v^{*}_{S}\\in\\operatorname{child}_{S}(u_{S}) such that Ïƒâ€‹(Cj)âˆ©Lâ€‹(Sâ€‹(vSâˆ—))â‰ âˆ…ğœsubscriptğ¶ğ‘—ğ¿ğ‘†subscriptsuperscriptğ‘£ğ‘†\\sigma(C_{j})\\cap L(S(v^{*}_{S}))\\neq\\emptyset in LineÂ 19. To this end, we\npick xâˆˆCjğ‘¥subscriptğ¶ğ‘—x\\in C_{j} arbitrarily and query vSâˆ—=LAâ¡(Ïƒâ€‹(x),depthâ¡(uS)+1)subscriptsuperscriptğ‘£ğ‘†LAğœğ‘¥depthsubscriptğ‘¢ğ‘†1v^{*}_{S}=\\operatorname{LA}(\\sigma(x),\\operatorname{depth}(u_{S})+1). For each connected component Cksubscriptğ¶ğ‘˜C_{k} of H3subscriptğ»3H_{3}, we can\nfind vSâˆˆchildSâ¡(uS)subscriptğ‘£ğ‘†subscriptchildğ‘†subscriptğ‘¢ğ‘†v_{S}\\in\\operatorname{child}_{S}(u_{S}) such that Ïƒâ€‹(Ck)âŠ†Lâ€‹(Sâ€‹(vS))ğœsubscriptğ¶ğ‘˜ğ¿ğ‘†subscriptğ‘£ğ‘†\\sigma(C_{k})\\subseteq L(S(v_{S}))\nin LineÂ 22 in the same way. In summary, for\neach connected component of each graph, the effort of creating a new\nvertex (in case of H1subscriptğ»1H_{1} and H2subscriptğ»2H_{2}), attaching the vertex to the tree\n(H1subscriptğ»1H_{1}, H2subscriptğ»2H_{2}, and H3subscriptğ»3H_{3}), choosing vSâˆ—subscriptsuperscriptğ‘£ğ‘†v^{*}_{S} in LineÂ 19\n(H2subscriptğ»2H_{2}), choosing vSsubscriptğ‘£ğ‘†v_{S} in LineÂ 22 (H3subscriptğ»3H_{3}),\nand assigning the values for Ï„Tsubscriptğœğ‘‡\\tau_{T} and Î¼ğœ‡\\mu for the newly created\nvertices are all constant-time operations. The overall effort for one\nrecursion step (excluding the recursive calls) is therefore bounded by\nOâ€‹(|Lâ€²|2)ğ‘‚superscriptsuperscriptğ¿â€²2O(|L^{\\prime}|^{2}). To bound the total effort of BuildGeneTree, consider the\nrecursion tree Rğ‘…R of the algorithm and let dğ‘‘d be its maximum depth\n(i.e.Â the maximum distance from ÏRsubscriptğœŒğ‘…\\rho_{R} to a leaf). Notice that when a\nrecursion receives uSâˆˆVâ€‹(S)subscriptğ‘¢ğ‘†ğ‘‰ğ‘†u_{S}\\in V(S) as input, it passes a child of uSsubscriptğ‘¢ğ‘†u_{S} to\nany recursive call that it makes. Since terminal calls occur on leaves\nof Sğ‘†S, it follows that dğ‘‘d is at most the height of Sğ‘†S, which is\nOâ€‹(|Vâ€‹(S)|)=Oâ€‹(|L|)ğ‘‚ğ‘‰ğ‘†ğ‘‚ğ¿O(|V(S)|)=O(|L|) under the assumption that Ïƒğœ\\sigma\nis surjective. For râˆˆVâ€‹(R)ğ‘Ÿğ‘‰ğ‘…r\\in V(R), denote by Lrâ€²subscriptsuperscriptğ¿â€²ğ‘ŸL^{\\prime}_{r} the set Lâ€²superscriptğ¿â€²L^{\\prime} received\nas input on the recursive call corresponding to rğ‘Ÿr. If rğ‘Ÿr is not a\nleaf of Rğ‘…R, then notice that {Lqâ€²:qâˆˆchildRâ¡(r)}conditional-setsubscriptsuperscriptğ¿â€²ğ‘ğ‘subscriptchildğ‘…ğ‘Ÿ\\{L^{\\prime}_{q}:q\\in\\operatorname{child}_{R}(r)\\} is a\npartition of Lrâ€²subscriptsuperscriptğ¿â€²ğ‘ŸL^{\\prime}_{r} (without repeated subsets), since a recursive call is\nmade precisely for each connected component of H3subscriptğ»3H_{3}. Let â„“âˆˆ{0,1,â€¦,d}â„“01â€¦ğ‘‘\\ell\\in\\{0,1,\\ldots,d\\}. We claim that for any two vertices r,qâˆˆVâ€‹(R)ğ‘Ÿğ‘ğ‘‰ğ‘…r,q\\in V(R) at distance â„“â„“\\ell from ÏRsubscriptğœŒğ‘…\\rho_{R}, Lrâ€²âˆ©Lqâ€²=âˆ…subscriptsuperscriptğ¿â€²ğ‘Ÿsubscriptsuperscriptğ¿â€²ğ‘L^{\\prime}_{r}\\cap L^{\\prime}_{q}=\\emptyset. This can be seen by induction, with â„“=0â„“0\\ell=0 as the\ntrivial base case. Consider â„“>0â„“0\\ell>0. If rğ‘Ÿr and qğ‘q have the same\nparent, then Lrâ€²âˆ©Lqâ€²=âˆ…subscriptsuperscriptğ¿â€²ğ‘Ÿsubscriptsuperscriptğ¿â€²ğ‘L^{\\prime}_{r}\\cap L^{\\prime}_{q}=\\emptyset follows from the observation\nthat recursions partition their input Lâ€²superscriptğ¿â€²L^{\\prime} to their child calls. If rğ‘Ÿr\nand qğ‘q have distinct parents in Rğ‘…R, we know by induction that\nLpâ€‹aâ€‹rRâ€‹(r)â€²âˆ©Lpâ€‹aâ€‹rRâ€‹(q)â€²=âˆ…subscriptsuperscriptğ¿â€²ğ‘ğ‘subscriptğ‘Ÿğ‘…ğ‘Ÿsubscriptsuperscriptğ¿â€²ğ‘ğ‘subscriptğ‘Ÿğ‘…ğ‘L^{\\prime}_{par_{R}(r)}\\cap L^{\\prime}_{par_{R}(q)}=\\emptyset. Since recursions pass a\nsubset of their input Lâ€²superscriptğ¿â€²L^{\\prime}, Lrâ€²âˆ©Lqâ€²=âˆ…subscriptsuperscriptğ¿â€²ğ‘Ÿsubscriptsuperscriptğ¿â€²ğ‘L^{\\prime}_{r}\\cap L^{\\prime}_{q}=\\emptyset holds as well.\nThus our claim is true. Now, for a given depth â„“âˆˆ{0,1,â€¦,d}â„“01â€¦ğ‘‘\\ell\\in\\{0,1,\\ldots,d\\}, denote by r1,â€¦,rksubscriptğ‘Ÿ1â€¦subscriptğ‘Ÿğ‘˜r_{1},\\ldots,r_{k} the set of vertices of\nRğ‘…R at distance â„“â„“\\ell from ÏRsubscriptğœŒğ‘…\\rho_{R}. The total effort of these vertices\nis Oâ€‹(|Lr1â€²|2+â€¦+|Lrkâ€²|2)ğ‘‚superscriptsubscriptsuperscriptğ¿â€²subscriptğ‘Ÿ12â€¦superscriptsubscriptsuperscriptğ¿â€²subscriptğ‘Ÿğ‘˜2O(|L^{\\prime}_{r_{1}}|^{2}+\\ldots+|L^{\\prime}_{r_{k}}|^{2}) and, since\n|Lr1â€²|+â€¦+|Lrkâ€²|â‰¤|L|subscriptsuperscriptğ¿â€²subscriptğ‘Ÿ1â€¦subscriptsuperscriptğ¿â€²subscriptğ‘Ÿğ‘˜ğ¿|L^{\\prime}_{r_{1}}|+\\ldots+|L^{\\prime}_{r_{k}}|\\leq|L| by\nour claim, the total time spent at depth â„“â„“\\ell is Oâ€‹(|L|2)ğ‘‚superscriptğ¿2O(|L|^{2}).\nBecause this holds for every depth from 00 to dâˆˆOâ€‹(|L|)ğ‘‘ğ‘‚ğ¿d\\in O(|L|),\nthe total time spent in BuildGeneTree is Oâ€‹(|L|3)ğ‘‚superscriptğ¿3O(|L|^{3}). It only remains to argue on the time spent constructing the final output\ntree Tğ‘‡T. Note that in each recursion with corresponding vertex râˆˆVâ€‹(R)ğ‘Ÿğ‘‰ğ‘…r\\in V(R), BuildGeneTree adds at most 2â€‹|Lrâ€²|+12subscriptsuperscriptğ¿â€²ğ‘Ÿ12|L^{\\prime}_{r}|+1 nodes to\nthe constructed tree Tâ€²superscriptğ‘‡â€²T^{\\prime} (we always add Ïâ€²superscriptğœŒâ€²\\rho^{\\prime} and, additionally, in\nnon-terminal calls, we add one uisubscriptğ‘¢ğ‘–u_{i} and one vjsubscriptğ‘£ğ‘—v_{j} vertex for each of the\nOâ€‹(|Lrâ€²|)ğ‘‚subscriptsuperscriptğ¿â€²ğ‘ŸO(|L^{\\prime}_{r}|) connected components of H1subscriptğ»1H_{1} and H2subscriptğ»2H_{2},\nrespectively, and in terminal calls we add |Lrâ€²|subscriptsuperscriptğ¿â€²ğ‘Ÿ|L^{\\prime}_{r}| leaves).\nSince the vertices of Rğ‘…R at the same depth â„“â„“\\ell receive pairwise\ndisjoint Lrâ€²subscriptsuperscriptğ¿â€²ğ‘ŸL^{\\prime}_{r} sets, it follows that a total of at most Oâ€‹(|L|)ğ‘‚ğ¿O(|L|) vertices are added to Tğ‘‡T by the recursive calls at the same\ndepth â„“â„“\\ell. Since dâˆˆOâ€‹(|L|)ğ‘‘ğ‘‚ğ¿d\\in O(|L|), the resulting tree Tâ€²superscriptğ‘‡â€²T^{\\prime} has\nat most Oâ€‹(|L|2)ğ‘‚superscriptğ¿2O(|L|^{2}) vertices. To obtain the final gene tree Tğ‘‡T,\nwe can traverse Tâ€²superscriptğ‘‡â€²T^{\\prime} and suppress all vertices with a single child by\nremoving the vertex and reconnecting its child to its parent in (O(|V(Tâ€²)|)=O(|L|2)(O(|V(T^{\\prime})|)=O(|L|^{2}) total time. Hence, the overall time complexity of AlgorithmÂ 1 is\nOâ€‹(|L|4â€‹logâ¡|L|)ğ‘‚superscriptğ¿4ğ¿O(|L|^{4}\\log|L|).\nâˆ\n\nReference markers found: [29]\n\nContext windows for each [ref]:\n[ref]29: By construction, we have |Mâ€²|âˆˆOâ€‹(|L|)superscriptğ‘€â€²ğ‘‚ğ¿|M^{\\prime}|\\in O(|L|). The algorithm MTT, which stands for\nmixed triplets problem restricted to trees and was described in\n[ref]29, constructs a tree on Mâ€²superscriptğ‘€â€²M^{\\prime} that agrees with (â„›,â„±)â„›â„±(\\mathscr{R},\\mathscr{F}), if\none exists, in\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 29,\n            \"titles\": [\n                \"Biologically Feasible Gene Trees, Reconciliation Maps and Informative Triples\",\n                \"Inferring a tree from lowest common ancestors with an application to the optimization of relational expressions\",\n                \"Efficient algorithms for the reconciliation problem with gene duplication, horizontal transfer and loss\",\n                \"The level ancestor problem simplified\",\n                \"Lowest common ancestors in trees and directed acyclic graphs\",\n                \"FÃ¤rbung von Graphen, deren sÃ¤mtliche bzw. deren ungerade Kreise starr sind (Zusammenfassung)\",\n                \"Finding level-ancestors in trees\",\n                \"The ancestor of modern Holozoa acquired the CCA-adding enzyme from Alphaproteobacteria by horizontal gene transfer\",\n                \"Pattern matching for permutations\",\n                \"Extension operations on sets of leaf-labelled trees\",\n                \"Recognizing Berge graphs\",\n                \"The strong perfect graph theorem\",\n                \"Decomposition of odd-hole-free graphs by double star cutsets and 2-joins\",\n                \"Complement reducible graphs\",\n                \"A linear recognition algorithm for cographs\",\n                \"Xenolog classification\",\n                \"PhyloSift: phylogenetic analysis of genomes and metagenomes\",\n                \"Reconstruction methods for derivation trees\",\n                \"Distinguishing homologous from analogous proteins\",\n                \"Homology: a personal view on some of the problems\",\n                \"A method for investigating relative timing information on phylogenetic trees\",\n                \"Transitiv orientierbare graphen\",\n                \"Reconstructing Gene Trees From Fitchâ€™s Xenology Relation\",\n                \"Best Match Graphs and Reconciliation of Gene Trees with Species Trees\",\n                \"Reciprocal best match graphs\",\n                \"H-trees: a model of evolutionary scenarios with horizontal gene transfer\",\n                \"Evolution of antibiotic resistance genes: The DNA sequence of a kanamycin resistance gene from Staphylococcus aureus\",\n                \"Reconstruction of ancient molecular phylogeny\",\n                \"Complete Edge-Colored Permutation Graphs\",\n                \"Inferring phylogenetic relationships avoiding forbidden rooted triplets\",\n                \"Alternative characterizations of Fitchâ€™s xenology relation\",\n                \"On Symbolic Ultrametrics, Cotree Representations, and Cograph Edge Decompositions and Partitions\",\n                \"From sequence data incl. orthologs, paralogs, and xenologs to gene and species trees\",\n                \"On tree representations of relations and graphs: Symbolic ultrametrics and cograph edge decompositions\",\n                \"Orthology relations, symbolic ultrametrics, and cographs\",\n                \"A Short Note on Undirected Fitch Graphs\",\n                \"From event-labeled gene trees to species trees\",\n                \"A new characterization of P6subscriptğ‘ƒ6P_{6}-free graphs\",\n                \"Determining the consistency of resolved triplets and fan triplets\",\n                \"Orthology and paralogy constraints: satisfiability and consistency\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]29 based on the context and research area of Relative Timing Information and Orthology in Evolutionary Scenarios. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}