{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Geometric algorithms for sampling the flux space of metabolic networks\n\nPaper Abstract: \n\nPaper Section Text:\nEfficient uniform random sampling on polytopes resulting from metabolic\nnetworks is a very challenging task both from the theoretical (algorithmic)\nand the engineering (implementation) point of view.\nFirst, the dimension of the polytopes is of the order of certain thousands. This\nrequires, for example, advanced engineering techniques to cope with memory\nrequirements and to perform linear algebra operations with large matrices;\ne.g., in\nRecon3D  we compute the null space of a\n8 399×13 5438399135438\\,399\\times 13\\,543 matrix. Second, the polytopes are rather skinny\n(Sec. 4); this makes it harder for sampling algorithms to\nmove in the interior of polytopes and calls for novel practical techniques to\nsample. There is extended on-going research concerning advanced algorithms and\nimplementations for sampling metabolic networks over the last decades. Markov\nChain Monte Carlo algorithms such as Hit-and-Run (HR)  have been\nwidely used to address the challenges of sampling. Two variants of HR are the\nnon-Markovian Artificial Centering Hit-and-Run\n(ACHR)  that has been widely used in sampling\nmetabolic models, e.g., , and Coordinate Hit-and-Run with Rounding\n(CHRR) .\nThe latter is part of the cobra toolbox , the most commonly used software package for the analysis of metabolic networks.\nCHRR enables sampling from complex metabolic\nnetwork corresponding to the highest dimensional polytopes so far. There are\nalso stochastic formulations where the inclusion of experimental noise in the\nmodel makes it more compatible with the stochastic nature of biological\nnetworks . The recent study in \noffers an overview as well as an experimental comparison of the currently\navailable samplers. These implementations played a crucial role in actually performing in practice\nuniform sampling from the flux space. However, they are currently limited to\nhandle polytopes of dimension say ≤2 500absent2500\\leq 2\\,500  . This is also the order of magnitude of the most\ncomplicated, so far, metabolic network model built,\nRecon3D . By including 13 5431354313\\,543 metabolic reactions and\ninvolving 4 14041404\\,140 unique metabolites, Recon3D provides a representation of the\n17%percent1717\\% of the functionally of annotated human genes. To our knowledge, there is\nno method that can efficiently handle sampling from the flux space of Recon3D. Apparently, the dimension of the polytopes will keep rising and not only for the ones corresponding to human metabolic networks.\nMetabolism governs systems biology at all its levels, including the one of the community.\nThus, we are not only interested in sampling a sole metabolic network, even if it has the challenges of the human.\nSampling in polytopes associated to network of networks are the next big thing in metabolic networks analysis and in Systems Biology  8. Regarding the sampling process, from the theoretical point of view, we are\ninterested in the convergence time, or mixing time, of the Markov Chain,\nor geometric random walk, to the target distribution. Given a\nd𝑑d-dimensional polytope P𝑃P, the mixing time of several geometric random walks\n(e.g., HR or Ball Walk) grows quadratically with respect to the sandwiching\nratio R/r𝑅𝑟R/r of the polytope  . Here r𝑟r and R𝑅R are the\nradii of the smallest and largest ball with center the origin that contains, and\nis contained, in P𝑃P, respectively; i.e., r​Bd⊆P⊆R​Bd𝑟subscript𝐵𝑑𝑃𝑅subscript𝐵𝑑rB_{d}\\subseteq P\\subseteq RB_{d},\nwhere Bdsubscript𝐵𝑑B_{d} is the unit ball. It is crucial to reduce R/r𝑅𝑟R/r, i.e., to put P𝑃P in\nwell a rounded position where R/r=𝒪~​(d)𝑅𝑟~𝒪𝑑R/r=\\widetilde{\\mathcal{O}}(\\sqrt{d}); the 𝒪~​(⋅)~𝒪⋅\\widetilde{\\mathcal{O}}(\\cdot) notation\nmeans that we are ignoring polylogarithmic factors. A powerful approach to\nobtain well roundness is to put P𝑃P in near isotropic position. In\ngeneral, K⊂ℝd𝐾superscriptℝ𝑑K\\subset{\\mathbb{R}}^{d} is in isotropic position if the uniform distribution\nover K𝐾K is in isotropic position, that is 𝔼X∼K​[X]=0subscript𝔼similar-to𝑋𝐾delimited-[]𝑋0\\mathbb{E}_{X\\sim K}[X]=0 and\n𝔼X∼K​[XT​X]=Idsubscript𝔼similar-to𝑋𝐾delimited-[]superscript𝑋𝑇𝑋subscript𝐼𝑑\\mathbb{E}_{X\\sim K}[X^{T}X]=I_{d}, where Idsubscript𝐼𝑑I_{d} is the d×d𝑑𝑑d\\times d identity\nmatrix. Thus, to put a polytope P𝑃P into isotropic position one has to generate\na set of uniform points in its interior and apply to P𝑃P the transformation that\nmaps the point-set to isotropic position; then iterate this procedure until P𝑃P\nis in c𝑐c-isotropic position  , for a constant c𝑐c.\nIn  they prove that 𝒪​(d)𝒪𝑑\\mathcal{O}(d) points suffice to achieve\n222-isotropic position. Alternatively in  they\ncompute the maximum volume ellipsoid in P𝑃P, they map it to the unit ball, and\nthen apply to P𝑃P the same transformation. They experimentally show that a few\niterations suffice to put P𝑃P in John’s position . Moreover, there\nare a few algorithmic contributions that combine sampling with distribution\nisotropization steps, e.g., the multi-point walk  and the\nannealing schedule . An important parameter of a random walk is the walk length, i.e., the number of the intermediate points that a random walk visits before producing a single sample point.\nThe longer the walk length of a random walk is, the smaller the distance of the current distribution to the stationary (target) distribution becomes.\nFor the majority of random walks there are bounds on the walk length to bound the mixing time with respect to a statistical distance. For example, HR generates a sample from a distribution with total variation distance less than ϵitalic-ϵ\\epsilon from the target distribution after 𝒪~​(d3)~𝒪superscript𝑑3\\widetilde{\\mathcal{O}}(d^{3})  steps, in a well rounded convex body and for log-concave distributions. Similarly, CDHR mixes after a polynomial, in the diameter and the dimension, number of steps [ref]34 2 for the case of uniform distribution. However, extended practical results have shown that both CDHR and HR converges after 𝒪​(d2)𝒪superscript𝑑2\\mathcal{O}(d^{2}) steps 0  . The leading algorithms for uniform polytope sampling are the Riemannian Hamiltonian Monte Carlo sampler  and the Vaidya walk 3, with mixing\ntimes 𝒪~​(m​d2/3)~𝒪𝑚superscript𝑑23\\widetilde{\\mathcal{O}}(md^{2/3}) and 𝒪~​(m1/2​d3/2)~𝒪superscript𝑚12superscript𝑑32\\widetilde{\\mathcal{O}}(m^{1/2}d^{3/2}) steps, respectively.\nHowever, it is not clear if these random walks can outperform CDHR in practice,\nbecause of their high cost per step and numerical instability. Billiard Walk (BW)  is a random walk that employs linear\ntrajectories in a convex body with boundary reflections; alas with an unknown\nmixing time. The closest guarantees for its mixing time are those of HR and\nstochastic billiards 7. Interestingly,  shows\nthat, experimentally, BW converges faster than HR for a proper tuning of its\nparameters. The same conclusion follows from the computation of the volume of\nzonotopes 1. It is not known how the sandwiching ratio of P𝑃P\naffects the mixing time of BW. Since BW employs reflections on the boundary,\nwe can consider it as a special case of Reflective Hamiltonian Monte Carlo 4. For almost all random walks the theoretical bounds on their mixing times are\npessimistic and unrealistic for computations. Hence,\nif we terminate the random walk earlier, we generate samples that are usually highly correlated.\nThere are several MCMC Convergence Diagnostics 0 to check\nif the quality of a sample can provide an accurate\napproximation of the target distribution. For a dependent sample, a powerful\ndiagnostic is the Effective Sample Size (ESS). It is the number of\neffectively independent draws from the target distribution that the Markov chain\nis equivalent to. For autocorrelated samples, ESS bounds\nthe uncertainty in estimates  and provides information about\nthe quality of the sample. There are several statistical tests to evaluate the quality of a generated sample, e.g., potential scale reduction factor (PSRF) 9, maximum mean discrepancy (MMD) ,\nand the uniform tests 5.\nInterestingly,\nthe copula representation we employ in Fig. 2 to capture the dependence between two fluxes of reactions was also used successfully in a geometric framework to detect financial crises capturing the dependence between portfolio return and volatility [ref]9.\n\nReference markers found: [34]\n\nContext windows for each [ref]:\n[ref]34: steps, in a well rounded convex body and for log-concave distributions. Similarly, CDHR mixes after a polynomial, in the diameter and the dimension, number of steps [ref]34 2 for the case of uniform distribution. However, extended practical results have shown that both CDHR and HR converges after 𝒪​(d2)𝒪superscript𝑑2\\mathcal{O}(d^{2}) steps 0  . The leading\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 34,\n            \"titles\": [\n                \"Convergence Rate of Riemannian Hamiltonian Monte Carlo and Faster Polytope Volume Computation\",\n                \"Quantitative estimates of the convergence of the empirical covariance matrix in log-concave ensembles\",\n                \"The MOSEK optimization toolbox for R manual. Version 9.2.\",\n                \"On radial isotropic position: Theory and algorithms\",\n                \"Metabolic network percolation quantifies biosynthetic capabilities across the human oral microbiome\",\n                \"Solving convex programs by random walks\",\n                \"Sampling the solution space in genome-scale metabolic networks reveals transcriptional regulation in key enzymes\",\n                \"Recon3D enables a three-dimensional view of gene variation in human metabolism\",\n                \"A new metabolomics analysis technique: steady-state metabolic network dynamics analysis\",\n                \"Practical Volume Computation of Structured Convex Bodies, and an Application to Modeling Portfolio Dependencies and Financial Crises\",\n                \"Practical volume estimation by a new annealing schedule for cooling convex bodies\",\n                \"Practical volume estimation of zonotopes by a new annealing schedule for cooling convex bodies\",\n                \"volesti: Volume Approximation and Sampling for Convex Polytopes in R\",\n                \"Fast mcmc sampling algorithms on polytopes\",\n                \"Hamiltonian Monte Carlo with boundary reflections, and application to polytope volume calculations\",\n                \"Efficient high-dimensional sampling and integration\",\n                \"A practical volume algorithm\",\n                \"Stochastic billiards for sampling from the boundary of a convex set\",\n                \"A comparison of Monte Carlo sampling methods for metabolic network models\",\n                \"Inference from Iterative Simulation Using Multiple Sequences\",\n                \"Practical Markov chain Monte Carlo\",\n                \"A kernel two-sample test\",\n                \"Random sampling: Billiard walk algorithm\",\n                \"Eigen v3\",\n                \"CHRR: coordinate hit-and-run with rounding for uniform sampling of constraint-based models\",\n                \"Creation and analysis of biochemical constraint-based models using the cobra toolbox v. 3.0\",\n                \"Matrix Computations\",\n                \"A new approach to decoding life: systems biology\",\n                \"Extremum Problems with Inequalities as Subsidiary Conditions\",\n                \"Simulated annealing for convex optimization\",\n                \"Direction choice for accelerated convergence in hit-and-run sampling\",\n                \"Bigg models: A platform for integrating, standardizing and sharing genome-scale models\",\n                \"Systems biology: a textbook\",\n                \"Systems biology: an approach\",\n                \"Convergence of Gibbs Sampling: Coordinate Hit-and-Run Mixes Fast\",\n                \"Random walks and an O∗​(n5)superscript𝑂superscript𝑛5{O}^{*}(n^{5}) volume algorithm for convex bodies\",\n                \"Simulated annealing in convex bodies and an O∗​(n4)superscript𝑂superscript𝑛4{O}^{*}(n^{4}) volume algorithms\",\n                \"Improving the accuracy of flux balance analysis through the implementation of carbon availability constraints for intracellular reactions\",\n                \"Robust analysis of fluxes in genome-scale metabolic pathways\",\n                \"Fast automated reconstruction of genome-scale metabolic models for microbial species and communities\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]34 based on the context and research area of Geometric algorithms for sampling the flux space of metabolic networks. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}