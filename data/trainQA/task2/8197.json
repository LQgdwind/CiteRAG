{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: A survey of Zarankiewicz problem in geometry\n\nPaper Abstract: \n\nPaper Section Text:\nLet us consider the natural generalization of Zarankiewicz’s problem in r𝑟r-uniform hypergraphs. These are hypergraphs where each hyperedge has cardianlity r𝑟r.\nFor a given r𝑟r-uniform H𝐻H Let e​xr​(n,H)𝑒superscript𝑥𝑟𝑛𝐻ex^{r}(n,H) denote the maximum number of hyperedges that an r𝑟r-uniform hypergraph on n𝑛n vertices can have if it does not contain a (not necessarily induced) copy isomorphic to H𝐻H. Let Kt,t,…,trsubscriptsuperscript𝐾𝑟𝑡𝑡…𝑡K^{r}_{t,t,\\ldots,t}\ndenote the complete r𝑟r-partite r𝑟r-uniform hypergraph with all parts having size t𝑡t. Obtain sharp asymptotic bounds on e​xr​(n,Kt,t,…,tr)𝑒superscript𝑥𝑟𝑛subscriptsuperscript𝐾𝑟𝑡𝑡…𝑡ex^{r}(n,K^{r}_{t,t,\\ldots,t}). In 1964 Erdős  obtained the following generalization of Theorem 1.6: He also showed that this bound is not far from being optimal for general hypergraphs.\nNamely, he showed that there exists an absolute constant C𝐶C (independent of n,t,r𝑛𝑡𝑟n,t,r) such that This version of Zarankiewicz problem seems much harder already for r=3𝑟3r=3 even for natural geometrically defined hypergraphs.\nRecently, improved bounds were obtained for several r𝑟r-partite hypergraphs that arise in geometry    .\nFor example Mustafa and Pach generalized the result of Fox and Pach  for any r𝑟r-uniform intersection hypergraph of r−1𝑟1r-1-dimensional simplices in ℝrsuperscriptℝ𝑟\\mathbb{R}^{r}. They prove: Let d,t≥2𝑑𝑡2d,t\\geq 2 be integers and let S𝑆S be a set of n𝑛n d−1𝑑1d-1-dimensional simplices in ℝdsuperscriptℝ𝑑\\mathbb{R}^{d} and let\nH𝐻H be there d𝑑d-uniform intersection hypergraph. Namely, H𝐻H consists of all unordered d𝑑d tupples {s1,…,sd}⊂Ssubscript𝑠1…subscript𝑠𝑑𝑆\\{s_{1},...,s_{d}\\}\\subset S with s1∩…∩sd≠∅subscript𝑠1…subscript𝑠𝑑s_{1}\\cap...\\cap s_{d}\\neq\\emptyset. If H𝐻H does not contain Kt,t,…,tdsubscriptsuperscript𝐾𝑑𝑡𝑡…𝑡K^{d}_{t,t,\\ldots,t} then its number of hyperedges is bounded by O​(nd−1+ε)𝑂superscript𝑛𝑑1𝜀O(n^{d-1+{\\varepsilon}}) for any ε>0𝜀0{\\varepsilon}>0. Note that the case d=2𝑑2d=2 is the special setting of Kt,tsubscript𝐾𝑡𝑡K_{t,t}-free intersection graph of line segments which was proved by Fox and Pach  to have O​(n)𝑂𝑛O(n) edges, a bound that they later generalized to arbitrary string graphs  .\nNote also that the above bound is near-optimal. We leave it as an exercise to see that there are such hypergraphs avoiding Kt,t,…,tdsubscriptsuperscript𝐾𝑑𝑡𝑡…𝑡K^{d}_{t,t,\\ldots,t} with Ω​(nd−1)Ωsuperscript𝑛𝑑1\\Omega(n^{d-1}) hyperedges. Semi-algebraic hypergraphs\nDo  extended the result on semi-algebraic graphs (that was mentioned in Section 3) of Fox et al. [ref]28 to r𝑟r-uniform r𝑟r-partite hypergraphs:\nFix some positive integers d,t𝑑𝑡d,t. Let H𝐻H be an r𝑟r-uniform r𝑟r-partite hypergraph H=(P1∪…∪Pr,E)𝐻subscript𝑃1…subscript𝑃𝑟𝐸H=(P_{1}\\cup...\\cup P_{r},E) where Pisubscript𝑃𝑖P_{i} is a set of points in ℝdsuperscriptℝ𝑑\\mathbb{R}^{d} for i=1,…,r𝑖1…𝑟i=1,\\ldots,r.\nThere is a natural way to generalize the notion of a semi-algebraic graph with bounded description complexity s𝑠s (that was discussed in Section 3) to r𝑟r-uniform r𝑟r-partite hypergraphs by simply requiring that the underlying polynomials are r⋅d⋅𝑟𝑑r\\cdot d-variate polynomials. Do proved that if such hypergraphs are Kt,t,…,trsubscriptsuperscript𝐾𝑟𝑡𝑡…𝑡K^{r}_{t,t,\\ldots,t}-free then the number of hyperedges is bounded by Or,t,s​(nr−r(r−1)​d+1+ε)subscript𝑂𝑟𝑡𝑠superscript𝑛𝑟𝑟𝑟1𝑑1𝜀O_{r,t,s}(n^{r-\\frac{r}{(r-1)d+1}+{\\varepsilon}}) for every ε>0𝜀0{\\varepsilon}>0. This bound is asymptotically much smaller than the general bound of O​(nr−1tr−1)𝑂superscript𝑛𝑟1superscript𝑡𝑟1O(n^{r-\\frac{1}{t^{r-1}}}) given by Erdős for any t𝑡t satisfying r(r−1)​d+1>1tr−1𝑟𝑟1𝑑11superscript𝑡𝑟1\\frac{r}{(r-1)d+1}>\\frac{1}{t^{r-1}}. Very recently in  these bounds for semi-algebraic hypergraphs were improved by getting rid of the ε𝜀{\\varepsilon} in the exponent of the big-‘O’ notation and also making the dependency on t𝑡t and the description complexity s𝑠s explicit and polynomial. See also the recent paper of Rubin  for related results. Let us consider the natural generalization of the setting discussed in Section 5. That is the r𝑟r-partite r𝑟r-uniform version of intersection hypergraphs in geometry: Let ℱℱ\\mathcal{F} be a family of shapes in ℝdsuperscriptℝ𝑑\\mathbb{R}^{d} (e.g., the family of all balls, all axis-parallel boxes etc).\nLet S1,S2,…,Srsubscript𝑆1subscript𝑆2…subscript𝑆𝑟S_{1},S_{2},\\ldots,S_{r} be r𝑟r finite subsets of ℱℱ\\mathcal{F} each of cardinality n𝑛n. Let H=(S1∪…∪Sr,E)𝐻subscript𝑆1…subscript𝑆𝑟𝐸H=(S_{1}\\cup...\\cup S_{r},E) be the r𝑟r-uniform r𝑟r-partite hypergraph on the vertex set S1∪…∪Srsubscript𝑆1…subscript𝑆𝑟S_{1}\\cup...\\cup S_{r} where an r𝑟r tuple {s1,…,sr}∈S1×⋯×Srsubscript𝑠1…subscript𝑠𝑟subscript𝑆1⋯subscript𝑆𝑟\\{s_{1},...,s_{r}\\}\\in S_{1}\\times\\cdot\\cdot\\cdot\\times S_{r} is a hyperedge (i.e., {s1,…,sr}∈Esubscript𝑠1…subscript𝑠𝑟𝐸\\{s_{1},...,s_{r}\\}\\in E) if and only if s1∩…∩sr≠∅subscript𝑠1…subscript𝑠𝑟s_{1}\\cap...\\cap s_{r}\\neq\\emptyset. How many hyperedges can H𝐻H have if it does not contain a copy of Kt,t,…,trsubscriptsuperscript𝐾𝑟𝑡𝑡…𝑡K^{r}_{t,t,\\ldots,t}? Consider for example the case of ℱℱ\\mathcal{F} being the family of all discs in the plane and r=3𝑟3r=3. Fix an integer t𝑡t. So the setting is as follows: We are given 333 families A,B,C𝐴𝐵𝐶A,B,C each consisting of n𝑛n discs in the plane. Consider the 333-partite 333-uniform hypergraph which hyperedges are all triples a∈A,b∈B,c∈Cformulae-sequence𝑎𝐴formulae-sequence𝑏𝐵𝑐𝐶a\\in A,b\\in B,c\\in C of discs that have non-empty intersection. Assume that this hypergraph is Kt,t,t3subscriptsuperscript𝐾3𝑡𝑡𝑡K^{3}_{t,t,t}-free. Since a disc can be viewed as a point in ℝ3superscriptℝ3\\mathbb{R}^{3} and since one can define intersection of triples of discs using a constant number of quadratic polynomials in 999 variables, the result of Do  implies that the number of such triples is bounded by O​(n3−37)𝑂superscript𝑛337O(n^{3-\\frac{3}{7}}). We believe that the true bound in this special case should be close to quadratic.\nAs mentioned in Section 5 the case r=2𝑟2r=2 (i.e., intersection graph of two families of discs) has optimal O​(n)𝑂𝑛O(n) bound even in the more general case of pseudo-discs.\n\nReference markers found: [28]\n\nContext windows for each [ref]:\n[ref]28: with Ω​(nd−1)Ωsuperscript𝑛𝑑1\\Omega(n^{d-1}) hyperedges. Semi-algebraic hypergraphs\nDo  extended the result on semi-algebraic graphs (that was mentioned in Section 3) of Fox et al. [ref]28 to r𝑟r-uniform r𝑟r-partite hypergraphs:\nFix some positive integers d,t𝑑𝑡d,t. Let H𝐻H be an r𝑟r-uniform r𝑟r-partite hypergraph H=(P1∪…∪Pr,E)𝐻subscript𝑃1…subscript𝑃𝑟𝐸H=(P_{1}\\cup...\\cup\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 28,\n            \"titles\": [\n                \"On the Erdős–Purdy problem and the Zarankiewitz problem for semialgebraic graphs\",\n                \"Crossing-free subgraphs\",\n                \"Dominating sets in k-majority tournaments\",\n                \"Partitioning and geometric embedding of range spaces of finite Vapnik-Chervonenkis dimension\",\n                \"The ϵitalic-ϵ\\\\epsilon-t-net problem\",\n                \"Norm-graphs: Variations and applications\",\n                \"Large complete bipartite subgraphs in incidence graphs of points and hyperplanes\",\n                \"Approximate polytope membership queries\",\n                \"Zarankiewicz’s problem for semilinear hypergraphs\",\n                \"Learnability and the Vapnik-Chervonenkis dimension\",\n                \"On polynomial degree-boundedness\",\n                \"Identifying codes in hereditary classes of graphs and vc-dimension\",\n                \"On graphs that do not contain a Thomsen graph\",\n                \"Extremal graphs without exponentially small bicliques\",\n                \"Improved deterministic algorithms for linear programming in low dimensions\",\n                \"On the number of incidences when avoiding an induced biclique in geometric settings\",\n                \"Lower bounds for orthogonal range searching: I. The reporting case\",\n                \"Representation complexities of semi-algebraic graphs\",\n                \"Zarankiewicz’s problem for semi-algebraic hypergraphs\",\n                \"A survey of degree-boundedness\",\n                \"Shallow packings, semialgebraic set systems, Macbeath regions, and polynomial partitioning\",\n                \"On extremal problems of graphs and generalized graphs\",\n                \"Ramsey-type theorems\",\n                \"On the structure of linear graphs\",\n                \"Separator theorems and Turán-type results for planar intersection graph\",\n                \"A separator theorem for string graphs and its applications\",\n                \"Coloring kkk{}_{\\\\mbox{k}}-free intersection graphs of geometric objects in the plane\",\n                \"Applications of a new separator theorem for string graphs\",\n                \"A semi-algebraic version of Zarankiewicz’s problem\",\n                \"Induced subdivisions in Ks,ssubscript𝐾𝑠𝑠{K}_{s,s}-free graphs with polynomial average degree\",\n                \"Hypergraph regularity and the multidimensional Szemerédi’s theorem\",\n                \"On the Erdős distinct distances problem in the plane\",\n                \"Epsilon-nets and simplex range queries\",\n                \"On the Zarankiewicz problem for graphs with bounded VC-dimension\",\n                \"Extremal combinatorics\",\n                \"Simple proofs of classical theorems in discrete geometry via the guth-katz polynomial partitioning technique\",\n                \"Zarankiewicz’s problem via ϵitalic-ϵ\\\\epsilon-t-nets\",\n                \"Radius two trees specify χ𝜒\\\\chi-bounded classes\",\n                \"Almost tight bounds for epsilon-nets\",\n                \"On a problem of Zarankiewicz\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]28 based on the context and research area of A survey of Zarankiewicz problem in geometry. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}