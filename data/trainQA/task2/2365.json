{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Inapproximability of counting hypergraph colourings\n\nPaper Abstract: \n\nPaper Section Text:\nIn this section we show hardness results for finding hypergraph colourings for parameters beyond the local lemma condition.\nThe key is to find instances that do not have proper colourings. We will use a configuration model to construct random regular hypergraphs.\nWith constant probability, the resulting hypergraph is simple [ref]6 .\nFrieze and Mubayi  showed that if q>c​(Δlog⁡Δ)1K−1𝑞𝑐superscriptΔΔ1𝐾1q>c\\left(\\frac{\\Delta}{\\log\\Delta}\\right)^{\\frac{1}{K-1}} for some constant c=c​(K)𝑐𝑐𝐾c=c(K) that only depends on K𝐾K,\nthen any simple K𝐾K-uniform hypergraph with maximum degree ΔΔ\\Delta is q𝑞q-colourable.\nIn particular, their condition holds if Δ≤c​K​qK−1​ln⁡qΔ𝑐𝐾superscript𝑞𝐾1𝑞\\Delta\\leq cKq^{K-1}\\ln q for some constant c=c​(K)𝑐𝑐𝐾c=c(K).\nOur next lemma complements their result by showing as an intermediate result that if Δ>K​qK−1​ln⁡q+1Δ𝐾superscript𝑞𝐾1𝑞1\\Delta>Kq^{K-1}\\ln q+1,\nwe can find a K𝐾K-uniform hypergraph with maximum degree ΔΔ\\Delta which is not q𝑞q-colourable. For our reductions, we use such hypergraphs to obtain a “disequality” gadget, as detailed in the lemma below. Let q,K≥2𝑞𝐾2q,K\\geq 2 be integers.\nThen, for all integers Δ>K​qK−1​ln⁡q+1Δ𝐾superscript𝑞𝐾1𝑞1\\Delta>Kq^{K-1}\\ln q+1, there exists a q𝑞q-colourable K𝐾K-uniform simple hypergraph H𝐻H with maximum degree ΔΔ\\Delta and two distinct vertices u,v𝑢𝑣u,v\nsuch that the degree of u𝑢u is 111, the degree of v𝑣v is at most ΔΔ\\Delta,\nand for every q𝑞q-colouring σ𝜎\\sigma of H𝐻H it holds that σ​(u)≠σ​(v)𝜎𝑢𝜎𝑣\\sigma(u)\\neq\\sigma(v). We first argue that for all Δ>K​qK−1​ln⁡qΔ𝐾superscript𝑞𝐾1𝑞\\Delta>Kq^{K-1}\\ln q there is a ΔΔ\\Delta-regular hypergraph H0subscript𝐻0H_{0} such that Zc​o​l​(H0)=0subscript𝑍𝑐𝑜𝑙subscript𝐻00Z_{col}(H_{0})=0,\nwhere Zc​o​l​(H)subscript𝑍𝑐𝑜𝑙𝐻Z_{col}(H) denotes the number of q𝑞q-colourings in H𝐻H. Let n𝑛n be such that m=n​Δ/K𝑚𝑛Δ𝐾m=n\\Delta/K is an integer. We sample a K𝐾K-uniform ΔΔ\\Delta-regular hypergraph H𝐻H according to the following pairing model (see ). Start with a bipartite graph with the points [n]×[Δ]delimited-[]𝑛delimited-[]Δ[n]\\times[\\Delta] on the left and the points [m]×[K]delimited-[]𝑚delimited-[]𝐾[m]\\times[K] on the right, and pair the two sides using a uniformly random perfect matching; the vertex set of the final hypergraph H𝐻H is obtained in the natural way by projecting the set [n]×[Δ]delimited-[]𝑛delimited-[]Δ[n]\\times[\\Delta] onto [n]delimited-[]𝑛[n]. Note that it will be convenient to view the hyperedges of H𝐻H for now as ordered tuples rather than sets; this does not make any difference when considering colourings of H𝐻H due to the symmetry among possible ordering of the colours within the hyperedge. It is a well-known fact, see for example [6, Lemma 2] or [37, Theorem 2.4 & Appendix A.4], that the probability that H𝐻H is simple is bounded away from zero for all sufficiently large n𝑛n.444We remark that the term “simple” has different meanings across the literature. A simple hypergraph in this paper actually corresponds to a configuration without 444-cycles in the context of [37, Theorem 2.4] (where one should plug in ℓ=2ℓ2\\ell=2), or a hypergraph without 222-cycles in [ref]6. For a colouring σ:[n]→[q]:𝜎→delimited-[]𝑛delimited-[]𝑞\\sigma:[n]\\rightarrow[q], a colour i∈[q]𝑖delimited-[]𝑞i\\in[q] and a K𝐾K-tuple of colours 𝒊=(i1,…,iK)∈[q]K𝒊subscript𝑖1…subscript𝑖𝐾superscriptdelimited-[]𝑞𝐾{\\bm{i}}=(i_{1},\\ldots,i_{K})\\in[q]^{K}, let n​αi𝑛subscript𝛼𝑖n\\alpha_{i} be the number of vertices with colour i𝑖i, and m​β𝒊𝑚subscript𝛽𝒊m\\beta_{{\\bm{i}}} be the number of hyperedges whose vertices are coloured according to 𝒊𝒊{\\bm{i}} (i.e., the j𝑗j-th vertex of the hyperedge takes the colour ijsubscript𝑖𝑗i_{j}). Let 𝜶={αi}i∈[q]𝜶subscriptsubscript𝛼𝑖𝑖delimited-[]𝑞\\bm{\\alpha}=\\{\\alpha_{i}\\}_{i\\in[q]} and 𝜷={β𝒊}𝒊∈[q]K𝜷subscriptsubscript𝛽𝒊𝒊superscriptdelimited-[]𝑞𝐾\\bm{\\beta}=\\{\\beta_{{\\bm{i}}}\\}_{{\\bm{i}}\\in[q]^{K}}, and note that (𝜶,𝜷)∈Sq𝜶𝜷subscript𝑆𝑞(\\bm{\\alpha},\\bm{\\beta})\\in S_{q}, where Sqsubscript𝑆𝑞S_{q} is the space of all pairs of vectors in ℝq×ℝqKsuperscriptℝ𝑞superscriptℝsuperscript𝑞𝐾\\mathbb{R}^{q}\\times\\mathbb{R}^{q^{K}} satisfying where for i∈[q]𝑖delimited-[]𝑞i\\in[q] and 𝒊∈[q]K𝒊superscriptdelimited-[]𝑞𝐾{\\bm{i}}\\in[q]^{K} we denote by ti,𝒊subscript𝑡𝑖𝒊t_{i,{\\bm{i}}} the number of occurrences of colour i𝑖i in the tuple 𝒊𝒊{\\bm{i}}.\nThen, we have since a term in the sum corresponding to (𝜶,𝜷)𝜶𝜷(\\bm{\\alpha},\\bm{\\beta}) accounts for the number of ways to choose σ𝜎\\sigma and H𝐻H with vertex-colour frequencies given by the vector 𝜶𝜶\\bm{\\alpha} and edge-colour frequencies given by the vector 𝜷𝜷\\bm{\\beta}. Using Stirling’s approximation (2​π​k)1/2​(k/e)k≤k!≤e​k1/2​(k/e)ksuperscript2𝜋𝑘12superscript𝑘e𝑘𝑘esuperscript𝑘12superscript𝑘e𝑘(2\\pi k)^{1/2}(k/\\mathrm{e})^{k}\\leq k!\\leq\\mathrm{e}k^{1/2}(k/\\mathrm{e})^{k} that holds for all integers k≥1𝑘1k\\geq 1, we obtain by expanding the terms inside the sum (note that there are at most nqK+qsuperscript𝑛superscript𝑞𝐾𝑞n^{q^{K}+q} of them) that where F​(𝜶,𝜷)=−(Δ−1)​h​(𝜶)+ΔK​h​(𝜷)𝐹𝜶𝜷Δ1ℎ𝜶Δ𝐾ℎ𝜷F(\\bm{\\alpha},\\bm{\\beta})=-(\\Delta-1)h(\\bm{\\alpha})+\\frac{\\Delta}{K}h(\\bm{\\beta}) and h​(⋅)ℎ⋅h(\\cdot) is the entropy function (here, we adopt the usual convention that 0​ln⁡0=00000\\ln 0=0 which makes hℎh and F𝐹F continuous and therefore the maximum in (2) well-defined). For (𝜶,𝜷)∈Sq𝜶𝜷subscript𝑆𝑞(\\bm{\\alpha},\\bm{\\beta})\\in S_{q}, we have that αi=1K​∑𝒊∈[q]K​ti,𝒊​β𝒊subscript𝛼𝑖1𝐾subscript𝒊superscriptdelimited-[]𝑞𝐾subscript𝑡𝑖𝒊subscript𝛽𝒊\\alpha_{i}=\\tfrac{1}{K}\\mbox{$\\sum_{{\\bm{i}}\\in[q]^{K}}$}t_{i,{\\bm{i}}}\\beta_{{\\bm{i}}} for i∈[q]𝑖delimited-[]𝑞i\\in[q], and hence Note that for a fixed vector 𝜶𝜶\\bm{\\alpha}, the function G𝜶​(𝜷):=G​(𝜶,𝜷)assignsubscript𝐺𝜶𝜷𝐺𝜶𝜷G_{\\bm{\\alpha}}(\\bm{\\beta}):=G(\\bm{\\alpha},\\bm{\\beta}) is concave and the method of Lagrange multipliers yields that the maximum of G𝜶subscript𝐺𝜶G_{\\bm{\\alpha}} happens at 𝜷∗={β𝒊∗}𝒊∈[q]Ksuperscript𝜷subscriptsuperscriptsubscript𝛽𝒊𝒊superscriptdelimited-[]𝑞𝐾\\bm{\\beta}^{*}=\\{\\beta_{\\bm{i}}^{*}\\}_{{\\bm{i}}\\in[q]^{K}} that satisfies It follows that where the last inequality follows from h​(𝜶)≤ln⁡qℎ𝜶𝑞h(\\bm{\\alpha})\\leq\\ln q and ‖𝜶‖KK≥1/qK−1subscriptsuperscriptnorm𝜶𝐾𝐾1superscript𝑞𝐾1\\left\\|\\bm{\\alpha}\\right\\|^{K}_{K}\\geq 1/q^{K-1}, both of which are simple applications of Jensen’s inequality. For Δ>K​qK−1​ln⁡qΔ𝐾superscript𝑞𝐾1𝑞\\Delta>Kq^{K-1}\\ln q, the r.h.s. of (3) is negative and therefore max(𝜶,𝜷)∈Sq⁡F​(𝜶,𝜷)<0subscript𝜶𝜷subscript𝑆𝑞𝐹𝜶𝜷0\\max_{(\\bm{\\alpha},\\bm{\\beta})\\in S_{q}}F(\\bm{\\alpha},\\bm{\\beta})<0. From (2), we conclude that Zc​o​l​(H)=0subscript𝑍𝑐𝑜𝑙𝐻0Z_{col}(H)=0 with probability 1−exp⁡(−Ω​(n))1Ω𝑛1-\\exp(-\\Omega(n)). By a union bound, we obtain a simple ΔΔ\\Delta-regular hypergraph H0subscript𝐻0H_{0} with Zc​o​l​(H0)=0subscript𝑍𝑐𝑜𝑙subscript𝐻00Z_{col}(H_{0})=0, as claimed. To obtain the final hypergraph H𝐻H with the desired property, we invoke an argument in [17, Lemma 28] (which in turn was inspired by ).\nWe give the details here for completeness.\nGiven H0=(V,ℰ)subscript𝐻0𝑉ℰH_{0}=(V,\\mathcal{E}) with Zc​o​l​(H0)=0subscript𝑍𝑐𝑜𝑙subscript𝐻00Z_{col}(H_{0})=0,\nwe can remove hyperedges from ℰℰ\\mathcal{E} one by one until removing any more hyperedge makes Zc​o​l​(H)>0subscript𝑍𝑐𝑜𝑙𝐻0Z_{col}(H)>0.\nCall the resulting hypergraph H0′=(V,ℰ0′)superscriptsubscript𝐻0′𝑉superscriptsubscriptℰ0′H_{0}^{\\prime}=(V,\\mathcal{E}_{0}^{\\prime}).\nClearly H0′superscriptsubscript𝐻0′H_{0}^{\\prime} is simple and has at least one hyperedge. Choose an arbitrary hyperedge e∈ℰ0′𝑒superscriptsubscriptℰ0′e\\in\\mathcal{E}_{0}^{\\prime}.\nLet S⊆e𝑆𝑒S\\subseteq e be the set of vertices with non-zero degree in H0′−esuperscriptsubscript𝐻0′𝑒H_{0}^{\\prime}-e.\nIf S=∅𝑆S=\\varnothing, then e𝑒e is disconnected from the rest of the graph.\nThus as H0′superscriptsubscript𝐻0′H_{0}^{\\prime} is not q𝑞q-colourable, removing e𝑒e would not make the hypergraph q𝑞q-colourable.\nThis contradicts to the minimality of H0′superscriptsubscript𝐻0′H_{0}^{\\prime} and thus S≠∅𝑆S\\neq\\varnothing.\nDenote the vertices in S𝑆S by v1,…,visubscript𝑣1…subscript𝑣𝑖v_{1},\\dots,v_{i}, and the vertices in e∖S𝑒𝑆e\\setminus S by vi+1,…,vKsubscript𝑣𝑖1…subscript𝑣𝐾v_{i+1},\\dots,v_{K}.\nWe construct i𝑖i simple hypergraphs H1,…,Hisubscript𝐻1…subscript𝐻𝑖H_{1},\\dots,H_{i} where for 1≤j≤i1𝑗𝑖1\\leq j\\leq i,\nin Hjsubscript𝐻𝑗H_{j} we introduce new vertices u1,…,ujsubscript𝑢1…subscript𝑢𝑗u_{1},\\dots,u_{j} and replace the hyperedge e𝑒e by ej:={u1,…,uj,vj+1,…,vK}assignsubscript𝑒𝑗subscript𝑢1…subscript𝑢𝑗subscript𝑣𝑗1…subscript𝑣𝐾e_{j}:=\\{u_{1},\\dots,u_{j},v_{j+1},\\dots,v_{K}\\}.\nBy minimality of H0′superscriptsubscript𝐻0′H_{0}^{\\prime} again, Zc​o​l​(Hi)>0subscript𝑍𝑐𝑜𝑙subscript𝐻𝑖0Z_{col}(H_{i})>0 as eisubscript𝑒𝑖e_{i} is disconnected from the rest of Hisubscript𝐻𝑖H_{i}.\nThus we can find the smallest j≥1𝑗1j\\geq 1 such that Zc​o​l​(Hj)>0subscript𝑍𝑐𝑜𝑙subscript𝐻𝑗0Z_{col}(H_{j})>0 and Zc​o​l​(Hj−1)=0subscript𝑍𝑐𝑜𝑙subscript𝐻𝑗10Z_{col}(H_{j-1})=0 (or Zc​o​l​(H0′)=0subscript𝑍𝑐𝑜𝑙superscriptsubscript𝐻0′0Z_{col}(H_{0}^{\\prime})=0 if j=1𝑗1j=1).\nFor any proper colouring σ𝜎\\sigma of Hjsubscript𝐻𝑗H_{j},\nif σ​(uj)=σ​(vj)𝜎subscript𝑢𝑗𝜎subscript𝑣𝑗\\sigma(u_{j})=\\sigma(v_{j}),\nσ𝜎\\sigma would be a proper colouring of Hj−1subscript𝐻𝑗1H_{j-1},\ncontradicting to the above.\nThus it must hold that for any colouring σ𝜎\\sigma of Hjsubscript𝐻𝑗H_{j}, σ​(uj)≠σ​(vj)𝜎subscript𝑢𝑗𝜎subscript𝑣𝑗\\sigma(u_{j})\\neq\\sigma(v_{j}).\nThis is the hypergraph required by the lemma,\nwith u=uj𝑢subscript𝑢𝑗u=u_{j} and v=vj𝑣subscript𝑣𝑗v=v_{j}.\nMoreover, the degree of ujsubscript𝑢𝑗u_{j} is 111, and the degree of vjsubscript𝑣𝑗v_{j} is at most ΔΔ\\Delta.\n∎ Lemma 2.1 leads to the following hardness result,\nwhere we lose a factor 2​q2𝑞2q in the degree bound due to the reduction.\nWe note that for q=2𝑞2q=2, K=3𝐾3K=3, Δ=4Δ4\\Delta=4, and simple hypergraphs, 𝐍𝐏𝐍𝐏\\mathbf{NP}-hardness is known .\nHowever, the main point of the next theorem is that there is a degree bound that scales roughly as qKsuperscript𝑞𝐾q^{K} and makes the problem 𝐍𝐏𝐍𝐏\\mathbf{NP}-hard. Let q,K≥2𝑞𝐾2q,K\\geq 2 be integers with (q,K)≠(2,2)𝑞𝐾22(q,K)\\neq(2,2). Then, it is 𝐍𝐏𝐍𝐏\\mathbf{NP}-hard to find a q𝑞q-colouring on a K𝐾K-uniform simple hypergraph of maximum degree at most ΔΔ\\Delta, when Δ≥2​K​qK​ln⁡q+2​qΔ2𝐾superscript𝑞𝐾𝑞2𝑞\\Delta\\geq 2Kq^{K}\\ln q+2q. For q>2𝑞2q>2, we reduce from the problem of finding q𝑞q-colourings in graphs whose degrees are bounded by 2​q2𝑞2q.\nThe latter problem is shown to be 𝐍𝐏𝐍𝐏\\mathbf{NP}-hard by .\nGiven a graph G𝐺G, we replace each edge (u,v)𝑢𝑣(u,v) of G𝐺G by the hypergraph in Lemma 2.1,\nwhere u𝑢u and v𝑣v are identified with the special vertices in the hypergraph.\nThen each such hypergraph is effectively a disequality for the colours of u𝑢u and v𝑣v.\nCall the resulting hypergraph H𝐻H.\nThus G𝐺G is q𝑞q-colourable if and only if H𝐻H is q𝑞q-colourable.\nThe maximum degree of H𝐻H is 2​q​(K​qK−1​ln⁡q+1)2𝑞𝐾superscript𝑞𝐾1𝑞12q(Kq^{K-1}\\ln q+1). For q=2𝑞2q=2 and K>2𝐾2K>2, using two copies of the hypergraph from Lemma 2.1, we build an “equality” gadget, i.e., a simple hypergraph H𝐻H of maximum degree Δ≤2​(K​qK−1​ln⁡q+1)=K​2K​ln⁡2+2Δ2𝐾superscript𝑞𝐾1𝑞1𝐾superscript2𝐾22\\Delta\\leq 2(Kq^{K-1}\\ln q+1)=K2^{K}\\ln 2+2 with distinct vertices u,v𝑢𝑣u,v which both have degree 1 such that for every q𝑞q-colouring σ𝜎\\sigma it holds that σ​(u)=σ​(v)𝜎𝑢𝜎𝑣\\sigma(u)=\\sigma(v). It is well-known that finding 2-colourings of K𝐾K-uniform simple hypergraphs is 𝐍𝐏𝐍𝐏\\mathbf{NP}-hard (or we can use for example ), and using the equality gadget H𝐻H, for any K𝐾K-uniform simple hypergraph F𝐹F, we can construct a K𝐾K-uniform simple hypergraph F′superscript𝐹′F^{\\prime} of maximum degree ΔΔ\\Delta such that F𝐹F is 2-colourable if and only if F′superscript𝐹′F^{\\prime} is 2-colourable.\nOne possible way to do so is replacing each degree-d𝑑d vertex w𝑤w of F𝐹F with a cycle of length d𝑑d and then replacing each edge e𝑒e of the cycle with a distinct copy of the hypergraph H𝐻H using u,v𝑢𝑣u,v for the endpoints of the edge e𝑒e; then, for each hyperedge of F𝐹F that uses w𝑤w, in F′superscript𝐹′F^{\\prime} we use instead one of the d𝑑d vertices of the cycle.\n∎ Note that the result of Frieze and Mubayi  is also algorithmic.\nThus Theorem 2.2 is sharp for simple hypergraphs up to a factor c​q𝑐𝑞cq where c=c​(K)𝑐𝑐𝐾c=c(K) is a constant depending only on K𝐾K.\nFor general hypergraphs, the algorithm of Moser and Tardos  applies in this setting when Δ≤qK−1e​(K−1)Δsuperscript𝑞𝐾1𝑒𝐾1\\Delta\\leq\\frac{q^{K-1}}{e(K-1)},\nin which case Theorem 2.2 almost matches the algorithmic result, up to a factor of c​K2​q​ln⁡q𝑐superscript𝐾2𝑞𝑞cK^{2}q\\ln q where c𝑐c is a constant. For approximate counting, we can avoid the loss of the factor q𝑞q when q≥2𝑞2q\\geq 2 and K≥4𝐾4K\\geq 4.\nFor a q𝑞q-by-q𝑞q matrix 𝑩={Bi​j}i,j∈[q]𝑩subscriptsubscript𝐵𝑖𝑗𝑖𝑗delimited-[]𝑞{\\bm{B}}=\\{B_{ij}\\}_{i,j\\in[q]}, the partition function for the q𝑞q-spin system with interaction matrix B𝐵B in a graph G=(V,E)𝐺𝑉𝐸G=(V,E) is given by where wt​(σ):=∏(u,v)∈EBσ​(u)​σ​(v)assignwt𝜎subscriptproduct𝑢𝑣𝐸subscript𝐵𝜎𝑢𝜎𝑣\\text{wt}(\\sigma):=\\prod_{(u,v)\\in E}B_{\\sigma(u)\\sigma(v)} is the weight of an assignment σ:V→{1,…,q}:𝜎→𝑉1…𝑞\\sigma:V\\rightarrow\\{1,\\dots,q\\} of the q𝑞q spins to the vertices of G𝐺G. In particular, the q𝑞q-state antiferromagnetic Potts model corresponds to the case where 𝑩𝑩{\\bm{B}} is the matrix whose off-diagonal entries are equal to 1, whereas the diagonal entries equal to some parameter B<1𝐵1B<1 (note, B=0𝐵0B=0 corresponds to q𝑞q-colourings). We will use the following hardness result about the Potts model.\nA fully polynomial-time randomized approximation scheme (FPRAS) is an algorithm that takes the accuracy ε𝜀\\varepsilon as an extra input,\noutputs an ε𝜀\\varepsilon-approximation, and runs in time polynomially bounded by both the instance size and 1/ε1𝜀1/\\varepsilon. There is a constant C1>5subscript𝐶15C_{1}>5 such that,\nfor any integers q≥2𝑞2q\\geq 2, Δ≥2​C1​q​ln⁡qΔ2subscript𝐶1𝑞𝑞\\Delta\\geq 2C_{1}q\\ln q, and B<1−C1​q​ln⁡qΔ𝐵1subscript𝐶1𝑞𝑞ΔB<1-\\frac{C_{1}q\\ln q}{\\Delta},\nthere is no FPRAS to approximate the q𝑞q-state antiferromagnetic Potts partition function ZBsubscript𝑍𝐵Z_{B} in graphs with bounded degree ΔΔ\\Delta,\nunless 𝐍𝐏=𝐑𝐏𝐍𝐏𝐑𝐏\\mathbf{NP}=\\mathbf{RP}. The proof of Lemma 2.3 is quite a detour from the problems we focus on,\nso we postpone it to Section 5.1.\nWe note that Lemma 2.3 is weaker than the inapproximability result in [21, Theorem 1.2],\nwhich achieves B<1−qΔ𝐵1𝑞ΔB<1-\\frac{q}{\\Delta} but only holds for even q𝑞q.\nWe want to deal with general q𝑞q, and thus settle with this weaker version. There is a constant C1>5subscript𝐶15C_{1}>5 such that,\nfor any integers q≥2𝑞2q\\geq 2, K≥4𝐾4K\\geq 4, and Δ≥C1​K​qK−1​ln⁡qΔsubscript𝐶1𝐾superscript𝑞𝐾1𝑞\\Delta\\geq C_{1}Kq^{K-1}\\ln q,\nunless 𝐍𝐏=𝐑𝐏𝐍𝐏𝐑𝐏\\mathbf{NP}=\\mathbf{RP}, there is no FPRAS for the number of\nq𝑞q-colourings in K𝐾K-uniform simple hypergraphs of maximum degree at most ΔΔ\\Delta. We reduce the partition function of the q𝑞q-state antiferromagnetic Potts model with B=1−1q2−3​q+3𝐵11superscript𝑞23𝑞3B=1-\\frac{1}{q^{2}-3q+3} in graphs with bounded degree ΔΔ\\Delta\nto the problem of counting q𝑞q-colourings in K𝐾K-uniform simple hypergraphs of maximum degree at most ΔΔ\\Delta.\nNote that if K≥4𝐾4K\\geq 4 and Δ≥C1​K​qK−1​ln⁡qΔsubscript𝐶1𝐾superscript𝑞𝐾1𝑞\\Delta\\geq C_{1}Kq^{K-1}\\ln q, where C1subscript𝐶1C_{1} is from Lemma 2.3,\nthen B<1−C1​q​ln⁡qΔ𝐵1subscript𝐶1𝑞𝑞ΔB<1-\\frac{C_{1}q\\ln q}{\\Delta}.\nThus the reduction implies the theorem via Lemma 2.3. The reduction goes as follows.\nFor each edge (u,v)𝑢𝑣(u,v) in a ΔΔ\\Delta-regular graph G=(V,E)𝐺𝑉𝐸G=(V,E),\nwe replace it by a gadget using the hypergraph H𝐻H in Lemma 2.1,\nwhose degree bound is Δ0=K​qK−1​ln⁡q+1subscriptΔ0𝐾superscript𝑞𝐾1𝑞1\\Delta_{0}=Kq^{K-1}\\ln q+1.\nTo be more specific, we introduce new vertices w1subscript𝑤1w_{1} and w2subscript𝑤2w_{2}.\nWe add three copies of the hypergraph H𝐻H with special vertices (u,w1)𝑢subscript𝑤1(u,w_{1}), (w2,w1)subscript𝑤2subscript𝑤1(w_{2},w_{1}), and (v,w2)𝑣subscript𝑤2(v,w_{2}), respectively.\nDo this for all edges in G𝐺G.\nThen, the degrees of u𝑢u and v𝑣v are still ΔΔ\\Delta,\nthe degrees of w1subscript𝑤1w_{1}’s are at most 2​Δ0<Δ2subscriptΔ0Δ2\\Delta_{0}<\\Delta,\nand the degrees of w2subscript𝑤2w_{2}’s are at most Δ0+1<ΔsubscriptΔ01Δ\\Delta_{0}+1<\\Delta.\nAll other newly introduced vertices have degrees at most Δ0<ΔsubscriptΔ0Δ\\Delta_{0}<\\Delta.\nThus, the degree requirement is met.\nCall the resulting hypergraph HGsubscript𝐻𝐺H_{G}. To finish the reduction,\nwe claim that where C𝐶C is a constant depending only on H𝐻H.\nFirst notice that for any pair of colours i𝑖i and j𝑗j,\nthe number of colourings σ𝜎\\sigma of H𝐻H such that σ​(u)=i𝜎𝑢𝑖\\sigma(u)=i and σ​(v)=j𝜎𝑣𝑗\\sigma(v)=j is a constant,\ndue to the symmetry among colours.\nDenote this constant by C0subscript𝐶0C_{0}.\nThus, in the gadget above,\nwhen the two endpoints u𝑢u and v𝑣v have different colours, the number of possible colourings for the gadget is ((q−2)2+(q−1))​C03superscript𝑞22𝑞1superscriptsubscript𝐶03((q-2)^{2}+(q-1))C_{0}^{3};\nwhen the two endpoints u𝑢u and v𝑣v have the same colour, the number of possible colourings for the gadget is (q−1)​(q−2)​C03𝑞1𝑞2superscriptsubscript𝐶03(q-1)(q-2)C_{0}^{3}.\nThe claim holds with C=((q−2)2+(q−1))​C03𝐶superscript𝑞22𝑞1superscriptsubscript𝐶03C=((q-2)^{2}+(q-1))C_{0}^{3}.\n∎ In Theorem 2.4, we could avoid the large constant C1subscript𝐶1C_{1} in the degree bound by using [21, Theorem 1.2] as the starting point of our reduction,\nbut doing so will restrict the result to even q𝑞q only. For K𝐾K-CNFs on simple hypergraphs,\nHermon, Sly, and Zhang [ref]24 showed an efficient approximate counting and sampling algorithm if Δ≤c​2KK2Δ𝑐superscript2𝐾superscript𝐾2\\Delta\\leq\\frac{c2^{K}}{K^{2}}, where c𝑐c is a constant.\nIn view of their result, Theorem 2.2 and Theorem 2.4 are potentially sharp for simple hypergraphs, up to some polynomial factor in K𝐾K.\n\nReference markers found: [6]\n\nContext windows for each [ref]:\n[ref]6: key is to find instances that do not have proper colourings. We will use a configuration model to construct random regular hypergraphs.\nWith constant probability, the resulting hypergraph is simple [ref]6 .\nFrieze and Mubayi  showed that if q>c​(Δlog⁡Δ)1K−1𝑞𝑐superscriptΔΔ1𝐾1q>c\\left(\\frac{\\Delta}{\\log\\Delta}\\right)^{\\frac{1}{K-1}} for some constant c=c​(K)𝑐𝑐𝐾c=c(K) that only depends on\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 6,\n            \"titles\": [\n                \"Sampling Colorings and Independent Sets of Random Regular Bipartite Graphs in the Non-Uniqueness Region\",\n                \"Some APX-completeness results for cubic graphs\",\n                \"A parallel algorithmic version of the local lemma\",\n                \"An algorithmic approach to the Lovász local lemma. I.\",\n                \"Approximation via correlation decay when strong spatial mixing fails\",\n                \"Inapproximability after uniqueness phase transition in two-spin systems\",\n                \"Perfect matchings in random r𝑟r-regular, s𝑠s-uniform hypergraphs\",\n                \"Coloring nonuniform hypergraphs: A new algorithmic approach to the general Lovász local lemma\",\n                \"On weighted vs unweighted versions of combinatorial optimization problems\",\n                \"On a simple hard variant of Not-All-Equal 333-SAT\",\n                \"On counting independent sets in sparse graphs\",\n                \"Uniquely colourable graphs and the hardness of colouring graphs of large girth\",\n                \"Problems and results on 333-chromatic hypergraphs and some related questions\",\n                \"Fast sampling and counting k𝑘k-SAT solutions in the local lemma regime\",\n                \"Sampling constraint satisfaction solutions in the local lemma regime\",\n                \"Coloring simple hypergraphs\",\n                \"The complexity of approximately counting in 2-spin systems on k𝑘k-uniform bounded-degree hypergraphs\",\n                \"Uniform Sampling through the Lovász Local Lemma\",\n                \"Counting hypergraph colorings in the local lemma regime\",\n                \"The local lemma is asymptotically tight for SAT\",\n                \"Inapproximability for antiferromagnetic spin systems in the tree nonuniqueness region\",\n                \"Inapproximability of the partition function for the antiferromagnetic Ising and hard-core models\",\n                \"Perfect sampling for (atomic) Lovász local lemma\",\n                \"Rapid mixing of hypergraph independent sets\",\n                \"On the sampling Lovász Local Lemma for atomic constraint satisfaction problems\",\n                \"Towards the sampling Lovász local lemma\",\n                \"Random generation of combinatorial structures from a uniform distribution\",\n                \"On the hardness of approximating max k𝑘k-cut and its dual\",\n                \"One more occurrence of variables makes satisfiability jump from trivial to NP-complete\",\n                \"Correlation decay up to uniqueness in spin systems\",\n                \"Approximate Counting, the Lovász Local Lemma and Inference in Graphical Models\",\n                \"A constructive proof of the Lovász local lemma\",\n                \"Further algorithmic aspects of the local lemma\",\n                \"Fast mixing for independent sets, colorings, and other models on trees\",\n                \"A constructive proof of the general Lovász local lemma\",\n                \"On the hardness of sampling independent sets beyond the tree threshold\",\n                \"Satisfiability thresholds for regular occupation problems\",\n                \"Computational transition at the uniqueness threshold\",\n                \"Improved algorithmic versions of the Lovász local lemma\",\n                \"Counting in two-spin models on d𝑑d-regular graphs\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]6 based on the context and research area of Inapproximability of counting hypergraph colourings. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}