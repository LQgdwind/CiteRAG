{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: QVHighlights: Detecting Moments and Highlights in Videos via Natural Language Queries\n\nPaper Abstract: \n\nPaper Section Text:\nComparison with baselines.\nWe compare Moment-DETR with various moment retrieval and highlight detection methods on the QVHighlights test split; results are shown in Table 3.\nFor moment retrieval, we provide three baselines, two proposal-based methods MCN  and CAL [ref]4, and a span prediction method XML [ref]19.\nFor highlight detection, we provide two baselines, BeautyThumb 7 based solely on frame quality, and DVSE  based on clip-query similarity.\nSince XML also outputs clip-wise similarity scores to the user query, we provide highlight detection results for this model as well.\nThe original XML model has a smaller capacity than Moment-DETR, hence for a fair comparison, we increased its capacity by adding more layers and train it for the same number of epochs as Moment-DETR. Moreover, to leverage the saliency annotations in QVHighlights, we further added an auxiliary saliency loss to it (referred to as ‘XML+’).\nThese enhancements improve the original XML model by 2.76 average mAP.\nIn addition, for both tasks, we also add CLIP  as a baseline. Specifically, we compute clip-wise similarity scores by computing image-query scores where the image is the center frame of the clip. For highlight detection, we directly use these scores as prediction; for moment retrieval, we use TAG  to progressively groups top-scored clips with the classical watershed algorithm . Compared to the best baseline XML+, Moment-DETR performs competitively on moment retrieval, where it achieves significantly higher scores on a lower IoU threshold, i.e., R1@0.5 and mAP@0.5 (>7% absolute improvement), but obtains lower scores on higher IoU threshold, i.e., R1@0.7 and mAP@0.75.\nWe hypothesize that this is because the L1 and generalized IoU losses give large penalties only to large mismatches (i.e., small IoU) between the predicted and ground truth moments.\nThis property encourages Moment-DETR to focus more on predictions with small IoUs with the ground truth, while less on those with a reasonably large IoU (e.g., 0.5).\nThis observation is the same as DETR  for object detection, where it shows a notable improvement over the baseline in AP50, but lags behind in AP75.\nFor highlight detection, Moment-DETR performs similarily to XML+.\nAs discussed in Section 4.3, Moment-DETR is designed without human priors or hand-crafted components, thus may require more training data to learn these priors from data.\nTherefore, we also use ASR captions for weakly supervised pretraining.\nWith pretraining, Moment-DETR greatly outperforms the baselines on both tasks, showing the effectiveness of our approach.444We also tried pretraining with XML+, and under careful tuning, the results are still worse than without pretraining, which might because XML+’s cross-entropy loss gives strong penalties to small mismatches, preventing it from learning effectively from noisy (thus many small mismatches) data.\nOne surprising finding is that CLIP  gives the best highlight detection performance in terms of HIT@1, though its overall performance is much lower than Moment-DETR. Loss ablations.\nIn Table 4, we show the impact of the losses by turning off one loss at a time.\nWhen turning off the saliency loss, we observe a significant performance drop for highlight detection, and surprisingly moment retrieval as well.\nWe hypothesize that the moment span prediction losses (L1 and IoU) and classification (CLS) loss do not provide strong supervision for learning the similarity between the input text queries and their relevant clips, while the saliency loss gives a direct signal to learn such similarity.\nUnder our framework, this also suggests that jointly detecting saliency is beneficial to retrieve moments.\nWhen turning off one of the span predictions losses (L1 or IoU), we see a notable drop in moment retrieval performance while the highlight detection performance stays similar, showing that both losses are important for moment retrieval. Moment query analysis.\nIn Figure 4, we visualize moment span predictions for all the 1550 QVHighlights val videos, for the 10 moment query slots in Moment-DETR decoder. As shown in the figure, each slot learns to predict moments of different patterns, i.e., different temporal locations and different widths.\nFor example, some slots learn to predict short moments near the beginning or end of the videos (e.g., the first two slots), while some slots learn to predict both short and long moments near the center (e.g., the third slot).\nOverall, most of the slots learn to predict short moments while only a handful of them learn to predict long moments, possibly because there are more short moments in QVHighlights than long moments (see our data analysis in Section 3.2). Pretraining data domain and size. To better understand the role of pretraining, we examine the effect of using data of different domain and sizes for pretraining. Specifically, we use HowTo100M  instructional videos of different sizes for pretraining Moment-DETR and then evaluate its finetuning performance on QVHighlights dataset. The results are shown in Table 5.\nWe notice that out-of-domain pretraining on HowTo100M videos also improves the model performance, even when only trained on 2.5K videos.\nWhen increasing the number videos, we see there is a steady performance gain for the moment retrieval task. While for highlight detection, the performance fluctuates, probably because of the pretraining task is not well aligned with the goal of detecting highlights.\nCompared to in-domain and out-of-domain videos, we notice that 5.4K in-domain QVHighlights videos greatly outperforms 10K HowTo100M videos, demonstrating the importance of aligning the pretraining and the downstream task domain. Generalization to other datasets. In Table 6, we test Moment-DETR’s performance on moment retrieval dataset CharadesSTA .\nSimilar to our observations in Table 3, when comparing to SOTA methods, we notice that Moment-DETR shows a significant performance gain on R1@0.5, while performs slightly worse on a tighter metric, i.e., R1@0.7.\nMeanwhile, after pretrained on 10K HowTo100M videos, Moment-DETR’s performance is greatly improved, setting new state-of-the-art for the dataset. This shows Moment-DETR’s potential to adapt to different data and tasks. Prediction visualization.\nFigure 5 (top) shows a correct prediction from Moment-DETR.\nWe can see that the model is able to correctly localize two disjoint moments relevant to the user query.\nMeanwhile, the saliency scores also align very well with the ground truth score curve (obtained by averaging the scores from 3 annotators).\nAnd not surprisingly, this saliency score curve also matches the moment predictions – where we see higher scores for localized regions than those outside.\nFigure 5 (bottom) shows a failure case, where it incorrectly localized a partially true moment (2nd frame) where the family is playing on a court but not playing basketball.\nMore examples in Appendix.\n\nReference markers found: [4]\n\nContext windows for each [ref]:\n[ref]4: retrieval and highlight detection methods on the QVHighlights test split; results are shown in Table 3.\nFor moment retrieval, we provide three baselines, two proposal-based methods MCN  and CAL [ref]4, and a span prediction method XML [ref]19.\nFor highlight detection, we provide two baselines, BeautyThumb 7 based solely on frame quality, and DVSE  based on clip-query similarity.\nSince XML\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 4,\n            \"titles\": [\n                \"SlowFast Networks for Video Recognition\",\n                \"Attention augmented convolutional networks\",\n                \"Activitynet: A large-scale video benchmark for human activity understanding\",\n                \"End-to-end object detection with transformers\",\n                \"Temporal localization of moments in video collections with natural language\",\n                \"From Lifestyle Vlogs to Everyday Interactions\",\n                \"TALL: Temporal Activity Localization via Language Query\",\n                \"PHD-GIFs: Personalized Highlight Detection for Automatic GIF Creation\",\n                \"ExCL: Extractive Clip Localization Using Natural Language Descriptions\",\n                \"Understanding the difficulty of training deep feedforward neural networks\",\n                \"Deep sparse rectifier neural networks\",\n                \"Video2GIF: Automatic Generation of Animated GIFs from Video\",\n                \"Localizing Moments in Video with Natural Language\",\n                \"Improving neural networks by preventing co-adaptation of feature detectors\",\n                \"MDETR - Modulated Detection for End-to-End Multi-Modal Understanding\",\n                \"Dense-Captioning Events in Videos\",\n                \"Less is more: Clipbert for video-and-language learning via sparse sampling\",\n                \"TVQA+: Spatio-Temporal Grounding for Video Question Answering\",\n                \"TVR: A Large-Scale Dataset for Video-Subtitle Moment Retrieval\",\n                \"What is More Likely to Happen Next? Video-and-Language Future Event Prediction\",\n                \"Hero: Hierarchical encoder for video+ language omni-representation pre-training\",\n                \"Query sensitive dynamic web video thumbnail generation\",\n                \"Multi-task deep visual-semantic embedding for video thumbnail selection\",\n                \"Decoupled Weight Decay Regularization\",\n                \"End-to-End Learning of Visual Representations from Uncurated Instructional Videos\",\n                \"HowTo100M: Learning a Text-Video Embedding by Watching Hundred Million Narrated Video Clips\",\n                \"Interventional Video Grounding with Dual Contrastive Learning\",\n                \"Activity graph transformer for temporal action localization\",\n                \"Image Transformer\",\n                \"PyTorch: An Imperative Style, High-Performance Deep Learning Library\",\n                \"Learning Transferable Visual Models From Natural Language Supervision\",\n                \"Grounding action descriptions in videos\",\n                \"Generalized intersection over union: A metric and a loss for bounding box regression\",\n                \"Adaptive Video Highlight Detection by Learning from User History\",\n                \"The watershed transform: Definitions, algorithms and parallelization strategies\",\n                \"Find and focus: Retrieve and localize video events with natural language queries\",\n                \"To click or not to click: Automatic selection of beautiful thumbnails from videos\",\n                \"End-to-end people detection in crowded scenes\",\n                \"Ranking domain-specific highlights by analyzing edited videos\",\n                \"Attention Is All You Need\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]4 based on the context and research area of QVHighlights: Detecting Moments and Highlights in Videos via Natural Language Queries. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}