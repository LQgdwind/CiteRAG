{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Q-PPG: Energy-Efficient PPG-based Heart Rate Monitoring on Wearable Devices\n\nPaper Abstract: \n\nPaper Section Text:\nWork\nDataset\nActivities\nSign.\nPre-Processing\nAlgorithm\nPost-Proc.\nMAE\n\nClassical methods\n\nTROIKA, 2014 \nSPC, 12 subj.\nRest, Running\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering,\n\nDownsampling\n\n\n\n\nSignal decomp.,\n\nreconstruct.,\n\npeak tracking\n\n\n\n\nth.,\n\nhist. track.\n\n2.34 BPM\n\nJOSS, 2015 \nSPC, 12 subj.\nRest, Running\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering,\n\nDownsampling\n\n\n\n\nMMV,\n\nspectral subtraction\n\n\n\n\nth.,\n\nhist. track.\n\n1.28 BPM\n\nIMAT, 2015 \nSPC, 12 subj.\nRest, Running\n\n\n\nPPG,\n\nAcc.\n\n0.5-4 Hz filtering\n\n\n\nMA cancellation\n\nby SVD, IMAT\n\n\n\n\npeak sel.,\n\nth.\n\n1.25 BPM\n\nSpaMa, 2016 [ref]14\n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\nChon Lab, 10 subj.\n\nDalia, 15 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.,\n\nRest, Running\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-3 Hz filtering,\n\nDownsampling\n\n\n\n\nspectral filtering\n\nbased on PSD\n\n\n\n\nhist. track.,\n\nspline interp.\n\n\n\n\n0.89 BPM\n\n3.36 BPM\n\n1.38 BPM\n\n11.06 BPM\n\n\nWFPV, 2017 \n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering,\n\nz-score scaling,\n\nDownsampling\n\n\n\n\nWiener filtering,\n\nphase vocoder\n\n\n\n\nth.,\n\nhist. track.\n\n\n\n\n1.02 BPM\n\n1.97 BPM\n\n\nSchack2017 \n\n\n\nSPC, 12 subj.\n\nDalia, 15 subj.\n\n\n\n\nRest, Running,\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-6 Hz filtering,\n\nDownsampling\n\n\n\n\nCorr.-based Freq.\n\nindicating func.,\n\nFFT\n\nth.\n\n\n\n1.32 BPM\n\n20.5 BPM\n\n\nFSM, 2018 \nSPC, 23 subj.\n\n\n\nRest, Running,\n\nRehab. ex.\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering,\n\nz-score scaling,\n\nDownsampling\n\nWiner filtering\nFSM\n0.99 BPM\n\nCurToSS, 2020 \n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\nDalia, 15 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.,\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering\n\n\n\n\nSSR\n\nCurve tracking\n\nN/A\n\n\n\n2.2 BPM\n\n4.5 BPM\n\n5.0 BPM\n\n\nTAPIR, 2020 \n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\nDalia, 15 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.,\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering\n\n\n\n\nAdaptive filter\n\nPeak detection\n\nLinear Transform.\n\nNotch filter\n\n\n\n2.5 BPM\n\n5.9 BPM\n\n4.6 BPM\n\n\nDeep Learning\n\nDeepPPG, 2019 \n\n\n\nSPC, 12 subj.\n\nDalia, 15 subj.\n\n\n\n\nRest, Running,\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\nSTFT,\n\n0-4 Hz filtering\n\nCNN\nN/A\n\n\n\n4 BPM\n\n7.65 BPM\n\n\nCorNET, 2019 \n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.\n\n\n\n\nPPG\n\n\n\n\n0.4-18 Hz filtering,\n\nz-score scaling\n\nCNN+LSTM\nN/A\n\n\n\n4.67 BPM\n\n5.55 BPM\n\n\nBinary CorNET, 2020 \n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.\n\n\n\n\nPPG\n\n\n\n\n0.4-18 Hz filtering,\n\nz-score scaling\n\nBin. CNN+LSTM\nN/A\n\n\n\n6.78 BPM\n\n7.32 BPM\n\n\nNAS-PPG, 2021 \nDalia, 15 subj.\n8 daily activities\nPPG\n\n\n\nFFT,\n\n0.6-3.6 Hz filtering\n\nCNN+LSTM\nN/A\n6.02 BPM\n\nOur Work\n\n\n\nDalia, 15 subj.\n\n\n\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-4 Hz filtering\n\n\n\n\nTCN\n\n\n\n\nth,\n\nfinetuning\n\n\n\n\n4.36 BPM\n\n+f.t: 3.61 BPM\n\n\n\n The study of HR monitoring solutions based on wearable devices equipped with PPG sensors has attracted significant research efforts from academia and industry in recent years.\nWhile tracking the HR is a relatively easy and already solved problem for steady subjects, movements usually impair the task’s performance, adding noise to the PPG signal.\nThe main challenge is therefore trying to keep a sufficiently high accuracy, typically measured as the MAE between the predicted H​Rp​r​e​d𝐻subscript𝑅𝑝𝑟𝑒𝑑HR_{pred} and ground truth H​Rt​r​u​e𝐻subscript𝑅𝑡𝑟𝑢𝑒HR_{true}, where M​A​E=|H​Rt​r​u​e−H​Rp​r​e​d|𝑀𝐴𝐸𝐻subscript𝑅𝑡𝑟𝑢𝑒𝐻subscript𝑅𝑝𝑟𝑒𝑑MAE=|HR_{true}-HR_{pred}|, also during activities with strong movements. This has to be done under the tight memory, latency and energy constraints of battery-operated wrist-worn devices.\nThe latter usually have operating frequencies in the order of 10s of MHz and a power envelope lower than 100 mW, thus requiring very low-complexity algorithms for real-time execution. Recent algorithms can be split into two main categories. One group includes classical model-driven approaches, based on either time- or frequency-domain extracted features, followed by a series of filtering and peak detection/position-refinement steps. The other group consists of data-driven algorithms, mostly based on deep learning. Fewer works are included in this group, since differently from other fields, where it has become the de facto standard, DL is still relatively unexplored for PPG-based HR monitoring.\nTable I provides an overview of the main solutions proposed in the literature. Starting from classical approaches, the seminal work of  paved the way to the algorithmic exploration in this field, introducing the first public PPG dataset called SPC Cup 2015 (SPC hereinafter).\nThe paper also proposed a three-stage pipeline called TROIKA, comprising i) a signal decomposition step, ii) spectrum estimation, and iii) a final spectral peak tracking.\nTested on SPC, TROIKA achieves a MAE of 2.34 Beats Per Minute (BPM).\nThe same authors improved their own algorithm in , proposing JOSS, a JOint Sparse Spectrum reconstruction approach, where spectral difference is used to remove motion artifacts from the PPG spectrum, further reducing the MAE to just 1.28 BPM.\nSimilar to this approach, in , the authors propose to suppress motion artifacts using Singular Value Decomposition (SVD), coupled with an Iterative Method with Adaptive Thresholding (IMAT), and a final peak selection step. This work slightly improves the performance on the SPC dataset, obtaining a MAE of 1.25 BPM.\nOther model-driven approaches    use FFT and Wiener filtering to remove motion artifacts from noisy PPG signals, further improving the performance on SPC to 0.99 BPM of MAE.\nUntil now, the best MAE result on the SPC dataset (0.89 BPM) has been achieved by SpaMa [ref]14, a complex five-step pipeline that combines spectral filtering and spline interpolation. In 2019, Reiss et al.  released\na new dataset for PPG-based HR monitoring\ncalled PPG-Dalia (Dalia hereinafter), with a higher number of subjects (15) and more activities per subject (8 in total), including daily-life tasks such as driving, sitting or walking.\nThe most recent model-driven algorithms   are optimized on this new dataset. The first, CurToSS , improves JOSS by using sparse signal reconstruction for both acceleration and PPG signals, obtaining 5.0 BPM of MAE. The second, TAPIR , relies on linear temporal transformations, strongly reducing the computational complexity while achieving a MAE of 4.6 BPM.\nNoteworthy, all these model-based algorithms include many free parameters, which leads to over-fitting the dataset used for hand-tuning them.\nTherefore, using model-driven algorithms could strongly impair generalization, leading to badly performing solutions in real-life situations, represented in table I by the challenging DALIA dataset.\nMoreover, to the best of our knowledge, none of the aforementioned algorithms has been deployed on wearable devices, probably due to the high complexity of some of the algorithms. In recent years, motivated by the increasing success of deep learning in other bio-signal applications (e.g., gesture recognition [ref]20, seizure detection   and brain-computer interfaces ), some researchers have started exploring deep NNs, in particular Convolutional Neural Networks (CNNs) and Recurrent Neural Networks (RNNs), for PPG-based HR tracking.\nThe seminal work in this group is , which in conjunction with the publication of Dalia, introduced different CNN variants coupled with a short-time Fourier transform, which outperformed the best model-driven methods [ref]14  on the new dataset.\nCorNET  and its variant for highly constrained devices, BinaryCorNET  have been introduced to reduce model complexity, achieving comparable results to model-driven methods on the SPC dataset using a deep architecture with a CNN front-end and a long-short term memory (LSTM) RNN to combine multiple time samples.\nFinally, a Neural Architecture Search (NAS) approach has been recently applied to the HR tracking problem in , finding a CNN+LSTM network that achieves 6.02 BPM of MAE on Dalia, while also reducing the complexity of the algorithm compared to , but being still too large for MCU deployment (800k floating-point parameters).\nIndeed, deep NN models typically have large memory footprints and high computational complexity. Therefore, their deployment on memory-constrained MCUs, with low energy consumption and respecting real-time latency constraints is not trivial.\nIn our work, we tackle precisely these challenges. To the best of our knowledge, we are the first to i) explicitly create a Pareto frontier of NNs in the MAE versus memory (or number of operations) space, from which different models can be selected based on the hardware target’s constraints and ii) investigate the embedding of these models into an actual edge device. Furthermore, we achieve the leading accuracy on the DALIA dataset, outperforming all previous state-of-the-art models.\n\nReference markers found: [14]\n\nContext windows for each [ref]:\n[ref]14: track.\n\n1.28 BPM\n\nIMAT, 2015 \nSPC, 12 subj.\nRest, Running\n\n\n\nPPG,\n\nAcc.\n\n0.5-4 Hz filtering\n\n\n\nMA cancellation\n\nby SVD, IMAT\n\n\n\n\npeak sel.,\n\nth.\n\n1.25 BPM\n\nSpaMa, 2016 [ref]14\n\n\n\nSPC, 12 subj.\n\nSPC, 23 subj.\n\nChon Lab, 10 subj.\n\nDalia, 15 subj.\n\n\n\n\nRest, Running,\n\nRehab. ex.,\n\nRest, Running\n\n8 daily activities\n\n\n\n\nPPG,\n\nAcc.\n\n\n\n\n0.5-3 Hz\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 14,\n            \"titles\": [\n                \"Photoplethysmography-Based Heart Rate Monitoring in Physical Activities via Joint Sparse Spectrum Reconstruction\",\n                \"Human photoplethysmogram: new insight into chaotic characteristics\",\n                \"Apple watch series\",\n                \"Fitbit charge 4\",\n                \"Wearable photoplethysmographic sensors—past and present\",\n                \"A review on wearable photoplethysmography sensors and their potential future applications in health care\",\n                \"TROIKA: A General Framework for Heart Rate Monitoring Using Wrist-Type Photoplethysmographic Signals During Intensive Physical Exercise\",\n                \"Evaluating the accuracy of wearable heart rate monitors\",\n                \"Evaluation of coherence between ecg and ppg derived parameters on heart rate variability and respiration in healthy volunteers with/without controlled breathing\",\n                \"Neurosky\",\n                \"Deep ppg: large-scale heart rate estimation with convolutional neural networks\",\n                \"Accurate heart rate monitoring during physical exercises using ppg\",\n                \"Computationally efficient heart rate estimation during physical exercise using photoplethysmographic signals\",\n                \"Finite state machine framework for instantaneous heart rate validation using wearable photoplethysmography during intensive exercise\",\n                \"A novel time-varying spectral filtering algorithm for reconstruction of motion artifact corrupted heart rate signals during intense physical activities using a wearable photoplethysmogram sensor\",\n                \"A review of wrist-worn wearable: Sensors, models, and challenges\",\n                \"Cornet: Deep learning framework for ppg-based heart rate estimation and biometric identification in ambulant environment\",\n                \"Binary cornet: accelerator for hr estimation from wrist-ppg\",\n                \"Robust and energy-efficient ppg-based heart-rate monitoring\",\n                \"Robust real-time embedded emg recognition framework using temporal convolutional networks on a multicore iot processor\",\n                \"H-Watch: An Open, Connected Platform for AI-Enhanced COVID19 Infection Symptoms Monitoring and Contact Tracing\",\n                \"Heart rate tracking using wrist-type photoplethysmographic (ppg) signals during physical exercise with simultaneous accelerometry\",\n                \"Heart rate monitoring using sparse spectral curve tracing\",\n                \"Robust ppg-based ambulatory heart rate tracking algorithm\",\n                \"Nas-ppg: Ppg based heart rate estimation using neural architecture search\",\n                \"Hyperdimensional computing with local binary patterns: One-shot learning for seizure onset detection and identification of ictogenic brain regions from short-time ieeg recordings.\",\n                \"An ensemble of hyperdimensional classifiers: Hardware-friendly short-latency seizure detection with automatic ieeg electrode selection\",\n                \"A survey on deep learning based brain computer interface: Recent advances and new frontiers\",\n                \"An empirical evaluation of generic convolutional and recurrent networks for sequence modeling\",\n                \"Temporal Convolutional Networks: A Unified Approach to Action Segmentation\",\n                \"Cloud-edge based lightweight temporal convolutional networks for remaining useful life prediction in iiot\",\n                \"Stm32wb55\",\n                \"Max30101\",\n                \"Lsm6dsm\",\n                \"Pact: Parameterized Clipping Activation for Quantized Neural Networks\",\n                \"How to train neural networks\",\n                \"Batch normalization: Accelerating deep network training by reducing internal covariate shift\",\n                \"Morphnet: Fast & simple resource-constrained structure learning of deep networks\",\n                \"Pruning In Time (PIT): A Lightweight Network Architecture Optimizer for Temporal Convolutional Networks\",\n                \"MnasNet: Platform-Aware Neural Architecture Search for Mobile\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]14 based on the context and research area of Q-PPG: Energy-Efficient PPG-based Heart Rate Monitoring on Wearable Devices. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}