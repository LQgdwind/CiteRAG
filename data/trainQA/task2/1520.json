{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: GLocalX - From Local to Global Explanations of Black Box AI Models\n\nPaper Abstract: \n\nPaper Section Text:\nWe showcase the proposed approach on three benchmark datasets frequently used in the literature, namely adult444https://archive.ics.uci.edu/ml/datasets/Adult, compas555https://github.com/propublica/compas-analysis, and german666https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data), and a real world proprietary dataset, diva777https://kdd.isti.cnr.it/project/diva.\nThe adult dataset includes 48,8424884248,842 instances with information like age, job, marital status, race, capital loss, capital gain, etc.\nThe labels have values “<<=50K” or “>>50K”, indicating whether the person will earn more or less than 50​k​$50𝑘currency-dollar50k\\$ in this fiscal year.\nThe compas recidivism dataset contains the features used by the COMPAS algorithm for scoring defendants and their risk of recidivism (Low, Medium and High), for over 4,00040004,000 individuals.\nWe have considered the two classes “Low-Medium” and “Medium” as equivalent to map the task into a binary classification task.\nThe dataset includes features like: age, sex, race, priors count, days before screening arrest, length of sentence, charge degree, etc.\nIn german each one of the 1,00010001,000 persons is classified as a “good” or “bad” creditor according to attributes like age, sex, checking account, credit amount, loan purpose, etc.\nFinally, diva is a privately released dataset on fraud evasion, periodically issued by the Italian Ministry of Economics888Due to privacy and legal concerns, we are not allowed to publicly release the dataset..\ndiva records financial activities for more than 12,0001200012,000 citizens, including their past financial credit score, declared income and property value, debt and several taxation detailed infos.\nThe labels mark fraudulent citizens.\nThese datasets contain both categorical and continuous features.\nMissing values, if present, were replaced by the mean for continuous features and by the mode for categorical ones.\nDetails are reported in Table 1.\nSimilarly to the training/test classical split, we split the dataset into three partitions: X𝑏𝑏subscript𝑋𝑏𝑏X_{\\mathit{bb}}, the set of records to train a black box model; Xl​esubscript𝑋𝑙𝑒X_{le}, the set of locally explained records which is also used as reference set by GLocalX for calculating coverage and fidelity in training phase, and by the global competitors for training; X𝑡𝑠subscript𝑋𝑡𝑠X_{\\mathit{ts}}, the held-out set of records to validate the fidelity and accuracy of GLocalX.\nFigure 1 depicts this three-way split. We validate GLocalX on its ability to mime Deep Neural Networks (DNN), Random Forests (RF) and Support Vector Machines (SVM).\nThe black boxes have been trained on X𝑏𝑏subscript𝑋𝑏𝑏X_{\\mathit{bb}} with grid searches on a 333-fold cross-validation schema.\nGiven the poor performances of DNNs and SVMs on diva and german datasets, they were experimented upon only on Random Forests.\nPerformance in terms of accuracy of these black boxes are reported in Table 2 (3r​dsuperscript3𝑟𝑑3^{rd} column).\nGiven the novelty of the problem and the lack of local to global explainer in the literature999lime  and some other recent works extending lime claim to obtain a global explanation by joining local feature importance but in fact the resulting model is just a set of numbers and cannot be used to replace the black box, nor expresses in logical form the logic adopted by the black box for taking decisions., we compare GLocalX against natively global frameworks: Decision Tree  (dt), Pruned Decision Tree101010A pruned decision tree is a decision tree with maximum dept equals to four. We adopt four as maximum dept as it is the measure used in Optimal Decision trees . We do not compare with Optimal Decision trees due to the complexity of running the models that requires a particular architecture and the non public availability of the code.  (pdt) in a C4.5  implementation, and cpar , a rule-based classifier (rb) implemented in the LUCS-KDD library111111https://cgi.csc.liv.ac.uk/∼similar-to\\simfrans/KDD/Software. In addition, we also experiment with GLocalX in a particular setting in which only local explanations e1,…,ensubscript𝑒1…subscript𝑒𝑛e_{1},\\ldots,e_{n} are provided, and no data Xl​esubscript𝑋𝑙𝑒X_{le} is available.\nWe call this setting synthetic and name it GLocalX* for short.\nIn this case, we assume to have some information on the feature distribution, and employ a data generation and sampling schema similar to [ref]15 to construct a training dataset for GLocalX of the same size of Xl​esubscript𝑋𝑙𝑒X_{le}.\nSpecifically, the joint distribution has been estimated with a Gaussian density estimator, which has then been randomly sampled to build a training set for GLocalX*.\nThis dataset is then provided as input, and GLocalX is executed as previously defined.\nWith GLocalX*, we wish to grasp the learning abilities of GLocalX when a minimal input comprised exclusively of the local rules and data distributions is provided.\nA minimal assumption of knowledge on the data distribution is needed to validate the merging procedure.\nRelaxing this assumption would reduce the merging problem in a logical inference one, as no quantitative evaluation of any merge can be performed, leaving only intra-rule implication as a form of rule generalization.\nIn other words, when no knowledge on the data is available, the Local to Global problem is equivalent to a logic inference problem.\n\nReference markers found: [15]\n\nContext windows for each [ref]:\n[ref]15: call this setting synthetic and name it GLocalX* for short.\nIn this case, we assume to have some information on the feature distribution, and employ a data generation and sampling schema similar to [ref]15 to construct a training dataset for GLocalX of the same size of Xl​esubscript𝑋𝑙𝑒X_{le}.\nSpecifically, the joint distribution has been estimated with a Gaussian density estimator, which has\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 15,\n            \"titles\": [\n                \"Interpreting Tree Ensembles with inTrees\",\n                \"The black box society: The secret algorithms that control money and information\",\n                \"Explanation in Artificial Intelligence: Insights from the Social Sciences\",\n                \"Comprehensible classification models: a position paper\",\n                \"A Survey Of Methods For Explaining Black Box Models\",\n                \"How we analyzed the compas recidivism algorithm\",\n                \"Why a right to explanation of automated decision-making does not exist in the general data protection regulation\",\n                \"Why a right to legibility of automated decision-making exists in the General Data Protection Regulation\",\n                \"Helping your docker images to spread based on explainable models\",\n                \"Explainable ai: the new 42?\",\n                \"Peeking inside the black-box: A survey on explainable artificial intelligence (xai)\",\n                \"“Why Should I Trust You?” Explaining the Predictions of Any Classifier\",\n                \"Anchors: High-precision model-agnostic explanations\",\n                \"Factual and counterfactual explanations for black box decision making\",\n                \"Explaining multi-label black box classifiers for health applications\",\n                \"Extracting tree-structured representations of trained networks\",\n                \"A Unified Approach to Interpreting Model Predictions\",\n                \"Cpar: Classification based on predictive association rules\",\n                \"Interpretable decision sets: A joint framework for description and prediction\",\n                \"Learning qualitatively diverse and interpretable rules for classification\",\n                \"Ensembles of locally independent prediction models\",\n                \"Meaningful explanations of black box ai decision systems\",\n                \"On the robustness of interpretability methods\",\n                \"On the stability of interpretable models\",\n                \"C4. 5: Programs for Machine Learning\",\n                \"Classification based on predictive association rules of incomplete data\",\n                \"Deep learning in neural networks: An overview\",\n                \"Interpretable & Explorable Approximations of Black Box Models\",\n                \"Learning certifiably optimal rule lists\",\n                \"Yadt: Yet another decision tree builder\",\n                \"Using sampling and queries to extract rules from trained neural networks\",\n                \"Introduction to data mining\",\n                \"A value for n-person games\",\n                \"Clustering methods\",\n                \"‘all models are wrong…’: an introduction to model uncertainty\",\n                \"X-means: Extending k-means with efficient estimation of the number of clusters.\",\n                \"Tosca: two-steps clustering algorithm for personal locations detection\",\n                \"Pruning algorithms for rule learning\",\n                \"Learning from polyhedral sets\",\n                \"Optimal classification trees\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]15 based on the context and research area of GLocalX - From Local to Global Explanations of Black Box AI Models. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}