{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Annotated Dependency Pairs for Full Almost-Sure Termination of Probabilistic Term Rewritingfunded by the DFG Research Training Group 2236 UnRAVeL\n\nPaper Abstract: \n\nPaper Section Text:\nIn this section, we give all proofs for our new results and observations.\nIn the following, let Lâ€‹(x)=(pxğ”—,txğ”—)ğ¿ğ‘¥superscriptsubscriptğ‘ğ‘¥ğ”—superscriptsubscriptğ‘¡ğ‘¥ğ”—L(x)=(p_{x}^{\\mathfrak{T}},t_{x}^{\\mathfrak{T}}) denote the labeling of the node\nxğ‘¥x in the chain tree ğ”—ğ”—\\mathfrak{T}.\nWe say that a CT (or RST) ğ”—ğ”—\\mathfrak{T} converges (or terminates) with probability\npâˆˆâ„ğ‘â„p\\in\\mathbb{R} if we have |ğ”—|ğ™»ğšğšŠğš=psubscriptğ”—ğ™»ğšğšŠğšğ‘|\\mathfrak{T}|_{\\mathtt{Leaf}}=p.\nMoreover, we often write\n#Îµâ€‹(t)subscript#ğœ€ğ‘¡\\#_{\\varepsilon}(t) instead of #{Îµ}â€‹(t)subscript#ğœ€ğ‘¡\\#_{\\{\\varepsilon\\}}(t) and\n#ğ’Ÿâ€‹(t)subscript#ğ’Ÿğ‘¡\\#_{\\mathcal{D}}(t) instead of #Posğ’Ÿâ€‹(t)â€‹(t)subscript#subscriptPosğ’Ÿğ‘¡ğ‘¡\\#_{\\mathrm{Pos}_{\\mathcal{D}}(t)}(t) to annotate all defined symbols\nin a term tğ‘¡t.\nWe can now start with the proof of the sound and complete chain criterion for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. See 3.2 Proof. Soundness: Assume that â„›â„›\\mathcal{R} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nThen, there exists an â„›â„›\\mathcal{R}-RST ğ”—=(V,E,L)ğ”—ğ‘‰ğ¸ğ¿\\mathfrak{T}=(V,E,L)\nwhose root is labeled with (1:t):1ğ‘¡(1:t) for some term tâˆˆğ’¯ğ‘¡ğ’¯t\\in\\mathcal{T}\nthat converges with probability <1absent1<1.\nWe will construct a ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R})-CT ğ”—â€²=(V,E,Lâ€²,Vâˆ–ğ™»ğšğšŠğšğ”—)superscriptğ”—â€²ğ‘‰ğ¸superscriptğ¿â€²ğ‘‰superscriptğ™»ğšğšŠğšğ”—\\mathfrak{T}^{\\prime}=(V,E,L^{\\prime},V\\setminus\\mathtt{Leaf}^{\\mathfrak{T}})\nwith the same underlying tree structure and an adjusted labeling such that\npxğ”—=pxğ”—â€²superscriptsubscriptğ‘ğ‘¥ğ”—superscriptsubscriptğ‘ğ‘¥superscriptğ”—â€²p_{x}^{\\mathfrak{T}}=p_{x}^{\\mathfrak{T}^{\\prime}} for all xâˆˆVğ‘¥ğ‘‰x\\in V, where all the inner nodes are in Ağ´A.\nSince the tree structure and the probabilities are the same, we then get |ğ”—|ğ™»ğšğšŠğš=|ğ”—â€²|ğ™»ğšğšŠğšsubscriptğ”—ğ™»ğšğšŠğšsubscriptsuperscriptğ”—â€²ğ™»ğšğšŠğš|\\mathfrak{T}|_{\\mathtt{Leaf}}=|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}.\nTo be precise, the set of leaves in ğ”—ğ”—\\mathfrak{T} is equal to the set of leaves in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}, and they have the same probabilities.\nSince |ğ”—|ğ™»ğšğšŠğš<1subscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}|_{\\mathtt{Leaf}}<1, we thus have |ğ”—â€²|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}<1.\nHence, there exists a ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R})-CT ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} that converges with probability <1absent1<1\nand ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R}) is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} either. We label all nodes xâˆˆVğ‘¥ğ‘‰x\\in V in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} with #ğ’Ÿâ€‹(tx)subscript#ğ’Ÿsubscriptğ‘¡ğ‘¥\\#_{\\mathcal{D}}(t_{x}), where txsubscriptğ‘¡ğ‘¥t_{x} is the term for the node xğ‘¥x in ğ”—ğ”—\\mathfrak{T}.\nThe annotations ensure that we rewrite with Case (ğšğ­)ğšğ­(\\mathbf{at}) of Def.Â 4 so that the node xğ‘¥x is contained in Ağ´A.\nWe only have to show that ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} is indeed a valid CT, i.e., that the edge relation represents valid rewrite steps with â†ªğ’Ÿâ€‹ğ’«â€‹(â„›)subscriptabsentâ†ªğ’Ÿğ’«â„›\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{DP}(\\mathcal{R})}}.\nLet xâˆˆVâˆ–ğ™»ğšğšŠğšğ‘¥ğ‘‰ğ™»ğšğšŠğšx\\in V\\setminus\\mathtt{Leaf} and xâ€‹E={y1,â€¦,yk}ğ‘¥ğ¸subscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜xE=\\{y_{1},\\ldots,y_{k}\\} be the set of its successors.\nSince xğ‘¥x is not a leaf, we have txâ†’â„›{py1px:ty1,â€¦,pykpx:tyk}subscriptâ†’â„›subscriptğ‘¡ğ‘¥conditional-setsubscriptğ‘subscriptğ‘¦1subscriptğ‘ğ‘¥:subscriptğ‘¡subscriptğ‘¦1â€¦subscriptğ‘subscriptğ‘¦ğ‘˜subscriptğ‘ğ‘¥subscriptğ‘¡subscriptğ‘¦ğ‘˜t_{x}\\to_{\\mathcal{R}}\\{\\tfrac{p_{y_{1}}}{p_{x}}:t_{y_{1}},\\ldots,\\tfrac{p_{y_{k}}}{p_{x}}:t_{y_{k}}\\}.\nThis means that there is a rule â„“â†’{p1:r1,â€¦,pk:rk}âˆˆâ„›â†’â„“conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜â„›\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}\\in\\mathcal{R}, a position Ï€ğœ‹\\pi, and a substitution Ïƒğœ\\sigma such that tx|Ï€=â„“â€‹Ïƒevaluated-atsubscriptğ‘¡ğ‘¥ğœ‹â„“ğœ{t_{x}}|_{\\pi}=\\ell\\sigma.\nFurthermore, we have tyj=txâ€‹[rjâ€‹Ïƒ]Ï€subscriptğ‘¡subscriptğ‘¦ğ‘—subscriptğ‘¡ğ‘¥subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹t_{y_{j}}=t_{x}[r_{j}\\sigma]_{\\pi} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k. The corresponding ADP for the rule is â„“â†’{p1:#ğ’Ÿâ€‹(r1),â€¦,pk:#ğ’Ÿâ€‹(rk)}ğ—ğ—‹ğ—ğ–¾â†’â„“superscriptconditional-setsubscriptğ‘1:subscript#ğ’Ÿsubscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscript#ğ’Ÿsubscriptğ‘Ÿğ‘˜ğ—ğ—‹ğ—ğ–¾\\ell\\to\\{p_{1}:\\#_{\\mathcal{D}}(r_{1}),\\ldots,p_{k}:\\#_{\\mathcal{D}}(r_{k})\\}^{\\mathsf{true}}.\nFurthermore, Ï€âˆˆPosğ’Ÿ#â€‹(#ğ’Ÿâ€‹(tx))ğœ‹subscriptPossuperscriptğ’Ÿ#subscript#ğ’Ÿsubscriptğ‘¡ğ‘¥\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(\\#_{\\mathcal{D}}(t_{x})) as all defined symbols are annotated in #ğ’Ÿâ€‹(tx)subscript#ğ’Ÿsubscriptğ‘¡ğ‘¥\\#_{\\mathcal{D}}(t_{x}).\nHence, we can rewrite #ğ’Ÿâ€‹(tx)subscript#ğ’Ÿsubscriptğ‘¡ğ‘¥\\#_{\\mathcal{D}}(t_{x}) with â„“â†’{p1:#ğ’Ÿâ€‹(r1),â€¦,pk:#ğ’Ÿâ€‹(rk)}ğ—ğ—‹ğ—ğ–¾â†’â„“superscriptconditional-setsubscriptğ‘1:subscript#ğ’Ÿsubscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscript#ğ’Ÿsubscriptğ‘Ÿğ‘˜ğ—ğ—‹ğ—ğ–¾\\ell\\to\\{p_{1}:\\#_{\\mathcal{D}}(r_{1}),\\ldots,p_{k}:\\#_{\\mathcal{D}}(r_{k})\\}^{\\mathsf{true}},\nusing the position Ï€ğœ‹\\pi, the substitution Ïƒğœ\\sigma, and Case (ğšğ­)ğšğ­(\\mathbf{at}) of Def.Â 4 applies.\nFurthermore, we take some VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k} that is surjective on\nthe positions of the variables in the right-hand side, i.e., for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k\nand all positions Ï„âˆˆPosğ’±â€‹(rj)ğœsubscriptPosğ’±subscriptğ‘Ÿğ‘—\\tau\\in\\mathrm{Pos}_{\\mathcal{V}}(r_{j}) there exists a Ï„â€²âˆˆPosğ’±â€‹(â„“)superscriptğœâ€²subscriptPosğ’±â„“\\tau^{\\prime}\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell) such that Ï†jâ€‹(Ï„â€²)=Ï„subscriptğœ‘ğ‘—superscriptğœâ€²ğœ\\varphi_{j}(\\tau^{\\prime})=\\tau.\nSuch a VRF must exist, since â„›â„›\\mathcal{R} is non-duplicating.\nWe have #ğ’Ÿâ€‹(tx)â†ªğ’Ÿâ€‹ğ’«â€‹(â„›){p1:#ğ’Ÿâ€‹(ty1),â€¦,pk:#ğ’Ÿâ€‹(tyk)}subscriptabsentâ†ªğ’Ÿğ’«â„›subscript#ğ’Ÿsubscriptğ‘¡ğ‘¥conditional-setsubscriptğ‘1:subscript#ğ’Ÿsubscriptğ‘¡subscriptğ‘¦1â€¦subscriptğ‘ğ‘˜subscript#ğ’Ÿsubscriptğ‘¡subscriptğ‘¦ğ‘˜\\#_{\\mathcal{D}}(t_{x})\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{DP}(\\mathcal{R})}}\\{p_{1}:\\#_{\\mathcal{D}}(t_{y_{1}}),\\ldots,p_{k}:\\#_{\\mathcal{D}}(t_{y_{k}})\\} since\nby rewriting with (ğšğ­)ğšğ­(\\mathbf{at}) we get #ğ’Ÿâ€‹(tx)â€‹[#Î¦jâ€‹(rjâ€‹Ïƒ)]Ï€=#ğ’Ÿâ€‹(tyj)subscript#ğ’Ÿsubscriptğ‘¡ğ‘¥subscriptdelimited-[]subscript#subscriptÎ¦ğ‘—subscriptğ‘Ÿğ‘—ğœğœ‹subscript#ğ’Ÿsubscriptğ‘¡subscriptğ‘¦ğ‘—\\#_{\\mathcal{D}}(t_{x})[\\#_{\\Phi_{j}}(r_{j}\\sigma)]_{\\pi}=\\#_{\\mathcal{D}}(t_{y_{j}})\nwith Î¦jsubscriptÎ¦ğ‘—\\Phi_{j} defined as in Def.Â 4.\nNote that since the used VRF is surjective on the variable positions of the right-hand side, we do not remove any annotation in the substitution.\nFurthermore, we annotated all defined symbols in rjsubscriptğ‘Ÿğ‘—r_{j}.\nThus, we result in #ğ’Ÿâ€‹(tyj)subscript#ğ’Ÿsubscriptğ‘¡subscriptğ‘¦ğ‘—\\#_{\\mathcal{D}}(t_{y_{j}}) where all defined symbols are annotated again. Completeness: Assume that ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R}) is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nThen, there exists a ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R})-CT ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) whose root is labeled with (1:t):1ğ‘¡(1:t) for some annotated term tâˆˆğ’¯#ğ‘¡superscriptğ’¯#t\\in\\mathcal{T}^{\\#}\nthat converges with probability <1absent1<1.\nWe will construct an â„›â„›\\mathcal{R}-RST ğ”—â€²=(V,E,Lâ€²)superscriptğ”—â€²ğ‘‰ğ¸superscriptğ¿â€²\\mathfrak{T}^{\\prime}=(V,E,L^{\\prime}) with the same underlying tree structure and an adjusted labeling such that pxğ”—=pxğ”—â€²superscriptsubscriptğ‘ğ‘¥ğ”—superscriptsubscriptğ‘ğ‘¥superscriptğ”—â€²p_{x}^{\\mathfrak{T}}=p_{x}^{\\mathfrak{T}^{\\prime}} for all xâˆˆVğ‘¥ğ‘‰x\\in V.\nSince the tree structure and the probabilities are the same, we then get |ğ”—â€²|ğ™»ğšğšŠğš=|ğ”—|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²ğ™»ğšğšŠğšsubscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}=|\\mathfrak{T}|_{\\mathtt{Leaf}}<1.\nTherefore, there exists an â„›â„›\\mathcal{R}-RST ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} that converges with probability <1absent1<1.\nHence, â„›â„›\\mathcal{R} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} either. We label all nodes xâˆˆVğ‘¥ğ‘‰x\\in V in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} with â™­â€‹(tx)â™­subscriptğ‘¡ğ‘¥\\flat(t_{x}), where txsubscriptğ‘¡ğ‘¥t_{x} is the term for the node xğ‘¥x in ğ”—ğ”—\\mathfrak{T},\ni.e., we remove all annotations.\nWe only have to show that ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} is indeed a valid RST,\ni.e., that the edge relation represents valid rewrite steps with â†’â„›subscriptâ†’â„›\\to_{\\mathcal{R}},\nbut this follows directly from the fact that if we remove all annotations in Def.Â 4,\nthen we get the ordinary probabilistic term rewriting relation again.\nâˆ Next, we prove the sound and complete chain criterion for ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nIn the following,\nfor two (possibly annotated) terms s,tğ‘ ğ‘¡s,t we define sâ‰tapproaches-limitğ‘ ğ‘¡s\\doteq t if â™­â€‹(s)=â™­â€‹(t)â™­ğ‘ â™­ğ‘¡\\flat(s)=\\flat(t). See 3.3 Proof.\n\nSince the reachability component of the canonical basic ADP problem is empty, we just\nconsider ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R})-CTs. Soundness:\nWe use the same construction as for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} but the definition of the terms\nin the new ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R})-CT is slightly different.\nPreviously, all defined symbols were annotated.\nNow, we do not annotate all of them, but we may remove annotations from defined symbols\nif the corresponding subterm at this position is in normal form.\nFurthermore, the initial term tğ‘¡t is a basic term and thus, #ğ’Ÿâ€‹(t)=t#subscript#ğ’Ÿğ‘¡superscriptğ‘¡#\\#_{\\mathcal{D}}(t)=t^{\\#}. We construct the new labeling Lâ€²superscriptğ¿â€²L^{\\prime} for the ğ’Ÿâ€‹ğ’«â€‹(â„›)ğ’Ÿğ’«â„›\\mathcal{DP}(\\mathcal{R})-CT inductively such that for all inner nodes xâˆˆVâˆ–ğ™»ğšğšŠğšğ‘¥ğ‘‰ğ™»ğšğšŠğšx\\in V\\setminus\\mathtt{Leaf} with children nodes xâ€‹E={y1,â€¦,yk}ğ‘¥ğ¸subscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜xE=\\{y_{1},\\ldots,y_{k}\\} we have txâ€²â†ªğ’Ÿâ€‹ğ’«â€‹(â„›){py1px:ty1â€²,â€¦,pykpx:tykâ€²}subscriptabsentâ†ªğ’Ÿğ’«â„›superscriptsubscriptğ‘¡ğ‘¥â€²conditional-setsubscriptğ‘subscriptğ‘¦1subscriptğ‘ğ‘¥:superscriptsubscriptğ‘¡subscriptğ‘¦1â€²â€¦subscriptğ‘subscriptğ‘¦ğ‘˜subscriptğ‘ğ‘¥superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘˜â€²t_{x}^{\\prime}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{DP}(\\mathcal{R})}}\\{\\tfrac{p_{y_{1}}}{p_{x}}:t_{y_{1}}^{\\prime},\\ldots,\\tfrac{p_{y_{k}}}{p_{x}}:t_{y_{k}}^{\\prime}\\}.\nLet XâŠ†Vğ‘‹ğ‘‰X\\subseteq V be the set of nodes xğ‘¥x where we have already defined the labeling Lâ€²â€‹(x)superscriptğ¿â€²ğ‘¥L^{\\prime}(x).\nFurthermore, for any term tâˆˆğ’¯ğ‘¡ğ’¯t\\in\\mathcal{T} let\nPosPossâ€‹(t,â„›)={Ï€âˆ£Ï€âˆˆPosğ’Ÿâ€‹(t),t|Ï€âˆ‰ğ™½ğ™µâ„›}subscriptPosPosstâ„›conditional-setğœ‹formulae-sequenceğœ‹subscriptPosğ’Ÿtevaluated-attğœ‹subscriptğ™½ğ™µâ„›{\\mathrm{Pos}_{\\text{Poss}}}(t,\\mathcal{R})=\\{\\pi\\mid\\pi\\in\\mathrm{Pos}_{\\mathcal{D}}(t),t|_{\\pi}\\notin\\mathtt{NF}_{\\mathcal{R}}\\}.\nDuring our construction, we ensure that the following property holds: This means that the corresponding term txsubscriptğ‘¡ğ‘¥t_{x} for the node xğ‘¥x in ğ”—ğ”—\\mathfrak{T}\nhas the same structure as the term txâ€²superscriptsubscriptğ‘¡ğ‘¥â€²t_{x}^{\\prime} in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime},\nand additionally, at least all possible redexes in txsubscriptğ‘¡ğ‘¥t_{x} are annotated in txâ€²superscriptsubscriptğ‘¡ğ‘¥â€²t_{x}^{\\prime}.\nThe annotations ensure that we rewrite with Case (ğšğ­)ğšğ­(\\mathbf{at}) of Def.Â 4 so that the node xğ‘¥x is contained in Ağ´A.\nWe label the root of ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} with t#superscriptğ‘¡#t^{\\#}.\nHere, we have tâ‰t#approaches-limitğ‘¡superscriptğ‘¡#t\\doteq t^{\\#} and PosPossâ€‹(t,â„›)={Îµ}=Posğ’Ÿ#â€‹(t#)subscriptPosPossğ‘¡â„›ğœ€subscriptPossuperscriptğ’Ÿ#superscriptğ‘¡#\\mathrm{Pos}_{\\text{Poss}}(t,\\mathcal{R})=\\{\\varepsilon\\}=\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\#}), since tğ‘¡t is a basic term.\nAs long as there is still an inner node xâˆˆXğ‘¥ğ‘‹x\\in X such that its successors are not contained in Xğ‘‹X, we do the following.\nLet xâ€‹E={y1,â€¦,yk}ğ‘¥ğ¸subscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜xE=\\{y_{1},\\ldots,y_{k}\\} be the set of its successors.\nWe need to define the corresponding terms ty1â€²,â€¦,tykâ€²superscriptsubscriptğ‘¡subscriptğ‘¦1â€²â€¦superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘˜â€²t_{y_{1}}^{\\prime},\\ldots,t_{y_{k}}^{\\prime} for the nodes y1,â€¦,yksubscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜y_{1},\\ldots,y_{k}.\nSince xğ‘¥x is not a leaf, we have txâ†’â„›{py1px:ty1,â€¦,pykpx:tyk}subscriptâ†’â„›subscriptğ‘¡ğ‘¥conditional-setsubscriptğ‘subscriptğ‘¦1subscriptğ‘ğ‘¥:subscriptğ‘¡subscriptğ‘¦1â€¦subscriptğ‘subscriptğ‘¦ğ‘˜subscriptğ‘ğ‘¥subscriptğ‘¡subscriptğ‘¦ğ‘˜t_{x}\\to_{\\mathcal{R}}\\{\\tfrac{p_{y_{1}}}{p_{x}}:t_{y_{1}},\\ldots,\\tfrac{p_{y_{k}}}{p_{x}}:t_{y_{k}}\\}, i.e., there is a rule â„“â†’{p1:r1,â€¦,pk:rk}âˆˆâ„›â†’â„“conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜â„›\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}\\in\\mathcal{R}, a position Ï€ğœ‹\\pi, and a substitution Ïƒğœ\\sigma such that tx|Ï€=â„“â€‹Ïƒevaluated-atsubscriptğ‘¡ğ‘¥ğœ‹â„“ğœ{t_{x}}|_{\\pi}=\\ell\\sigma.\nFurthermore, we have tyj=txâ€‹[rjâ€‹Ïƒ]Ï€subscriptğ‘¡subscriptğ‘¦ğ‘—subscriptğ‘¡ğ‘¥subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹t_{y_{j}}=t_{x}[r_{j}\\sigma]_{\\pi} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k. The corresponding ADP for the rule is â„“â†’{p1:#ğ’Ÿâ€‹(r1),â€¦,pk:#ğ’Ÿâ€‹(rk)}ğ—ğ—‹ğ—ğ–¾â†’â„“superscriptconditional-setsubscriptğ‘1:subscript#ğ’Ÿsubscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscript#ğ’Ÿsubscriptğ‘Ÿğ‘˜ğ—ğ—‹ğ—ğ–¾\\ell\\to\\{p_{1}:\\#_{\\mathcal{D}}(r_{1}),\\ldots,p_{k}:\\#_{\\mathcal{D}}(r_{k})\\}^{\\mathsf{true}}.\nFurthermore, Ï€âˆˆPosPossâ€‹(tx,â„›)âŠ†(Iâ€‹H)Posğ’Ÿ#â€‹(txâ€²)ğœ‹subscriptPosPosssubscriptğ‘¡ğ‘¥â„›subscriptğ¼ğ»subscriptPossuperscriptğ’Ÿ#superscriptsubscriptğ‘¡ğ‘¥â€²\\pi\\in\\mathrm{Pos}_{\\text{Poss}}(t_{x},\\mathcal{R})\\subseteq_{(IH)}\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{x}^{\\prime}) and txâ‰(Iâ€‹H)txâ€²subscriptapproaches-limitğ¼ğ»subscriptğ‘¡ğ‘¥superscriptsubscriptğ‘¡ğ‘¥â€²t_{x}\\doteq_{(IH)}t_{x}^{\\prime}.\nHence, we can rewrite txâ€²superscriptsubscriptğ‘¡ğ‘¥â€²t_{x}^{\\prime} with â„“â†’{p1:#ğ’Ÿâ€‹(r1),â€¦,pk:#ğ’Ÿâ€‹(rk)}ğ—ğ—‹ğ—ğ–¾â†’â„“superscriptconditional-setsubscriptğ‘1:subscript#ğ’Ÿsubscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscript#ğ’Ÿsubscriptğ‘Ÿğ‘˜ğ—ğ—‹ğ—ğ–¾\\ell\\to\\{p_{1}:\\#_{\\mathcal{D}}(r_{1}),\\ldots,p_{k}:\\#_{\\mathcal{D}}(r_{k})\\}^{\\mathsf{true}},\nusing the position Ï€ğœ‹\\pi\nand the substitution Ïƒğœ\\sigma, and Case (ğšğ­)ğšğ­(\\mathbf{at}) of Def.Â 4 applies.\nAdditionally, we use a VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k} that is surjective on the\npositions of those variables\nthat occur at least as often in the left-hand side as in the right-hand sides. The\npositions of all other variables (i.e., all variables that are duplicated) are\nmapped to âŠ¥bottom\\bot.\nNote that â„›â„›\\mathcal{R} is weakly spare, hence such variables can only be instantiated by normal forms.\nWe get txâ€²â†ªğ’Ÿâ€‹ğ’«â€‹(â„›){p1:ty1â€²,â€¦,pk:tykâ€²}subscriptabsentâ†ªğ’Ÿğ’«â„›superscriptsubscriptğ‘¡ğ‘¥â€²conditional-setsubscriptğ‘1:superscriptsubscriptğ‘¡subscriptğ‘¦1â€²â€¦subscriptğ‘ğ‘˜superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘˜â€²t_{x}^{\\prime}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{DP}(\\mathcal{R})}}\\{p_{1}:t_{y_{1}}^{\\prime},\\ldots,p_{k}:t_{y_{k}}^{\\prime}\\} with\ntyjâ€²=txâ€²â€‹[#Î¦jâ€‹(rjâ€‹Ïƒ)]Ï€superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²superscriptsubscriptğ‘¡ğ‘¥â€²subscriptdelimited-[]subscript#subscriptÎ¦ğ‘—subscriptğ‘Ÿğ‘—ğœğœ‹t_{y_{j}}^{\\prime}=t_{x}^{\\prime}[\\#_{\\Phi_{j}}(r_{j}\\sigma)]_{\\pi} by (ğšğ­)ğšğ­(\\mathbf{at})\nwith Î¦jsubscriptÎ¦ğ‘—\\Phi_{j} defined as in Def.Â 4.\nThis means that we have tyjâ‰tyjâ€²approaches-limitsubscriptğ‘¡subscriptğ‘¦ğ‘—superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²t_{y_{j}}\\doteq t_{y_{j}}^{\\prime}.\nIt remains to prove PosPossâ€‹(tyj,â„›)âŠ†Posğ’Ÿ#â€‹(tyjâ€²)subscriptPosPosssubscriptğ‘¡subscriptğ‘¦ğ‘—â„›subscriptPossuperscriptğ’Ÿ#superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²\\mathrm{Pos}_{\\text{Poss}}(t_{y_{j}},\\mathcal{R})\\subseteq\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{y_{j}}^{\\prime}) for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k.\nFor all positions Ï„âˆˆPosPossâ€‹(tyj,â„›)=PosPossâ€‹(txâ€‹[rjâ€‹Ïƒ]Ï€,â„›)ğœsubscriptPosPosssubscriptğ‘¡subscriptğ‘¦ğ‘—â„›subscriptPosPosssubscriptğ‘¡ğ‘¥subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹â„›\\tau\\in\\mathrm{Pos}_{\\text{Poss}}(t_{y_{j}},\\mathcal{R})=\\mathrm{Pos}_{\\text{Poss}}(t_{x}[r_{j}\\sigma]_{\\pi},\\mathcal{R}) that are orthogonal or above Ï€ğœ‹\\pi, we have Ï„âˆˆPosPossâ€‹(tx,â„›)âŠ†(Iâ€‹H)Posğ’Ÿ#â€‹(txâ€²)ğœsubscriptPosPosssubscriptğ‘¡ğ‘¥â„›subscriptğ¼ğ»subscriptPossuperscriptğ’Ÿ#superscriptsubscriptğ‘¡ğ‘¥â€²\\tau\\in\\mathrm{Pos}_{\\text{Poss}}(t_{x},\\mathcal{R})\\subseteq_{(IH)}\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{x}^{\\prime}), and all annotations orthogonal or above Ï€ğœ‹\\pi remain in tyjâ€²superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²t_{y_{j}}^{\\prime} as they were in txâ€²superscriptsubscriptğ‘¡ğ‘¥â€²t_{x}^{\\prime}.\nFor all positions Ï„âˆˆPosPossâ€‹(tyj,â„›)=PosPossâ€‹(txâ€‹[rjâ€‹Ïƒ]Ï€,â„›)ğœsubscriptPosPosssubscriptğ‘¡subscriptğ‘¦ğ‘—â„›subscriptPosPosssubscriptğ‘¡ğ‘¥subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹â„›\\tau\\in\\mathrm{Pos}_{\\text{Poss}}(t_{y_{j}},\\mathcal{R})=\\mathrm{Pos}_{\\text{Poss}}(t_{x}[r_{j}\\sigma]_{\\pi},\\mathcal{R}) that are below Ï€ğœ‹\\pi, we have two possibilities: (1) at least the defined root symbol of tyj|Ï„evaluated-atsubscriptğ‘¡subscriptğ‘¦ğ‘—ğœt_{y_{j}}|_{\\tau} is inside rjsubscriptğ‘Ÿğ‘—r_{j},\nand thus Ï„âˆˆPosğ’Ÿ#â€‹(tyjâ€²)ğœsubscriptPossuperscriptğ’Ÿ#superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{y_{j}}^{\\prime}), as all defined symbols of rjsubscriptğ‘Ÿğ‘—r_{j} are annotated in\ntyjâ€²=txâ€²â€‹[#Î¦jâ€‹(rj)â€‹Ïƒ]Ï€superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²superscriptsubscriptğ‘¡ğ‘¥â€²subscriptdelimited-[]subscript#subscriptÎ¦ğ‘—subscriptğ‘Ÿğ‘—ğœğœ‹t_{y_{j}}^{\\prime}=t_{x}^{\\prime}[\\#_{\\Phi_{j}}(r_{j})\\sigma]_{\\pi},\nor (2) Ï„ğœ\\tau is below a non-duplicated variable\n(otherwise the subterm tyj|Ï„evaluated-atsubscriptğ‘¡subscriptğ‘¦ğ‘—ğœt_{y_{j}}|_{\\tau} has to be a normal form and thus,\nÏ„âˆ‰PosPossâ€‹(tyj,â„›)ğœsubscriptPosPosssubscriptğ‘¡subscriptğ‘¦ğ‘—â„›\\tau\\notin\\mathrm{Pos}_{\\text{Poss}}(t_{y_{j}},\\mathcal{R})),\nand hence, it is still annotated in tyjâ€²superscriptsubscriptğ‘¡subscriptğ‘¦ğ‘—â€²t_{y_{j}}^{\\prime} due to the used VRF.\nThis ends the induction proof for this direction. Completeness: Completely the same as in the proof of Thm.Â 3.2.\nâˆ Next, we consider the theorems regarding the processors\nthat we adapted from [ref]31 to our new framework for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} and\nğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nWe first recapitulate the notion of a sub-chain tree from . Let ğ’«ğ’«\\mathcal{P} be an ADP problem and let ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) be a tree that satisfies Conditions (1)-(5) of a ğ’«ğ’«\\mathcal{P}-CT.\nLet WâŠ†Vğ‘Šğ‘‰W\\subseteq V be non-empty, weakly connected, and for all xâˆˆWğ‘¥ğ‘Šx\\in W we have xâ€‹Eâˆ©W=âˆ…ğ‘¥ğ¸ğ‘ŠxE\\cap W=\\varnothing or xâ€‹Eâˆ©W=xâ€‹Eğ‘¥ğ¸ğ‘Šğ‘¥ğ¸xE\\cap W=xE.\nThen, we define the subtree (or sub-CT if it satisfies Condition (6) as well) ğ”—â€‹[W]ğ”—delimited-[]ğ‘Š\\mathfrak{T}[W] by ğ”—â€‹[W]=(W,Eâˆ©(WÃ—W),LW,Aâˆ©(Wâˆ–Wğ™»ğšğšŠğš))ğ”—delimited-[]ğ‘Šğ‘Šğ¸ğ‘Šğ‘Šsuperscriptğ¿ğ‘Šğ´ğ‘Šsubscriptğ‘Šğ™»ğšğšŠğš\\mathfrak{T}[W]=(W,E\\cap(W\\times W),L^{W},A\\cap(W\\setminus W_{\\mathtt{Leaf}})).\nHere, Wğ™»ğšğšŠğšsubscriptğ‘Šğ™»ğšğšŠğšW_{\\mathtt{Leaf}} denotes the leaves of the tree Gğ”—â€‹[W]=(W,Eâˆ©(WÃ—W))superscriptğºğ”—delimited-[]ğ‘Šğ‘Šğ¸ğ‘Šğ‘ŠG^{\\mathfrak{T}[W]}=(W,E\\cap(W\\times W)) so that the new set Aâˆ©(Wâˆ–Wğ™»ğšğšŠğš)ğ´ğ‘Šsubscriptğ‘Šğ™»ğšğšŠğšA\\cap(W\\setminus W_{\\mathtt{Leaf}}) only contains inner nodes.\nLet wâˆˆWğ‘¤ğ‘Šw\\in W be the root of Gğ”—â€‹[W]superscriptğºğ”—delimited-[]ğ‘ŠG^{\\mathfrak{T}[W]}.\nTo ensure that the root of our subtree has the probability 111 again,\nwe use the labeling LW(x)=(pxğ”—pwğ”—:txğ”—)L^{W}(x)=(\\frac{p_{x}^{\\mathfrak{T}}}{p_{w}^{\\mathfrak{T}}}:t_{x}^{\\mathfrak{T}})\nfor all nodes xâˆˆWğ‘¥ğ‘Šx\\in W.\nIf Wğ‘ŠW contains the root of (V,E)ğ‘‰ğ¸(V,E), then we call the sub-chain tree grounded. Reconsider the PTRS â„›1subscriptâ„›1\\mathcal{R}_{1} containing the only rule ğ—€â†’{3/4:ğ–½â€‹(ğ—€),1/4:ğŸ¢}â†’ğ—€conditional-set34:ğ–½ğ—€140\\mathsf{g}\\to\\{\\nicefrac{{3}}{{4}}:\\mathsf{d}(\\mathsf{g}),\\,\\nicefrac{{1}}{{4}}:\\mathsf{0}\\}.\nBelow one can see the â„›1subscriptâ„›1\\mathcal{R}_{1}-RST from Sect.Â 2 (on the left), and the subtree that starts at the node of the term ğ–½â€‹(ğ—€)ğ–½ğ—€\\mathsf{d}(\\mathsf{g}) (on the right).\nNote that the probabilities are normalized such that the root has the probability 111 again. The property of being non-empty and weakly connected ensures that the resulting\ngraph Gğ”—â€‹[W]superscriptğºğ”—delimited-[]ğ‘ŠG^{\\mathfrak{T}[W]} is a tree again.\nThe property that we either have xâ€‹Eâˆ©W=âˆ…ğ‘¥ğ¸ğ‘ŠxE\\cap W=\\varnothing or xâ€‹Eâˆ©W=xâ€‹Eğ‘¥ğ¸ğ‘Šğ‘¥ğ¸xE\\cap W=xE ensures that the sum of\nprobabilities for the successors of a node xğ‘¥x is equal to the probability for the node xğ‘¥x itself. Next, we recapitulate a lemma\nand adapt another important lemma from .\nAfterwards, we prove the theorems on the processors.\nWe start with the A-partition lemma.\nThis lemma was proven in \n(where it was called â€œP-partition lemmaâ€)\nand still applies to our new ADP problems, since the structure of our\nCTs is the same as in  . Let ğ’«ğ’«\\mathcal{P} be an ADP problem and let ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) be a ğ’«ğ’«\\mathcal{P}-CT that converges with probability <1absent1<1.\nAssume that we can partition A=A1âŠA2ğ´âŠsubscriptğ´1subscriptğ´2A=A_{1}\\uplus A_{2} such that every sub-CT that only contains Ağ´A-nodes from A1subscriptğ´1A_{1} converges with probability 111.\nThen there is a grounded sub-CT ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} that converges with probability <1absent1<1 such that every infinite path has an infinite number of nodes from A2subscriptğ´2A_{2}. Proof.\n\nSee , as this proof does not depend on the used rewrite strategy but just on the structure of a chain tree.\nâˆ Next, we adapt the proof of the starting lemma from\n .\nIt shows that w.l.o.g., we can assume\nthat we label the root of our CT with (1:t):1ğ‘¡(1:t)\nfor an annotated term tğ‘¡t such that Posğ’Ÿ#â€‹(t)={Îµ}subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)=\\{\\varepsilon\\}, i.e., only the root is annotated.\nThis obviously holds for ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, but\nthe starting lemma shows that it can also be assumed for\nğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nFor the following proofs,\nwe extend Def.Â 4 by the missing (ğ§ğŸ)ğ§ğŸ(\\mathbf{nf}) case.\nAs discussed in Sect.Â 3, this does not change the definition of ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} for chain\ntrees, but it allows us to still perform the same rewrite steps in a CT if annotations are\nremoved. Let ğ’«ğ’«\\mathcal{P} be an ADP problem.\nA term sâˆˆğ’¯#ğ‘ superscriptğ’¯#s\\in\\mathcal{T}^{\\#} rewrites with ğ’«ğ’«\\mathcal{P} to\nÎ¼={p1:t1,â€¦,pk:tk}ğœ‡conditional-setsubscriptğ‘1:subscriptğ‘¡1â€¦subscriptğ‘ğ‘˜subscriptğ‘¡ğ‘˜\\mu=\\{p_{1}:t_{1},\\ldots,p_{k}:t_{k}\\} (denoted sâ†ªğ’«Î¼subscriptabsentâ†ªğ’«ğ‘ ğœ‡s\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}\\mu)\nif there are an ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆğ’«absentâ†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šğ’«\\ell\\mathrel{\\xrightarrow{}\\!\\!}\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\mathcal{P}, a VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k} for this ADP, a substitution Ïƒğœ\\sigma,\nand a position Ï€âˆˆPosğ’Ÿâˆªğ’Ÿ#â€‹(s)ğœ‹subscriptPosğ’Ÿsuperscriptğ’Ÿ#ğ‘ \\pi\\in\\mathrm{Pos}_{\\mathcal{D}\\cup\\mathcal{D}^{\\#}}(s) such that â™­â€‹(s|Ï€)=â„“â€‹Ïƒâ™­evaluated-atğ‘ ğœ‹â„“ğœ\\flat(s|_{\\pi})=\\ell\\sigma,\nand for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k we have Here, Î¨j={Ï†j(Ï).Ï„âˆ£ÏâˆˆPosğ’±(â„“),Ï†j(Ï)â‰ âŠ¥,Ï.Ï„âˆˆPosğ’Ÿ#(s|Ï€)}\\Psi_{j}\\!=\\!\\{\\varphi_{j}(\\rho).\\tau\\mid\\rho\\!\\in\\!\\mathrm{Pos}_{\\mathcal{V}}(\\ell),\\,\\varphi_{j}(\\rho)\\!\\neq\\!\\bot,\\,\\rho.\\tau\\!\\in\\!\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(s|_{\\pi})\\}\nand Î¦j=Posğ’Ÿ#â€‹(rj)âˆªÎ¨jsubscriptÎ¦ğ‘—subscriptPossuperscriptğ’Ÿ#subscriptğ‘Ÿğ‘—subscriptÎ¨ğ‘—\\Phi_{j}\\!=\\!\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(r_{j})\\cup\\Psi_{j}. If an ADP problem ğ’«ğ’«\\mathcal{P} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then there exists a ğ’«ğ’«\\mathcal{P}-CT\nğ”—ğ”—\\mathfrak{T} with |ğ”—|ğ™»ğšğšŠğš<1subscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}|_{\\mathtt{Leaf}}<1 that starts with (1:t):1ğ‘¡(1:t) where Posğ’Ÿ#â€‹(t)={Îµ}subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)=\\{\\varepsilon\\}. Proof.\n\nWe prove the contraposition.\nAssume that every ğ’«ğ’«\\mathcal{P}-CT ğ”—ğ”—\\mathfrak{T}\nconverges with probability 111 if it\nstarts with (1:t):1ğ‘¡(1:t) and Posğ’Ÿ#â€‹(t)={Îµ}subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)=\\{\\varepsilon\\}.\nWe now prove that then also every ğ’«ğ’«\\mathcal{P}-CT ğ”—ğ”—\\mathfrak{T}\nthat starts with (1:t):1ğ‘¡(1:t) for some arbitrary term tğ‘¡t converges with probability 111,\nand thus ğ’«ğ’«\\mathcal{P} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nWe prove the claim by induction on the number of annotations in the initial term tğ‘¡t. If tğ‘¡t contains no annotation, then the CT\nstarting with (1:t):1ğ‘¡(1:t) is trivially finite (it cannot contain an infinite path, since there are no nodes in Ağ´A) and hence, it converges with probability 111.\nNext, if tğ‘¡t contains exactly one annotation at position Ï€ğœ‹\\pi, then we can ignore everything above the annotation, as we will never use an Ağ´A-step above the annotated position, and we cannot duplicate or change annotations by rewriting above them, since we use VRFs and not GVRFs.\nHowever, for t|Ï€evaluated-atğ‘¡ğœ‹t|_{\\pi} with Posğ’Ÿ#â€‹(t|Ï€)={Îµ}subscriptPossuperscriptğ’Ÿ#evaluated-atğ‘¡ğœ‹ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t|_{\\pi})=\\{\\varepsilon\\},\nwe know by our assumption that such a CT converges with probability 111. Now we regard the induction step, and assume for a contradiction that for a term tğ‘¡t with n>1ğ‘›1n>1 annotations, there is a CT ğ”—ğ”—\\mathfrak{T} that\nconverges with probability <1absent1<1.\nHere, our induction hypothesis is that every ğ’«ğ’«\\mathcal{P}-CT ğ”—ğ”—\\mathfrak{T} that starts with (1:tâ€²):1superscriptğ‘¡â€²(1:t^{\\prime}), where tâ€²superscriptğ‘¡â€²t^{\\prime} contains mğ‘šm annotations for some 1â‰¤m<n1ğ‘šğ‘›1\\leq m<n converges with probability 111.Let Î 1={Ï„}subscriptÎ 1ğœ\\Pi_{1}=\\{\\tau\\} and Î 2={Ï‡âˆˆPosğ’Ÿ#â€‹(t)âˆ£Ï‡â‰ Ï„}subscriptÎ 2conditional-setğœ’subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ’ğœ\\Pi_{2}=\\{\\chi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)\\mid\\chi\\neq\\tau\\} for some Ï„âˆˆPosğ’Ÿ#â€‹(t)ğœsubscriptPossuperscriptğ’Ÿ#ğ‘¡\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t) and consider the two terms #Î 1â€‹(t)subscript#subscriptÎ 1ğ‘¡\\#_{\\Pi_{1}}(t) and #Î 2â€‹(t)subscript#subscriptÎ 2ğ‘¡\\#_{\\Pi_{2}}(t), which contain both strictly less than nğ‘›n annotations.\nBy our induction hypothesis, we know that every ğ’«ğ’«\\mathcal{P}-CT that starts with (1:#Î 1â€‹(t)):1subscript#subscriptÎ 1ğ‘¡(1:\\#_{\\Pi_{1}}(t)) or (1:#Î 2â€‹(t)):1subscript#subscriptÎ 2ğ‘¡(1:\\#_{\\Pi_{2}}(t)) converges with probability 111.\nLet ğ”—1=(V,E,L1,A1)subscriptğ”—1ğ‘‰ğ¸subscriptğ¿1subscriptğ´1\\mathfrak{T}_{1}=(V,E,L_{1},A_{1}) be the tree that starts with (1:#Î 1â€‹(t)):1subscript#subscriptÎ 1ğ‘¡(1:\\#_{\\Pi_{1}}(t))\nand uses the same rules as we did in ğ”—ğ”—\\mathfrak{T}. (Here, the new definition of the rewrite\nrelation â†ªğ’«subscriptabsentâ†ªğ’«\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}} including the case\n(ğ§ğŸ)ğ§ğŸ(\\mathbf{nf}) from Def.Â 8 is needed in order to ensure that one can still use the same rules as in ğ”—ğ”—\\mathfrak{T} although we now may have less annotations.) We can partition Ağ´A into the sets A1subscriptğ´1A_{1} and A2=Aâˆ–A1subscriptğ´2ğ´subscriptğ´1A_{2}=A\\setminus A_{1}.\nNote that ğ”—1subscriptğ”—1\\mathfrak{T}_{1} itself may not be a ğ’«ğ’«\\mathcal{P}-CT again, since there might exist paths without\nan infinite number of A1subscriptğ´1A_{1}-nodes,\nbut obviously every subtree ğ”—1â€²subscriptsuperscriptğ”—â€²1\\mathfrak{T}^{\\prime}_{1} of ğ”—1subscriptğ”—1\\mathfrak{T}_{1} such that every infinite path has an infinite number\nof A1subscriptğ´1A_{1}-nodes is a ğ’«ğ’«\\mathcal{P}-CT again.\nMoreover, by extending such a subtree to be grounded, i.e., adding the initial path from the root of\nğ”—1subscriptğ”—1\\mathfrak{T}_{1} to ğ”—1â€²subscriptsuperscriptğ”—â€²1\\mathfrak{T}^{\\prime}_{1},\nwe created a ğ’«ğ’«\\mathcal{P}-CT that starts with #Î 1â€‹(t)subscript#subscriptÎ 1ğ‘¡\\#_{\\Pi_{1}}(t),\nand hence by our induction hypothesis, converges with probability 111. Thus, this also\nholds for ğ”—1â€²subscriptsuperscriptğ”—â€²1\\mathfrak{T}^{\\prime}_{1}. We want to use the A-partition lemma (LemmaÂ 1) for the tree ğ”—ğ”—\\mathfrak{T}.\nFor this, we have to show that every sub-CT ğ”—1â€²subscriptsuperscriptğ”—â€²1\\mathfrak{T}^{\\prime}_{1} of ğ”—ğ”—\\mathfrak{T}\nthat only contains Ağ´A-nodes from A1subscriptğ´1A_{1} converges with probability 111.\nBut since ğ”—1â€²subscriptsuperscriptğ”—â€²1\\mathfrak{T}^{\\prime}_{1} only contains Ağ´A-nodes from A1subscriptğ´1A_{1}\nit must either contain infinitely many A1subscriptğ´1A_{1}-nodes,\nand by the previous paragraph it converges with probability 111,\nor it contains only finitely many A1subscriptğ´1A_{1}-nodes, hence must be finite itself,\nand also converges with probability 111. Now, we have shown that the conditions for the A-partition lemma (LemmaÂ 1) are satisfied.\nThus, we can apply the A-partition lemma to obtain a grounded sub-CT\nğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} of ğ”—ğ”—\\mathfrak{T} with |ğ”—â€²|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}<1 such that on every infinite path, we have an infinite number of A2subscriptğ´2A_{2} nodes.\nLet ğ”—2subscriptğ”—2\\mathfrak{T}_{2} be the tree that starts with #Î 2â€‹(t)subscript#subscriptÎ 2ğ‘¡\\#_{\\Pi_{2}}(t)\nand uses the same rules as we did in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}.\nAgain, all local properties for a ğ’«ğ’«\\mathcal{P}-CT are satisfied.\nAdditionally, this time we know that every infinite path has an infinite number of A2subscriptğ´2A_{2}-nodes in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}, hence we also know that the global property for ğ”—2subscriptğ”—2\\mathfrak{T}_{2} is satisfied.\nThis means that ğ”—2subscriptğ”—2\\mathfrak{T}_{2} is a ğ’«ğ’«\\mathcal{P}-CT that starts with\n#Î 2â€‹(t)subscript#subscriptÎ 2ğ‘¡\\#_{\\Pi_{2}}(t) and with |ğ”—2|ğ™»ğšğšŠğš<1subscriptsubscriptğ”—2ğ™»ğšğšŠğš1|\\mathfrak{T}_{2}|_{\\mathtt{Leaf}}<1.\nThis is our desired contradiction, which proves the induction step.\nâˆ As only the root position of the term at the root of the CT is annotated, we can\nassume that\nthe step from the root of the CT to its children corresponds to a\nrewrite step at the root of this term.\nThe reason is that we have to eventually rewrite at this root position of the term in a CT that converges with\nprobability <1absent1<1. Hence, w.l.o.g.Â we can start with this root rewrite step. Next, we adapt the soundness and completeness proofs for the processors from  from\ninnermost to full rewriting. See 4.2 Proof.\n\nLet XÂ¯=Xâˆªâ™­â€‹(ğ’«âˆ–X)Â¯ğ‘‹ğ‘‹â™­ğ’«ğ‘‹\\overline{X}=X\\cup\\flat(\\mathcal{P}\\setminus X) for XâŠ†ğ’«ğ‘‹ğ’«X\\subseteq\\mathcal{P}. Completeness: Every ğ’«iÂ¯Â¯subscriptğ’«ğ‘–\\overline{\\mathcal{P}_{i}}-CT is also a ğ’«ğ’«\\mathcal{P}-CT with fewer annotations in the terms.\nSo if some ğ’«iÂ¯Â¯subscriptğ’«ğ‘–\\overline{\\mathcal{P}_{i}} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then there exists a ğ’«iÂ¯Â¯subscriptğ’«ğ‘–\\overline{\\mathcal{P}_{i}}-CT ğ”—ğ”—\\mathfrak{T} that converges with probability <1absent1<1.\nBy adding annotations to the terms of the tree, we result in a ğ’«ğ’«\\mathcal{P}-CT that converges with probability <1absent1<1 as well.\nHence, if ğ’«iÂ¯Â¯subscriptğ’«ğ‘–\\overline{\\mathcal{P}_{i}} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then ğ’«ğ’«\\mathcal{P} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} either. Soundness: Let ğ”Šğ”Š\\mathfrak{G} be the ğ’«ğ’«\\mathcal{P}-dependency graph.\nSuppose that every ğ’«iÂ¯Â¯subscriptğ’«ğ‘–\\overline{\\mathcal{P}_{i}}-CT converges with probability 111 for all 1â‰¤iâ‰¤n1ğ‘–ğ‘›1\\leq i\\leq n.\nWe prove that then also every ğ’«ğ’«\\mathcal{P}-CT converges with probability 1.\nLet W={ğ’«1,â€¦,ğ’«n}âˆª{{v}âŠ†ğ’«âˆ£vW=\\{\\mathcal{P}_{1},\\ldots,\\mathcal{P}_{n}\\}\\cup\\{\\{v\\}\\subseteq\\mathcal{P}\\mid v is not in an SCC of ğ”Š}\\mathfrak{G}\\} be the set of all SCCs and all singleton sets of nodes that do not belong to any SCC.\nThe core steps of this proof are the following: We show that every ADP problem XÂ¯Â¯ğ‘‹\\overline{X} with XâˆˆWğ‘‹ğ‘ŠX\\in W is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. We show that composing SCCs maintains the ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} property. We show that for every XâˆˆWğ‘‹ğ‘ŠX\\in W, the ADP problem â‹ƒX>ğ”Šâˆ—YYÂ¯Â¯subscriptsuperscriptsubscriptğ”Šğ‘‹ğ‘Œğ‘Œ\\overline{\\bigcup_{X>_{\\mathfrak{G}}^{*}Y}Y} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} by induction on >ğ”Šsubscriptğ”Š>_{\\mathfrak{G}}. We conclude that ğ’«ğ’«\\mathcal{P} must be ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. Here, for two X1,X2âˆˆWsubscriptğ‘‹1subscriptğ‘‹2ğ‘ŠX_{1},X_{2}\\in W we say that X2subscriptğ‘‹2X_{2} is a direct successor of X1subscriptğ‘‹1X_{1} (denoted\nX1>ğ”ŠX2subscriptğ”Šsubscriptğ‘‹1subscriptğ‘‹2X_{1}>_{\\mathfrak{G}}X_{2}) if there exist nodes vâˆˆX1ğ‘£subscriptğ‘‹1v\\in X_{1} and wâˆˆX2ğ‘¤subscriptğ‘‹2w\\in X_{2} such that there is\nan edge from vğ‘£v to wğ‘¤w in ğ”Šğ”Š\\mathfrak{G}. 1. Every ADP problem XÂ¯Â¯ğ‘‹\\overline{X} with XâˆˆWğ‘‹ğ‘ŠX\\in W is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. We start by proving the following: To proveÂ (22), note that if Xğ‘‹X is an SCC, then it follows from our assumption that XÂ¯Â¯ğ‘‹\\overline{X} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nIf Xğ‘‹X is a singleton set of a node that does not belong to any SCC,\nthen assume for a contradiction that XÂ¯Â¯ğ‘‹\\overline{X} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nBy LemmaÂ 2 there exists an XÂ¯Â¯ğ‘‹\\overline{X}-CT ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) that converges with probability\n<1absent1<1 and starts with (1:t):1ğ‘¡(1:t) where Posğ’Ÿ#â€‹(t)={Îµ}subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)=\\{\\varepsilon\\}\nand â™­â€‹(t)=sâ€‹Î¸â™­ğ‘¡ğ‘ ğœƒ\\flat(t)=s\\theta for a substitution Î¸ğœƒ\\theta and some ADP sâ†’{p1:t1,â€¦,pk:rk}mâˆˆXÂ¯â†’ğ‘ superscriptconditional-setsubscriptğ‘1:subscriptğ‘¡1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šÂ¯ğ‘‹s\\to\\{p_{1}:t_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\overline{X}.\nIf sâ†’â€¦âˆ‰Xâ†’ğ‘ â€¦ğ‘‹s\\to\\ldots\\notin X, then the resulting terms after the first rewrite step contain no annotations anymore and this cannot start a CT that converges with probability <1absent1<1.\nHence, we have sâ†’â€¦âˆˆXâ†’ğ‘ â€¦ğ‘‹s\\to\\ldots\\in X and thus,\nX={sâ†’â€¦}ğ‘‹â†’ğ‘ â€¦X=\\{s\\to\\ldots\\}, since Xğ‘‹X is a singleton set.\nAssume for a contradiction that there exists a node xâˆˆAğ‘¥ğ´x\\in A in ğ”—ğ”—\\mathfrak{T} that is not the root and introduces new annotations.\nW.l.o.G., let xğ‘¥x be reachable from the root without traversing any other node that introduces new annotations.\nThis means that for the corresponding term txsubscriptğ‘¡ğ‘¥t_{x} for\nnode xğ‘¥x there is a tâ€²â€‹âŠ´#â€‹txsuperscriptğ‘¡â€²subscriptâŠ´#subscriptğ‘¡ğ‘¥t^{\\prime}\\trianglelefteq_{\\#}t_{x} at position Ï„ğœ\\tau such that tâ€²=sâ€‹Ïƒâ€²superscriptğ‘¡â€²ğ‘ superscriptğœâ€²t^{\\prime}=s\\sigma^{\\prime} for\nsome substitution Ïƒâ€²superscriptğœâ€²\\sigma^{\\prime} and the only ADP sâ†’â€¦âˆˆXâ†’ğ‘ â€¦ğ‘‹s\\to\\ldots\\in X (since this\nis the only ADP in XÂ¯Â¯ğ‘‹\\overline{X} that contains any annotations in the right-hand side).\nLet (z0,â€¦,zm)subscriptğ‘§0â€¦subscriptğ‘§ğ‘š(z_{0},\\ldots,z_{m}) with zm=xsubscriptğ‘§ğ‘šğ‘¥z_{m}=x be the path from the root to xğ‘¥x in ğ”—ğ”—\\mathfrak{T}.\nThe first rewrite step at the root must be sâ€‹Î¸â†ªXÂ¯{p1:r1â€‹Î¸,â€¦,pk:rkâ€‹Î¸}subscriptabsentâ†ªÂ¯ğ‘‹ğ‘ ğœƒconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1ğœƒâ€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğœƒs\\theta\\mathrel{\\xhookrightarrow{}\\!\\!_{\\overline{X}}}\\{p_{1}:r_{1}\\theta,\\ldots,p_{k}:r_{k}\\theta\\}.\nAfter that, we only use ADPs with the flag ğ—ğ—‹ğ—ğ–¾ğ—ğ—‹ğ—ğ–¾\\mathsf{true} below the annotated position that\nwill be used for the rewrite step at node xğ‘¥x,\nas otherwise, the position Ï„ğœ\\tau would not be annotated in txsubscriptğ‘¡ğ‘¥t_{x}.\nTherefore, we must have an 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k and a tâ€²â€²â€‹âŠ´#â€‹rjsuperscriptğ‘¡â€²â€²subscriptâŠ´#subscriptğ‘Ÿğ‘—t^{\\prime\\prime}\\trianglelefteq_{\\#}r_{j} such that\ntâ€²â€²â£#â€‹Î¸â†’npâ€‹(ğ’«)âˆ—s#â€‹Ïƒâ€²superscriptsubscriptâ†’npğ’«superscriptğ‘¡â€²â€²#ğœƒsuperscriptğ‘ #superscriptğœâ€²t^{\\prime\\prime\\#}\\theta\\to_{{\\text{np}}(\\mathcal{P})}^{*}s^{\\#}\\sigma^{\\prime},\nwhich means that there must be a self-loop for the only\nADP in Xğ‘‹X, which is a contradiction to our assumption that Xğ‘‹X is a\nsingleton consisting of an ADP that is not in any SCC of ğ”Šğ”Š\\mathfrak{G}.Now, we have proven that the XÂ¯Â¯ğ‘‹\\overline{X}-CT ğ”—ğ”—\\mathfrak{T} does not introduce new annotations.\nBy definition of a ğ’«ğ’«\\mathcal{P}-CT, every infinite path must contain an infinite number of nodes in Ağ´A, i.e., nodes where we rewrite at an annotation.\nThus, every path in ğ”—ğ”—\\mathfrak{T} must be finite, which means that ğ”—ğ”—\\mathfrak{T} is finite itself,\nas the tree is finitely branching.\nBut every finite CT converges with probability 111, which is a contradiction to\nour assumption that ğ”—ğ”—\\mathfrak{T}\nconverges with probability <1absent1<1. 2. Composing SCCs maintains the ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} property. Next, we show that composing SCCs maintains the ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} property. More precisely, we prove\nthe following: To showÂ (23), we assume that both â‹ƒXâˆˆX^XÂ¯Â¯subscriptğ‘‹^ğ‘‹ğ‘‹\\overline{\\bigcup_{X\\in\\hat{X}}X} and â‹ƒYâˆˆY^YÂ¯Â¯subscriptğ‘Œ^ğ‘Œğ‘Œ\\overline{\\bigcup_{Y\\in\\hat{Y}}Y} are ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nLet ZÂ¯=â‹ƒXâˆˆX^Xâˆªâ‹ƒYâˆˆY^YÂ¯Â¯ğ‘Â¯subscriptğ‘‹^ğ‘‹ğ‘‹subscriptğ‘Œ^ğ‘Œğ‘Œ\\overline{Z}=\\overline{\\bigcup_{X\\in\\hat{X}}X\\cup\\bigcup_{Y\\in\\hat{Y}}Y}.\nThe property inÂ (23) for X^^ğ‘‹\\hat{X} and Y^^ğ‘Œ\\hat{Y} says that a\npath between two nodes from â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X that only traverses nodes\nfrom Zğ‘Z must also be a path that only traverses\nnodes from â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X, so that â‹ƒYâˆˆY^Ysubscriptğ‘Œ^ğ‘Œğ‘Œ\\bigcup_{Y\\in\\hat{Y}}Y cannot be used to â€œcreateâ€ new paths between two nodes from â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X, and vice versa.\nAssume for a contradiction that ZÂ¯Â¯ğ‘\\overline{Z} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nBy LemmaÂ 2 there exists a ZÂ¯Â¯ğ‘\\overline{Z}-CT ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) that converges with probability\n<1absent1<1 and starts with (1:t):1ğ‘¡(1:t) where Posğ’Ÿ#â€‹(t)={Îµ}subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)=\\{\\varepsilon\\} and â™­â€‹(t)=sâ€‹Î¸â™­ğ‘¡ğ‘ ğœƒ\\flat(t)=s\\theta for a substitution Î¸ğœƒ\\theta and an ADP sâ†’â€¦âˆˆZÂ¯â†’ğ‘ â€¦Â¯ğ‘s\\to\\ldots\\in\\overline{Z}. If sâ†’â€¦âˆ‰â‹ƒXâˆˆX^Xâˆªâ‹ƒYâˆˆY^Yâ†’ğ‘ â€¦subscriptğ‘‹^ğ‘‹ğ‘‹subscriptğ‘Œ^ğ‘Œğ‘Œs\\to\\ldots\\notin\\bigcup_{X\\in\\hat{X}}X\\cup\\bigcup_{Y\\in\\hat{Y}}Y, then the resulting terms contain no annotations anymore and this cannot start a CT that converges with probability <1absent1<1.\nW.l.o.g., we may assume that the ADP that is used for the rewrite step at\nthe root is in â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X.\nOtherwise, we simply swap â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X with â‹ƒYâˆˆY^Ysubscriptğ‘Œ^ğ‘Œğ‘Œ\\bigcup_{Y\\in\\hat{Y}}Y in the following. We can partition the set Ağ´A of our ZÂ¯Â¯ğ‘\\overline{Z}-CT ğ”—ğ”—\\mathfrak{T} into the sets A1:={xâˆˆAâˆ£xA_{1}:=\\{x\\in A\\mid x together with the labeling and its successors represents a step with an ADP from â‹ƒXâˆˆX^X}\\bigcup_{X\\in\\hat{X}}X\\} A2:=Aâˆ–A1assignsubscriptğ´2ğ´subscriptğ´1A_{2}:=A\\setminus A_{1} Note that in the case of xâˆˆA2ğ‘¥subscriptğ´2x\\in A_{2}, we know that xğ‘¥x together with its successors and the labeling represents a step with an ADP from ğ’«âˆ–â‹ƒXâˆˆX^Xğ’«subscriptğ‘‹^ğ‘‹ğ‘‹\\mathcal{P}\\setminus\\bigcup_{X\\in\\hat{X}}X.\nWe know that every â‹ƒYâˆˆY^YÂ¯Â¯subscriptğ‘Œ^ğ‘Œğ‘Œ\\overline{\\bigcup_{Y\\in\\hat{Y}}Y}-CT converges with probability 111, since â‹ƒYâˆˆY^YÂ¯Â¯subscriptğ‘Œ^ğ‘Œğ‘Œ\\overline{\\bigcup_{Y\\in\\hat{Y}}Y} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nThus, also every â‹ƒYâˆˆY^Yâˆ–â‹ƒXâˆˆX^XÂ¯Â¯subscriptğ‘Œ^ğ‘Œğ‘Œsubscriptğ‘‹^ğ‘‹ğ‘‹\\overline{\\bigcup_{Y\\in\\hat{Y}}Y\\setminus\\bigcup_{X\\in\\hat{X}}X}-CT converges with probability 111 (as it contains fewer annotations than â‹ƒYâˆˆY^YÂ¯Â¯subscriptğ‘Œ^ğ‘Œğ‘Œ\\overline{\\bigcup_{Y\\in\\hat{Y}}Y}).\nFurthermore, we have |ğ”—|ğ™»ğšğšŠğš<1subscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}|_{\\mathtt{Leaf}}<1 by our assumption.\nBy the A-partition lemma (LemmaÂ 1) we can find a grounded sub ZÂ¯Â¯ğ‘\\overline{Z}-CT ğ”—â€²=(Vâ€²,Eâ€²,Lâ€²,Aâ€²)superscriptğ”—â€²superscriptğ‘‰â€²superscriptğ¸â€²superscriptğ¿â€²superscriptğ´â€²\\mathfrak{T}^{\\prime}=(V^{\\prime},E^{\\prime},L^{\\prime},A^{\\prime}) with |ğ”—â€²|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}<1 such that every infinite path has an infinite number of A1subscriptğ´1A_{1}-edges.\nSince ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} is a grounded sub-CT of ğ”—ğ”—\\mathfrak{T} it must also start with (1:t):1ğ‘¡(1:t). We now construct a â‹ƒXâˆˆX^XÂ¯Â¯subscriptğ‘‹^ğ‘‹ğ‘‹\\overline{\\bigcup_{X\\in\\hat{X}}X}-CT ğ”—â€²â€²=(Vâ€²,Eâ€²,Lâ€²â€²,Aâ€²â€²)superscriptğ”—â€²â€²superscriptğ‘‰â€²superscriptğ¸â€²superscriptğ¿â€²â€²superscriptğ´â€²â€²\\mathfrak{T}^{\\prime\\prime}=(V^{\\prime},E^{\\prime},L^{\\prime\\prime},A^{\\prime\\prime})\nwith A1âˆ©Aâ€²âŠ†Aâ€²â€²subscriptğ´1superscriptğ´â€²superscriptğ´â€²â€²A_{1}\\cap A^{\\prime}\\subseteq A^{\\prime\\prime}\nthat has the same underlying tree structure and adjusted labeling\nsuch that all nodes get the same probabilities as in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}.\nSince the tree structure and the probabilities are the same, we then obtain |ğ”—â€²|ğ™»ğšğšŠğš=|ğ”—â€²â€²|ğ™»ğšğšŠğšsubscriptsuperscriptğ”—â€²ğ™»ğšğšŠğšsubscriptsuperscriptğ”—â€²â€²ğ™»ğšğšŠğš|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}=|\\mathfrak{T}^{\\prime\\prime}|_{\\mathtt{Leaf}}.\nTo be precise, the set of leaves in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} is equal to the set of leaves in ğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime}, and every leaf has the same probability.\nSince |ğ”—â€²|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}<1 we thus have |ğ”—â€²â€²|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²â€²ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime\\prime}|_{\\mathtt{Leaf}}<1, which is a contradiction to our\nassumption that â‹ƒXâˆˆX^XÂ¯Â¯subscriptğ‘‹^ğ‘‹ğ‘‹\\overline{\\bigcup_{X\\in\\hat{X}}X} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. The core idea of this construction is that annotations introduced by rewrite steps at a node xâˆˆA2ğ‘¥subscriptğ´2x\\in A_{2} are not\nimportant for our computation.\nThe reason is that if annotations are introduced using an ADP from\nâ‹ƒYâˆˆY^Ysubscriptğ‘Œ^ğ‘Œğ‘Œ\\bigcup_{Y\\in\\hat{Y}}Y that is not contained in â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X,\nthen by the prerequisite ofÂ (23), we know that such an ADP\nhas no path in the dependency graph to an ADP in â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X.\nHence, by definition of the dependency graph, we are never able to use these terms\nfor a rewrite step with an ADP from â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X to introduce new annotations.\nWe can therefore apply the non-annotated ADP from â‹ƒYâˆˆY^Ysubscriptğ‘Œ^ğ‘Œğ‘Œ\\bigcup_{Y\\in\\hat{Y}}Y to perform the rewrite step. We now construct the new labeling Lâ€²â€²superscriptğ¿â€²â€²L^{\\prime\\prime} for the â‹ƒXâˆˆX^XÂ¯Â¯subscriptğ‘‹^ğ‘‹ğ‘‹\\overline{\\bigcup_{X\\in\\hat{X}}X}-CT ğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime} recursively.\nLet QâŠ†Vğ‘„ğ‘‰Q\\subseteq V be the set of nodes where we have already defined the labeling Lâ€²â€²superscriptğ¿â€²â€²L^{\\prime\\prime}.\nFurthermore, for any term txâ€²subscriptsuperscriptğ‘¡â€²ğ‘¥t^{\\prime}_{x}, let JunkX^â€‹(txâ€²)subscriptJunk^ğ‘‹subscriptsuperscriptğ‘¡â€²ğ‘¥\\mathrm{Junk}_{\\hat{X}}(t^{\\prime}_{x}) denote the positions of all annotated subterms sâ€‹âŠ´#â€‹txâ€²ğ‘ subscriptâŠ´#subscriptsuperscriptğ‘¡â€²ğ‘¥s\\trianglelefteq_{\\#}t^{\\prime}_{x}\nthat can never be used for a rewrite step with an ADP from X^^ğ‘‹\\hat{X}, as indicated by the dependency graph.\nTo be precise, we define Ï€âˆˆJunkX^â€‹(txâ€²)ğœ‹subscriptJunk^ğ‘‹subscriptsuperscriptğ‘¡â€²ğ‘¥\\pi\\in\\mathrm{Junk}_{\\hat{X}}(t^{\\prime}_{x}):â‡”â‡”\\Leftrightarrow there\nis no AâˆˆWğ´ğ‘ŠA\\in W with A>ğ”Šâˆ—Xsuperscriptsubscriptğ”Šğ´ğ‘‹A>_{\\mathfrak{G}}^{*}X\nfor some XâˆˆX^ğ‘‹^ğ‘‹X\\in\\hat{X} such that there is\nan ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆAâ†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šğ´\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in A, and a substitution Ïƒğœ\\sigma with #Îµâ€‹(txâ€²|Ï€)â†’npâ€‹(ğ’«)âˆ—â„“#â€‹Ïƒsuperscriptsubscriptâ†’npğ’«subscript#ğœ€evaluated-atsuperscriptsubscriptğ‘¡ğ‘¥â€²ğœ‹superscriptâ„“#ğœ\\#_{\\varepsilon}(t_{x}^{\\prime}|_{\\pi})\\to_{{\\text{np}}(\\mathcal{P})}^{*}\\ell^{\\#}\\sigma.\nDuring our construction, we ensure that the following property holds: We start by setting tvâ€²â€²=tvâ€²subscriptsuperscriptğ‘¡â€²â€²ğ‘£subscriptsuperscriptğ‘¡â€²ğ‘£t^{\\prime\\prime}_{v}=t^{\\prime}_{v} for the root vğ‘£v of ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}.\nHere, our propertyÂ (24) is clearly satisfied.\nAs long as there is still an inner node xâˆˆQğ‘¥ğ‘„x\\in Q such that its successors are not contained in Qğ‘„Q, we do the following.\nLet xâ€‹E={y1,â€¦,yk}ğ‘¥ğ¸subscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜xE=\\{y_{1},\\ldots,y_{k}\\} be the set of its successors.\nWe need to define the corresponding terms for the nodes y1,â€¦,yksubscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜y_{1},\\ldots,y_{k} in ğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime}.\nSince xğ‘¥x is not a leaf and ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} is a ZÂ¯Â¯ğ‘\\overline{Z}-CT, we have txâ€²â†ªZÂ¯{py1px:ty1â€²,â€¦,pykpx:tykâ€²}subscriptabsentâ†ªÂ¯ğ‘subscriptsuperscriptğ‘¡â€²ğ‘¥conditional-setsubscriptğ‘subscriptğ‘¦1subscriptğ‘ğ‘¥:subscriptsuperscriptğ‘¡â€²subscriptğ‘¦1â€¦subscriptğ‘subscriptğ‘¦ğ‘˜subscriptğ‘ğ‘¥subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘˜t^{\\prime}_{x}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\overline{Z}}}\\{\\tfrac{p_{y_{1}}}{p_{x}}:t^{\\prime}_{y_{1}},\\ldots,\\tfrac{p_{y_{k}}}{p_{x}}:t^{\\prime}_{y_{k}}\\},\nand hence, we have to deal with the following two cases: If we use an ADP from â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}, then we perform\nthe rewrite step with the same ADP, the same VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k}, the same position Ï€ğœ‹\\pi, and the same substitution in ğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime}.\nSince we have txâ€²â‰(Iâ€‹H)txâ€²â€²subscriptapproaches-limitğ¼ğ»subscriptsuperscriptğ‘¡â€²ğ‘¥subscriptsuperscriptğ‘¡â€²â€²ğ‘¥t^{\\prime}_{x}\\doteq_{(IH)}t^{\\prime\\prime}_{x}, we also get tyjâ€²â‰tyjâ€²â€²approaches-limitsubscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—subscriptsuperscriptğ‘¡â€²â€²subscriptğ‘¦ğ‘—t^{\\prime}_{y_{j}}\\doteq t^{\\prime\\prime}_{y_{j}} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k.\nFurthermore, since we rewrite at position Ï€ğœ‹\\pi it cannot be in JunkX^â€‹(txâ€²)subscriptJunk^ğ‘‹subscriptsuperscriptğ‘¡â€²ğ‘¥\\mathrm{Junk}_{\\hat{X}}(t^{\\prime}_{x}), and hence,\nif Ï€âˆˆPosğ’Ÿ#â€‹(txâ€²)ğœ‹subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²ğ‘¥\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime}_{x}), then also Ï€âˆˆPosğ’Ÿ#â€‹(txâ€²â€²)ğœ‹subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²â€²ğ‘¥\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime\\prime}_{x}) by (24).\nThus, whenever we create annotations in the rewrite step in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} (a step with\n(ğšğŸ)ğšğŸ(\\mathbf{af}) or (ğšğ­)ğšğ­(\\mathbf{at})), then we do the same in ğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime} (the step is also an (ğšğŸ)ğšğŸ(\\mathbf{af}) or (ğšğ­)ğšğ­(\\mathbf{at}) step, respectively), and whenever we remove annotations in the rewrite step in ğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime} (a step with (ğšğŸ)ğšğŸ(\\mathbf{af}) or (ğ§ğŸ)ğ§ğŸ(\\mathbf{nf})), then the same happened in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} (the step is also an (ğšğŸ)ğšğŸ(\\mathbf{af}) or (ğ§ğŸ)ğ§ğŸ(\\mathbf{nf}) step).\nTherefore, we also get Posğ’Ÿ#â€‹(tyjâ€²)âˆ–JunkX^â€‹(tyjâ€²)âŠ†Posğ’Ÿ#â€‹(tyjâ€²â€²)subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—subscriptJunk^ğ‘‹subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²â€²subscriptğ‘¦ğ‘—\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime}_{y_{j}})\\setminus\\mathrm{Junk}_{\\hat{X}}(t^{\\prime}_{y_{j}})\\subseteq\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime\\prime}_{y_{j}}) for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k and (24) is again satisfied. If we use an ADP from ğ’«âˆ–â‹ƒXâˆˆX^Xğ’«subscriptğ‘‹^ğ‘‹ğ‘‹\\mathcal{P}\\setminus\\bigcup_{X\\in\\hat{X}}X in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}, and we use the ADP â„“â†’{p1:r1,â€¦,pk:rk}mâ†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘š\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m},\nthen we can use â„“â†’{p1:â™­â€‹(r1),â€¦,pk:â™­â€‹(rk)}mâ†’â„“superscriptconditional-setsubscriptğ‘1:â™­subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜â™­subscriptğ‘Ÿğ‘˜ğ‘š\\ell\\to\\{p_{1}:\\flat(r_{1}),\\ldots,p_{k}:\\flat(r_{k})\\}^{m} instead, with the same VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k}, the same position Ï€ğœ‹\\pi, and the same substitution.\nNote that if Ï€âˆˆPosğ’Ÿ#â€‹(txâ€²)ğœ‹subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²ğ‘¥\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime}_{x}), then all the annotations introduced by the ADP are in JunkX^â€‹(tyjâ€²)subscriptJunk^ğ‘‹subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—\\mathrm{Junk}_{\\hat{X}}(t^{\\prime}_{y_{j}}) for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k, since the used ADP is not in â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X and by (23) we cannot use another ADP to create a path in the dependency graph to a node in â‹ƒXâˆˆX^Xsubscriptğ‘‹^ğ‘‹ğ‘‹\\bigcup_{X\\in\\hat{X}}X again.\nOtherwise, we remove the annotations during the application of the rule anyway.\nAgain, (24) is satisfied. We have now shown thatÂ (23) holds. 3. For every XâˆˆWğ‘‹ğ‘ŠX\\in W, the ADP problem â‹ƒX>ğ”Šâˆ—YYÂ¯Â¯subscriptsuperscriptsubscriptğ”Šğ‘‹ğ‘Œğ‘Œ\\overline{\\bigcup_{X>_{\\mathfrak{G}}^{*}Y}Y} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. UsingÂ (22) andÂ (23), by induction on >ğ”Šsubscriptğ”Š>_{\\mathfrak{G}} we now prove that Note that >ğ”Šsubscriptğ”Š>_{\\mathfrak{G}} is well founded,  since ğ”Šğ”Š\\mathfrak{G} is finite. For the base case, we consider an XâˆˆWğ‘‹ğ‘ŠX\\in W that is minimal w.r.t.Â >ğ”Šsubscriptğ”Š>_{\\mathfrak{G}}.\nHence, we have â‹ƒX>ğ”Šâˆ—YY=Xsubscriptsuperscriptsubscriptğ”Šğ‘‹ğ‘Œğ‘Œğ‘‹\\bigcup_{X>_{\\mathfrak{G}}^{*}Y}Y=X.\nByÂ (22), XÂ¯Â¯ğ‘‹\\overline{X} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. For the induction step, we consider an XâˆˆWğ‘‹ğ‘ŠX\\in W and assume that\nâ‹ƒY>ğ”Šâˆ—ZZÂ¯Â¯subscriptsuperscriptsubscriptğ”Šğ‘Œğ‘ğ‘\\overline{\\bigcup_{Y>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} for every YâˆˆWğ‘Œğ‘ŠY\\in W with X>ğ”Š+Ysuperscriptsubscriptğ”Šğ‘‹ğ‘ŒX>_{\\mathfrak{G}}^{+}Y.\nLet ğš‚ğšğšŒğšŒâ€‹(X)={YâˆˆWâˆ£X>ğ”ŠY}={Y1,â€¦â€‹Ym}ğš‚ğšğšŒğšŒğ‘‹conditional-setğ‘Œğ‘Šsubscriptğ”Šğ‘‹ğ‘Œsubscriptğ‘Œ1â€¦subscriptğ‘Œğ‘š\\mathtt{Succ}(X)=\\{Y\\in W\\mid X>_{\\mathfrak{G}}Y\\}=\\{Y_{1},\\ldots Y_{m}\\} be the set of all direct successors of Xğ‘‹X.\nThe induction hypothesis states that â‹ƒYu>ğ”Šâˆ—ZZÂ¯Â¯subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘¢ğ‘ğ‘\\overline{\\bigcup_{Y_{u}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} for all 1â‰¤uâ‰¤m1ğ‘¢ğ‘š1\\leq u\\leq m.\nWe first prove by induction that for all 1â‰¤uâ‰¤m1ğ‘¢ğ‘š1\\leq u\\leq m,\nâ‹ƒ1â‰¤iâ‰¤uâ‹ƒYi>ğ”Šâˆ—ZZÂ¯Â¯subscript1ğ‘–ğ‘¢subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘\\overline{\\bigcup_{1\\leq i\\leq u}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. In the inner induction base, we have u=1ğ‘¢1u=1 and hence â‹ƒ1â‰¤iâ‰¤uâ‹ƒYi>ğ”Šâˆ—ZZÂ¯=â‹ƒY1>ğ”Šâˆ—ZZÂ¯Â¯subscript1ğ‘–ğ‘¢subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘Â¯subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œ1ğ‘ğ‘\\overline{\\bigcup_{1\\leq i\\leq u}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z}=\\overline{\\bigcup_{Y_{1}>_{\\mathfrak{G}}^{*}Z}Z}.\nBy our outer induction hypothesis we know that â‹ƒY1>ğ”Šâˆ—ZZÂ¯Â¯subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œ1ğ‘ğ‘\\overline{\\bigcup_{Y_{1}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. In the inner induction step, assume that the claim holds for some 1â‰¤u<m1ğ‘¢ğ‘š1\\leq u<m.\nThen â‹ƒYu+1>ğ”Šâˆ—ZZÂ¯Â¯subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘¢1ğ‘ğ‘\\overline{\\bigcup_{Y_{u+1}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} by our outer induction hypothesis andâ‹ƒ1â‰¤iâ‰¤uâ‹ƒYi>ğ”Šâˆ—ZZÂ¯Â¯subscript1ğ‘–ğ‘¢subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘\\overline{\\bigcup_{1\\leq i\\leq u}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} by our inner induction hypothesis.\nByÂ (23), we know that then â‹ƒ1â‰¤iâ‰¤u+1â‹ƒYi>ğ”Šâˆ—ZZÂ¯Â¯subscript1ğ‘–ğ‘¢1subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘\\overline{\\bigcup_{1\\leq i\\leq u+1}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} as well.\nThe conditions forÂ (23) are clearly satisfied, as we use the\nreflexive, transitive closure >ğ”Šâˆ—superscriptsubscriptğ”Š>_{\\mathfrak{G}}^{*} of the direct successor relation\nin both â‹ƒ1â‰¤iâ‰¤uâ‹ƒYi>ğ”Šâˆ—ZZsubscript1ğ‘–ğ‘¢subscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘\\bigcup_{1\\leq i\\leq u}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z and â‹ƒYu+1>ğ”Šâˆ—ZZsubscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘¢1ğ‘ğ‘\\bigcup_{Y_{u+1}>_{\\mathfrak{G}}^{*}Z}Z. Now we have shown that â‹ƒ1â‰¤iâ‰¤mâ‹ƒYi>ğ”Šâˆ—ZZÂ¯Â¯subscript1ğ‘–ğ‘šsubscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘\\overline{\\bigcup_{1\\leq i\\leq m}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nWe know that XÂ¯Â¯ğ‘‹\\overline{X} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} by our assumption and that â‹ƒ1â‰¤iâ‰¤mâ‹ƒYi>ğ”Šâˆ—ZZÂ¯Â¯subscript1ğ‘–ğ‘šsubscriptsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘ğ‘\\overline{\\bigcup_{1\\leq i\\leq m}\\bigcup_{Y_{i}>_{\\mathfrak{G}}^{*}Z}Z} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nHence, byÂ (23) we obtain that â‹ƒX>ğ”Šâˆ—YYÂ¯Â¯subscriptsuperscriptsubscriptğ”Šğ‘‹ğ‘Œğ‘Œ\\overline{\\bigcup_{X>_{\\mathfrak{G}}^{*}Y}Y} ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nAgain, the conditions ofÂ (23) are satisfied, since Xğ‘‹X is strictly\ngreater w.r.t.Â >ğ”Š+superscriptsubscriptğ”Š>_{\\mathfrak{G}}^{+} than all Zğ‘Z with Yi>ğ”Šâˆ—Zsuperscriptsubscriptğ”Šsubscriptğ‘Œğ‘–ğ‘Y_{i}>_{\\mathfrak{G}}^{*}Z for some 1â‰¤iâ‰¤m1ğ‘–ğ‘š1\\leq i\\leq m. 4. ğ’«ğ’«\\mathcal{P} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. InÂ (25) we have shown that â‹ƒX>ğ”Šâˆ—YYÂ¯Â¯subscriptsuperscriptsubscriptğ”Šğ‘‹ğ‘Œğ‘Œ\\overline{\\bigcup_{X>_{\\mathfrak{G}}^{*}Y}Y} for every XâˆˆWğ‘‹ğ‘ŠX\\in W is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nLet X1,â€¦,XmâˆˆWsubscriptğ‘‹1â€¦subscriptğ‘‹ğ‘šğ‘ŠX_{1},\\ldots,X_{m}\\linebreak\\in W be the maximal elements of Wğ‘ŠW w.r.t.Â >ğ”Šsubscriptğ”Š>_{\\mathfrak{G}}.\nBy induction, one can prove that â‹ƒ1â‰¤iâ‰¤uâ‹ƒXi>ğ”Šâˆ—YYÂ¯Â¯subscript1ğ‘–ğ‘¢subscriptsuperscriptsubscriptğ”Šsubscriptğ‘‹ğ‘–ğ‘Œğ‘Œ\\overline{\\bigcup_{1\\leq i\\leq u}\\bigcup_{X_{i}>_{\\mathfrak{G}}^{*}Y}Y} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} for all 1â‰¤uâ‰¤m1ğ‘¢ğ‘š1\\leq u\\leq m byÂ (23), analogous to the previous induction.\nAgain, the conditions ofÂ (23) are satisfied as we use\nthe reflexive, transitive closure of >ğ”Šsubscriptğ”Š>_{\\mathfrak{G}}.\nIn the end, we know that â‹ƒ1â‰¤iâ‰¤mâ‹ƒXi>ğ”Šâˆ—YYÂ¯=ğ’«Â¯subscript1ğ‘–ğ‘šsubscriptsuperscriptsubscriptğ”Šsubscriptğ‘‹ğ‘–ğ‘Œğ‘Œğ’«\\overline{\\bigcup_{1\\leq i\\leq m}\\bigcup_{X_{i}>_{\\mathfrak{G}}^{*}Y}Y}=\\mathcal{P} is ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} and this ends the proof.\nâˆ See 4.3 Proof.\n\nLet XÂ¯ğ’«=Xâˆªâ™­â€‹(ğ’«âˆ–X)superscriptÂ¯ğ‘‹ğ’«ğ‘‹â™­ğ’«ğ‘‹\\overline{X}^{\\mathcal{P}}=X\\cup\\flat(\\mathcal{P}\\setminus X) for XâŠ†ğ’«ğ‘‹ğ’«X\\subseteq\\mathcal{P}\nand XÂ¯â„=Xâˆªâ™­â€‹(â„âˆ–X)superscriptÂ¯ğ‘‹â„ğ‘‹â™­â„ğ‘‹\\overline{X}^{\\mathcal{I}}=X\\cup\\flat(\\mathcal{I}\\setminus X) for XâŠ†â„âˆªğ’«ğ‘‹â„ğ’«X\\subseteq\\mathcal{I}\\cup\\mathcal{P}. Completeness: Every (ğ’¥Â¯â„âˆªğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}}\\cup\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}})-CT is also a (â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-CT with fewer annotations in the terms.\nSo if some (ğ’¥Â¯â„,ğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}},\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}}) is not\nğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, then there exists a (ğ’¥Â¯â„âˆªğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}}\\cup\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}})-CT ğ”—ğ”—\\mathfrak{T} that converges with probability <1absent1<1 and uses\nğ’¥Â¯â„âˆ–ğ’«iÂ¯ğ’«superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«\\overline{\\mathcal{J}}^{\\mathcal{I}}\\setminus\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}}\nonly finitely often.\nBy adding annotations to the terms of the tree, we result in an (â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-CT that converges with probability <1absent1<1 as well and uses ADPs from\nâ„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} only finitely often.\nHence, if (ğ’¥Â¯â„,ğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}},\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}}) is not\nğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, then (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P}) is not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST} either. Soundness:\nLet (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P}) be not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nThen there exists an (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P})-CT ğ”—ğ”—\\mathfrak{T} that converges with probability\n<1absent1<1, whose root is labeled with (1:t#):1superscriptğ‘¡#(1:t^{\\#})\nfor a basic term tğ‘¡t, and â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} is used only finitely often.\nSo there exists a depth Hâˆˆâ„•ğ»â„•H\\in\\mathbb{N}, such that we only use ADPs from ğ’«ğ’«\\mathcal{P} and no ADPs from â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} anymore.\nAll the subtrees that start at depth Hğ»H are ğ’«ğ’«\\mathcal{P}-CTs and one of them needs to\nconverge with probability <1absent1<1, since ğ”—ğ”—\\mathfrak{T} converges with probability <1absent1<1.\nW.l.o.G., let xğ‘¥x be the root node of such a subtree that converges with probability <1absent1<1 (with xğ‘¥x at depth Hğ»H).\nWe can use the previous proof of Thm.Â 4.2\nto show that then there exists an SCC ğ’«iâŠ†ğ’«subscriptğ’«ğ‘–ğ’«\\mathcal{P}_{i}\\subseteq\\mathcal{P} and a CT ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} such that\nğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} starts with (1:tx):1subscriptğ‘¡ğ‘¥(1:t_{x}), where txsubscriptğ‘¡ğ‘¥t_{x} is the term of the node xğ‘¥x in ğ”—ğ”—\\mathfrak{T},\nğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} converges with probability <1absent1<1, and\nğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} is a ğ’«iÂ¯ğ’«superscriptÂ¯subscriptğ’«ğ‘–ğ’«\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}}-CT.\nIt remains to show that we can reach the root term txsubscriptğ‘¡ğ‘¥t_{x} of ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}\nfrom a basic term in\na (ğ’¥Â¯â„âˆªğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}}\\cup\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}})-CT with\nğ’¥âˆˆğ’«iâ†‘ğ’¥subscriptğ’«ğ‘–â†‘absent\\mathcal{J}\\in\\mathcal{P}_{i}\\!\\!\\uparrow. Let â„“â†’Î¼â†’â„“ğœ‡\\ell\\to\\mu be the ADP used at the root of ğ”—ğ”—\\mathfrak{T}.\nSince the root of ğ”—ğ”—\\mathfrak{T} is t#superscriptğ‘¡#t^{\\#} for a basic term tğ‘¡t, the ADP from ğ’«isubscriptğ’«ğ‘–\\mathcal{P}_{i} applied to\ntxsubscriptğ‘¡ğ‘¥t_{x} must be reachable from â„“â†’Î¼â†’â„“ğœ‡\\ell\\to\\mu in the (â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-dependency graph.\nHence, there exists a ğ’¥âˆˆğ’«iâ†‘ğ’¥subscriptğ’«ğ‘–â†‘absent\\mathcal{J}\\in\\mathcal{P}_{i}\\!\\!\\uparrow such that one can reach txsubscriptğ‘¡ğ‘¥t_{x}\nfrom t#superscriptğ‘¡#t^{\\#} by applying only ADPs from ğ’¥Â¯â„âˆªğ’«iÂ¯ğ’«superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«\\overline{\\mathcal{J}}^{\\mathcal{I}}\\cup\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}}. Therefore,\nğ”—â€²â€²superscriptğ”—â€²â€²\\mathfrak{T}^{\\prime\\prime} together with the prefix tree that includes the\npath from t#superscriptğ‘¡#t^{\\#} to txsubscriptğ‘¡ğ‘¥t_{x} is a\n(ğ’¥Â¯â„,ğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}},\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}})-CT that converges with probability <1absent1<1.\nHence, (ğ’¥Â¯â„,ğ’«iÂ¯ğ’«)superscriptÂ¯ğ’¥â„superscriptÂ¯subscriptğ’«ğ‘–ğ’«(\\overline{\\mathcal{J}}^{\\mathcal{I}},\\overline{\\mathcal{P}_{i}}^{\\mathcal{P}})\nis not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nâˆ See 4.5 Proof. Completeness:\nWe only prove this direction for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nThe proof for ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST} is completely analogous.\nEvery ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P})-CT is also a ğ’«ğ’«\\mathcal{P}-CT with fewer annotations in the terms.\nSo if ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P}) is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then there exists a ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P})-CT ğ”—ğ”—\\mathfrak{T} that converges with probability <1absent1<1.\nBy adding annotations to the terms of the tree, we result in a ğ’«ğ’«\\mathcal{P}-CT that converges with probability <1absent1<1 as well.\nHence, if ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P}) is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then ğ’«ğ’«\\mathcal{P} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} either. Soundness:\nHere, the proofs for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} and ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST} differ slightly, similar to the proofs of Thm.Â 4.2 and Thm.Â 4.3.\nWe start with the proof of ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. Let ğ’«ğ’«\\mathcal{P} be not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nThen by LemmaÂ 2 there exists a ğ’«ğ’«\\mathcal{P}-CT ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) that converges with probability\n<1absent1<1 whose root is labeled with (1:t):1ğ‘¡(1:t) and Posğ’Ÿ#â€‹(t)={Îµ}subscriptPossuperscriptğ’Ÿ#ğ‘¡ğœ€\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t)=\\{\\varepsilon\\}.\nWe will now create a ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P})-CT ğ”—â€²=(V,E,Lâ€²,A)superscriptğ”—â€²ğ‘‰ğ¸superscriptğ¿â€²ğ´\\mathfrak{T}^{\\prime}=(V,E,L^{\\prime},A), with the same underlying tree structure, and an adjusted labeling such that pxğ”—=pxğ”—â€²superscriptsubscriptğ‘ğ‘¥ğ”—superscriptsubscriptğ‘ğ‘¥superscriptğ”—â€²p_{x}^{\\mathfrak{T}}=p_{x}^{\\mathfrak{T}^{\\prime}} for all xâˆˆVğ‘¥ğ‘‰x\\in V.\nSince the tree structure and the probabilities are the same, we then get |ğ”—â€²|ğ™»ğšğšŠğš=|ğ”—|ğ™»ğšğšŠğš<1subscriptsuperscriptğ”—â€²ğ™»ğšğšŠğšsubscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\prime}|_{\\mathtt{Leaf}}=|\\mathfrak{T}|_{\\mathtt{Leaf}}<1, and hence ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P}) is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} either. We construct the new labeling Lâ€²superscriptğ¿â€²L^{\\prime} for the ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P})-CT ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} recursively.\nLet XâŠ†Vğ‘‹ğ‘‰X\\subseteq V be the set of nodes where we have already defined the labeling Lâ€²superscriptğ¿â€²L^{\\prime}.\nDuring our construction, we ensure that the following property holds for every node xâˆˆXğ‘¥ğ‘‹x\\in X: Here, for any term txsubscriptğ‘¡ğ‘¥t_{x}, let Junkâ€‹(tx)Junksubscriptğ‘¡ğ‘¥\\mathrm{Junk}(t_{x}) be the set of positions\nthat can never be used for a rewrite step with an ADP that contains annotations.\nTo be precise, we define Ï€âˆˆJunkâ€‹(tx)ğœ‹Junksubscriptğ‘¡ğ‘¥\\pi\\in\\mathrm{Junk}(t_{x}):â‡”â‡”\\Leftrightarrow there\nis no ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆğ’«â†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šğ’«\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\mathcal{P} with annotations\nand no substitution Ïƒğœ\\sigma such that #Îµâ€‹(tx|Ï€)â†’npâ€‹(ğ’«)âˆ—â„“#â€‹Ïƒsuperscriptsubscriptâ†’npğ’«subscript#ğœ€evaluated-atsubscriptğ‘¡ğ‘¥ğœ‹superscriptâ„“#ğœ\\#_{\\varepsilon}(t_{x}|_{\\pi})\\to_{{\\text{np}}(\\mathcal{P})}^{*}\\ell^{\\#}\\sigma. We start with the same term tğ‘¡t at the root.\nHere, our propertyÂ (26) is clearly satisfied.\nAs long as there is still an inner node xâˆˆXğ‘¥ğ‘‹x\\in X such that its successors are not contained in Xğ‘‹X, we do the following.\nLet xâ€‹E={y1,â€¦,yk}ğ‘¥ğ¸subscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜xE=\\{y_{1},\\ldots,y_{k}\\} be the set of its successors.\nWe need to define the terms for the nodes y1,â€¦,yksubscriptğ‘¦1â€¦subscriptğ‘¦ğ‘˜y_{1},\\ldots,y_{k} in ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}.\nSince xğ‘¥x is not a leaf and ğ”—ğ”—\\mathfrak{T} is a ğ’«ğ’«\\mathcal{P}-CT, we have txâ†ªğ’«{py1px:ty1,â€¦,pykpx:tyk}subscriptabsentâ†ªğ’«subscriptğ‘¡ğ‘¥conditional-setsubscriptğ‘subscriptğ‘¦1subscriptğ‘ğ‘¥:subscriptğ‘¡subscriptğ‘¦1â€¦subscriptğ‘subscriptğ‘¦ğ‘˜subscriptğ‘ğ‘¥subscriptğ‘¡subscriptğ‘¦ğ‘˜t_{x}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}\\{\\tfrac{p_{y_{1}}}{p_{x}}:t_{y_{1}},\\ldots,\\tfrac{p_{y_{k}}}{p_{x}}:t_{y_{k}}\\}.\nIf we performed a step with â†ªğ’«subscriptabsentâ†ªğ’«\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}} using the ADP â„“â†’{p1:r1,â€¦,pk:rk}mâ†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘š\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}, the VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k},\nthe position Ï€ğœ‹\\pi, and the substitution Ïƒğœ\\sigma in ğ”—ğ”—\\mathfrak{T},\nthen we can use the ADP â„“â†’{p1:#Î”ğ’«â€‹(r1)â€‹(r1),â€¦,pk:#Î”ğ’«â€‹(rk)â€‹(rk)}mâ†’â„“superscriptconditional-setsubscriptğ‘1:subscript#subscriptÎ”ğ’«subscriptğ‘Ÿ1subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscript#subscriptÎ”ğ’«subscriptğ‘Ÿğ‘˜subscriptğ‘Ÿğ‘˜ğ‘š\\ell\\!\\to\\!\\{p_{1}:\\#_{\\Delta_{\\mathcal{P}}(r_{1})}(r_{1}),\\ldots,p_{k}:\\#_{\\Delta_{\\mathcal{P}}(r_{k})}(r_{k})\\}^{m} with the same VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k}, the same position Ï€ğœ‹\\pi, and the same substitution Ïƒğœ\\sigma.\nNow, we directly get tyjâ‰tyjâ€²approaches-limitsubscriptğ‘¡subscriptğ‘¦ğ‘—subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—t_{y_{j}}\\doteq t^{\\prime}_{y_{j}} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k.\nTo prove Posğ’Ÿ#â€‹(tyj)âˆ–Junkâ€‹(tyj)âŠ†Posğ’Ÿ#â€‹(tyjâ€²)subscriptPossuperscriptğ’Ÿ#subscriptğ‘¡subscriptğ‘¦ğ‘—Junksubscriptğ‘¡subscriptğ‘¦ğ‘—subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{y_{j}})\\setminus\\mathrm{Junk}(t_{y_{j}})\\subseteq\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime}_{y_{j}}),\nnote that if Ï€âˆˆPosğ’Ÿ#â€‹(tx)âˆ©Junkâ€‹(tx)ğœ‹subscriptPossuperscriptğ’Ÿ#subscriptğ‘¡ğ‘¥Junksubscriptğ‘¡ğ‘¥\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{x})\\cap\\mathrm{Junk}(t_{x}),\nthen â„“â†’{p1:r1,â€¦,pk:rk}mâ†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘š\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m} contains no annotations by definition of Junkâ€‹(tx)Junksubscriptğ‘¡ğ‘¥\\mathrm{Junk}(t_{x}).\nTherefore, it does not matter whether we rewrite with case (ğšğ­)ğšğ­(\\mathbf{at}) or (ğ§ğ­)ğ§ğ­(\\mathbf{nt}) ((ğšğŸ)ğšğŸ(\\mathbf{af}) or (ğ§ğŸ)ğ§ğŸ(\\mathbf{nf})).\nOtherwise, if Ï€âˆˆPosğ’Ÿ#â€‹(tx)âˆ–Junkâ€‹(tx)ğœ‹subscriptPossuperscriptğ’Ÿ#subscriptğ‘¡ğ‘¥Junksubscriptğ‘¡ğ‘¥\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{x})\\setminus\\mathrm{Junk}(t_{x}), then\nthe original rule contains the same terms with possibly more annotations,\nbut all missing annotations are in Junkâ€‹(tx)Junksubscriptğ‘¡ğ‘¥\\mathrm{Junk}(t_{x})\nby definition of #Î”ğ’«â€‹(rj)â€‹(rj)subscript#subscriptÎ”ğ’«subscriptğ‘Ÿğ‘—subscriptğ‘Ÿğ‘—\\#_{\\Delta_{\\mathcal{P}}(r_{j})}(r_{j}).\nThus, we get Posğ’Ÿ#â€‹(tyj)âˆ–Junkâ€‹(tyj)âŠ†Posğ’Ÿ#â€‹(tyjâ€²)subscriptPossuperscriptğ’Ÿ#subscriptğ‘¡subscriptğ‘¦ğ‘—Junksubscriptğ‘¡subscriptğ‘¦ğ‘—subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²subscriptğ‘¦ğ‘—\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{y_{j}})\\setminus\\mathrm{Junk}(t_{y_{j}})\\subseteq\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime}_{y_{j}}) for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k. Next, we consider ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nLet (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P}) be not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nThen there exists an (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P})-CT ğ”—ğ”—\\mathfrak{T} that converges with probability\n<1absent1<1, whose root is labeled with (1:t#):1superscriptğ‘¡#(1:t^{\\#})\nfor a basic term tğ‘¡t, and â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} is used only finitely often.\nSo there exists a depth Hâˆˆâ„•ğ»â„•H\\in\\mathbb{N}, such that we only use ADPs from ğ’«ğ’«\\mathcal{P} and no ADPs from â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} anymore.\nAll the subtrees that start at depth Hğ»H are ğ’«ğ’«\\mathcal{P}-CTs and one of them needs to\nconverge with probability <1absent1<1, since ğ”—ğ”—\\mathfrak{T} converges with probability <1absent1<1.\nW.l.o.G., let xğ‘¥x be the root node of such a subtree that converges with probability <1absent1<1 (with xğ‘¥x at depth Hğ»H).\nWe can use the previous proof for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}\nto show that then there exists a ğ’¯ğš„ğšƒâ€‹(ğ’«)subscriptğ’¯ğš„ğšƒğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P})-CT ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} such that\nğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} starts with (1:tx):1subscriptğ‘¡ğ‘¥(1:t_{x}), where txsubscriptğ‘¡ğ‘¥t_{x} is the term of the node xğ‘¥x in ğ”—ğ”—\\mathfrak{T},\nand ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime} converges with probability <1absent1<1.\nIt remains to show that we can reach the root term txsubscriptğ‘¡ğ‘¥t_{x} of ğ”—â€²superscriptğ”—â€²\\mathfrak{T}^{\\prime}\nfrom a basic term in\na (ğ’¯ğš„ğšƒâ€‹(â„âˆªğ’«),ğ’¯ğš„ğšƒâ€‹(ğ’«))subscriptğ’¯ğš„ğšƒâ„ğ’«subscriptğ’¯ğš„ğšƒğ’«(\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{I}\\cup\\mathcal{P}),\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{P}))-CT.\nBut since we consider both â„â„\\mathcal{I} and ğ’«ğ’«\\mathcal{P} in ğ’¯ğš„ğšƒâ€‹(â„âˆªğ’«)subscriptğ’¯ğš„ğšƒâ„ğ’«\\mathcal{T}_{\\mathtt{UT}}(\\mathcal{I}\\cup\\mathcal{P}),\nwe can use the same construction as before to show that we can reach a term txâ€²superscriptsubscriptğ‘¡ğ‘¥â€²t_{x}^{\\prime} with\ntxâ‰txâ€²approaches-limitsubscriptğ‘¡ğ‘¥subscriptsuperscriptğ‘¡â€²ğ‘¥t_{x}\\doteq t^{\\prime}_{x} and Posğ’Ÿ#â€‹(tx)âˆ–Junkâ€‹(tx)âŠ†Posğ’Ÿ#â€‹(txâ€²)subscriptPossuperscriptğ’Ÿ#subscriptğ‘¡ğ‘¥Junksubscriptğ‘¡ğ‘¥subscriptPossuperscriptğ’Ÿ#subscriptsuperscriptğ‘¡â€²ğ‘¥\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t_{x})\\setminus\\mathrm{Junk}(t_{x})\\subseteq\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(t^{\\prime}_{x}), which\nis sufficient.\nâˆ See 4.7 Proof.\n\nLet XÂ¯=(Xâˆ©ğ’°â€‹(â„âˆªğ’«))âˆª{â„“â†’Î¼ğ–¿ğ–ºğ—…ğ—Œğ–¾âˆ£â„“â†’Î¼mâˆˆXâˆ–ğ’°â€‹(â„âˆªğ’«)}Â¯ğ‘‹ğ‘‹ğ’°â„ğ’«conditional-setâ†’â„“superscriptğœ‡ğ–¿ğ–ºğ—…ğ—Œğ–¾â†’â„“superscriptğœ‡ğ‘šğ‘‹ğ’°â„ğ’«\\overline{X}=(X\\cap\\mathcal{U}(\\mathcal{I}\\cup\\mathcal{P}))\\cup\\{\\ell\\to\\mu^{\\mathsf{false}}\\mid\\ell\\to\\mu^{m}\\in X\\setminus\\mathcal{U}(\\mathcal{I}\\cup\\mathcal{P})\\}. Completeness: Every (â„Â¯âˆªğ’«Â¯)Â¯â„Â¯ğ’«(\\overline{\\mathcal{I}}\\cup\\overline{\\mathcal{P}})-CT is also an (â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-CT with fewer annotations in the terms.\nIf (â„Â¯,ğ’«Â¯)Â¯â„Â¯ğ’«(\\overline{\\mathcal{I}},\\overline{\\mathcal{P}}) is not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, then there exists\nan (â„Â¯âˆªğ’«Â¯)Â¯â„Â¯ğ’«(\\overline{\\mathcal{I}}\\cup\\overline{\\mathcal{P}})-CT ğ”—ğ”—\\mathfrak{T} that converges with\nprobability <1absent1<1 and uses ADPs from\nâ„Â¯âˆ–ğ’«Â¯Â¯â„Â¯ğ’«\\overline{\\mathcal{I}}\\setminus\\overline{\\mathcal{P}} only finitely often.\nBy adding annotations to the terms of the tree, we result in an\n(â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-CT that converges with probability <1absent1<1 as well\nand uses ADPs from â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} only finitely often.\nHence, if (â„Â¯,ğ’«Â¯)Â¯â„Â¯ğ’«(\\overline{\\mathcal{I}},\\overline{\\mathcal{P}}) is not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, then (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P}) is not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST} either. Soundness: Assume that (â„,ğ’«)â„ğ’«(\\mathcal{I},\\mathcal{P}) is not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nThen there exists an (â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-CT that converges with probability\n<1absent1<1, whose root is labeled with (1:t#):1superscriptğ‘¡#(1:t^{\\#}) for a basic term tğ‘¡t,\nand â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} is used only finitely often.\nAs tğ‘¡t is basic,\nin the first rewrite step at the root of the tree, the substitution only instantiates\nvariables of the ADP by normal forms. By the definition of usable rules, as in the non-probabilistic case,\nrules â„“â†’Î¼mâˆˆâ„âˆªğ’«â†’â„“superscriptğœ‡ğ‘šâ„ğ’«\\ell\\to\\mu^{m}\\in\\mathcal{I}\\cup\\mathcal{P} that are not usable\n(i.e., â„“â†’Î¼mâˆ‰ğ’°â€‹(â„âˆªğ’«)â†’â„“superscriptğœ‡ğ‘šğ’°â„ğ’«\\ell\\to\\mu^{m}\\not\\in\\mathcal{U}(\\mathcal{I}\\cup\\mathcal{P}))\nwill never be used below an annotated symbol in such an (â„âˆªğ’«)â„ğ’«(\\mathcal{I}\\cup\\mathcal{P})-CT.\nHence, we can also view ğ”—ğ”—\\mathfrak{T} as an (â„Â¯âˆªğ’«Â¯)Â¯â„Â¯ğ’«(\\overline{\\mathcal{I}}\\cup\\overline{\\mathcal{P}})-CT that\nconverges with probability <1absent1<1 and thus (â„Â¯,ğ’«Â¯)Â¯â„Â¯ğ’«(\\overline{\\mathcal{I}},\\overline{\\mathcal{P}}) is not ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nâˆ In the following, we use the prefix ordering\n(Ï€â‰¤Ï„â‡”Â there existsÂ Ï‡âˆˆâ„•âˆ—Â such thatÂ Ï€.Ï‡=Ï„\\pi\\leq\\tau\\Leftrightarrow\\text{ there exists }\\chi\\in\\mathbb{N}^{*}\\text{ such that }\\pi.\\chi=\\tau)\nto compare positions. See 4.8 Proof.\n\nFor the proof for ğš’ğ™°ğš‚ğšƒğš’ğ™°ğš‚ğšƒ\\mathtt{iAST}, see .\nLet ğ’«Â¯=ğ’«â‰¥âˆªâ™­â€‹(ğ’«>)Â¯ğ’«subscriptğ’«â™­subscriptğ’«\\overline{\\mathcal{P}}=\\mathcal{P}_{\\geq}\\cup\\flat(\\mathcal{P}_{>}). Completeness: Every ğ’«Â¯Â¯ğ’«\\overline{\\mathcal{P}}-CT is also a ğ’«ğ’«\\mathcal{P}-CT with fewer annotations in the terms.\nSo if ğ’«Â¯Â¯ğ’«\\overline{\\mathcal{P}} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then there exists a ğ’«Â¯Â¯ğ’«\\overline{\\mathcal{P}}-CT ğ”—ğ”—\\mathfrak{T} that converges with probability <1absent1<1.\nBy adding annotations to the terms of the tree, we result in a ğ’«ğ’«\\mathcal{P}-CT that converges with probability <1absent1<1 as well.\nHence, if ğ’«Â¯Â¯ğ’«\\overline{\\mathcal{P}} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, then ğ’«ğ’«\\mathcal{P} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} either. Soundness: This proof uses the proof idea for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} fromÂ .\nThe core steps of the proof are the following: We extend the conditions (1), (2), and (3) to rewrite steps instead of just rules (and thus, to edges of a CT). We create a CT ğ”—â‰¤Nsuperscriptğ”—absentğ‘\\mathfrak{T}^{\\leq N} for any Nâˆˆâ„•ğ‘â„•N\\in\\mathbb{N}. We prove that |ğ”—â‰¤N|ğ™»ğšğšŠğšâ‰¥pmâ€‹iâ€‹nNsubscriptsuperscriptğ”—absentğ‘ğ™»ğšğšŠğšsuperscriptsubscriptğ‘ğ‘šğ‘–ğ‘›ğ‘|\\mathfrak{T}^{\\leq N}|_{\\mathtt{Leaf}}\\geq p_{min}^{N} for any Nâˆˆâ„•ğ‘â„•N\\in\\mathbb{N}. We prove that |ğ”—â‰¤N|ğ™»ğšğšŠğš=1subscriptsuperscriptğ”—absentğ‘ğ™»ğšğšŠğš1|\\mathfrak{T}^{\\leq N}|_{\\mathtt{Leaf}}=1 for any Nâˆˆâ„•ğ‘â„•N\\in\\mathbb{N}. Finally, we prove that |ğ”—|ğ™»ğšğšŠğš=1subscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}|_{\\mathtt{Leaf}}=1. Here, pmâ€‹iâ€‹nsubscriptğ‘ğ‘šğ‘–ğ‘›p_{min} is the minimal probability occurring in ğ’«ğ’«\\mathcal{P}.\nParts (II) to (V) remain completely the same as in .\nWe only show that we can adjust part (I) to our new rewrite relation for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}. (I) We extend the conditions to rewrite steps instead of just rules We show that the conditions (1), (2), and (3) of the lemma extend to rewrite steps instead of just rules: If sâ†’{p1:t1,â€¦,pk:tk}â†’ğ‘ conditional-setsubscriptğ‘1:subscriptğ‘¡1â€¦subscriptğ‘ğ‘˜subscriptğ‘¡ğ‘˜s\\to\\{p_{1}:t_{1},\\ldots,p_{k}:t_{k}\\} using a rewrite rule â„“â†’{p1:r1,â€¦,pk:rk}â†’â„“conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}with Polâ¡(â„“)â‰¥Polâ¡(rj)Polâ„“Polsubscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\operatorname{Pol}(r_{j}) for some 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k, then we have Pâ€‹oâ€‹lâ€‹(s)â‰¥Pâ€‹oâ€‹lâ€‹(tj)ğ‘ƒğ‘œğ‘™ğ‘ ğ‘ƒğ‘œğ‘™subscriptğ‘¡ğ‘—Pol(s)\\geq Pol(t_{j}). If aâ†ªğ’«{p1:b1,â€¦,pk:bk}subscriptabsentâ†ªğ’«ğ‘conditional-setsubscriptğ‘1:subscriptğ‘1â€¦subscriptğ‘ğ‘˜subscriptğ‘ğ‘˜a\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}\\{p_{1}:b_{1},\\ldots,p_{k}:b_{k}\\} using the ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆğ’«>â†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šsubscriptğ’«\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\mathcal{P}_{>} at a position Ï€âˆˆPosğ’Ÿ#â€‹(a)ğœ‹subscriptPossuperscriptğ’Ÿ#ğ‘\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a), then ğ’®â€‹ğ‘¢ğ‘šâ€‹(a)>ğ’®â€‹ğ‘¢ğ‘šâ€‹(bj)ğ’®ğ‘¢ğ‘šğ‘ğ’®ğ‘¢ğ‘šsubscriptğ‘ğ‘—\\mathit{\\mathcal{S}\\!um}(a)>\\mathit{\\mathcal{S}\\!um}(b_{j}) for some 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k. If sâ†’{p1:t1,â€¦,pk:tk}â†’ğ‘ conditional-setsubscriptğ‘1:subscriptğ‘¡1â€¦subscriptğ‘ğ‘˜subscriptğ‘¡ğ‘˜s\\to\\{p_{1}:t_{1},\\ldots,p_{k}:t_{k}\\} using a rewrite rule â„“â†’{p1:r1,â€¦,pk:rk}â†’â„“conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}with Pâ€‹oâ€‹lâ€‹(â„“)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…Polâ¡(rj)ğ‘ƒğ‘œğ‘™â„“subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—Polsubscriptğ‘Ÿğ‘—Pol(\\ell)\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\operatorname{Pol}(r_{j}), then Pâ€‹oâ€‹lâ€‹(s)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…Polâ¡(tj)ğ‘ƒğ‘œğ‘™ğ‘ subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—Polsubscriptğ‘¡ğ‘—Pol(s)\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\operatorname{Pol}(t_{j}). If aâ†ªğ’«{p1:b1,â€¦,pk:bk}subscriptabsentâ†ªğ’«ğ‘conditional-setsubscriptğ‘1:subscriptğ‘1â€¦subscriptğ‘ğ‘˜subscriptğ‘ğ‘˜a\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}\\{p_{1}:b_{1},\\ldots,p_{k}:b_{k}\\} using the ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆğ’«â†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šğ’«\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\mathcal{P}, then ğ’®â€‹ğ‘¢ğ‘šâ€‹(a)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…ğ’®â€‹ğ‘¢ğ‘šâ€‹(bj)ğ’®ğ‘¢ğ‘šğ‘subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—ğ’®ğ‘¢ğ‘šsubscriptğ‘ğ‘—\\mathit{\\mathcal{S}\\!um}(a)\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\mathit{\\mathcal{S}\\!um}(b_{j}). In this case, there exist a rule â„“â†’{p1:r1,â€¦,pk:rk}â†’â„“conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\} with\nPolâ¡(â„“)â‰¥Polâ¡(rj)Polâ„“Polsubscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\operatorname{Pol}(r_{j}) for some 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k, a substitution Ïƒğœ\\sigma,\nand a position Ï€ğœ‹\\pi of sğ‘ s such that s|Ï€=â„“â€‹Ïƒevaluated-atğ‘ ğœ‹â„“ğœs|_{\\pi}=\\ell\\sigma and\nth=sâ€‹[rhâ€‹Ïƒ]Ï€subscriptğ‘¡â„ğ‘ subscriptdelimited-[]subscriptğ‘Ÿâ„ğœğœ‹t_{h}=s[r_{h}\\sigma]_{\\pi} for all 1â‰¤hâ‰¤k1â„ğ‘˜1\\leq h\\leq k. We perform structural induction on Ï€ğœ‹\\pi.\nSo in the induction base, let Ï€=Îµğœ‹ğœ€\\pi=\\varepsilon.\nHence, we have s=â„“â€‹Ïƒâ†’{p1:r1â€‹Ïƒ,â€¦,pk:rkâ€‹Ïƒ}ğ‘ â„“ğœâ†’conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1ğœâ€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğœs=\\ell\\sigma\\to\\{p_{1}:r_{1}\\sigma,\\ldots,p_{k}:r_{k}\\sigma\\}.\nBy assumption, we have Polâ¡(â„“)â‰¥Polâ¡(rj)Polâ„“Polsubscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\operatorname{Pol}(r_{j}) for some 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k.\nAs these inequations hold for all instantiations of the occurring variables, for tj=rjâ€‹Ïƒsubscriptğ‘¡ğ‘—subscriptğ‘Ÿğ‘—ğœt_{j}=r_{j}\\sigma we have In the induction step, we have Ï€=i.Ï€â€²formulae-sequenceğœ‹ğ‘–superscriptğœ‹â€²\\pi=i.\\pi^{\\prime}, s=fâ€‹(s1,â€¦,si,â€¦,sn)ğ‘ ğ‘“subscriptğ‘ 1â€¦subscriptğ‘ ğ‘–â€¦subscriptğ‘ ğ‘›s=f(s_{1},\\ldots,s_{i},\\ldots,s_{n}),\nfâˆˆÎ£ğ‘“Î£f\\in\\Sigma, siâ†’{p1:ti,1,â€¦,pk:ti,k}â†’subscriptğ‘ ğ‘–conditional-setsubscriptğ‘1:subscriptğ‘¡ğ‘–1â€¦subscriptğ‘ğ‘˜subscriptğ‘¡ğ‘–ğ‘˜s_{i}\\to\\{p_{1}:t_{i,1},\\ldots,p_{k}:t_{i,k}\\}, and tj=fâ€‹(s1,â€¦,ti,j,â€¦,sn)subscriptğ‘¡ğ‘—ğ‘“subscriptğ‘ 1â€¦subscriptğ‘¡ğ‘–ğ‘—â€¦subscriptğ‘ ğ‘›t_{j}=f(s_{1},\\ldots,t_{i,j},\\ldots,s_{n}) with ti,j=siâ€‹[rjâ€‹Ïƒ]Ï€â€²subscriptğ‘¡ğ‘–ğ‘—subscriptğ‘ ğ‘–subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœsuperscriptğœ‹â€²t_{i,j}=s_{i}[r_{j}\\sigma]_{\\pi^{\\prime}} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k.\nThen by the induction hypothesis we have Pâ€‹oâ€‹lâ€‹(si)â‰¥Pâ€‹oâ€‹lâ€‹(ti,j)ğ‘ƒğ‘œğ‘™subscriptğ‘ ğ‘–ğ‘ƒğ‘œğ‘™subscriptğ‘¡ğ‘–ğ‘—Pol(s_{i})\\geq Pol(t_{i,j}).\nFor tj=fâ€‹(s1,â€¦,ti,j,â€¦,sn)subscriptğ‘¡ğ‘—ğ‘“subscriptğ‘ 1â€¦subscriptğ‘¡ğ‘–ğ‘—â€¦subscriptğ‘ ğ‘›t_{j}=f(s_{1},\\ldots,t_{i,j},\\ldots,s_{n}) we obtain In this case, there exist an ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆğ’«>â†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šsubscriptğ’«\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\mathcal{P}_{>},\na VRF (Ï†j)1â‰¤jâ‰¤ksubscriptsubscriptğœ‘ğ‘—1ğ‘—ğ‘˜(\\varphi_{j})_{1\\leq j\\leq k}, a substitution Ïƒğœ\\sigma,\nand position Ï€âˆˆPosğ’Ÿ#â€‹(a)ğœ‹subscriptPossuperscriptğ’Ÿ#ğ‘\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a) with â™­â€‹(a|Ï€)=â„“â€‹Ïƒâ™­evaluated-atğ‘ğœ‹â„“ğœ\\flat(a|_{\\pi})=\\ell\\sigma and bjâ‰aâ€‹[rjâ€‹Ïƒ]Ï€approaches-limitsubscriptğ‘ğ‘—ğ‘subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹b_{j}\\doteq a[r_{j}\\sigma]_{\\pi}.\nFirst, assume that m=ğ—ğ—‹ğ—ğ–¾ğ‘šğ—ğ—‹ğ—ğ–¾m=\\mathsf{true}.\nLet I1={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Ï„<Ï€}subscriptğ¼1conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘ğœğœ‹I_{1}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\tau<\\pi\\} be the set of positions of all\nannotations strictly above Ï€ğœ‹\\pi, I2={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Î³âˆˆPosğ’±â€‹(â„“),Ï€<Ï„â‰¤Ï€.Î³}subscriptğ¼2conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘formulae-sequenceformulae-sequenceğ›¾subscriptPosğ’±â„“ğœ‹ğœğœ‹ğ›¾I_{2}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\gamma\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell),\\pi<\\tau\\leq\\pi.\\gamma\\} be the set of positions of all\nannotations inside the left-hand side â„“â„“\\ell of the used redex â„“â€‹Ïƒâ„“ğœ\\ell\\sigma (but\nnot on the root of â„“â„“\\ell),\nI3={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Î³âˆˆPosğ’±â€‹(â„“),Ï€.Î³<Ï„}subscriptğ¼3conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘formulae-sequenceğ›¾subscriptPosğ’±â„“ğœ‹ğ›¾ğœI_{3}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\gamma\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell),\\pi.\\gamma<\\tau\\} be the set of positions of all annotations inside the substitution, and let I4={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Ï„âŠ¥Ï€}subscriptğ¼4conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘bottomğœğœ‹I_{4}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\tau\\bot\\pi\\} be the set of positions of all annotations orthogonal to Ï€ğœ‹\\pi.\nFurthermore, for each\nÏ„âˆˆI1ğœsubscriptğ¼1\\tau\\in I_{1} let ÎºÏ„subscriptğœ…ğœ\\kappa_{\\tau} be the position such that Ï„.ÎºÏ„=Ï€formulae-sequenceğœsubscriptğœ…ğœğœ‹\\tau.\\kappa_{\\tau}=\\pi,\nand for each Ï„âˆˆI3ğœsubscriptğ¼3\\tau\\in I_{3} let Î³Ï„subscriptğ›¾ğœ\\gamma_{\\tau} and ÏÏ„subscriptğœŒğœ\\rho_{\\tau} be the positions such that\nÎ³Ï„âˆˆPosğ’±â€‹(â„“)subscriptğ›¾ğœsubscriptPosğ’±â„“\\gamma_{\\tau}\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell) and Ï€.Î³Ï„.ÏÏ„=Ï„formulae-sequenceğœ‹subscriptğ›¾ğœsubscriptğœŒğœğœ\\pi.\\gamma_{\\tau}.\\rho_{\\tau}=\\tau.\nBy Requirement (2), there exists a 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k with Polâ¡(â„“#)>ğ’®â€‹ğ‘¢ğ‘šâ€‹(rj)=âˆ‘sâ€‹âŠ´#â€‹rjPolâ¡(s#)Polsuperscriptâ„“#ğ’®ğ‘¢ğ‘šsubscriptğ‘Ÿğ‘—subscriptğ‘ subscriptâŠ´#subscriptğ‘Ÿğ‘—Polsuperscriptğ‘ #\\operatorname{Pol}(\\ell^{\\#})>\\mathit{\\mathcal{S}\\!um}(r_{j})=\\sum_{s\\trianglelefteq_{\\#}r_{j}}\\operatorname{Pol}(s^{\\#}) and, additionally, Polâ¡(â„“)â‰¥Polâ¡(â™­â€‹(rj))Polâ„“Polâ™­subscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\operatorname{Pol}(\\flat(r_{j})) since m=ğ—ğ—‹ğ—ğ–¾ğ‘šğ—ğ—‹ğ—ğ–¾m=\\mathsf{true}.\nAs these inequations hold for all instantiations of the occurring variables, we\nhave In the case m=ğ–¿ğ–ºğ—…ğ—Œğ–¾ğ‘šğ–¿ğ–ºğ—…ğ—Œğ–¾m=\\mathsf{false}, we remove âˆ‘Ï„âˆˆI1Polâ¡(#Îµâ€‹(a|Ï„â€‹[rjâ€‹Ïƒ]ÎºÏ„))subscriptğœsubscriptğ¼1Polsubscript#ğœ€evaluated-atğ‘ğœsubscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœsubscriptğœ…ğœ\\sum_{\\tau\\in I_{1}}\\operatorname{Pol}(\\#_{\\varepsilon}(a|_{\\tau}[r_{j}\\sigma]_{\\kappa_{\\tau}})), so that the inequation remains\ncorrect. In this case, there exist a rule â„“â†’{p1:r1,â€¦,pk:rk}â†’â„“conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\} with Polâ¡(â„“)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…Polâ¡(rj)Polâ„“subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—Polsubscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\operatorname{Pol}(r_{j}), a substitution Ïƒğœ\\sigma, and a position Ï€ğœ‹\\pi of sğ‘ s such that s|Ï€=â„“â€‹Ïƒevaluated-atğ‘ ğœ‹â„“ğœs|_{\\pi}=\\ell\\sigma, and tj=sâ€‹[rjâ€‹Ïƒ]Ï€subscriptğ‘¡ğ‘—ğ‘ subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹t_{j}=s[r_{j}\\sigma]_{\\pi} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k. We perform structural induction on Ï€ğœ‹\\pi.\nSo in the induction base Ï€=Îµğœ‹ğœ€\\pi=\\varepsilon we have s=â„“â€‹Ïƒâ†’{p1:r1â€‹Ïƒ,â€¦,pk:rkâ€‹Ïƒ}ğ‘ â„“ğœâ†’conditional-setsubscriptğ‘1:subscriptğ‘Ÿ1ğœâ€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğœs=\\ell\\sigma\\to\\{p_{1}:r_{1}\\sigma,\\ldots,p_{k}:r_{k}\\sigma\\}.\nAs Polâ¡(â„“)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…Polâ¡(rj)Polâ„“subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—Polsubscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\operatorname{Pol}(r_{j}) holds for all instantiations of the occurring variables, for tj=rjâ€‹Ïƒsubscriptğ‘¡ğ‘—subscriptğ‘Ÿğ‘—ğœt_{j}=r_{j}\\sigma we obtain In the induction step, we have Ï€=i.Ï€â€²formulae-sequenceğœ‹ğ‘–superscriptğœ‹â€²\\pi=i.\\pi^{\\prime}, s=fâ€‹(s1,â€¦,si,â€¦,sn)ğ‘ ğ‘“subscriptğ‘ 1â€¦subscriptğ‘ ğ‘–â€¦subscriptğ‘ ğ‘›s=f(s_{1},\\ldots,s_{i},\\ldots,s_{n}),\nsiâ†’{p1:ti,1,â€¦,pk:ti,k}â†’subscriptğ‘ ğ‘–conditional-setsubscriptğ‘1:subscriptğ‘¡ğ‘–1â€¦subscriptğ‘ğ‘˜subscriptğ‘¡ğ‘–ğ‘˜s_{i}\\to\\{p_{1}:t_{i,1},\\ldots,p_{k}:t_{i,k}\\}, and tj=fâ€‹(s1,â€¦,ti,j,â€¦,sn)subscriptğ‘¡ğ‘—ğ‘“subscriptğ‘ 1â€¦subscriptğ‘¡ğ‘–ğ‘—â€¦subscriptğ‘ ğ‘›t_{j}=f(s_{1},\\ldots,t_{i,j},\\ldots,s_{n})\nwith ti,j=siâ€‹[rjâ€‹Ïƒ]Ï€â€²subscriptğ‘¡ğ‘–ğ‘—subscriptğ‘ ğ‘–subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœsuperscriptğœ‹â€²t_{i,j}=s_{i}[r_{j}\\sigma]_{\\pi^{\\prime}} for all 1â‰¤jâ‰¤k1ğ‘—ğ‘˜1\\leq j\\leq k.\nThen by the induction hypothesis we have Polâ¡(si)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…Polâ¡(ti,j)Polsubscriptğ‘ ğ‘–subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—Polsubscriptğ‘¡ğ‘–ğ‘—\\operatorname{Pol}(s_{i})\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\operatorname{Pol}(t_{i,j}).\nThus, we have In this case, there exist an ADP â„“â†’{p1:r1,â€¦,pk:rk}mâˆˆğ’«â†’â„“superscriptconditional-setsubscriptğ‘1:subscriptğ‘Ÿ1â€¦subscriptğ‘ğ‘˜subscriptğ‘Ÿğ‘˜ğ‘šğ’«\\ell\\to\\{p_{1}:r_{1},\\ldots,p_{k}:r_{k}\\}^{m}\\in\\mathcal{P},\na substitution Ïƒğœ\\sigma, and position Ï€ğœ‹\\pi with â™­â€‹(a|Ï€)=â„“â€‹Ïƒâ™­evaluated-atğ‘ğœ‹â„“ğœ\\flat(a|_{\\pi})=\\ell\\sigma and bjâ‰aâ€‹[rjâ€‹Ïƒ]Ï€approaches-limitsubscriptğ‘ğ‘—ğ‘subscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœğœ‹b_{j}\\doteq a[r_{j}\\sigma]_{\\pi}.\nFirst, assume that m=ğ—ğ—‹ğ—ğ–¾ğ‘šğ—ğ—‹ğ—ğ–¾m=\\mathsf{true} and Ï€âˆˆPosğ’Ÿ#â€‹(a)ğœ‹subscriptPossuperscriptğ’Ÿ#ğ‘\\pi\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a).\nLet I1={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Ï„<Ï€}subscriptğ¼1conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘ğœğœ‹I_{1}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\tau<\\pi\\} be the set of positions of all\nannotations strictly above Ï€ğœ‹\\pi, I2={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Î³âˆˆPosğ’±â€‹(â„“),Ï€<Ï„â‰¤Ï€.Î³}subscriptğ¼2conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘formulae-sequenceformulae-sequenceğ›¾subscriptPosğ’±â„“ğœ‹ğœğœ‹ğ›¾I_{2}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\gamma\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell),\\pi<\\tau\\leq\\pi.\\gamma\\} be the set of positions of all\nannotations inside the left-hand side â„“â„“\\ell of the used redex â„“â€‹Ïƒâ„“ğœ\\ell\\sigma (but\nnot on the root of â„“â„“\\ell), I3={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Î³âˆˆPosğ’±â€‹(â„“),Ï€.Î³<Ï„}subscriptğ¼3conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘formulae-sequenceğ›¾subscriptPosğ’±â„“ğœ‹ğ›¾ğœI_{3}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\gamma\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell),\\pi.\\gamma<\\tau\\} be the set of positions of all annotations inside the substitution, and let I4={Ï„âˆˆPosğ’Ÿ#â€‹(a)âˆ£Ï„âŠ¥Ï€}subscriptğ¼4conditional-setğœsubscriptPossuperscriptğ’Ÿ#ğ‘bottomğœğœ‹I_{4}=\\{\\tau\\in\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a)\\mid\\tau\\bot\\pi\\} be the set of positions of all annotations orthogonal to Ï€ğœ‹\\pi.\nFurthermore, for each Ï„âˆˆI1ğœsubscriptğ¼1\\tau\\in I_{1} let ÎºÏ„subscriptğœ…ğœ\\kappa_{\\tau} be the position such that\nÏ„.ÎºÏ„=Ï€formulae-sequenceğœsubscriptğœ…ğœğœ‹\\tau.\\kappa_{\\tau}=\\pi,\nand for each Ï„âˆˆI3ğœsubscriptğ¼3\\tau\\in I_{3} let Î³Ï„subscriptğ›¾ğœ\\gamma_{\\tau} and ÏÏ„subscriptğœŒğœ\\rho_{\\tau} be the positions such that\nÎ³Ï„âˆˆPosğ’±â€‹(â„“)subscriptğ›¾ğœsubscriptPosğ’±â„“\\gamma_{\\tau}\\in\\mathrm{Pos}_{\\mathcal{V}}(\\ell) and Ï€.Î³Ï„.ÏÏ„=Ï„formulae-sequenceğœ‹subscriptğ›¾ğœsubscriptğœŒğœğœ\\pi.\\gamma_{\\tau}.\\rho_{\\tau}=\\tau.\nBy Requirement (1), we have Polâ¡(#Îµâ€‹(â„“))â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…âˆ‘tâ€‹âŠ´#â€‹rjPolâ¡(#Îµâ€‹(t))Polsubscript#ğœ€â„“subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—subscriptğ‘¡subscriptâŠ´#subscriptğ‘Ÿğ‘—Polsubscript#ğœ€ğ‘¡\\operatorname{Pol}(\\#_{\\varepsilon}(\\ell))\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\sum_{t\\trianglelefteq_{\\#}r_{j}}\\operatorname{Pol}(\\#_{\\varepsilon}(t)) and by (3) we have Polâ¡(â„“)â‰¥âˆ‘1â‰¤jâ‰¤kpjâ‹…Polâ¡(â™­â€‹(rj))Polâ„“subscript1ğ‘—ğ‘˜â‹…subscriptğ‘ğ‘—Polâ™­subscriptğ‘Ÿğ‘—\\operatorname{Pol}(\\ell)\\geq\\sum_{1\\leq j\\leq k}p_{j}\\cdot\\operatorname{Pol}(\\flat(r_{j})).\nAs these inequations hold for all instantiations of the occurring variables, we have In the case Ï€âˆ‰Posğ’Ÿ#â€‹(a)ğœ‹subscriptPossuperscriptğ’Ÿ#ğ‘\\pi\\notin\\mathrm{Pos}_{\\mathcal{D}^{\\#}}(a), we need to remove\nPolâ¡(#Îµâ€‹(â„“)â€‹Ïƒ)Polsubscript#ğœ€â„“ğœ\\operatorname{Pol}(\\#_{\\varepsilon}(\\ell)\\sigma) as this annotated subterm does not exist in ağ‘a,\nand therefore also âˆ‘tâ€‹âŠ´#â€‹rjâ€‹ÏƒPolâ¡(t#)subscriptğ‘¡subscriptâŠ´#subscriptğ‘Ÿğ‘—ğœPolsuperscriptğ‘¡#\\sum_{t\\trianglelefteq_{\\#}r_{j}\\sigma}\\operatorname{Pol}(t^{\\#})\nin the end, leading to the same result.\nIn the case m=ğ–¿ğ–ºğ—…ğ—Œğ–¾ğ‘šğ–¿ğ–ºğ—…ğ—Œğ–¾m=\\mathsf{false}, we additionally remove âˆ‘iâˆˆI1Polâ¡(#Îµâ€‹(a|Ï„â€‹[rjâ€‹Ïƒ]ÎºÏ„))subscriptğ‘–subscriptğ¼1Polsubscript#ğœ€evaluated-atğ‘ğœsubscriptdelimited-[]subscriptğ‘Ÿğ‘—ğœsubscriptğœ…ğœ\\sum_{i\\in I_{1}}\\operatorname{Pol}(\\#_{\\varepsilon}(a|_{\\tau}[r_{j}\\sigma]_{\\kappa_{\\tau}})) in the end. The rest is completely analogous to the proof in .\nâˆ See 4.9 Proof.\n\nAnalogous to the proof of Thm.Â 4.8.\nWe can only use the ADPs from â„âˆ–ğ’«â„ğ’«\\mathcal{I}\\setminus\\mathcal{P} finitely often,\nhence we can ignore them for the constraints in the theorem.\nâˆ See 4.11 Proof.\n\nLet ğ’«ğ’«\\mathcal{P} be an ADP problem such that every ADP in\nğ’«ğ’«\\mathcal{P} has the form â„“â†’{1:r}mâ†’â„“superscriptconditional-set1ğ‘Ÿğ‘š\\ell\\to\\{1:r\\}^{m}.\nNote that every ğ’«ğ’«\\mathcal{P}-chain tree is a single (not necessarily finite) path.\nFor such a chain tree ğ”—ğ”—\\mathfrak{T} that is only a single path, we have only two possibilities for |ğ”—|ğ™»ğšğšŠğšsubscriptğ”—ğ™»ğšğšŠğš|\\mathfrak{T}|_{\\mathtt{Leaf}}.\nIf the path is finite, then |ğ”—|ğ™»ğšğšŠğš=1subscriptğ”—ğ™»ğšğšŠğš1|\\mathfrak{T}|_{\\mathtt{Leaf}}=1, since we have a single leaf in this tree with probability 111.\nOtherwise, we have an infinite path, which means that there is no leaf at all and\nhence |ğ”—|ğ™»ğšğšŠğš=0subscriptğ”—ğ™»ğšğšŠğš0|\\mathfrak{T}|_{\\mathtt{Leaf}}=0. â€œonly ifâ€ This direction only works for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nAssume that (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P})) is not terminating.\nThen there exists an infinite (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P}))-chain such that for all iâˆˆâ„•ğ‘–â„•i\\in\\mathbb{N} we have ti#=â„“i#â€‹Ïƒisuperscriptsubscriptğ‘¡ğ‘–#superscriptsubscriptâ„“ğ‘–#subscriptğœğ‘–t_{i}^{\\#}=\\ell_{i}^{\\#}\\sigma_{i} for\nsome dependency pair â„“i#â†’ri#âˆˆdpâ€‹(ğ’«)â†’superscriptsubscriptâ„“ğ‘–#superscriptsubscriptğ‘Ÿğ‘–#dpğ’«\\ell_{i}^{\\#}\\to r_{i}^{\\#}\\in{\\text{dp}}(\\mathcal{P}) and some substitution Ïƒisubscriptğœğ‘–\\sigma_{i}.\nFrom this infinite (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P}))-chain, we will now construct an infinite ğ’«ğ’«\\mathcal{P}-chain tree ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A).\nAs explained above, we then know that this infinite ğ’«ğ’«\\mathcal{P}-chain tree must be an\ninfinite path, and thus |ğ”—|ğ™»ğšğšŠğš=0subscriptğ”—ğ™»ğšğšŠğš0|\\mathfrak{T}|_{\\mathtt{Leaf}}=0, which means that ğ’«ğ’«\\mathcal{P} is not\nğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, and thus, a processor with Procğ™¿ğšâ¡(ğ’«)=âˆ…subscriptProcğ™¿ğšğ’«\\operatorname{Proc}_{\\mathtt{PR}}(\\mathcal{P})=\\varnothing\nwould be unsound. We start our chain tree with (1:t0#):1superscriptsubscriptğ‘¡0#(1:t_{0}^{\\#}).\nIn the non-probabilistic rewrite sequence, we have t0#â†’dpâ€‹(ğ’«)âˆ˜â†’npâ€‹(ğ’«)âˆ—t1#t_{0}^{\\#}\\to_{{\\text{dp}}(\\mathcal{P})}\\circ\\to_{{\\text{np}}(\\mathcal{P})}^{*}t_{1}^{\\#}, so there exists a natural number kâ‰¥1ğ‘˜1k\\geq 1 such that Performing the same rewrite steps with ğ’«ğ’«\\mathcal{P} yields\nterms a1,â€¦,aksubscriptğ‘1â€¦subscriptğ‘ğ‘˜a_{1},\\ldots,a_{k} such that\nviâ€‹âŠ´#â€‹aisubscriptğ‘£ğ‘–subscriptâŠ´#subscriptğ‘ğ‘–v_{i}\\trianglelefteq_{\\#}a_{i} for all 1â‰¤iâ‰¤k1ğ‘–ğ‘˜1\\leq i\\leq k.\nHere, one needs that all ADPs that yield the rules in npâ€‹(ğ’«)npğ’«{\\text{np}}(\\mathcal{P}) have the flag\nğ—ğ—‹ğ—ğ–¾ğ—ğ—‹ğ—ğ–¾\\mathsf{true} and thus, the annotations above the redex are not removed.\nFor all 1â‰¤iâ‰¤k1ğ‘–ğ‘˜1\\leq i\\leq k, we now construct aisubscriptğ‘ğ‘–a_{i} inductively. In the induction base (i=1ğ‘–1i=1), let\nâ„“0â†’{1:r0â€²}mâˆˆğ’«â†’subscriptâ„“0superscriptconditional-set1superscriptsubscriptğ‘Ÿ0â€²ğ‘šğ’«\\ell_{0}\\to\\{1:r_{0}^{\\prime}\\}^{m}\\in\\mathcal{P} be the\nADP that was used to create the dependency pair â„“0#â†’r0#â†’superscriptsubscriptâ„“0#superscriptsubscriptğ‘Ÿ0#\\ell_{0}^{\\#}\\to r_{0}^{\\#} in dpâ€‹(ğ’«)dpğ’«{\\text{dp}}(\\mathcal{P}).\nThis means that we have r0â€‹âŠ´#â€‹r0â€²subscriptğ‘Ÿ0subscriptâŠ´#superscriptsubscriptğ‘Ÿ0â€²r_{0}\\trianglelefteq_{\\#}r_{0}^{\\prime}.\nSince we have t0#=â„“0#â€‹Ïƒ0superscriptsubscriptğ‘¡0#superscriptsubscriptâ„“0#subscriptğœ0t_{0}^{\\#}=\\ell_{0}^{\\#}\\sigma_{0}, we can also\nrewrite t0#superscriptsubscriptğ‘¡0#t_{0}^{\\#} with the ADP â„“0â†’{1:r0â€²}mâˆˆğ’«â†’subscriptâ„“0superscriptconditional-set1superscriptsubscriptğ‘Ÿ0â€²ğ‘šğ’«\\ell_{0}\\to\\{1:r_{0}^{\\prime}\\}^{m}\\in\\mathcal{P} and the substitution Ïƒ0subscriptğœ0\\sigma_{0}.\nWe result in a1=r0â€²â€‹Ïƒ0subscriptğ‘1superscriptsubscriptğ‘Ÿ0â€²subscriptğœ0a_{1}=r_{0}^{\\prime}\\sigma_{0} and thus we have v1=r0â€‹Ïƒ0â€‹âŠ´#â€‹r0â€²â€‹Ïƒ0=a1subscriptğ‘£1subscriptğ‘Ÿ0subscriptğœ0subscriptâŠ´#superscriptsubscriptğ‘Ÿ0â€²subscriptğœ0subscriptğ‘1v_{1}=r_{0}\\sigma_{0}\\trianglelefteq_{\\#}r_{0}^{\\prime}\\sigma_{0}=a_{1}. In the induction step, we assume that we have\nviâ€‹âŠ´#â€‹aisubscriptğ‘£ğ‘–subscriptâŠ´#subscriptğ‘ğ‘–v_{i}\\trianglelefteq_{\\#}a_{i} for some 1â‰¤i<k1ğ‘–ğ‘˜1\\leq i<k.\nLet Ï€ğœ‹\\pi be the annotated position of aisubscriptğ‘ğ‘–a_{i} where vi=â™­â€‹(ai)|Ï€subscriptğ‘£ğ‘–evaluated-atâ™­subscriptğ‘ğ‘–ğœ‹v_{i}=\\flat(a_{i})|_{\\pi}.\nIn our non-probabilistic rewrite sequence we have\nvi#â†’npâ€‹(ğ’«)vi+1#subscriptâ†’npğ’«superscriptsubscriptğ‘£ğ‘–#superscriptsubscriptğ‘£ğ‘–1#v_{i}^{\\#}\\to_{{\\text{np}}(\\mathcal{P})}v_{i+1}^{\\#}\nusing a rule â„“â€²â†’â™­â€‹(râ€²)âˆˆnpâ€‹(ğ’«)â†’superscriptâ„“â€²â™­superscriptğ‘Ÿâ€²npğ’«\\ell^{\\prime}\\to\\flat(r^{\\prime})\\in{\\text{np}}(\\mathcal{P}) and substitution Î´isubscriptğ›¿ğ‘–\\delta_{i} at\na position Ï„âˆˆâ„•+ğœsuperscriptâ„•\\tau\\in\\mathbb{N}^{+}\nsuch that vi#|Ï„=â„“â€²â€‹Î´ievaluated-atsuperscriptsubscriptğ‘£ğ‘–#ğœsuperscriptâ„“â€²subscriptğ›¿ğ‘–v_{i}^{\\#}|_{\\tau}=\\ell^{\\prime}\\delta_{i} and vi+1#=vi#â€‹[â™­â€‹(râ€²)â€‹Î´i]Ï„superscriptsubscriptğ‘£ğ‘–1#superscriptsubscriptğ‘£ğ‘–#subscriptdelimited-[]â™­superscriptğ‘Ÿâ€²subscriptğ›¿ğ‘–ğœv_{i+1}^{\\#}=v_{i}^{\\#}[\\flat(r^{\\prime})\\delta_{i}]_{\\tau}.\nWe can mirror this rewrite step with the ADP â„“â€²â†’{1:râ€²}ğ—ğ—‹ğ—ğ–¾âˆˆğ’«â†’superscriptâ„“â€²superscriptconditional-set1superscriptğ‘Ÿâ€²ğ—ğ—‹ğ—ğ–¾ğ’«\\ell^{\\prime}\\to\\{1:r^{\\prime}\\}^{\\mathsf{true}}\\in\\mathcal{P},\nsince by construction we have viâ€‹âŠ´#â€‹aisubscriptğ‘£ğ‘–subscriptâŠ´#subscriptğ‘ğ‘–v_{i}\\trianglelefteq_{\\#}a_{i} and vi=â™­â€‹(ai)|Ï€subscriptğ‘£ğ‘–evaluated-atâ™­subscriptğ‘ğ‘–ğœ‹v_{i}=\\flat(a_{i})|_{\\pi}.\nWe obtain aiâ†ªğ’«ai+1=aiâ€‹[#Xâ€‹(râ€²â€‹Î´i)]Ï€.Ï„subscriptabsentâ†ªğ’«subscriptğ‘ğ‘–subscriptğ‘ğ‘–1subscriptğ‘ğ‘–subscriptdelimited-[]subscript#ğ‘‹superscriptğ‘Ÿâ€²subscriptğ›¿ğ‘–formulae-sequenceğœ‹ğœa_{i}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}a_{i+1}=a_{i}[\\#_{X}(r^{\\prime}\\delta_{i})]_{\\pi.\\tau} with X=Î¦1ğ‘‹subscriptÎ¦1X=\\Phi_{1} (step with (ğšğ­)ğšğ­(\\mathbf{at})) or X=Î¨1ğ‘‹subscriptÎ¨1X=\\Psi_{1} (step with (ğ§ğ­)ğ§ğ­(\\mathbf{nt})) by rewriting the subterm\nof aisubscriptğ‘ğ‘–a_{i} at position Ï€.Ï„formulae-sequenceğœ‹ğœ\\pi.\\tau, which implies vi+1=viâ€‹[â™­â€‹(râ€²)â€‹Î´i]Ï„â€‹âŠ´#â€‹aiâ€‹[#Xâ€‹(râ€²â€‹Î´i)]Ï€.Ï„=ai+1subscriptğ‘£ğ‘–1subscriptğ‘£ğ‘–subscriptdelimited-[]â™­superscriptğ‘Ÿâ€²subscriptğ›¿ğ‘–ğœsubscriptâŠ´#subscriptğ‘ğ‘–subscriptdelimited-[]subscript#ğ‘‹superscriptğ‘Ÿâ€²subscriptğ›¿ğ‘–formulae-sequenceğœ‹ğœsubscriptğ‘ğ‘–1v_{i+1}=v_{i}[\\flat(r^{\\prime})\\delta_{i}]_{\\tau}\\trianglelefteq_{\\#}a_{i}[\\#_{X}(r^{\\prime}\\delta_{i})]_{\\pi.\\tau}=a_{i+1}. At the end of this induction, we result in aksubscriptğ‘ğ‘˜a_{k}.\nNext, we can mirror the step t1#â†’dpâ€‹(ğ’«)âˆ˜â†’npâ€‹(ğ’«)âˆ—t2#t_{1}^{\\#}\\to_{{\\text{dp}}(\\mathcal{P})}\\circ\\to_{{\\text{np}}(\\mathcal{P})}^{*}t_{2}^{\\#} from our non-probabilistic rewrite sequence with the same construction, etc.\nThis results in an infinite ğ’«ğ’«\\mathcal{P}-chain tree.\nTo see that this is indeed a ğ’«ğ’«\\mathcal{P}-chain tree, note that all the\nlocal properties are satisfied since every edge represents a rewrite step with â†ªğ’«subscriptabsentâ†ªğ’«\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}.\nThe global property is also satisfied since,\nin an infinite (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P}))-chain, we use\nan infinite number of steps with â†’dpâ€‹(ğ’«)subscriptâ†’dpğ’«\\to_{{\\text{dp}}(\\mathcal{P})}\nso that our resulting chain tree has an infinite number of nodes in Ağ´A. â€œifâ€ This direction works analogously\nfor both ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} and ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, and we prove it only for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}.\nFor ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST} we simply ignore the reachability component â„â„\\mathcal{I}.\nAssume that ğ’«ğ’«\\mathcal{P} is not ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST}, i.e., that the processor\nProcğ™¿ğšâ¡(ğ’«)=âˆ…subscriptProcğ™¿ğšğ’«\\operatorname{Proc}_{\\mathtt{PR}}(\\mathcal{P})=\\varnothing is unsound.\nBy LemmaÂ 2, there exists a ğ’«ğ’«\\mathcal{P}-chain tree ğ”—=(V,E,L,A)ğ”—ğ‘‰ğ¸ğ¿ğ´\\mathfrak{T}=(V,E,L,A) that converges with probability <1absent1<1 and starts with\n(1:t#):1superscriptğ‘¡#(1:t^{\\#}) such that t#=â„“#â€‹Ïƒ0superscriptğ‘¡#superscriptâ„“#subscriptğœ0t^{\\#}=\\ell^{\\#}\\sigma_{0} for some\nsubstitution Ïƒ0subscriptğœ0\\sigma_{0} and an ADP â„“â†’{1:r}mâˆˆğ’«â†’â„“superscriptconditional-set1ğ‘Ÿğ‘šğ’«\\ell\\to\\{1:r\\}^{m}\\in\\mathcal{P}.\nAs explained above, this tree must be an infinite path. From ğ”—ğ”—\\mathfrak{T}, we will now construct an infinite (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P}))-chain, which shows that (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P})) is not terminating.\nWe start our infinite chain with the term t0#=t#superscriptsubscriptğ‘¡0#superscriptğ‘¡#t_{0}^{\\#}=t^{\\#}.\nWe have t#â†ªğ’«{1:a1}subscriptabsentâ†ªğ’«superscriptğ‘¡#conditional-set1subscriptğ‘1t^{\\#}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}\\{1:a_{1}\\},\nwhere a1=#Î¦1â€‹(râ€‹Ïƒ0)=râ€‹Ïƒ0subscriptğ‘1subscript#subscriptÎ¦1ğ‘Ÿsubscriptğœ0ğ‘Ÿsubscriptğœ0a_{1}=\\#_{\\Phi_{1}}(r\\sigma_{0})=r\\sigma_{0}. There must be a term r0â€‹âŠ´#â€‹rsubscriptğ‘Ÿ0subscriptâŠ´#ğ‘Ÿr_{0}\\trianglelefteq_{\\#}r (i.e.,\nr0#â€‹Ïƒ0â€‹âŠ´â€‹râ€‹Ïƒ0superscriptsubscriptğ‘Ÿ0#subscriptğœ0âŠ´ğ‘Ÿsubscriptğœ0r_{0}^{\\#}\\sigma_{0}\\trianglelefteq r\\sigma_{0})\nsuch that if we replace a1=râ€‹Ïƒ0subscriptğ‘1ğ‘Ÿsubscriptğœ0a_{1}=r\\sigma_{0} with\nr0#â€‹Ïƒ0superscriptsubscriptğ‘Ÿ0#subscriptğœ0r_{0}^{\\#}\\sigma_{0} and obtain the same ğ’«ğ’«\\mathcal{P}-chain tree except when we\nwould rewrite terms that do not exist anymore (i.e., we ignore these rewrite steps),\nthen we still end up in an infinite number of nodes in Ağ´A (otherwise, ğ”—ğ”—\\mathfrak{T}\nwould not have an infinite number of nodes in Ağ´A). Let Ï€ğœ‹\\pi be the annotated position of râ€‹Ïƒ0ğ‘Ÿsubscriptğœ0r\\sigma_{0} where r0â€‹Ïƒ0=â™­â€‹(râ€‹Ïƒ0)|Ï€subscriptğ‘Ÿ0subscriptğœ0evaluated-atâ™­ğ‘Ÿsubscriptğœ0ğœ‹r_{0}\\sigma_{0}=\\flat(r\\sigma_{0})|_{\\pi}.\nWe can rewrite the term t0#superscriptsubscriptğ‘¡0#t_{0}^{\\#} with the dependency pair â„“#â†’r0#âˆˆdpâ€‹(ğ’«)â†’superscriptâ„“#superscriptsubscriptğ‘Ÿ0#dpğ’«\\ell^{\\#}\\to r_{0}^{\\#}\\in{\\text{dp}}(\\mathcal{P}), using the substitution Ïƒ0subscriptğœ0\\sigma_{0} since t0=t=â„“â€‹Ïƒ0subscriptğ‘¡0ğ‘¡â„“subscriptğœ0t_{0}=t=\\ell\\sigma_{0}.\nHence, we result in t0#â†’dpâ€‹(ğ’«)r0#â€‹Ïƒ0=v1#subscriptâ†’dpğ’«superscriptsubscriptğ‘¡0#superscriptsubscriptğ‘Ÿ0#subscriptğœ0superscriptsubscriptğ‘£1#t_{0}^{\\#}\\to_{{\\text{dp}}(\\mathcal{P})}r_{0}^{\\#}\\sigma_{0}=v_{1}^{\\#}.\nNext, we mirror the rewrite steps from the ğ’«ğ’«\\mathcal{P}-chain tree that are performed\nstrictly below the root of\nr0#â€‹Ïƒ0superscriptsubscriptğ‘Ÿ0#subscriptğœ0r_{0}^{\\#}\\sigma_{0} with npâ€‹(ğ’«)npğ’«{\\text{np}}(\\mathcal{P}) until we would rewrite at the root of r0#â€‹Ïƒ0superscriptsubscriptğ‘Ÿ0#subscriptğœ0r_{0}^{\\#}\\sigma_{0}.\nWith this construction, we ensure that each the term vi#superscriptsubscriptğ‘£ğ‘–#v_{i}^{\\#} in our (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P}))-chain\nsatisfies viâ€‹âŠ´#â€‹aisubscriptğ‘£ğ‘–subscriptâŠ´#subscriptğ‘ğ‘–v_{i}\\trianglelefteq_{\\#}a_{i} and vi=â™­â€‹(ai)|Ï€subscriptğ‘£ğ‘–evaluated-atâ™­subscriptğ‘ğ‘–ğœ‹v_{i}=\\flat(a_{i})|_{\\pi}.\nA rewrite step at position Ï€.Ï„formulae-sequenceğœ‹ğœ\\pi.\\tau in aisubscriptğ‘ğ‘–a_{i} with ğ’«ğ’«\\mathcal{P} is then mirrored with npâ€‹(ğ’«)npğ’«{\\text{np}}(\\mathcal{P})\nin vi#superscriptsubscriptğ‘£ğ‘–#v_{i}^{\\#} at position Ï„ğœ\\tau.\nNote that we only use a finite number of npâ€‹(ğ’«)npğ’«{\\text{np}}(\\mathcal{P}) steps until we rewrite at the root. So eventually, we result in a term t1#=vk#superscriptsubscriptğ‘¡1#superscriptsubscriptğ‘£ğ‘˜#t_{1}^{\\#}=v_{k}^{\\#} with vk=â™­â€‹(ak)|Ï€subscriptğ‘£ğ‘˜evaluated-atâ™­subscriptğ‘ğ‘˜ğœ‹v_{k}=\\flat(a_{k})|_{\\pi},\nand we rewrite at position Ï€ğœ‹\\pi in the ğ’«ğ’«\\mathcal{P}-chain tree.\nWe mirror the step akâ†ªğ’«ak+1subscriptabsentâ†ªğ’«subscriptğ‘ğ‘˜subscriptğ‘ğ‘˜1a_{k}\\mathrel{\\xhookrightarrow{}\\!\\!_{\\mathcal{P}}}a_{k+1}\nwith dpâ€‹(ğ’«)dpğ’«{\\text{dp}}(\\mathcal{P}) and then use the same construction again until we reach term t2#superscriptsubscriptğ‘¡2#t_{2}^{\\#}, etc.\nThis construction creates a sequence t0#,t1#,â€¦superscriptsubscriptğ‘¡0#superscriptsubscriptğ‘¡1#â€¦t_{0}^{\\#},t_{1}^{\\#},\\ldots of terms such that Therefore, (dpâ€‹(ğ’«),npâ€‹(ğ’«))dpğ’«npğ’«({\\text{dp}}(\\mathcal{P}),{\\text{np}}(\\mathcal{P})) is not terminating.\nâˆ A counterexample for the â€œonly ifâ€ part of Thm.Â 4.10\nfor ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST} is the basic ADP problem (âˆ…,ğ’«)ğ’«(\\varnothing,\\mathcal{P})\nwith ğ’«ğ’«\\mathcal{P} containing the ADPs ğ–¿â€‹(ğ–º,ğ–»,x)â†’{1:ğ–¥â€‹(x,x,x)}ğ—ğ—‹ğ—ğ–¾â†’ğ–¿ğ–ºğ–»ğ‘¥superscriptconditional-set1ğ–¥ğ‘¥ğ‘¥ğ‘¥ğ—ğ—‹ğ—ğ–¾\\mathsf{f}(\\mathsf{a},\\mathsf{b},x)\\to\\{1:\\mathsf{F}(x,x,x)\\}^{\\mathsf{true}},\nğ—â€‹(x,y)â†’{1:x}ğ—ğ—‹ğ—ğ–¾â†’ğ—ğ‘¥ğ‘¦superscriptconditional-set1ğ‘¥ğ—ğ—‹ğ—ğ–¾\\mathsf{h}(x,y)\\to\\{1:x\\}^{\\mathsf{true}}, and ğ—â€‹(x,y)â†’{1:y}ğ—ğ—‹ğ—ğ–¾â†’ğ—ğ‘¥ğ‘¦superscriptconditional-set1ğ‘¦ğ—ğ—‹ğ—ğ–¾\\mathsf{h}(x,y)\\to\\{1:y\\}^{\\mathsf{true}},\nwhich is based on the well-known TRS from .\nIt is ğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}, but the DP problem (ğ’Ÿ,â„›)ğ’Ÿâ„›(\\mathcal{D},\\mathcal{R}) with\nğ’Ÿ={ğ–¥â€‹(ğ–º,ğ–»,x)â†’ğ–¥â€‹(x,x,x)}ğ’Ÿâ†’ğ–¥ğ–ºğ–»ğ‘¥ğ–¥ğ‘¥ğ‘¥ğ‘¥\\mathcal{D}=\\{\\mathsf{F}(\\mathsf{a},\\mathsf{b},x)\\to\\mathsf{F}(x,x,x)\\} and â„›={ğ—â€‹(x,y)â†’x,ğ—â€‹(x,y)â†’y}â„›formulae-sequenceâ†’ğ—ğ‘¥ğ‘¦ğ‘¥â†’ğ—ğ‘¥ğ‘¦ğ‘¦\\mathcal{R}=\\{\\mathsf{h}(x,y)\\to x,\\mathsf{h}(x,y)\\to y\\}\nconsiders termination w.r.t.Â arbitrary start terms again, hence it is non-terminating.\n\nReference markers found: [31]\n\nContext windows for each [ref]:\n[ref]31: VRF.\nThis ends the induction proof for this direction. Completeness: Completely the same as in the proof of Thm.Â 3.2.\nâˆ Next, we consider the theorems regarding the processors\nthat we adapted from [ref]31 to our new framework for ğ™°ğš‚ğšƒğ™°ğš‚ğšƒ\\mathtt{AST} and\nğš‹ğ™°ğš‚ğšƒğš‹ğ™°ğš‚ğšƒ\\mathtt{bAST}.\nWe first recapitulate the notion of a sub-chain tree from . Let ğ’«ğ’«\\mathcal{P} be an ADP problem and let\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 31,\n            \"titles\": [\n                \"A Complete Dependency Pair Framework for Almost-Sure Innermost Termination of Probabilistic Term Rewriting\",\n                \"Lexicographic Ranking Supermartingales: An Efficient Approach to Termination of Probabilistic Programs\",\n                \"Termination of term rewriting using dependency pairs\",\n                \"A collection of examples for termination of term rewriting using dependency pairs\",\n                \"On probabilistic term rewriting\",\n                \"A modular cost analysis for probabilistic programs\",\n                \"Term Rewriting and All That\",\n                \"A Calculus for Amortized Expected Runtimes\",\n                \"On Probabilistic Termination of Functional Programs with Continuous Distributions\",\n                \"Probabilistic rewrite strategies. applications to ELAN\",\n                \"Proving positive almost-sure termination\",\n                \"Termination analysis of probabilistic programs with martingales\",\n                \"Probabilistic termination by monadic affine sized typing\",\n                \"Intersection Types and (Positive) Almost-Sure Termination\",\n                \"Probabilistic Rewriting and Asymptotic Behaviour: on Termination and Unique Normal Forms\",\n                \"Probabilistic termination: Soundness, completeness, and compositionality\",\n                \"Analyzing Runtime Complexity via Innermost Runtime Complexity\",\n                \"The dependency pair framework: Combining techniques for automated termination proofs\",\n                \"Mechanizing and improving dependency pairs\",\n                \"Analyzing program termination and complexity automatically with AProVE\",\n                \"Computing expected runtimes for constant probability programs\",\n                \"Probabilistic programming\",\n                \"MU-TERM: Verify Termination Properties Automatically (System Description)\",\n                \"Automating the dependency pair method\",\n                \"Tyrolean termination tool: Techniques and features\",\n                \"Modular Verification for Almost-Sure Termination of Probabilistic Programs\",\n                \"Weakest precondition reasoning for expected runtimes of randomized algorithms\",\n                \"Expected runtime analyis by program verification\",\n                \"Proving almost-sure innermost termination of probabilistic term rewriting using dependency pairs\",\n                \"From innermost to full almost-sure termination of probabilistic term rewriting\",\n                \"A dependency pair framework for relative termination of term rewriting\",\n                \"Tyrolean termination tool 2\",\n                \"A probabilistic PDL\",\n                \"On proving term rewriting systems are Noetherian\",\n                \"Automated expected amortised cost analysis of probabilistic data structures\",\n                \"Abstraction, Refinement and Proof for Probabilistic Systems\",\n                \"A New Proof Rule for Almost-Sure Termination\",\n                \"Inferring expected runtimes of probabilistic integer programs using expected sizes\",\n                \"Automated Termination Analysis of Polynomial Probabilistic Programs\",\n                \"Bounded expectations: Resource analysis for probabilistic programs\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]31 based on the context and research area of Annotated Dependency Pairs for Full Almost-Sure Termination of Probabilistic Term Rewritingfunded by the DFG Research Training Group 2236 UnRAVeL. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}