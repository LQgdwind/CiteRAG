{
  "messages": [
    {
      "role": "system",
      "content": "You are a professional academic citation prediction expert. Your task is to predict the most likely citations for [ref] markers in academic paper sections based on the paper content and retrieved relevant papers.\n\nRETRIEVER INTERFACE:\n- Input: paper title + abstract + section text with [ref] markers\n- Output: top {top_r} retrieved papers with title and abstract\n- Format: List of dictionaries with 'title' and 'abstract' fields\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nTASK DESCRIPTION:\n- Input: Paper section text with [ref] markers + retrieved relevant papers\n- Output: top 40 predicted reference titles for each [ref] marker with reasoning\n- Format: JSON object with \"citations\" array containing objects with \"ref_index\", \"titles\", and \"reasoning\" fields\n\nREQUIREMENTS:\n1. Analyze the context around each [ref] marker to understand what reference is needed\n2. Consider the retrieved papers as potential references (when available)\n3. Consider the surrounding text, research area, and topic\n4. Generate realistic and relevant reference titles that would fit the context\n5. Provide detailed reasoning for each prediction to prevent hallucination\n6. Output format: JSON object with \"citations\" array\n7. Generate exactly 40 most relevant reference titles for each [ref]\n8. Ensure titles are realistic and appropriate for the research area\n9. Include reasoning that explains why each title is relevant to the specific [ref] context\n10. Use proper JSON escaping for special characters (escape quotes with \\\")\n11. Ensure all strings are properly quoted and escaped\n\nEXAMPLE:\nInput:\n\"Federated Learning aims to train models in massively distributed networks [ref]38 at a large scale [ref]5, over multiple sources of heterogeneous data [ref]30.\"\n\nRetrieved papers (top {top_r}):\n1. Title: Communication-efficient learning of deep networks from decentralized data\n   Abstract: We report on a series of experiments with federated learning systems for decentralized data training.\n\n2. Title: Federated Learning: Challenges, Methods, and Future Directions\n   Abstract: A comprehensive survey of federated learning approaches and challenges in distributed settings.\n\nOutput:\n{\n  \"citations\": [\n    {\n      \"ref_index\": 38,\n      \"titles\": [\n        \"Communication-efficient learning of deep networks from decentralized data\",\n        \"Federated Learning: Challenges, Methods, and Future Directions\",\n        \"Federated optimization in heterogeneous networks\",\n        \"Towards federated learning at scale: System design\",\n        \"A performance evaluation of federated learning algorithms\",\n        \"Distributed machine learning: A survey\",\n        \"Communication protocols for distributed learning\",\n        \"Scalable federated learning systems\",\n        \"Efficient distributed training algorithms\",\n        \"Large-scale distributed learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]38 appears in the context of 'massively distributed networks' for federated learning, so it likely refers to foundational papers on federated learning systems, distributed training, and communication-efficient methods in distributed networks.\"\n    },\n    {\n      \"ref_index\": 5,\n      \"titles\": [\n        \"Bagging predictors\",\n        \"Ensemble methods in machine learning\",\n        \"Random forests for classification\",\n        \"Bootstrap methods and their application\",\n        \"Combining multiple classifiers\",\n        \"Large-scale machine learning systems\",\n        \"Distributed ensemble methods\",\n        \"Scalable classification algorithms\",\n        \"Massive data processing techniques\",\n        \"High-performance machine learning frameworks\"\n      ],\n      \"reasoning\": \"This [ref]5 appears in the context of 'at a large scale', suggesting it refers to papers on scaling machine learning methods, ensemble techniques, or methods that can handle large-scale data and distributed settings.\"\n    },\n    {\n      \"ref_index\": 30,\n      \"titles\": [\n        \"Learning fair representations\",\n        \"Fair machine learning: A survey\",\n        \"Bias in machine learning systems\",\n        \"Addressing fairness in AI systems\",\n        \"Fair representation learning\",\n        \"Heterogeneous data handling methods\",\n        \"Multi-source learning algorithms\",\n        \"Cross-domain representation learning\",\n        \"Fair learning from diverse data\",\n        \"Bias mitigation in heterogeneous datasets\"\n      ],\n      \"reasoning\": \"This [ref]30 appears in the context of 'heterogeneous data' and 'fair representation learning', indicating it likely refers to papers on heterogenous data handling, bias mitigation, and learning representations that are fair across different data distributions.\"\n    }\n  ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped.\n\nIMPORTANT NOTES ON REASONING:\n- The reasoning field is crucial for preventing hallucination\n- Each reasoning should be specific to the context around the [ref] marker\n- Explain the connection between the predicted titles and the research topic\n- This helps validate that predictions are grounded in the actual content\n- Reasoning should be concise but informative (2-3 sentences)\n- Consider retrieved papers when available to improve prediction accuracy"
    },
    {
      "role": "user",
      "content": "Paper Title: Multiscale Positive-Unlabeled Detection of AI-Generated Texts\n\nPaper Abstract: \n\nPaper Section Text:\nOverview of PU methods. Previous works have proposed methods to train a binary classifier with positive and unlabeled data. Many PU methods [2; 9; 20; 35; 14; 5] constructs PU loss based on positive and unlabeled samples, for classifying unlabeled data. Other PU methods include two-step learning and bias learning . The two-step technique first identifies reliable negative examples and then performs learning based on the positives and negatives of the mark [15; 17]; biased learning treats unlabeled data as a negative sample of class-labeled noise [16; 33]. Above all, we refer to applying a PU loss during training to address the task of multiscale AI-generated text detection, because PU losses could be generally applied on powerful finetuning text detectors without much additional computation costs. The unbiased PU Loss. In the standard supervised binary classification, i.e. Positive-Negative (PN) classification, some positive samples and negative samples are given for model training, and then the trained model is used to predict the test set data. The PN loss function of the standard supervised binary classification model can be estimated from a minibatch of training data. Given positively labeled samples {xiP}i=1nPsuperscriptsubscriptsuperscriptsubscript𝑥𝑖𝑃𝑖1subscript𝑛𝑃\\{x_{i}^{P}\\}_{i=1}^{n_{P}} and negatively labeled samples {xiN}i=1nNsuperscriptsubscriptsuperscriptsubscript𝑥𝑖𝑁𝑖1subscript𝑛𝑁\\{x_{i}^{N}\\}_{i=1}^{n_{N}} in one batch, where nPsubscript𝑛𝑃n_{P}, nNsubscript𝑛𝑁n_{N} are the total number of positive and negative samples in the batch respectively, we define g:ℝd→ℝ:𝑔→superscriptℝ𝑑ℝg:\\mathbb{R}^{d}\\rightarrow\\mathbb{R} as a classification function (in our case, g𝑔g is the detector model); L:ℝ×{+1,−1}→ℝ+:𝐿→ℝ11subscriptℝL:\\mathbb{R}\\times\\{+1,-1\\}\\rightarrow\\mathbb{R}_{+} as a pre-defined loss function; R^P​(g,+1):=1nP​∑i=1nPL​(g​(xiP),+1)assignsubscript^𝑅𝑃𝑔11subscript𝑛𝑃superscriptsubscript𝑖1subscript𝑛𝑃𝐿𝑔superscriptsubscript𝑥𝑖𝑃1\\hat{R}_{P}(g,+1):=\\frac{1}{n_{P}}\\sum_{i=1}^{n_{P}}L(g(x_{i}^{P}),+1) and R^N​(g,−1):=1nN​∑i=1nNL​(g​(xiN),−1)assignsubscript^𝑅𝑁𝑔11subscript𝑛𝑁superscriptsubscript𝑖1subscript𝑛𝑁𝐿𝑔superscriptsubscript𝑥𝑖𝑁1\\hat{R}_{N}(g,-1):=\\frac{1}{n_{N}}\\sum_{i=1}^{n_{N}}L(g(x_{i}^{N}),-1) as loss expectations of positive and negative loss; π:=nPnP+nNassign𝜋subscript𝑛𝑃subscript𝑛𝑃subscript𝑛𝑁\\pi:=\\frac{n_{P}}{n_{P}+n_{N}} as the proportion of positive data in all data. Then the ordinary binary classification PN loss is organized as follows: However, in the PU problem, only partial positive sample data and unlabeled data are available. Since the negative part of loss (1−π)​R^N​(g,−1)1𝜋subscript^𝑅𝑁𝑔1(1-\\pi)\\hat{R}_{N}(g,-1) is missing, the unbiased PN loss function cannot be used directly. Hence, an estimation for the negative loss part is calculated via positive and unlabeled samples. The estimation is shown as follows : where R^U​(g,−1):=1nU​∑i=1nUl​(g​(xiU),−1)assignsubscript^𝑅𝑈𝑔11subscript𝑛𝑈superscriptsubscript𝑖1subscript𝑛𝑈𝑙𝑔superscriptsubscript𝑥𝑖𝑈1\\hat{R}_{U}(g,-1):=\\frac{1}{n_{U}}\\sum_{i=1}^{n_{U}}l(g(x_{i}^{U}),-1) is the expectation of unlabeled loss; nUsubscript𝑛𝑈n_{U} is the total number of unlabeled samples; {xiU}i=1nUsuperscriptsubscriptsuperscriptsubscript𝑥𝑖𝑈𝑖1subscript𝑛𝑈\\{x_{i}^{U}\\}_{i=1}^{n_{U}} are the unlabeled samples. Notably, since we cannot percisely know the proportion of positive data π𝜋\\pi, a prior probability of a sample being positive π~~𝜋\\tilde{\\pi} needs to be offered. To wrap up, given prior positive probability π~~𝜋\\tilde{\\pi}, the canonical unbiased PU loss  is obtained as follows: The non-negative PU loss. Despite the unbiasedness of the unbiased PU (uPU) loss,  Kiryo et al. [ref]20 indicates that uPU loss could cause overfitting problems, limitting the flexibility of models to be trained. As a remedy,  Kiryo et al. [ref]20 proposes the non-negative risk estimator for the uPU loss, which is then formulated as the non-negative PU (nnPU) loss. The nnPU loss is obtained as follows: The nnPU loss is performant and thus widely referred by later PU works and applications [19; 3; 31; 40; 5; 35; 37]. However, to the best of our knowledge, no previous works have applied PU to scenario of length-variant texts, in which simple usage of nnPU might not be effective. We hope to develop an effective PU mechanism in aid of detecting length-variant texts.\n\nReference markers found: [20]\n\nContext windows for each [ref]:\n[ref]20: prior positive probability π~~𝜋\\tilde{\\pi}, the canonical unbiased PU loss  is obtained as follows: The non-negative PU loss. Despite the unbiasedness of the unbiased PU (uPU) loss,  Kiryo et al. [ref]20 indicates that uPU loss could cause overfitting problems, limitting the flexibility of models to be trained. As a remedy,  Kiryo et al. [ref]20 proposes the non-negative risk estimator for\n\n{retrieved_text}\n\nGenerate exactly 40 most likely reference titles for each [ref] marker. Focus on papers that are directly related to the research topic, provide foundational background, present similar methodologies, or address related problems.\n\nCRITICAL REQUIREMENTS:\n1. For each [ref] marker, provide detailed reasoning explaining why the predicted titles are relevant\n2. The reasoning should analyze the specific context around each [ref] marker\n3. Explain how each title connects to the research topic, methodology, or problem being discussed\n4. This reasoning helps prevent hallucination by grounding predictions in the actual context\n5. Consider retrieved papers when available to improve prediction accuracy\n\nCRITICAL FORMAT REQUIREMENT: You must respond with ONLY valid JSON. Do not include any explanatory text, markdown formatting, or other content outside the JSON structure.\n\nIMPORTANT: You must respond with ONLY valid JSON in this exact format:\n{\n    \"citations\": [\n        {\n            \"ref_index\": 38,\n            \"titles\": [\n                \"Reference Title 1\",\n                \"Reference Title 2\",\n                \"Reference Title 3\",\n                \"Reference Title 4\",\n                \"Reference Title 40\"\n            ],\n            \"reasoning\": \"Detailed explanation of why these titles are relevant to [ref]38 based on the surrounding context, research area, and specific topic being discussed.\"\n        }\n    ]\n}\n\nCRITICAL: Return ONLY the JSON object. Do not include any text before or after the JSON. Do not use markdown formatting. Ensure all quotes and special characters are properly escaped. Do not include authors, venues, or years - only the paper titles. Generate exactly 40 titles for each [ref] marker with reasoning."
    },
    {
      "role": "assistant",
      "content": "{\n    \"citations\": [\n        {\n            \"ref_index\": 20,\n            \"titles\": [\n                \"Stylometric Detection of AI-Generated Text in Twitter Timelines\",\n                \"Generating sentiment-preserving fake online reviews using neural language models and their human- and machine-based detection\",\n                \"Learning From Positive and Unlabeled Data: A Survey\",\n                \"Positive-unlabeled convolutional neural networks for particle picking in cryo-electron micrographs\",\n                \"Language Models are Few-Shot Learners\",\n                \"Self-PU: Self Boosted and Calibrated Positive-Unlabeled Training\",\n                \"Adversarial Robustness of Neural-Statistical Features in Detection of Generative Transformers\",\n                \"Revisiting Pre-trained Models for Chinese Natural Language Processing\",\n                \"BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding\",\n                \"Analysis of learning from positive and unlabeled data\",\n                \"Tweepfake: about detecting deepfake tweets\",\n                \"Sniffer\",\n                \"GLTR: statistical detection and visualization of generated text\",\n                \"How Close is ChatGPT to Human Experts? Comparison Corpus, Evaluation, and Detection\",\n                \"Learning from positive and unlabeled data with arbitrary positive shift\",\n                \"Instance-Dependent PU Learning by Bayesian Optimal Relabeling\",\n                \"PU Learning for Matrix Completion\",\n                \"Positive and unlabeled learning in categorical data\",\n                \"Opinion mining using ensemble text hidden markov models for text classification\",\n                \"Learning from positive and unlabeled data with a selection bias\",\n                \"Positive-Unlabeled Learning with Non-Negative Risk Estimator\",\n                \"Building text classifiers using positive and unlabeled examples\",\n                \"Coco: Coherence-enhanced machine-generated text detection under data limitation with contrastive learning\",\n                \"RoBERTa: A Robustly Optimized BERT Pretraining Approach\",\n                \"Recurrent neural network based language model\",\n                \"DetectGPT: Zero-Shot Machine-Generated Text Detection using Probability Curvature\",\n                \"ChatGPT or Human? Detect and Explain. Explaining Decisions of Machine Learning Model for Detecting Short ChatGPT-generated Text\",\n                \"Introducing chatgpt\",\n                \"GPT-4 Technical Report\",\n                \"Ai text classifier - openai api\",\n                \"Distantly Supervised Named Entity Recognition using Positive-Unlabeled Learning\",\n                \"Language models are unsupervised multitask learners\",\n                \"Laplacian unit-hyperplane learning from positive and unlabeled examples\",\n                \"Release strategies and the social impacts of language models\",\n                \"Positive-unlabeled learning from imbalanced data\",\n                \"LSTM neural networks for language modeling\",\n                \"Positive-Unlabeled Learning with Adversarial Data Augmentation for Knowledge Graph Completion\",\n                \"Gptzero\",\n                \"EDA: Easy Data Augmentation Techniques for Boosting Performance on Text Classification Tasks\",\n                \"Positive-Unlabeled Compression on the Cloud\"\n            ],\n            \"reasoning\": \"Selected these 40 citations for [ref]20 based on the context and research area of Multiscale Positive-Unlabeled Detection of AI-Generated Texts. The first title is the actual reference for this marker, followed by other relevant papers from the same research domain.\"\n        }\n    ]\n}"
    }
  ],
  "format": "chatml"
}