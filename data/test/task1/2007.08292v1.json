{
  "paper_id": "2007.08292v1",
  "title": "Detecting Optimization Bugs in Database Engines via Non-Optimizing Reference Engine Construction",
  "abstract": "Abstract.\nDatabase Management Systems (DBMS) are used ubiquitously.\nTo efficiently access data, they apply sophisticated optimizations.\nIncorrect optimizations can result in logic bugs, which cause a query to compute an incorrect result set.\nWe propose Non-Optimizing Reference Engine Construction (NoREC), a fully-automatic approach to detect optimization bugs in DBMS.\nConceptually, this approach aims to evaluate a query by an optimizing and a non-optimizing version of a DBMS, to then detect differences in their returned result set, which would indicate a bug in the DBMS.\nObtaining a non-optimizing version of a DBMS is challenging, because DBMS typically provide limited control over optimizations.\nOur core insight is that a given, potentially randomly-generated optimized query can be rewritten to one that the DBMS cannot optimize.\nEvaluating this unoptimized query effectively corresponds to a non-optimizing reference engine executing the original query.\nWe evaluated NoREC in an extensive testing campaign on four widely-used DBMS, namely PostgreSQL, MariaDB, SQLite, and CockroachDB.\nWe found \\nrTruePositives previously unknown bugs in the latest versions of these systems, \\fixed of which have been fixed by the developers.\nOf these, \\sumnorec were optimization bugs, while the remaining were error and crash bugs.\nOur results suggest that NoREC is effective, general and requires little implementation effort, which makes the technique widely applicable in practice.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Automated SQL Query Generation for Systematic Testing of Database Engines",
      "abstract": "",
      "year": "2010",
      "venue": "IEEE/ACM International Conference on Automated Software Engineering",
      "authors": "Shadi Abdul Khalek and Sarfraz Khurshid"
    },
    {
      "index": 1,
      "title": "A Genetic Approach for Random Testing of Database Systems",
      "abstract": "",
      "year": "2007",
      "venue": "International Conference on Very Large Data Bases",
      "authors": "Hardik Bati, Leo Giakoumakis, Steve Herbert, and Aleksandras Surna"
    },
    {
      "index": 2,
      "title": "Reverse Query Processing",
      "abstract": "",
      "year": "2007",
      "venue": "International Conference on Data Engineering",
      "authors": "Carsten Binnig, Donald Kossmann, and Eric Lo"
    },
    {
      "index": 3,
      "title": "QAGen: Generating Query-Aware Test Databases",
      "abstract": "",
      "year": "2007",
      "venue": "ACM SIGMOD International Conference on Management of Data",
      "authors": "Carsten Binnig, Donald Kossmann, Eric Lo, and M. Tamer Özsu"
    },
    {
      "index": 4,
      "title": "Making an Embedded DBMS JIT-friendly",
      "abstract": "",
      "year": "2016",
      "venue": "European Conference on Object-Oriented Programming, ECOOP 2016",
      "authors": "Carl Friedrich Bolz, Darya Kurilova, and Laurence Tratt",
      "orig_title": "Making an Embedded DBMS JIT-friendly",
      "paper_id": "1512.03207v4"
    },
    {
      "index": 5,
      "title": "Fuzzing and Delta-Debugging SMT Solvers",
      "abstract": "",
      "year": "2009",
      "venue": "International Workshop on Satisfiability Modulo Theories",
      "authors": "Robert Brummayer and Armin Biere"
    },
    {
      "index": 6,
      "title": "Flexible Database Generators",
      "abstract": "",
      "year": "2005",
      "venue": "International Conference on Very Large Data Bases",
      "authors": "Nicolas Bruno and Surajit Chaudhuri"
    },
    {
      "index": 7,
      "title": "Power Hints for Query Optimization",
      "abstract": "",
      "year": "2009",
      "venue": "IEEE International Conference on Data Engineering",
      "authors": "Nicolas Bruno, Surajit Chaudhuri, and Ravi Ramamurthy"
    },
    {
      "index": 8,
      "title": "Generating Queries with Cardinality Constraints for DBMS Testing",
      "abstract": "",
      "year": "2006",
      "venue": "IEEE Transactions on Knowledge and Data Engineering",
      "authors": "Nicolas Bruno, Surajit Chaudhuri, and Dilys Thomas"
    },
    {
      "index": 9,
      "title": "SEQUEL: A Structured English Query Language",
      "abstract": "",
      "year": "1974",
      "venue": "ACM SIGFIDET (Now SIGMOD) Workshop on Data Description, Access and Control",
      "authors": "Donald D. Chamberlin and Raymond F. Boyce"
    },
    {
      "index": 10,
      "title": "Metamorphic testing: a new approach for generating next test cases",
      "abstract": "",
      "year": "1998",
      "venue": "Technical Report HKUST-CS98-01, Department of Computer Science, Hong Kong",
      "authors": "Tsong Y Chen, Shing C Cheung, and Shiu Ming Yiu"
    },
    {
      "index": 11,
      "title": "Metamorphic Testing: A Review of Challenges and Opportunities",
      "abstract": "",
      "year": "2018",
      "venue": "ACM Computing Surveys",
      "authors": "Tsong Yueh Chen, Fei-Ching Kuo, Huai Liu, Pak-Lok Poon, Dave Towey, T. H. Tse, and Zhi Quan Zhou"
    },
    {
      "index": 12,
      "title": "Bug submission: left join filter on negated expression including NOTNULL",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "And Clover"
    },
    {
      "index": 13,
      "title": "A Relational Model of Data for Large Shared Data Banks",
      "abstract": "",
      "year": "1970",
      "venue": "Communications of the ACM",
      "authors": "E. F. Codd"
    },
    {
      "index": 14,
      "title": "Relational Completeness of Data Base Sublanguages",
      "abstract": "",
      "year": "1972",
      "venue": "IBM Corporation",
      "authors": "E. F. Codd"
    },
    {
      "index": 15,
      "title": "Testing Static Analyzers with Randomly Generated Programs",
      "abstract": "",
      "year": "2012",
      "venue": "International Conference on NASA Formal Methods",
      "authors": "Pascal Cuoq, Benjamin Monate, Anne Pacalet, Virgile Prevosto, John Regehr, Boris Yakobowski, and Xuejun Yang"
    },
    {
      "index": 16,
      "title": "DB-Engines Ranking (July 2019)",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "DB-Engines"
    },
    {
      "index": 17,
      "title": "Plan Stitch: Harnessing the Best of Many Plans",
      "abstract": "",
      "year": "2018",
      "venue": "Proceedings of the VLDB Endowment",
      "authors": "Bailu Ding, Sudipto Das, Wentao Wu, Surajit Chaudhuri, and Vivek Narasayya"
    },
    {
      "index": 18,
      "title": "Fundamentals of database systems. Vol. 7",
      "abstract": "",
      "year": "2017",
      "venue": "Pearson",
      "authors": "Ramez Elmasri and Sham Navathe"
    },
    {
      "index": 19,
      "title": "Testing SQL Server’s Query Optimizer: Challenges, Techniques and Experiences",
      "abstract": "",
      "year": "2008",
      "venue": "IEEE Data Engineering Bulletin",
      "authors": "Leo Giakoumakis and César A Galindo-Legaria"
    },
    {
      "index": 20,
      "title": "Testing Challenges for Extending SQL Server’s Query Processor: A Case Study",
      "abstract": "",
      "year": "2008",
      "venue": "International Workshop on Testing Database Systems",
      "authors": "Torsten Grabs, Steve Herbert, and Xin (Shin) Zhang"
    },
    {
      "index": 21,
      "title": "Query evaluation techniques for large databases",
      "abstract": "",
      "year": "1993",
      "venue": "ACM Computing Surveys",
      "authors": "Goetz Graefe"
    },
    {
      "index": 22,
      "title": "Quickly Generating Billion-Record Synthetic Databases",
      "abstract": "",
      "year": "1994",
      "venue": "SIGMOD Record",
      "authors": "Jim Gray, Prakash Sundaresan, Susanne Englert, Ken Baclawski, and Peter J. Weinberger"
    },
    {
      "index": 23,
      "title": "Testing the Accuracy of Query Optimizers",
      "abstract": "",
      "year": "2012",
      "venue": "International Workshop on Testing Database Systems",
      "authors": "Zhongxian Gu, Mohamed A. Soliman, and Florian M. Waas"
    },
    {
      "index": 24,
      "title": "R-Trees: A Dynamic Index Structure for Spatial Searching",
      "abstract": "",
      "year": "1984",
      "venue": "ACM SIGMOD International Conference on Management of Data",
      "authors": "Antonin Guttman"
    },
    {
      "index": 25,
      "title": "Simple and Realistic Data Generation",
      "abstract": "",
      "year": "2006",
      "venue": "International Conference on Very Large Data Bases",
      "authors": "Kenneth Houkjær, Kristian Torp, and Rico Wind"
    },
    {
      "index": 26,
      "title": "Theoretical and Empirical Studies of Program Testing",
      "abstract": "",
      "year": "1978",
      "venue": "International Conference on Software Engineering",
      "authors": "William E. Howden"
    },
    {
      "index": 27,
      "title": "Testing Random, Valid SQL in CockroachDB",
      "abstract": "",
      "year": "2016",
      "venue": "",
      "authors": "Matt Jibson"
    },
    {
      "index": 28,
      "title": "SQLsmith: Randomized SQL Testing in CockroachDB",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Matt Jibson"
    },
    {
      "index": 29,
      "title": "APOLLO: Automatic Detection and Diagnosis of Performance Regressions in Database Systems",
      "abstract": "",
      "year": "2019",
      "venue": "Proceedings of the VLDB Endowment",
      "authors": "Jinho Jung, Hong Hu, Joy Arulraj, Taesoo Kim, and Woonhak Kang"
    },
    {
      "index": 30,
      "title": "Automatic Testing of Symbolic Execution Engines via Program Generation and Differential Testing",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE/ACM International Conference on Automated Software Engineering",
      "authors": "Timotej Kapus and Cristian Cadar"
    },
    {
      "index": 31,
      "title": "Query-Aware Test Generation Using a Relational Constraint Solver",
      "abstract": "",
      "year": "2008",
      "venue": "IEEE/ACM International Conference on Automated Software Engineering",
      "authors": "S. A. Khalek, B. Elkarablieh, Y. O. Laleye, and S. Khurshid"
    },
    {
      "index": 32,
      "title": "Compiler Validation via Equivalence Modulo Inputs",
      "abstract": "",
      "year": "2014",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "Vu Le, Mehrdad Afshari, and Zhendong Su"
    },
    {
      "index": 33,
      "title": "A framework for testing DBMS features",
      "abstract": "",
      "year": "2010",
      "venue": "VLDB Journal",
      "authors": "Eric Lo, Carsten Binnig, Donald Kossmann, M. Tamer Özsu, and Wing-Kai Hon"
    },
    {
      "index": 34,
      "title": "Neo: A Learned Query Optimizer",
      "abstract": "",
      "year": "2019",
      "venue": "Proceedings of the VLDB Endowment",
      "authors": "Ryan Marcus, Parimarjan Negi, Hongzi Mao, Chi Zhang, Mohammad Alizadeh, Tim Kraska, Olga Papaemmanouil, and Nesime Tatbul",
      "orig_title": "Neo: A Learned Query Optimizer",
      "paper_id": "1904.03711v1"
    },
    {
      "index": 35,
      "title": "Differential testing for software",
      "abstract": "",
      "year": "1998",
      "venue": "Digital Technical Journal",
      "authors": "William M McKeeman"
    },
    {
      "index": 36,
      "title": "Generating Targeted Queries for Database Testing",
      "abstract": "",
      "year": "2008",
      "venue": "ACM SIGMOD International Conference on Management of Data",
      "authors": "Chaitanya Mishra, Nick Koudas, and Calisto Zuzarte"
    },
    {
      "index": 37,
      "title": "Generating Consistent Test Data: Restricting the Search Space by a Generator Formula",
      "abstract": "",
      "year": "1993",
      "venue": "VLDB Journal",
      "authors": "Andrea Neufeld, Guido Moerkotte, and Peter C. Lockemann"
    },
    {
      "index": 38,
      "title": "Adaptive Optimization of Very Large Join Queries",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Management of Data",
      "authors": "Thomas Neumann and Bernhard Radke"
    },
    {
      "index": 39,
      "title": "Developer Survey Results 2019",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Stack Overflow"
    },
    {
      "index": 40,
      "title": "What’s Really New with NewSQL?",
      "abstract": "",
      "year": "2016",
      "venue": "SIGMOD Record",
      "authors": "Andrew Pavlo and Matthew Aslett"
    },
    {
      "index": 41,
      "title": "Generating Thousand Benchmark Queries in Seconds",
      "abstract": "",
      "year": "2004",
      "venue": "International Conference on Very Large Data Bases",
      "authors": "Meikel Poess and John M. Stephens"
    },
    {
      "index": 42,
      "title": "Test-Case Reduction for C Compiler Bugs",
      "abstract": "",
      "year": "2012",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "John Regehr, Yang Chen, Pascal Cuoq, Eric Eide, Chucky Ellison, and Xuejun Yang"
    },
    {
      "index": 43,
      "title": "LEFT JOIN in view malfunctions with NOTNULL",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Manuel Rigger"
    },
    {
      "index": 44,
      "title": "ESEC/FSE 20 Artifact for ”Detecting Optimization Bugs in Database Engines via Non-Optimizing Reference Engine Construction”",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Manuel Rigger and Zhendong Su"
    },
    {
      "index": 45,
      "title": "Testing Database Engines via Pivoted Query Synthesis",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Manuel Rigger and Zhendong Su"
    },
    {
      "index": 46,
      "title": "Metamorphic Testing 20 Years Later: A Hands-on Introduction",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Software Engineering: Companion Proceeedings",
      "authors": "Sergio Segura and Zhi Quan Zhou"
    },
    {
      "index": 47,
      "title": "Access Path Selection in a Relational Database Management System",
      "abstract": "",
      "year": "1979",
      "venue": "ACM SIGMOD International Conference on Management of Data",
      "authors": "P. Griffiths Selinger, M. M. Astrahan, D. D. Chamberlin, R. A. Lorie, and T. G. Price"
    },
    {
      "index": 48,
      "title": "SQLSmith",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Andreas Seltenreich"
    },
    {
      "index": 49,
      "title": "Massive stochastic testing of SQL",
      "abstract": "",
      "year": "1998",
      "venue": "VLDB",
      "authors": "Donald R Slutz"
    },
    {
      "index": 50,
      "title": "Generated Columns",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "SQLite3"
    },
    {
      "index": 51,
      "title": "How SQLite Is Tested",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "SQLite3"
    },
    {
      "index": 52,
      "title": "Most Widely Deployed and Used Database Engine",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "SQLite3"
    },
    {
      "index": 53,
      "title": "The SQLite Query Optimizer Overview",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "SQLite3"
    },
    {
      "index": 54,
      "title": "The Use Of assert() In SQLite",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "SQLite3"
    },
    {
      "index": 55,
      "title": "CockroachDB: The Resilient Geo-Distributed SQL Database",
      "abstract": "",
      "year": "2020",
      "venue": "ACM SIGMOD International Conference on Management of Data",
      "authors": "Rebecca Taft, Irfan Sharif, Andrei Matei, Nathan VanBenschoten, Jordan Lewis, Tobias Grieger, Kai Niemi, Andy Woods, Anne Birzin, Raphael Poss, Paul Bardea, Amruta Ranade, Ben Darnell, Bram Gruneir, Justin Jaffray, Lucy Zhang, and Peter Mattis"
    },
    {
      "index": 56,
      "title": "Magellan 2.0",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Tencent Blade Team"
    },
    {
      "index": 57,
      "title": "QRelX: Generating Meaningful Queries That Provide Cardinality Assurance",
      "abstract": "",
      "year": "2010",
      "venue": "ACM SIGMOD International Conference on Management of Data",
      "authors": "Manasi Vartak, Venkatesh Raghavan, and Elke A. Rundensteiner"
    },
    {
      "index": 58,
      "title": "Richard Hipp Speaks Out on SQLite",
      "abstract": "",
      "year": "2019",
      "venue": "SIGMOD Record",
      "authors": "Marianne Winslett and Vanessa Braganholo"
    },
    {
      "index": 59,
      "title": "Towards a Learning Optimizer for Shared Clouds",
      "abstract": "",
      "year": "2018",
      "venue": "Proceedings of the VLDB Endowment",
      "authors": "Chenggang Wu, Alekh Jindal, Saeed Amizadeh, Hiren Patel, Wangchao Le, Shi Qiao, and Sriram Rao"
    },
    {
      "index": 60,
      "title": "Finding and Understanding Bugs in C Compilers",
      "abstract": "",
      "year": "2011",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "Xuejun Yang, Yang Chen, Eric Eide, and John Regehr"
    },
    {
      "index": 61,
      "title": "인공지능 기반 공격 그래프 생성",
      "abstract": "",
      "year": "2011",
      "venue": "https://doi.org/10",
      "authors": "Xuejun Yang, Yang Chen,\nEric Eide, and John Regehr.\n2011.",
      "orig_title": "",
      "paper_id": "2311.14342v2"
    }
  ]
}