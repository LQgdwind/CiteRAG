{
  "paper_id": "2206.06072v1",
  "title": "Rank Diminishing in Deep Neural Networks",
  "abstract": "Abstract\nThe rank of neural networks measures information flowing across layers. It is an instance of a key structural condition that applies across broad domains of machine learning. In particular, the assumption of low-rank feature representations leads to algorithmic developments in many architectures. For neural networks, however, the intrinsic mechanism that yields low-rank structures remains vague and unclear. To fill this gap, we perform a rigorous study on the behavior of network rank, focusing particularly on the notion of rank deficiency. We theoretically establish a universal monotonic decreasing property of network rank from the basic rules of differential and algebraic composition, and uncover rank deficiency of network blocks and deep function coupling. By virtue of our numerical tools, we provide the first empirical analysis of the per-layer behavior of network rank in practical settings, i.e., ResNets, deep MLPs, and Transformers on ImageNet. These empirical results are in direct accord with our theory. Furthermore, we reveal a novel phenomenon of independence deficit caused by the rank deficiency of deep networks, where classification confidence of a given category can be linearly decided by the confidence of a handful of other categories. The theoretical results of this work, together with the empirical findings, may advance understanding of the inherent principles of deep neural networks.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Implicit Regularization in Deep Matrix Factorization",
      "abstract": "",
      "year": "2019",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "S. Arora, N. Cohen, W. Hu, and Y. Luo",
      "orig_title": "Implicit regularization in deep matrix factorization",
      "paper_id": "1905.13655v3"
    },
    {
      "index": 1,
      "title": "Layer normalization",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1607.06450",
      "authors": "J. L. Ba, J. R. Kiros, and G. E. Hinton"
    },
    {
      "index": 2,
      "title": "Learning long-term dependencies with gradient descent is difficult",
      "abstract": "",
      "year": "1994",
      "venue": "IEEE Trans. Neural Netw.",
      "authors": "Y. Bengio, P. Simard, and P. Frasconi"
    },
    {
      "index": 3,
      "title": "Understanding Batch Normalization",
      "abstract": "",
      "year": "2018",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "N. Bjorck, C. P. Gomes, B. Selman, and K. Q. Weinberger",
      "orig_title": "Understanding batch normalization",
      "paper_id": "1806.02375v4"
    },
    {
      "index": 4,
      "title": "Is pruning compression?: Investigating pruning via network layer similarity",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Winter Conf. Appl. Comput. Vis.",
      "authors": "C. Blakeney, Y. Yan, and Z. Zong"
    },
    {
      "index": 5,
      "title": "On the equivalent of low-rank linear regressions and linear discriminant analysis based regressions",
      "abstract": "",
      "year": "2013",
      "venue": "ACM SIGKDD Int. Conf. Knowl. Discov. Data Min.",
      "authors": "X. Cai, C. Ding, F. Nie, and H. Huang"
    },
    {
      "index": 6,
      "title": "Scatterbrain: Unifying sparse and low-rank attention",
      "abstract": "",
      "year": "2021",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "B. Chen, T. Dao, E. Winsor, Z. Song, A. Rudra, and C. Ré"
    },
    {
      "index": 7,
      "title": "GroupReduce: Block-Wise Low-Rank Approximation for Neural Language Model Shrinking",
      "abstract": "",
      "year": "2018",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "P. Chen, S. Si, Y. Li, C. Chelba, and C.-J. Hsieh",
      "orig_title": "Groupreduce: Block-wise low-rank approximation for neural language model shrinking",
      "paper_id": "1806.06950v1"
    },
    {
      "index": 8,
      "title": "Drone: Data-aware low-rank compression for large NLP models",
      "abstract": "",
      "year": "2021",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "P. Chen, H.-F. Yu, I. Dhillon, and C.-J. Hsieh"
    },
    {
      "index": 9,
      "title": "Lorslim: Low rank sparse linear methods for top-n recommendations",
      "abstract": "",
      "year": "2014",
      "venue": "IEEE Int. Conf. on Data Min.",
      "authors": "Y. Cheng, L. Yin, and Y. Yu"
    },
    {
      "index": 10,
      "title": "Low-Rank Constraints for Fast Inference in Structured Models",
      "abstract": "",
      "year": "2021",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "J. Chiu, Y. Deng, and A. Rush",
      "orig_title": "Low-rank constraints for fast inference in structured models",
      "paper_id": "2201.02715v1"
    },
    {
      "index": 11,
      "title": "Batch normalization provably avoids ranks collapse for randomly initialised deep networks",
      "abstract": "",
      "year": "2020",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "H. Daneshmand, J. Kohler, F. Bach, T. Hofmann, and A. Lucchi"
    },
    {
      "index": 12,
      "title": "ImageNet: A large-scale hierarchical image database",
      "abstract": "",
      "year": "2009",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei"
    },
    {
      "index": 13,
      "title": "Attention is not all you need: pure attention loses rank doubly exponentially with depth",
      "abstract": "",
      "year": "2021",
      "venue": "Int. Conf. Mach. Learn.",
      "authors": "Y. Dong, J.-B. Cordonnier, and A. Loukas",
      "orig_title": "Attention is not all you need: Pure attention loses rank doubly exponentially with depth",
      "paper_id": "2103.03404v2"
    },
    {
      "index": 14,
      "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale",
      "abstract": "",
      "year": "2020",
      "venue": "Int. Conf. Learn. Represent.",
      "authors": "A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, et al.",
      "orig_title": "An image is worth 16x16 words: Transformers for image recognition at scale",
      "paper_id": "2010.11929v2"
    },
    {
      "index": 15,
      "title": "Products of random matrices",
      "abstract": "",
      "year": "1960",
      "venue": "Ann. Math. Stat.",
      "authors": "H. Furstenberg and H. Kesten"
    },
    {
      "index": 16,
      "title": "Random matrix products and measures on projective spaces",
      "abstract": "",
      "year": "1983",
      "venue": "Israel J. Math.",
      "authors": "H. Furstenberg and H. Kesten"
    },
    {
      "index": 17,
      "title": "Robust low-rank tensor recovery: Models and algorithms",
      "abstract": "",
      "year": "2014",
      "venue": "SIAM J. Matrix Anal. Appl.",
      "authors": "D. Goldfarb and Z. Qin"
    },
    {
      "index": 18,
      "title": "Deep Residual Learning for Image Recognition",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "K. He, X. Zhang, S. Ren, and J. Sun",
      "orig_title": "Deep residual learning for image recognition",
      "paper_id": "1512.03385v1"
    },
    {
      "index": 19,
      "title": "Gaussian Error Linear Units (GELUs)",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1606.08415",
      "authors": "D. Hendrycks and K. Gimpel",
      "orig_title": "Gaussian error linear units (GELUs)",
      "paper_id": "1606.08415v5"
    },
    {
      "index": 20,
      "title": "Differential topology, volume 33",
      "abstract": "",
      "year": "2012",
      "venue": "Springer Science & Business Media",
      "authors": "M. W. Hirsch"
    },
    {
      "index": 21,
      "title": "Linear algebra",
      "abstract": "",
      "year": "1971",
      "venue": "Englewood Cliffs, NJ, Prentice-Hall",
      "authors": "K. Hoffman"
    },
    {
      "index": 22,
      "title": "Relations between two sets of variates",
      "abstract": "",
      "year": "1936",
      "venue": "Biometrika",
      "authors": "H. Hotelling"
    },
    {
      "index": 23,
      "title": "Low rank modeling of signed networks",
      "abstract": "",
      "year": "2012",
      "venue": "ACM SIGKDD Int. Conf. Knowl. Discov. Data Min.",
      "authors": "C.-J. Hsieh, K.-Y. Chiang, and I. S. Dhillon"
    },
    {
      "index": 24,
      "title": "Language model compression with weighted low-rank factorization",
      "abstract": "",
      "year": "2021",
      "venue": "Int. Conf. Learn. Represent.",
      "authors": "Y.-C. Hsu, T. Hua, S. Chang, Q. Lou, Y. Shen, and H. Jin"
    },
    {
      "index": 25,
      "title": "Batch normalization: Accelerating deep network training by reducing internal covariate shift",
      "abstract": "",
      "year": "2015",
      "venue": "Int. Conf. Mach. Learn.",
      "authors": "S. Ioffe and C. Szegedy"
    },
    {
      "index": 26,
      "title": "Semi-supervised low-rank mapping learning for multi-label classification",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "L. Jing, L. Yang, J. Yu, and M. K. Ng"
    },
    {
      "index": 27,
      "title": "Compacter: Efficient Low-Rank Hypercomplex Adapter Layers",
      "abstract": "",
      "year": "2021",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "R. Karimi Mahabadi, J. Henderson, and S. Ruder",
      "orig_title": "Compacter: Efficient low-rank hypercomplex adapter layers",
      "paper_id": "2106.04647v2"
    },
    {
      "index": 28,
      "title": "Deep low-rank subspace clustering",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog. Worksh.",
      "authors": "M. Kheirandishfard, F. Zohrizadeh, and F. Kamangar"
    },
    {
      "index": 29,
      "title": "Subadditive ergodic theory",
      "abstract": "",
      "year": "1973",
      "venue": "Ann. Probab.",
      "authors": "J. F. C. Kingman"
    },
    {
      "index": 30,
      "title": "Low-rank Bilinear Pooling for Fine-Grained Classification",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "S. Kong and C. Fowlkes",
      "orig_title": "Low-rank bilinear pooling for fine-grained classification",
      "paper_id": "1611.05109v2"
    },
    {
      "index": 31,
      "title": "HRank: Filter Pruning using High-Rank Feature Map",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "M. Lin, R. Ji, Y. Wang, Y. Zhang, B. Zhang, Y. Tian, and L. Shao",
      "orig_title": "Hrank: Filter pruning using high-rank feature map",
      "paper_id": "2002.10179v2"
    },
    {
      "index": 32,
      "title": "Swin transformer: Hierarchical vision transformer using shifted windows",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "Z. Liu, Y. Lin, Y. Cao, H. Hu, Y. Wei, Z. Zhang, S. Lin, and B. Guo"
    },
    {
      "index": 33,
      "title": "Distribution of eigenvalues for some sets of random matrices",
      "abstract": "",
      "year": "1967",
      "venue": "Math. USSR Sb.",
      "authors": "V. A. Marčenko and L. A. Pastur"
    },
    {
      "index": 34,
      "title": "Implicit Self-Regularization in Deep Neural Networks: Evidence from Random Matrix Theory and Implications for Learning",
      "abstract": "",
      "year": "2021",
      "venue": "J. Mach. Learn. Res.",
      "authors": "C. H. Martin and M. W. Mahoney",
      "orig_title": "Implicit self-regularization in deep neural networks: Evidence from random matrix theory and implications for learning",
      "paper_id": "1810.01075v1"
    },
    {
      "index": 35,
      "title": "Graph-based non-convex low-rank regularization for image compression artifact reduction",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Trans. Image Process.",
      "authors": "J. Mu, R. Xiong, X. Fan, D. Liu, F. Wu, and W. Gao"
    },
    {
      "index": 36,
      "title": "Rectified linear units improve restricted Boltzmann machines",
      "abstract": "",
      "year": "2010",
      "venue": "Int. Conf. Mach. Learn.",
      "authors": "V. Nair and G. E. Hinton"
    },
    {
      "index": 37,
      "title": "The distribution of Lyapunov exponents: Exact results for random matrices",
      "abstract": "",
      "year": "1986",
      "venue": "Commun. Math. Phys.",
      "authors": "C. M. Newman"
    },
    {
      "index": 38,
      "title": "On the difficulty of training recurrent neural networks",
      "abstract": "",
      "year": "2013",
      "venue": "Int. Conf. Mach. Learn.",
      "authors": "R. Pascanu, T. Mikolov, and Y. Bengio"
    },
    {
      "index": 39,
      "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "abstract": "",
      "year": "2019",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "A. Paszke, S. Gross, F. Massa, A. Lerer, J. Bradbury, G. Chanan, T. Killeen, Z. Lin, N. Gimelshein, L. Antiga, et al.",
      "orig_title": "Pytorch: An imperative style, high-performance deep learning library",
      "paper_id": "1912.01703v1"
    },
    {
      "index": 40,
      "title": "Characteristic Lyapunov exponents and smooth ergodic theory",
      "abstract": "",
      "year": "1977",
      "venue": "Russ. Math. Surv.",
      "authors": "Y. B. Pesin"
    },
    {
      "index": 41,
      "title": "Numerical mathematics, volume 37",
      "abstract": "",
      "year": "2010",
      "venue": "Springer Science & Business Media",
      "authors": "A. Quarteroni, R. Sacco, and F. Saleri"
    },
    {
      "index": 42,
      "title": "GLU Variants Improve Transformer",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2002.05202",
      "authors": "N. Shazeer",
      "orig_title": "GLU variants improve transformer",
      "paper_id": "2002.05202v1"
    },
    {
      "index": 43,
      "title": "Infinite-dimensional dynamical systems in mechanics and physics, volume 68",
      "abstract": "",
      "year": "2012",
      "venue": "Springer Science & Business Media",
      "authors": "R. Temam"
    },
    {
      "index": 44,
      "title": "Regression shrinkage and selection via the lasso",
      "abstract": "",
      "year": "1996",
      "venue": "J. R. Stat. Soc. Series B Stat. Methodol.",
      "authors": "R. Tibshirani"
    },
    {
      "index": 45,
      "title": "ResMLP: Feedforward networks for image classification with data-efficient training",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2105.03404",
      "authors": "H. Touvron, P. Bojanowski, M. Caron, M. Cord, A. El-Nouby, E. Grave, G. Izacard, A. Joulin, G. Synnaeve, J. Verbeek, et al.",
      "orig_title": "ResMLP: Feedforward networks for image classification with data-efficient training",
      "paper_id": "2105.03404v2"
    },
    {
      "index": 46,
      "title": "Instance Normalization: The Missing Ingredient for Fast Stylization",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1607.08022",
      "authors": "D. Ulyanov, A. Vedaldi, and V. Lempitsky",
      "orig_title": "Instance normalization: The missing ingredient for fast stylization",
      "paper_id": "1607.08022v3"
    },
    {
      "index": 47,
      "title": "Practical low-rank communication compression in decentralized deep learning",
      "abstract": "",
      "year": "2020",
      "venue": "Adv. Neural Inform. Process. Syst.",
      "authors": "T. Vogels, S. P. Karimireddy, and M. Jaggi"
    },
    {
      "index": 48,
      "title": "Rank-r approximation of tensors using image-as-matrix representation",
      "abstract": "",
      "year": "2005",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "H. Wang and N. Ahuja"
    },
    {
      "index": 49,
      "title": "Das asymptotische verteilungsgesetz der eigenwerte linearer partieller differentialgleichungen",
      "abstract": "",
      "year": "1912",
      "venue": "Math. Ann.",
      "authors": "H. Weyl"
    },
    {
      "index": 50,
      "title": "Principal component analysis",
      "abstract": "",
      "year": "1987",
      "venue": "Chemom. Intell. Lab. Syst",
      "authors": "S. Wold, K. Esbensen, and P. Geladi"
    },
    {
      "index": 51,
      "title": "Determining Lyapunov exponents from a time series",
      "abstract": "",
      "year": "1985",
      "venue": "Physica D",
      "authors": "A. Wolf, J. B. Swift, H. L. Swinney, and J. A. Vastano"
    },
    {
      "index": 52,
      "title": "Group Normalization",
      "abstract": "",
      "year": "2018",
      "venue": "Eur. Conf. Comput. Vis.",
      "authors": "Y. Wu and K. He",
      "orig_title": "Group normalization",
      "paper_id": "1803.08494v3"
    },
    {
      "index": 53,
      "title": "Generalized low rank approximations of matrices",
      "abstract": "",
      "year": "2005",
      "venue": "Mach. Learn.",
      "authors": "J. Ye"
    },
    {
      "index": 54,
      "title": "On compressing deep models by low rank and sparse decomposition",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "X. Yu, T. Liu, X. Wang, and D. Tao"
    },
    {
      "index": 55,
      "title": "From Rank Estimation to Rank Approximation: Rank Residual Constraint for Image Restoration",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Image Process.",
      "authors": "Z. Zha, X. Yuan, B. Wen, J. Zhou, J. Zhang, and C. Zhu",
      "orig_title": "From rank estimation to rank approximation: Rank residual constraint for image restoration",
      "paper_id": "1807.02504v11"
    },
    {
      "index": 56,
      "title": "Low-rank sparse feature selection for patient similarity learning",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Int. Conf. on Data Min.",
      "authors": "M. Zhan, S. Cao, B. Qian, S. Chang, and J. Wei"
    },
    {
      "index": 57,
      "title": "Low-rank sparse coding for image classification",
      "abstract": "",
      "year": "2013",
      "venue": "Int. Conf. Comput. Vis.",
      "authors": "T. Zhang, B. Ghanem, S. Liu, C. Xu, and N. Ahuja"
    },
    {
      "index": 58,
      "title": "Learning structured low-rank representations for image classification",
      "abstract": "",
      "year": "2013",
      "venue": "IEEE Conf. Comput. Vis. Pattern Recog.",
      "authors": "Y. Zhang, Z. Jiang, and L. S. Davis"
    },
    {
      "index": 59,
      "title": "Sparse principal component analysis",
      "abstract": "",
      "year": "2006",
      "venue": "J. Comput. Graph. Stat.",
      "authors": "H. Zou, T. Hastie, and R. Tibshirani"
    }
  ]
}