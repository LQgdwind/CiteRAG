{
  "paper_id": "2403.07973v1",
  "title": "Flexible Non-intrusive Dynamic Instrumentation for WebAssembly",
  "abstract": "Abstract.\nA key strength of managed runtimes over hardware is the ability to gain detailed insight into the dynamic execution of programs with instrumentation.\nAnalyses such as code coverage, execution frequency, tracing, and debugging, are all made easier in a virtual setting.\nAs a portable, low-level bytecode, WebAssembly offers inexpensive in-process sandboxing with high performance.\nYet to date, Wasm engines have not offered much insight into executing programs, supporting at best bytecode-level stepping and basic source maps, but no instrumentation capabilities.\nIn this paper, we show the first non-intrusive dynamic instrumentation system for WebAssembly in the open-source Wizard Research Engine††https://github.com/titzer/wizard-engine.\nOur innovative design offers a flexible, complete hierarchy of instrumentation primitives that support building high-level, complex analyses in terms of low-level, programmable probes.\nIn contrast to emulation or machine code instrumentation, injecting probes at the bytecode level increases expressiveness and vastly simplifies the implementation by reusing the engine’s JIT compiler, interpreter, and deoptimization mechanism rather than building new ones.\nWizard supports both dynamic instrumentation insertion and removal while providing consistency guarantees, which is key to composing multiple analyses without interference.\nWe detail a fully-featured implementation in a high-performance multi-tier Wasm engine, show novel optimizations specifically designed to minimize instrumentation overhead, and evaluate performance characteristics under load from various analyses.\nThis design is well-suited for production engine adoption as probes can be implemented to have no impact on production performance when not in use.",
  "reference_labels": [
    {
      "index": 0,
      "title": "The edge of the multi-cloud.",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": ""
    },
    {
      "index": 1,
      "title": "Wasm3: The fastest WebAssembly interpreter, and the most universal runtime.",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": ""
    },
    {
      "index": 2,
      "title": "Java Virtual Machine Tools Interface.",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 3,
      "title": "JavaScriptCore, the built-in JavaScript engine for WebKit.",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 4,
      "title": "V8 development site.",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 5,
      "title": "WebAssembly specifications.",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 6,
      "title": "Intel 64® and IA-32 Architectures Software Developer’s Manual Volume 3 (3A, 3B, 3C & 3D): System Programming Guide, chapter 33: Intel Processor Trace.",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": ""
    },
    {
      "index": 7,
      "title": "Walrus: A WebAssembly transformation library.",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": ""
    },
    {
      "index": 8,
      "title": "Wasm bytecode instrumenter.",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": ""
    },
    {
      "index": 9,
      "title": "SaBRe: load-time selective binary rewriting.",
      "abstract": "",
      "year": "2022",
      "venue": "International Journal on Software Tools for Technology Transfer",
      "authors": "Paul-Antoine Arras, Anastasios Andronidis, Luís Pina, Karolis Mituzas, Qianyi Shu, Daniel Grumberg, and Cristian Cadar"
    },
    {
      "index": 10,
      "title": "Linux perf main page.",
      "abstract": "",
      "year": "2012",
      "venue": "",
      "authors": "Linux Wiki Authors"
    },
    {
      "index": 11,
      "title": "The .NET Profiling API.",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ".NET Wiki Authors"
    },
    {
      "index": 12,
      "title": "TuningFork: A platform for visualization and analysis of complex real-time systems.",
      "abstract": "",
      "year": "2007",
      "venue": "ACM SIGPLAN Conference on Object-Oriented Programming Systems and Applications Companion",
      "authors": "David F. Bacon, Perry Cheng, and David Grove"
    },
    {
      "index": 13,
      "title": "QEMU: A generic and open source machine emulator and virtualizer.",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Fabrice Bellard"
    },
    {
      "index": 14,
      "title": "Anywhere, any-time binary instrumentation.",
      "abstract": "",
      "year": "2011",
      "venue": "ACM SIGPLAN-SIGSOFT Workshop on Program Analysis for Software Tools",
      "authors": "Andrew R. Bernat and Barton P. Miller"
    },
    {
      "index": 15,
      "title": "Advanced Java bytecode instrumentation.",
      "abstract": "",
      "year": "2007",
      "venue": "International Symposium on Principles and Practice of Programming in Java",
      "authors": "Walter Binder, Jarle Hulaas, and Philippe Moret"
    },
    {
      "index": 16,
      "title": "Provably-safe multilingual software sandboxing using WebAssembly.",
      "abstract": "",
      "year": "2022",
      "venue": "USENIX Security Symposium",
      "authors": "Jay Bosamiya, Wen Shih Lim, and Bryan Parno"
    },
    {
      "index": 17,
      "title": "An infrastructure for adaptive dynamic optimization.",
      "abstract": "",
      "year": "2003",
      "venue": "International Symposium on Code Generation and Optimization",
      "authors": "D Bruening, T Garnett, and S Amarasinghe"
    },
    {
      "index": 18,
      "title": "Runtime object lifetime profiler for latency sensitive big data applications.",
      "abstract": "",
      "year": "2019",
      "venue": "Fourteenth EuroSys Conference",
      "authors": "Rodrigo Bruno, Duarte Patricio, José Simão, Luis Veiga, and Paulo Ferreira"
    },
    {
      "index": 19,
      "title": "Living on the edge: Rapid-toggling probes with cross-modification on x86.",
      "abstract": "",
      "year": "2016",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "Buddhika Chamith, Bo Joel Svensson, Luke Dalessandro, and Ryan R. Newton"
    },
    {
      "index": 20,
      "title": "DTrace: Dynamic tracing in Oracle Solaris, Mac OS X, and Free BSD by Brendan Gregg and Jim Mauro.",
      "abstract": "",
      "year": "2012",
      "venue": "SIGSOFT Softw. Eng. Notes",
      "authors": "Greg Cooper"
    },
    {
      "index": 21,
      "title": "Libsodium",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "Frank Denis"
    },
    {
      "index": 22,
      "title": "Dynamic metrics for Java.",
      "abstract": "",
      "year": "2003",
      "venue": "SIGPLAN Not.",
      "authors": "Bruno Dufour, Karel Driesen, Laurie Hendren, and Clark Verbrugge"
    },
    {
      "index": 23,
      "title": "The RoadRunner dynamic analysis framework for concurrent programs.",
      "abstract": "",
      "year": "2010",
      "venue": "ACM SIGPLAN-SIGSOFT Workshop on Program Analysis for Software Tools and Engineering",
      "authors": "Cormac Flanagan and Stephen N. Freund"
    },
    {
      "index": 24,
      "title": "Design Patterns: Elements of Reusable Object-Oriented Software.",
      "abstract": "",
      "year": "1994",
      "venue": "Addison-Wesley Professional Computing Series",
      "authors": "E. Gamma, R. Helm, R. Johnson, and J. Vlissides"
    },
    {
      "index": 25,
      "title": "Side effect monitoring for Java using bytecode rewriting.",
      "abstract": "",
      "year": "2014",
      "venue": "International Conference on Principles and Practices of Programming on the Java Platform: Virtual Machines, Languages, and Tools",
      "authors": "Manuel Geffken and Peter Thiemann"
    },
    {
      "index": 26,
      "title": "DTrace: Dynamic Tracing in Oracle Solaris, Mac OS X and FreeBSD.",
      "abstract": "",
      "year": "2011",
      "venue": "Prentice Hall Press",
      "authors": "Brendan Gregg and Jim Mauro"
    },
    {
      "index": 27,
      "title": "Bringing the web up to speed with WebAssembly.",
      "abstract": "",
      "year": "2017",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "Andreas Haas, Andreas Rossberg, Derek L. Schuff, Ben L. Titzer, Michael Holman, Dan Gohman, Luke Wagner, Alon Zakai, and JF Bastien"
    },
    {
      "index": 28,
      "title": "Numerical computing on the web: Benchmarking for the future.",
      "abstract": "",
      "year": "2018",
      "venue": "ACM SIGPLAN International Symposium on Dynamic Languages",
      "authors": "David Herrera, Hanfeng Chen, Erick Lavoie, and Laurie Hendren"
    },
    {
      "index": 29,
      "title": "APT-GET: Profile-guided timely software prefetching.",
      "abstract": "",
      "year": "2022",
      "venue": "European Conference on Computer Systems",
      "authors": "Saba Jamilan, Tanvir Ahmed Khan, Grant Ayers, Baris Kasikci, and Heiner Litz"
    },
    {
      "index": 30,
      "title": "An overview of AspectJ.",
      "abstract": "",
      "year": "2001",
      "venue": "European Conference on Object-Oriented Programming",
      "authors": "Gregor Kiczales, Erik Hilsdale, Jim Hugunin, Mik Kersten, Jeffrey Palm, and William G. Griswold"
    },
    {
      "index": 31,
      "title": "EEL: Machine-independent executable editing.",
      "abstract": "",
      "year": "1995",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "James R. Larus and Eric Schnarr"
    },
    {
      "index": 32,
      "title": "Wasabi: A Framework for Dynamically Analyzing WebAssembly",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Architectural Support for Programming Languages and Operating Systems",
      "authors": "Daniel Lehmann and Michael Pradel",
      "orig_title": "Wasabi: A framework for dynamically analyzing WebAssembly.",
      "paper_id": "1808.10652v1"
    },
    {
      "index": 33,
      "title": "ThingSpire OS: A WebAssembly-based IoT operating system for cloud-edge integration.",
      "abstract": "",
      "year": "2021",
      "venue": "Annual International Conference on Mobile Systems, Applications, and Services",
      "authors": "Borui Li, Hongchang Fan, Yi Gao, and Wei Dong"
    },
    {
      "index": 34,
      "title": "Aerogel: Lightweight access control framework for WebAssembly-based bare-metal IoT devices.",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE/ACM Symposium on Edge Computing",
      "authors": "Renju Liu, Luis Garcia, and Mani Srivastava"
    },
    {
      "index": 35,
      "title": "Pin: Building customized program analysis tools with dynamic instrumentation.",
      "abstract": "",
      "year": "2005",
      "venue": "SIGPLAN Not.",
      "authors": "Chi-Keung Luk, Robert Cohn, Robert Muth, Harish Patil, Artur Klauser, Geoff Lowney, Steven Wallace, Vijay Janapa Reddi, and Kim Hazelwood"
    },
    {
      "index": 36,
      "title": "ShadowVM: Robust and comprehensive dynamic program analysis for the Java platform.",
      "abstract": "",
      "year": "2013",
      "venue": "International Conference on Generative Programming: Concepts and Experiences",
      "authors": "Lukáš Marek, Stephen Kell, Yudi Zheng, Lubomír Bulej, Walter Binder, Petr Tůma, Danilo Ansaloni, Aibek Sarimbekov, and Andreas Sewe"
    },
    {
      "index": 37,
      "title": "DiSL: A domain-specific language for bytecode instrumentation.",
      "abstract": "",
      "year": "2012",
      "venue": "Annual International Conference on Aspect-Oriented Software Development",
      "authors": "Lukáš Marek, Alex Villazón, Yudi Zheng, Danilo Ansaloni, Walter Binder, and Zhengwei Qi"
    },
    {
      "index": 38,
      "title": "The Paradyn parallel performance measurement tool.",
      "abstract": "",
      "year": "1995",
      "venue": "Computer",
      "authors": "Barton P. Miller, Mark D. Callaghan, Jonathan M. Cargille, Jeffrey K. Hollingsworth, R. Bruce Irvin, Karen L. Karavanic, Krishna Kunchithapadam, and Tia Newhall"
    },
    {
      "index": 39,
      "title": "Oron: Towards a dynamic analysis instrumentation platform for AssemblyScript.",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on the Art, Science, and Engineering of Programming",
      "authors": "Aäron Munsters, Angel Luis Scull Pupo, Jim Bauwens, and Elisa Gonzalez Boix"
    },
    {
      "index": 40,
      "title": "Retrofitting industrial machines with WebAssembly on the edge.",
      "abstract": "",
      "year": "2022",
      "venue": "Web Information Systems Engineering – WISE",
      "authors": "Otoya Nakakaze, István Koren, Florian Brillowski, and Ralf Klamma"
    },
    {
      "index": 41,
      "title": "Valgrind: A framework for heavyweight dynamic binary instrumentation.",
      "abstract": "",
      "year": "2007",
      "venue": "SIGPLAN Not.",
      "authors": "Nicholas Nethercote and Julian Seward"
    },
    {
      "index": 42,
      "title": "Edgedancer: Secure mobile WebAssembly services on the edge.",
      "abstract": "",
      "year": "2021",
      "venue": "International Workshop on Edge Systems, Analytics and Networking",
      "authors": "Manuel Nieke, Lennart Almstedt, and Rüdiger Kapitza"
    },
    {
      "index": 43,
      "title": "Bytecode-level analysis and optimization of Java classes.",
      "abstract": "",
      "year": "1998",
      "venue": "",
      "authors": "Nathaniel John Nystrom"
    },
    {
      "index": 44,
      "title": "PolyBench",
      "abstract": "",
      "year": "2016",
      "venue": "",
      "authors": "Louis-Noël Pouchet"
    },
    {
      "index": 45,
      "title": "Towards Solving the Challenge of Minimal Overhead Monitoring",
      "abstract": "",
      "year": "2023",
      "venue": "ACM/SPEC International Conference on Performance Engineering",
      "authors": "David Georg Reichelt, Stefan Kühne, and Wilhelm Hasselbring",
      "orig_title": "Towards solving the challenge of minimal overhead monitoring.",
      "paper_id": "2304.05688v1"
    },
    {
      "index": 46,
      "title": "Aspect-oriented WebAssembly transformation.",
      "abstract": "",
      "year": "2022",
      "venue": "Iberian Conference on Information Systems and Technologies",
      "authors": "João Rodrigues and Jorge Barreiros"
    },
    {
      "index": 47,
      "title": "Instrumentation and optimization of Win32/Intel executables using Etch.",
      "abstract": "",
      "year": "1997",
      "venue": "USENIX Windows NT Workshop",
      "authors": "Ted Romer, Geoff Voelker, Dennis Lee, Alec Wolman, Wayne Wong, Hank Levy, Brian Bershad, and Brad Chen"
    },
    {
      "index": 48,
      "title": "Jalangi: A selective record-replay and dynamic analysis framework for JavaScript.",
      "abstract": "",
      "year": "2013",
      "venue": "Joint Meeting on Foundations of Software Engineering",
      "authors": "Koushik Sen, Swaroop Kalasapur, Tasneem Brutch, and Simon Gibbs"
    },
    {
      "index": 49,
      "title": "BISM: Bytecode-Level Instrumentation for Software Monitoring",
      "abstract": "",
      "year": "2020",
      "venue": "Runtime Verification: International Conference",
      "authors": "Chukri Soueidi, Ali Kassem, and Yliès Falcone",
      "orig_title": "BISM: bytecode-level instrumentation for software monitoring.",
      "paper_id": "2007.03936v2"
    },
    {
      "index": 50,
      "title": "Vulcan: Binary transformation in a distributed environment.",
      "abstract": "",
      "year": "2001",
      "venue": "",
      "authors": "A. Srivastava, A. Edwards, and H. Vo"
    },
    {
      "index": 51,
      "title": "ATOM: A system for building customized program analysis tools.",
      "abstract": "",
      "year": "1994",
      "venue": "",
      "authors": "Amitabh Srivastava and Alan Eustace"
    },
    {
      "index": 52,
      "title": "Harmonizing classes, functions, tuples, and type parameters in Virgil III.",
      "abstract": "",
      "year": "2013",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation",
      "authors": "Ben L. Titzer"
    },
    {
      "index": 53,
      "title": "Wizard, An advanced Webassembly Engine for Research.",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "Ben L. Titzer"
    },
    {
      "index": 54,
      "title": "A fast in-place interpreter for WebAssembly",
      "abstract": "",
      "year": "2022",
      "venue": "Proc. ACM Program. Lang.",
      "authors": "Ben L. Titzer",
      "orig_title": "A fast in-place interpreter for WebAssembly.",
      "paper_id": "2205.01183v1"
    },
    {
      "index": 55,
      "title": "Whose baseline compiler is it anyway?",
      "abstract": "",
      "year": "2024",
      "venue": "CGO",
      "authors": "Ben L. Titzer",
      "orig_title": "Whose baseline compiler is it anyway?",
      "paper_id": "2305.13241v2"
    },
    {
      "index": 56,
      "title": "Avrora: Scalable sensor network simulation with precise timing.",
      "abstract": "",
      "year": "2005",
      "venue": "International Symposium on Information Processing in Sensor Networks",
      "authors": "Ben L. Titzer, Daniel K. Lee, and Jens Palsberg"
    },
    {
      "index": 57,
      "title": "Nonintrusive precision instrumentation of microcontroller software.",
      "abstract": "",
      "year": "2005",
      "venue": "ACM SIGPLAN/SIGBED Conference on Languages, Compilers, and Tools for Embedded Systems",
      "authors": "Ben L. Titzer and Jens Palsberg"
    },
    {
      "index": 58,
      "title": "Soot: A Java bytecode optimization framework.",
      "abstract": "",
      "year": "2010",
      "venue": "CASCON First Decade High Impact Papers",
      "authors": "Raja Vallée-Rai, Phong Co, Etienne Gagnon, Laurie Hendren, Patrick Lam, and Vijay Sundaresan"
    },
    {
      "index": 59,
      "title": "WebAssembly on Cloudflare Workers.",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": "Kenton Varda"
    },
    {
      "index": 60,
      "title": "Odin: On-demand instrumentation with on-the-fly recompilation.",
      "abstract": "",
      "year": "2022",
      "venue": "ACM SIGPLAN International Conference on Programming Language Design and Implementation",
      "authors": "Mingzhe Wang, Jie Liang, Chijin Zhou, Zhiyong Wu, Xinyi Xu, and Yu Jiang"
    },
    {
      "index": 61,
      "title": "Mechanising and verifying the WebAssembly specification.",
      "abstract": "",
      "year": "2018",
      "venue": "ACM SIGPLAN International Conference on Certified Programs and Proofs",
      "authors": "Conrad Watt"
    },
    {
      "index": 62,
      "title": "From hack to elaborate technique – a survey on binary rewriting.",
      "abstract": "",
      "year": "2019",
      "venue": "ACM Comput. Surv.",
      "authors": "Matthias Wenzl, Georg Merzdovnik, Johanna Ullrich, and Edgar Weippl"
    },
    {
      "index": 63,
      "title": "JPortal: Precise and efficient control-flow tracing for JVM programs with Intel Processor Trace.",
      "abstract": "",
      "year": "2021",
      "venue": "ACM SIGPLAN International Conference on Programming Language Design and Implementation",
      "authors": "Zhiqiang Zuo, Kai Ji, Yifei Wang, Wei Tao, Linzhang Wang, Xuandong Li, and Guoqing Harry Xu"
    }
  ]
}