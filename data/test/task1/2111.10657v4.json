{
  "paper_id": "2111.10657v4",
  "title": "Generalizing Graph Neural Networks on Out-Of-Distribution Graphs",
  "abstract": "Abstract\nGraph Neural Networks (GNNs) are proposed without considering the agnostic distribution shifts between training graphs and testing graphs, inducing the degeneration of the generalization ability of GNNs on Out-Of-Distribution (OOD) settings. The fundamental reason for such degeneration is that most GNNs are developed based on the I.I.D hypothesis. In such a setting, GNNs tend to exploit subtle statistical correlations existing in the training set for predictions, even though it is a spurious correlation. This learning mechanism inherits from the common characteristics of machine learning approaches. However, such spurious correlations may change in the wild testing environments, leading to the failure of GNNs. Therefore, eliminating the impact of spurious correlations is crucial for stable GNN models. To this end, in this paper, we argue that the spurious correlation exists among subgraph-level units and analyze the degeneration of GNN in causal view. Based on the causal view analysis, we propose a general causal representation framework for stable GNN, called StableGNN. The main idea of this framework is to extract high-level representations from raw graph data first and resort to the distinguishing ability of causal inference to help the model get rid of spurious correlations. Particularly, to extract meaningful high-level representations, we exploit a differentiable graph pooling layer to extract subgraph-based representations by an end-to-end manner. Furthermore, inspired by the confounder balancing techniques from causal inference, based on the learned high-level representations, we propose a causal variable distinguishing regularizer to correct the biased training distribution by learning a set of sample weights. Hence, GNNs would concentrate more on the true connection between discriminative substructures and labels. Extensive experiments are conducted on both synthetic datasets with various distribution shift degrees and eight real-world OOD graph datasets. The results well verify that the proposed model StableGNN not only outperforms the state-of-the-arts but also provides a flexible framework to enhance existing GNNs. In addition, the interpretability experiments validate that StableGNN could leverage causal structures for predictions.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Identification and estimation of local average treatment effects",
      "abstract": "",
      "year": "1995",
      "venue": "",
      "authors": "Joshua Angrist and Guido Imbens"
    },
    {
      "index": 1,
      "title": "Invariant risk minimization",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1907.02893",
      "authors": "Martin Arjovsky, Léon Bottou, Ishaan Gulrajani, and David Lopez-Paz"
    },
    {
      "index": 2,
      "title": "Approximate residual balancing: De-biased inference of average treatment effects in high dimensions",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1604.07125",
      "authors": "Susan Athey, Guido W Imbens, and Stefan Wager"
    },
    {
      "index": 3,
      "title": "A Meta-Transfer Objective for Learning to Disentangle Causal Mechanisms",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1901.10912",
      "authors": "Yoshua Bengio, Tristan Deleu, Nasim Rahaman, Rosemary Ke, Sébastien Lachapelle, Olexa Bilaniuk, Anirudh Goyal, and Christopher Pal",
      "orig_title": "A meta-transfer objective for learning to disentangle causal mechanisms",
      "paper_id": "1901.10912v2"
    },
    {
      "index": 4,
      "title": "Beyond Low-frequency Information in Graph Convolutional Networks",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "Deyu Bo, Xiao Wang, Chuan Shi, and Huawei Shen",
      "orig_title": "Beyond low-frequency information in graph convolutional networks",
      "paper_id": "2101.00797v1"
    },
    {
      "index": 5,
      "title": "Structure-activity relationship of mutagenic aromatic and heteroaromatic nitro compounds. correlation with molecular orbital energies and hydrophobicity",
      "abstract": "",
      "year": "1991",
      "venue": "Journal of medicinal chemistry",
      "authors": "Asim Kumar Debnath, Rosa L Lopez de Compadre, Gargi Debnath, Alan J Shusterman, and Corwin Hansch"
    },
    {
      "index": 6,
      "title": "Exploring the Landscape of Spatial Robustness",
      "abstract": "",
      "year": "2019",
      "venue": "ICML",
      "authors": "Logan Engstrom, Brandon Tran, Dimitris Tsipras, Ludwig Schmidt, and Aleksander Madry",
      "orig_title": "Exploring the landscape of spatial robustness",
      "paper_id": "1712.02779v4"
    },
    {
      "index": 7,
      "title": "Graph U-Nets",
      "abstract": "",
      "year": "2019",
      "venue": "international conference on machine learning",
      "authors": "Hongyang Gao and Shuiwang Ji",
      "orig_title": "Graph u-nets",
      "paper_id": "1905.05178v1"
    },
    {
      "index": 8,
      "title": "Neural Message Passing for Quantum Chemistry",
      "abstract": "",
      "year": "2017",
      "venue": "ICML",
      "authors": "Justin Gilmer, Samuel S Schoenholz, Patrick F Riley, Oriol Vinyals, and George E Dahl",
      "orig_title": "Neural message passing for quantum chemistry",
      "paper_id": "1704.01212v2"
    },
    {
      "index": 9,
      "title": "Measuring statistical dependence with hilbert-schmidt norms",
      "abstract": "",
      "year": "2005",
      "venue": "International conference on algorithmic learning theory",
      "authors": "Arthur Gretton, Olivier Bousquet, Alex Smola, and Bernhard Schölkopf"
    },
    {
      "index": 10,
      "title": "Entropy balancing for causal effects: A multivariate reweighting method to produce balanced samples in observational studies",
      "abstract": "",
      "year": "2012",
      "venue": "Political Analysis",
      "authors": "Jens Hainmueller"
    },
    {
      "index": 11,
      "title": "Inductive Representation Learning on Large Graphs",
      "abstract": "",
      "year": "2017",
      "venue": "NeurIPS",
      "authors": "Will Hamilton, Zhitao Ying, and Jure Leskovec",
      "orig_title": "Inductive representation learning on large graphs",
      "paper_id": "1706.02216v4"
    },
    {
      "index": 12,
      "title": "Deep Residual Learning for Image Recognition",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun",
      "orig_title": "Deep residual learning for image recognition",
      "paper_id": "1512.03385v1"
    },
    {
      "index": 13,
      "title": "Benchmarking Neural Network Robustness to Common Corruptions and Perturbations",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1903.12261",
      "authors": "Dan Hendrycks and Thomas Dietterich",
      "orig_title": "Benchmarking neural network robustness to common corruptions and perturbations",
      "paper_id": "1903.12261v1"
    },
    {
      "index": 14,
      "title": "Open Graph Benchmark: Datasets for Machine Learning on Graphs",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Weihua Hu, Matthias Fey, Marinka Zitnik, Yuxiao Dong, Hongyu Ren, Bowen Liu, Michele Catasta, and Jure Leskovec",
      "orig_title": "Open graph benchmark: Datasets for machine learning on graphs",
      "paper_id": "2005.00687v7"
    },
    {
      "index": 15,
      "title": "Using auc and accuracy in evaluating learning algorithms",
      "abstract": "",
      "year": "2005",
      "venue": "TKDE",
      "authors": "Jin Huang and Charles X Ling"
    },
    {
      "index": 16,
      "title": "Batch Normalization. Accelerating deep network training by reducing internal covariate shift",
      "abstract": "",
      "year": "",
      "venue": "arXiv preprint arXiv:1502.03167",
      "authors": "Sergey Ioffe and Christian Szegedy"
    },
    {
      "index": 17,
      "title": "Hierarchical Generation of Molecular Graphs using Structural Motifs",
      "abstract": "",
      "year": "2020",
      "venue": "ICML",
      "authors": "Wengong Jin, Regina Barzilay, and Tommi Jaakkola",
      "orig_title": "Hierarchical generation of molecular graphs using structural motifs",
      "paper_id": "2002.03230v2"
    },
    {
      "index": 18,
      "title": "Does invariant risk minimization capture invariance?",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Pritish Kamath, Akilesh Tangella, Danica Sutherland, and Nathan Srebro"
    },
    {
      "index": 19,
      "title": "Universal invariant and equivariant graph neural networks",
      "abstract": "",
      "year": "2019",
      "venue": "NeurIPS",
      "authors": "Nicolas Keriven and Gabriel Peyré"
    },
    {
      "index": 20,
      "title": "Semi-Supervised Classification with Graph Convolutional Networks",
      "abstract": "",
      "year": "2016",
      "venue": "ICLR",
      "authors": "Thomas N Kipf and Max Welling",
      "orig_title": "Semi-supervised classification with graph convolutional networks",
      "paper_id": "1609.02907v4"
    },
    {
      "index": 21,
      "title": "Out-of-distribution generalization via risk extrapolation (rex)",
      "abstract": "",
      "year": "2021",
      "venue": "ICML",
      "authors": "David Krueger, Ethan Caballero, Joern-Henrik Jacobsen, Amy Zhang, Jonathan Binas, Dinghuai Zhang, Remi Le Priol, and Aaron Courville"
    },
    {
      "index": 22,
      "title": "Stable prediction across unknown environments",
      "abstract": "",
      "year": "2018",
      "venue": "KDD",
      "authors": "Kun Kuang, Peng Cui, Susan Athey, Ruoxuan Xiong, and Bo Li"
    },
    {
      "index": 23,
      "title": "Stable prediction with model misspecification and agnostic distribution shift",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI",
      "authors": "Kun Kuang, Ruoxuan Xiong, Peng Cui, Susan Athey, and Bo Li"
    },
    {
      "index": 24,
      "title": "Building Machines That Learn and Think Like People",
      "abstract": "",
      "year": "2017",
      "venue": "Behavioral and brain sciences",
      "authors": "Brenden M Lake, Tomer D Ullman, Joshua B Tenenbaum, and Samuel J Gershman",
      "orig_title": "Building machines that learn and think like people",
      "paper_id": "1604.00289v3"
    },
    {
      "index": 25,
      "title": "Rdkit: A software suite for cheminformatics, computational chemistry, and predictive modeling",
      "abstract": "",
      "year": "2013",
      "venue": "",
      "authors": "Greg Landrum"
    },
    {
      "index": 26,
      "title": "Rdkit: Open-source cheminformatics",
      "abstract": "",
      "year": "2006",
      "venue": "",
      "authors": "Greg Landrum et al."
    },
    {
      "index": 27,
      "title": "Graph classification using structural attention",
      "abstract": "",
      "year": "2018",
      "venue": "SIGKDD",
      "authors": "John Boaz Lee, Ryan Rossi, and Xiangnan Kong"
    },
    {
      "index": 28,
      "title": "Self-Attention Graph Pooling",
      "abstract": "",
      "year": "2019",
      "venue": "ICML",
      "authors": "Junhyun Lee, Inyeop Lee, and Jaewoo Kang",
      "orig_title": "Self-attention graph pooling",
      "paper_id": "1904.08082v4"
    },
    {
      "index": 29,
      "title": "A reduction of a graph to a canonical form and an algebra arising during this reduction",
      "abstract": "",
      "year": "1968",
      "venue": "Nauchno-Technicheskaya Informatsiya",
      "authors": "AA Leman and B Weisfeiler"
    },
    {
      "index": 30,
      "title": "A PAC-Bayesian Approach to Generalization Bounds for Graph Neural Networks",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Renjie Liao, Raquel Urtasun, and Richard Zemel",
      "orig_title": "A pac-bayesian approach to generalization bounds for graph neural networks",
      "paper_id": "2012.07690v1"
    },
    {
      "index": 31,
      "title": "Generative Causal Explanations for Graph Neural Networks",
      "abstract": "",
      "year": "2021",
      "venue": "ICML",
      "authors": "Wanyu Lin, Hao Lan, and Baochun Li",
      "orig_title": "Generative causal explanations for graph neural networks",
      "paper_id": "2104.06643v2"
    },
    {
      "index": 32,
      "title": "Discovering causal signals in images",
      "abstract": "",
      "year": "2017",
      "venue": "CVPR",
      "authors": "David Lopez-Paz, Robert Nishihara, Soumith Chintala, Bernhard Scholkopf, and Léon Bottou"
    },
    {
      "index": 33,
      "title": "Parameterized Explainer for Graph Neural Network",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Dongsheng Luo, Wei Cheng, Dongkuan Xu, Wenchao Yu, Bo Zong, Haifeng Chen, and Xiang Zhang",
      "orig_title": "Parameterized explainer for graph neural network",
      "paper_id": "2011.04573v1"
    },
    {
      "index": 34,
      "title": "Domain generalization using a mixture of multiple latent domains",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI",
      "authors": "Toshihiko Matsuura and Tatsuya Harada"
    },
    {
      "index": 35,
      "title": "Geometric deep learning on graphs and manifolds using mixture model cnns",
      "abstract": "",
      "year": "2017",
      "venue": "CVPR",
      "authors": "Federico Monti, Davide Boscaini, Jonathan Masci, Emanuele Rodola, Jan Svoboda, and Michael M Bronstein"
    },
    {
      "index": 36,
      "title": "Explainability methods for graph convolutional neural networks",
      "abstract": "",
      "year": "2019",
      "venue": "CVPR",
      "authors": "Phillip E Pope, Soheil Kolouri, Mohammad Rostami, Charles E Martin, and Heiko Hoffmann"
    },
    {
      "index": 37,
      "title": "Learning to Learn Single Domain Generalization",
      "abstract": "",
      "year": "2020",
      "venue": "CVPR",
      "authors": "Fengchun Qiao, Long Zhao, and Xi Peng",
      "orig_title": "Learning to learn single domain generalization",
      "paper_id": "2003.13216v1"
    },
    {
      "index": 38,
      "title": "The Risks of Invariant Risk Minimization",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Elan Rosenfeld, Pradeep Ravikumar, and Andrej Risteski",
      "orig_title": "The risks of invariant risk minimization",
      "paper_id": "2010.05761v2"
    },
    {
      "index": 39,
      "title": "The graph neural network model",
      "abstract": "",
      "year": "2008",
      "venue": "IEEE Transactions on Neural Networks",
      "authors": "Franco Scarselli, Marco Gori, Ah Chung Tsoi, Markus Hagenbuchner, and Gabriele Monfardini"
    },
    {
      "index": 40,
      "title": "Modeling relational data with graph convolutional networks",
      "abstract": "",
      "year": "2018",
      "venue": "European semantic web conference",
      "authors": "Michael Schlichtkrull, Thomas N Kipf, Peter Bloem, Rianne Van Den Berg, Ivan Titov, and Max Welling"
    },
    {
      "index": 41,
      "title": "Toward causal representation learning",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE",
      "authors": "Bernhard Schölkopf, Francesco Locatello, Stefan Bauer, Nan Rosemary Ke, Nal Kalchbrenner, Anirudh Goyal, and Yoshua Bengio"
    },
    {
      "index": 42,
      "title": "Causally Regularized Learning with Agnostic Data Selection Bias",
      "abstract": "",
      "year": "2018",
      "venue": "MM",
      "authors": "Zheyan Shen, Peng Cui, Kun Kuang, Bo Li, and Peixuan Chen",
      "orig_title": "Causally regularized learning with agnostic data selection bias",
      "paper_id": "1708.06656v2"
    },
    {
      "index": 43,
      "title": "Stable Learning via Sample Reweighting",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI",
      "authors": "Zheyan Shen, Peng Cui, Tong Zhang, and Kun Kuang",
      "orig_title": "Stable learning via sample reweighting",
      "paper_id": "1911.12580v1"
    },
    {
      "index": 44,
      "title": "Efficient graphlet kernels for large graph comparison",
      "abstract": "",
      "year": "2009",
      "venue": "Artificial intelligence and statistics",
      "authors": "Nino Shervashidze, SVN Vishwanathan, Tobias Petri, Kurt Mehlhorn, and Karsten Borgwardt"
    },
    {
      "index": 45,
      "title": "Weisfeiler-lehman graph kernels",
      "abstract": "",
      "year": "2011",
      "venue": "Journal of Machine Learning Research",
      "authors": "Nino Shervashidze, Pascal Schweitzer, Erik Jan Van Leeuwen, Kurt Mehlhorn, and Karsten M Borgwardt"
    },
    {
      "index": 46,
      "title": "Supervised feature selection via dependence estimation",
      "abstract": "",
      "year": "2007",
      "venue": "ICML",
      "authors": "Le Song, Alex Smola, Arthur Gretton, Karsten M Borgwardt, and Justin Bedo"
    },
    {
      "index": 47,
      "title": "Feature selection via dependence maximization",
      "abstract": "",
      "year": "2012",
      "venue": "Journal of Machine Learning Research",
      "authors": "Le Song, Alex Smola, Arthur Gretton, Justin Bedo, and Karsten Borgwardt"
    },
    {
      "index": 48,
      "title": "One Pixel Attack for Fooling Deep Neural Networks",
      "abstract": "",
      "year": "2019",
      "venue": "TEC",
      "authors": "Jiawei Su, Danilo Vasconcellos Vargas, and Kouichi Sakurai",
      "orig_title": "One pixel attack for fooling deep neural networks",
      "paper_id": "1710.08864v7"
    },
    {
      "index": 49,
      "title": "Test-time training for out-of-distribution generalization",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Yu Sun, Xiaolong Wang, Zhuang Liu, John Miller, Alexei A Efros, and Moritz Hardt"
    },
    {
      "index": 50,
      "title": "Graph Attention Networks",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Petar Veličković, Guillem Cucurull, Arantxa Casanova, Adriana Romero, Pietro Lio, and Yoshua Bengio",
      "orig_title": "Graph attention networks",
      "paper_id": "1710.10903v3"
    },
    {
      "index": 51,
      "title": "Learning Robust Representations by Projecting Superficial Statistics Out",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1903.06256",
      "authors": "Haohan Wang, Zexue He, Zachary C Lipton, and Eric P Xing",
      "orig_title": "Learning robust representations by projecting superficial statistics out",
      "paper_id": "1903.06256v1"
    },
    {
      "index": 52,
      "title": "Simplifying Graph Convolutional Networks",
      "abstract": "",
      "year": "2019",
      "venue": "ICML",
      "authors": "Felix Wu, Amauri Souza, Tianyi Zhang, Christopher Fifty, Tao Yu, and Kilian Weinberger",
      "orig_title": "Simplifying graph convolutional networks",
      "paper_id": "1902.07153v2"
    },
    {
      "index": 53,
      "title": "Moleculenet: a benchmark for molecular machine learning",
      "abstract": "",
      "year": "2018",
      "venue": "Chemical science",
      "authors": "Zhenqin Wu, Bharath Ramsundar, Evan N Feinberg, Joseph Gomes, Caleb Geniesse, Aneesh S Pappu, Karl Leswing, and Vijay Pande"
    },
    {
      "index": 54,
      "title": "Representation learning on graphs with jumping knowledge networks",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Keyulu Xu, Chengtao Li, Yonglong Tian, Tomohiro Sonobe, Ken-ichi Kawarabayashi, and Stefanie Jegelka"
    },
    {
      "index": 55,
      "title": "How Powerful are Graph Neural Networks?",
      "abstract": "",
      "year": "2019",
      "venue": "ICLR",
      "authors": "Keyulu Xu, Weihua Hu, Jure Leskovec, and Stefanie Jegelka",
      "orig_title": "How powerful are graph neural networks?",
      "paper_id": "1810.00826v3"
    },
    {
      "index": 56,
      "title": "Hierarchical Graph Representation Learning with Differentiable Pooling",
      "abstract": "",
      "year": "2018",
      "venue": "NeurIPS",
      "authors": "Rex Ying, Jiaxuan You, Christopher Morris, Xiang Ren, William L Hamilton, and Jure Leskovec",
      "orig_title": "Hierarchical graph representation learning with differentiable pooling",
      "paper_id": "1806.08804v4"
    },
    {
      "index": 57,
      "title": "GNNExplainer: Generating Explanations for Graph Neural Networks",
      "abstract": "",
      "year": "2019",
      "venue": "NeurIPS",
      "authors": "Rex Ying, Dylan Bourgeois, Jiaxuan You, Marinka Zitnik, and Jure Leskovec",
      "orig_title": "Gnnexplainer: Generating explanations for graph neural networks",
      "paper_id": "1903.03894v4"
    },
    {
      "index": 58,
      "title": "Link Prediction Based on Graph Neural Networks",
      "abstract": "",
      "year": "2018",
      "venue": "",
      "authors": "Muhan Zhang and Yixin Chen",
      "orig_title": "Link prediction based on graph neural networks",
      "paper_id": "1802.09691v3"
    },
    {
      "index": 59,
      "title": "An end-to-end deep learning architecture for graph classification",
      "abstract": "",
      "year": "2018",
      "venue": "AAAI",
      "authors": "Muhan Zhang, Zhicheng Cui, Marion Neumann, and Yixin Chen"
    },
    {
      "index": 60,
      "title": "Deep Stable Learning for Out-Of-Distribution Generalization",
      "abstract": "",
      "year": "2021",
      "venue": "CVPR",
      "authors": "Xingxuan Zhang, Peng Cui, Renzhe Xu, Linjun Zhou, Yue He, and Zheyan Shen",
      "orig_title": "Deep stable learning for out-of-distribution generalization",
      "paper_id": "2104.07876v1"
    },
    {
      "index": 61,
      "title": "Counterfactual prediction for bundle treatment",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Hao Zou, Peng Cui, Bo Li, Zheyan Shen, Jianxin Ma, Hongxia Yang, and Yue He"
    },
    {
      "index": 62,
      "title": "Stable weights that balance covariates for estimation with incomplete outcome data",
      "abstract": "",
      "year": "2015",
      "venue": "Journal of the American Statistical Association",
      "authors": "José R Zubizarreta"
    }
  ]
}