{
  "paper_id": "2202.11091v2",
  "title": "Efficient and Differentiable Conformal Prediction with General Function Classes",
  "abstract": "Abstract\nQuantifying the data uncertainty in learning tasks is often done by learning a prediction interval or prediction set of the label given the input. Two commonly desired properties for learned prediction sets are valid coverage and good efficiency (such as low length or low cardinality). Conformal prediction is a powerful technique for learning prediction sets with valid coverage, yet by default its conformalization step only learns a single parameter, and does not optimize the efficiency over more expressive function classes.\nIn this paper, we propose a generalization of conformal prediction to multiple learnable parameters, by considering the constrained empirical risk minimization (ERM) problem of finding the most efficient prediction set subject to valid empirical coverage. This meta-algorithm generalizes existing conformal prediction algorithms, and we show that it achieves approximate valid population coverage and near-optimal efficiency within class, whenever the function class in the conformalization step is low-capacity in a certain sense. Next, this ERM problem is challenging to optimize as it involves a non-differentiable coverage constraint. We develop a gradient-based algorithm for it by approximating the original constrained ERM using differentiable surrogate losses and Lagrangians. Experiments show that our algorithm is able to learn valid prediction sets and improve the efficiency significantly over existing approaches in several applications such as prediction intervals with improved length, minimum-volume prediction sets for multi-output regression, and label prediction sets for image classification.\n00footnotetext: Code available at https://github.com/allenbai01/cp-gen.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Physicochemical properties of protein tertiary structure data set",
      "abstract": "",
      "year": "2019",
      "venue": "UCI Machine Learning Repository",
      "authors": ""
    },
    {
      "index": 1,
      "title": "Blogfeedback data set",
      "abstract": "",
      "year": "2019",
      "venue": "UCI Machine Learning Repository",
      "authors": ""
    },
    {
      "index": 2,
      "title": "Facebook comment volume data set",
      "abstract": "",
      "year": "2019",
      "venue": "UCI Machine Learning Repository",
      "authors": ""
    },
    {
      "index": 3,
      "title": "Kinematics of an 8 link robot arm",
      "abstract": "",
      "year": "2021",
      "venue": "DELV Data Repository",
      "authors": ""
    },
    {
      "index": 4,
      "title": "Medical expenditure panel survey, panel 19",
      "abstract": "",
      "year": "2019",
      "venue": "Medical Expenditure Panel Survey",
      "authors": ""
    },
    {
      "index": 5,
      "title": "Medical expenditure panel survey, panel 20",
      "abstract": "",
      "year": "2019",
      "venue": "Medical Expenditure Panel Survey",
      "authors": ""
    },
    {
      "index": 6,
      "title": "Medical expenditure panel survey, panel 21",
      "abstract": "",
      "year": "2019",
      "venue": "Medical Expenditure Panel Survey",
      "authors": ""
    },
    {
      "index": 7,
      "title": "Condition based maintenance of naval propulsion plants data set",
      "abstract": "",
      "year": "2021",
      "venue": "UCI Machine Learning Repository",
      "authors": ""
    },
    {
      "index": 8,
      "title": "Uncertainty sets for image classifiers using conformal prediction",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2009.14193",
      "authors": "Anastasios Angelopoulos, Stephen Bates, Jitendra Malik, and Michael I Jordan"
    },
    {
      "index": 9,
      "title": "A gentle introduction to conformal prediction and distribution-free uncertainty quantification",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2107.07511",
      "authors": "Anastasios N Angelopoulos and Stephen Bates"
    },
    {
      "index": 10,
      "title": "Understanding the under-coverage bias in uncertainty estimation",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2106.05515",
      "authors": "Yu Bai, Song Mei, Huan Wang, and Caiming Xiong"
    },
    {
      "index": 11,
      "title": "Predictive inference with the jackknife+",
      "abstract": "",
      "year": "2021",
      "venue": "The Annals of Statistics",
      "authors": "Rina Foygel Barber, Emmanuel J Candes, Aaditya Ramdas, and Ryan J Tibshirani"
    },
    {
      "index": 12,
      "title": "Prediction and asymptotics",
      "abstract": "",
      "year": "1996",
      "venue": "Bernoulli",
      "authors": "Ole E Barndorff-Nielsen and David R Cox"
    },
    {
      "index": 13,
      "title": "Convexity, classification, and risk bounds",
      "abstract": "",
      "year": "2006",
      "venue": "Journal of the American Statistical Association",
      "authors": "Peter L Bartlett, Michael I Jordan, and Jon D McAuliffe"
    },
    {
      "index": 14,
      "title": "Distribution-free, risk-controlling prediction sets",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2101.02703",
      "authors": "Stephen Bates, Anastasios Angelopoulos, Lihua Lei, Jitendra Malik, and Michael I Jordan"
    },
    {
      "index": 15,
      "title": "Calibrating prediction regions",
      "abstract": "",
      "year": "1990",
      "venue": "Journal of the American Statistical Association",
      "authors": "Rudolf Beran"
    },
    {
      "index": 16,
      "title": "Nonlinear programming",
      "abstract": "",
      "year": "1997",
      "venue": "Journal of the Operational Research Society",
      "authors": "Dimitri P Bertsekas"
    },
    {
      "index": 17,
      "title": "Predictive likelihood: A review",
      "abstract": "",
      "year": "1990",
      "venue": "Statistical Science",
      "authors": "Jan F Bjornstad"
    },
    {
      "index": 18,
      "title": "Openai gym",
      "abstract": "",
      "year": "2016",
      "venue": "",
      "authors": "Greg Brockman, Vicki Cheung, Ludwig Pettersson, Jonas Schneider, John Schulman, Jie Tang, and Wojciech Zaremba"
    },
    {
      "index": 19,
      "title": "Robust validation: Confident predictions even when distributions shift",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2008.04267",
      "authors": "Maxime Cauchois, Suyash Gupta, Alnur Ali, and John C Duchi"
    },
    {
      "index": 20,
      "title": "Knowing what you know: valid confidence sets in multiclass and multilabel prediction",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2004.10181",
      "authors": "Maxime Cauchois, Suyash Gupta, and John Duchi"
    },
    {
      "index": 21,
      "title": "Learning prediction intervals for regression: Generalization and calibration",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Haoxian Chen, Ziyi Huang, Henry Lam, Huajie Qian, and Haofeng Zhang"
    },
    {
      "index": 22,
      "title": "Prediction intervals and empirical bayes confidence intervals",
      "abstract": "",
      "year": "1975",
      "venue": "Journal of Applied Probability",
      "authors": "DR Cox"
    },
    {
      "index": 23,
      "title": "Imagenet: A large-scale hierarchical image database",
      "abstract": "",
      "year": "2009",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei"
    },
    {
      "index": 24,
      "title": "Improving Conditional Coverage via Orthogonal Quantile Regression",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2106.00394",
      "authors": "Shai Feldman, Stephen Bates, and Yaniv Romano",
      "orig_title": "Improving conditional coverage via orthogonal quantile regression",
      "paper_id": "2106.00394v2"
    },
    {
      "index": 25,
      "title": "The limits of distribution-free conditional predictive inference",
      "abstract": "",
      "year": "2021",
      "venue": "Information and Inference: A Journal of the IMA",
      "authors": "Rina Foygel Barber, Emmanuel J Candes, Aaditya Ramdas, and Ryan J Tibshirani"
    },
    {
      "index": 26,
      "title": "D4RL: Datasets for Deep Data-Driven Reinforcement Learning",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Justin Fu, Aviral Kumar, Ofir Nachum, George Tucker, and Sergey Levine",
      "orig_title": "D4rl: Datasets for deep data-driven reinforcement learning",
      "paper_id": "2004.07219v4"
    },
    {
      "index": 27,
      "title": "Dropout as a Bayesian Approximation: Representing Model Uncertainty in Deep Learning",
      "abstract": "",
      "year": "2016",
      "venue": "international conference on machine learning",
      "authors": "Yarin Gal and Zoubin Ghahramani",
      "orig_title": "Dropout as a bayesian approximation: Representing model uncertainty in deep learning",
      "paper_id": "1506.02142v6"
    },
    {
      "index": 28,
      "title": "Conformal prediction with localization",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1908.08558",
      "authors": "Leying Guan"
    },
    {
      "index": 29,
      "title": "Nested conformal prediction and quantile out-of-bag ensemble methods",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1910.10562",
      "authors": "Chirag Gupta, Arun K Kuchibhotla, and Aaditya K Ramdas",
      "orig_title": "Nested conformal prediction and quantile out-of-bag ensemble methods",
      "paper_id": "1910.10562v4"
    },
    {
      "index": 30,
      "title": "On prediction intervals based on predictive likelihood or bootstrap methods",
      "abstract": "",
      "year": "1999",
      "venue": "Biometrika",
      "authors": "Peter Hall, Liang Peng, and Nader Tajvidi"
    },
    {
      "index": 31,
      "title": "Bayes-optimal prediction with frequentist coverage control",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2105.14045",
      "authors": "Peter Hoff"
    },
    {
      "index": 32,
      "title": "Snapshot ensembles: Train 1, get m for free",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1704.00109",
      "authors": "Gao Huang, Yixuan Li, Geoff Pleiss, Zhuang Liu, John E Hopcroft, and Kilian Q Weinberger"
    },
    {
      "index": 33,
      "title": "Flexible distribution-free conditional predictive bands using density estimators",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1910.05575",
      "authors": "Rafael Izbicki, Gilson T Shimizu, and Rafael B Stern",
      "orig_title": "Flexible distribution-free conditional predictive bands using density estimators",
      "paper_id": "1910.05575v2"
    },
    {
      "index": 34,
      "title": "\\cdsplit and \\hpdsplit: efficient conformal regions in high dimensions",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2007.12778",
      "authors": "Rafael Izbicki, Gilson Shimizu, and Rafael B Stern",
      "orig_title": "Cd-split and hpd-split: efficient conformal regions in high dimensions",
      "paper_id": "2007.12778v3"
    },
    {
      "index": 35,
      "title": "What Uncertainties Do We Need in Bayesian Deep Learning for Computer Vision?",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1703.04977",
      "authors": "Alex Kendall and Yarin Gal",
      "orig_title": "What uncertainties do we need in bayesian deep learning for computer vision?",
      "paper_id": "1703.04977v2"
    },
    {
      "index": 36,
      "title": "Adaptive, distribution-free prediction intervals for deep networks",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Danijel Kivaranovic, Kory D Johnson, and Hannes Leeb"
    },
    {
      "index": 37,
      "title": "Simple and Scalable Predictive Uncertainty Estimation using Deep Ensembles",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1612.01474",
      "authors": "Balaji Lakshminarayanan, Alexander Pritzel, and Charles Blundell",
      "orig_title": "Simple and scalable predictive uncertainty estimation using deep ensembles",
      "paper_id": "1612.01474v3"
    },
    {
      "index": 38,
      "title": "Frequentist prediction intervals and predictive distributions",
      "abstract": "",
      "year": "2005",
      "venue": "Biometrika",
      "authors": "JF Lawless and Marc Fredette"
    },
    {
      "index": 39,
      "title": "Distribution-free prediction bands for non-parametric regression",
      "abstract": "",
      "year": "2014",
      "venue": "Journal of the Royal Statistical Society: Series B: Statistical Methodology",
      "authors": "Jing Lei and Larry Wasserman"
    },
    {
      "index": 40,
      "title": "Distribution-free prediction sets",
      "abstract": "",
      "year": "2013",
      "venue": "Journal of the American Statistical Association",
      "authors": "Jing Lei, James Robins, and Larry Wasserman"
    },
    {
      "index": 41,
      "title": "Distribution-free predictive inference for regression",
      "abstract": "",
      "year": "2018",
      "venue": "Journal of the American Statistical Association",
      "authors": "Jing Lei, Max G’Sell, Alessandro Rinaldo, Ryan J Tibshirani, and Larry Wasserman"
    },
    {
      "index": 42,
      "title": "Bayesian methods for adaptive models",
      "abstract": "",
      "year": "1992",
      "venue": "California Institute of Technology",
      "authors": "David John Cameron Mackay"
    },
    {
      "index": 43,
      "title": "A Simple Baseline for Bayesian Uncertainty in Deep Learning",
      "abstract": "",
      "year": "2019",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Wesley J Maddox, Pavel Izmailov, Timur Garipov, Dmitry P Vetrov, and Andrew Gordon Wilson",
      "orig_title": "A simple baseline for bayesian uncertainty in deep learning",
      "paper_id": "1902.02476v2"
    },
    {
      "index": 44,
      "title": "Predictive Uncertainty Estimation via Prior Networks",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv preprint arXiv:1802.10501",
      "authors": "Andrey Malinin and Mark Gales",
      "orig_title": "Predictive uncertainty estimation via prior networks",
      "paper_id": "1802.10501v4"
    },
    {
      "index": 45,
      "title": "Ensemble Distribution Distillation",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1905.00076",
      "authors": "Andrey Malinin, Bruno Mlodozeniec, and Mark Gales",
      "orig_title": "Ensemble distribution distillation",
      "paper_id": "1905.00076v3"
    },
    {
      "index": 46,
      "title": "The tight constant in the dvoretzky-kiefer-wolfowitz inequality",
      "abstract": "",
      "year": "1990",
      "venue": "The annals of Probability",
      "authors": "Pascal Massart"
    },
    {
      "index": 47,
      "title": "Can You Trust Your Model’s Uncertainty? Evaluating Predictive Uncertainty Under Dataset Shift",
      "abstract": "",
      "year": "2019",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Yaniv Ovadia, Emily Fertig, Jie Ren, Zachary Nado, David Sculley, Sebastian Nowozin, Joshua Dillon, Balaji Lakshminarayanan, and Jasper Snoek",
      "orig_title": "Can you trust your model’s uncertainty? evaluating predictive uncertainty under dataset shift",
      "paper_id": "1906.02530v2"
    },
    {
      "index": 48,
      "title": "Inductive conformal prediction: Theory and application to neural networks",
      "abstract": "",
      "year": "2008",
      "venue": "Tools in artificial intelligence",
      "authors": "Harris Papadopoulos"
    },
    {
      "index": 49,
      "title": "Pac confidence sets for deep neural networks via calibrated prediction",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:2001.00106",
      "authors": "Sangdon Park, Osbert Bastani, Nikolai Matni, and Insup Lee"
    },
    {
      "index": 50,
      "title": "High-quality prediction intervals for deep learning: A distribution-free, ensembled approach",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Machine Learning",
      "authors": "Tim Pearce, Alexandra Brintrup, Mohamed Zaki, and Andy Neely"
    },
    {
      "index": 51,
      "title": "Do ImageNet Classifiers Generalize to ImageNet?",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Machine Learning",
      "authors": "Benjamin Recht, Rebecca Roelofs, Ludwig Schmidt, and Vaishaal Shankar",
      "orig_title": "Do imagenet classifiers generalize to imagenet?",
      "paper_id": "1902.10811v2"
    },
    {
      "index": 52,
      "title": "Conformalized quantile regression",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1905.03222",
      "authors": "Yaniv Romano, Evan Patterson, and Emmanuel J Candès"
    },
    {
      "index": 53,
      "title": "Classification with valid and adaptive coverage",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2006.02544",
      "authors": "Yaniv Romano, Matteo Sesia, and Emmanuel J Candès"
    },
    {
      "index": 54,
      "title": "Least Ambiguous Set-Valued Classifiers with Bounded Error Levels",
      "abstract": "",
      "year": "2019",
      "venue": "Journal of the American Statistical Association",
      "authors": "Mauricio Sadinle, Jing Lei, and Larry Wasserman",
      "orig_title": "Least ambiguous set-valued classifiers with bounded error levels",
      "paper_id": "1609.00451v2"
    },
    {
      "index": 55,
      "title": "A tutorial on conformal prediction",
      "abstract": "",
      "year": "2008",
      "venue": "Journal of Machine Learning Research",
      "authors": "Glenn Shafer and Vladimir Vovk"
    },
    {
      "index": 56,
      "title": "Methods to compute prediction intervals: A review and new results",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2011.03065",
      "authors": "Qinglong Tian, Daniel J Nordman, and William Q Meeker"
    },
    {
      "index": 57,
      "title": "A note on bounds for vc dimensions",
      "abstract": "",
      "year": "2009",
      "venue": "Institute of Mathematical Statistics collections",
      "authors": "Aad Van Der Vaart and Jon A Wellner"
    },
    {
      "index": 58,
      "title": "High-dimensional probability: An introduction with applications in data science, volume 47",
      "abstract": "",
      "year": "2018",
      "venue": "Cambridge university press",
      "authors": "Roman Vershynin"
    },
    {
      "index": 59,
      "title": "Conditional validity of inductive conformal predictors",
      "abstract": "",
      "year": "2012",
      "venue": "Asian conference on machine learning",
      "authors": "Vladimir Vovk"
    },
    {
      "index": 60,
      "title": "Cross-conformal predictors",
      "abstract": "",
      "year": "2015",
      "venue": "Annals of Mathematics and Artificial Intelligence",
      "authors": "Vladimir Vovk"
    },
    {
      "index": 61,
      "title": "Algorithmic learning in a random world",
      "abstract": "",
      "year": "2005",
      "venue": "Springer Science & Business Media",
      "authors": "Vladimir Vovk, Alexander Gammerman, and Glenn Shafer"
    },
    {
      "index": 62,
      "title": "Cross-conformal predictive distributions",
      "abstract": "",
      "year": "2018",
      "venue": "Conformal and Probabilistic Prediction and Applications",
      "authors": "Vladimir Vovk, Ilia Nouretdinov, Valery Manokhin, and Alexander Gammerman"
    },
    {
      "index": 63,
      "title": "Machine-learning applications of algorithmic randomness",
      "abstract": "",
      "year": "1999",
      "venue": "",
      "authors": "Volodya Vovk, Alexander Gammerman, and Craig Saunders"
    },
    {
      "index": 64,
      "title": "Finite-sample efficient conformal prediction",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2104.13871",
      "authors": "Yachong Yang and Arun Kumar Kuchibhotla"
    }
  ]
}