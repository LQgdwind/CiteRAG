{
  "paper_id": "2102.08248v7",
  "title": "Hierarchical VAEs Know What They Don’t Know",
  "abstract": "Abstract\nDeep generative models have been demonstrated as state-of-the-art density estimators.\nYet, recent work has found that they often assign a higher likelihood to data from outside the training distribution.\nThis seemingly paradoxical behavior has caused concerns over the quality of the attained density estimates.\nIn the context of hierarchical variational autoencoders, we provide evidence to explain this behavior by out-of-distribution data having in-distribution low-level features.\nWe argue that this is both expected and desirable behavior.\nWith this insight in hand, we develop a fast, scalable and fully unsupervised likelihood-ratio score for OOD detection that requires data to be in-distribution across all feature-levels.\nWe benchmark the method on a vast set of data and model combinations and achieve state-of-the-art results on out-of-distribution detection.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Uncertainty in the Variational Information Bottleneck",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv",
      "authors": "Alemi, A. A., Fischer, I., and Dillon, J. V.",
      "orig_title": "Uncertainty in the Variational Information Bottleneck",
      "paper_id": "1807.00906v1"
    },
    {
      "index": 1,
      "title": "Representation learning: A review and new perspectives",
      "abstract": "",
      "year": "2013",
      "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence",
      "authors": "Bengio, Y., Courville, A. C., and Vincent, P."
    },
    {
      "index": 2,
      "title": "Novelty Detection and Neural-Network Validation",
      "abstract": "",
      "year": "1994",
      "venue": "IEE Proceedings - Vision, Image and Signal Processing",
      "authors": "Bishop, C. M."
    },
    {
      "index": 3,
      "title": "notMNIST dataset",
      "abstract": "",
      "year": "2011",
      "venue": "",
      "authors": "Bulatov, Y."
    },
    {
      "index": 4,
      "title": "Importance Weighted Autoencoders",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Learning Representations",
      "authors": "Burda, Y., Grosse, R., and Salakhutdinov, R. R.",
      "orig_title": "Importance Weighted Autoencoders",
      "paper_id": "1509.00519v4"
    },
    {
      "index": 5,
      "title": "The likelihood ratio, Wald, and Lagrange multiplier tests: An expository note",
      "abstract": "",
      "year": "1982",
      "venue": "The American Statistician",
      "authors": "Buse, A."
    },
    {
      "index": 6,
      "title": "Very Deep VAEs Generalize Autoregressive Models and Can Outperform Them on Images",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Learning Representations",
      "authors": "Child, R.",
      "orig_title": "Very Deep VAEs Generalize Autoregressive Models and Can Outperform Them on Images",
      "paper_id": "2011.10650v2"
    },
    {
      "index": 7,
      "title": "WAIC, but Why? Generative Ensembles for Robust Anomaly Detection",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv",
      "authors": "Choi, H., Jang, E., and Alemi, A. A.",
      "orig_title": "WAIC, but Why? Generative Ensembles for Robust Anomaly Detection",
      "paper_id": "1810.01392v4"
    },
    {
      "index": 8,
      "title": "Deep Learning for Classical Japanese Literature",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv",
      "authors": "Clanuwat, T., Bober-Irizar, M., Kitamoto, A., Lamb, A., Yamamoto, K., and Ha, D.",
      "orig_title": "Deep Learning for Classical Japanese Literature",
      "paper_id": "1812.01718v1"
    },
    {
      "index": 9,
      "title": "Inference Suboptimality in Variational Autoencoders",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Machine Learning",
      "authors": "Cremer, C., Li, X., and Duvenaud, D.",
      "orig_title": "Inference Suboptimality in Variational Autoencoders",
      "paper_id": "1801.03558v3"
    },
    {
      "index": 10,
      "title": "Learning Confidence for Out-of-Distribution Detection in Neural Networks",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv",
      "authors": "DeVries, T. and Taylor, G. W.",
      "orig_title": "Learning Confidence for Out-of-Distribution Detection in Neural Networks",
      "paper_id": "1802.04865v1"
    },
    {
      "index": 11,
      "title": "Avoiding latent variable collapse with generative skip models",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Dieng, A. B., Kim, Y., Rush, A. M., and Blei, D. M."
    },
    {
      "index": 12,
      "title": "Neocognitron: A Self-organizing Neural Network Model for a Mechanism of Pattern Recognition Unaffected by Shift in Position",
      "abstract": "",
      "year": "1980",
      "venue": "Biological Cybernetics",
      "authors": "Fukushima, K."
    },
    {
      "index": 13,
      "title": "Explaining and Harnessing Adversarial Examples",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Learning Representations",
      "authors": "Goodfellow, I. J., Shlens, J., and Szegedy, C.",
      "orig_title": "Explaining and harnessing adversarial examples",
      "paper_id": "1412.6572v3"
    },
    {
      "index": 14,
      "title": "A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Learning Representations",
      "authors": "Hendrycks, D. and Gimpel, K.",
      "orig_title": "A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks",
      "paper_id": "1610.02136v3"
    },
    {
      "index": 15,
      "title": "Deep Anomaly Detection with Outlier Exposure",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Learning Representations",
      "authors": "Hendrycks, D., Mazeika, M., and Dietterich, T. G.",
      "orig_title": "Deep anomaly detection with outlier exposure",
      "paper_id": "1812.04606v3"
    },
    {
      "index": 16,
      "title": "Flow++: Improving Flow-Based Generative Models with Variational Dequantization and Architecture Design",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Machine Learning",
      "authors": "Ho, J., Chen, X., Srinivas, A., Duan, Y., and Abbeel, P.",
      "orig_title": "Flow++: Improving Flow-Based Generative Models with Variational Dequantization and Architecture Design",
      "paper_id": "1902.00275v2"
    },
    {
      "index": 17,
      "title": "Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Machine Learning",
      "authors": "Ioffe, S. and Szegedy, C."
    },
    {
      "index": 18,
      "title": "Adam: A Method for Stochastic Optimization",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference for Learning Representations",
      "authors": "Kingma, D. P. and Ba, J. L."
    },
    {
      "index": 19,
      "title": "Glow: Generative Flow with Invertible 1×1 Convolutions",
      "abstract": "",
      "year": "2018",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Kingma, D. P. and Dhariwal, P.",
      "orig_title": "Glow: Generative Flow with Invertible 1×1 Convolutions",
      "paper_id": "1807.03039v2"
    },
    {
      "index": 20,
      "title": "Auto-Encoding Variational Bayes",
      "abstract": "",
      "year": "2014",
      "venue": "International Conference on Learning Representations",
      "authors": "Kingma, D. P. and Welling, M."
    },
    {
      "index": 21,
      "title": "Semi-supervised Learning with Deep Generative Models",
      "abstract": "",
      "year": "2014",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Kingma, D. P., Rezende, D. J., Mohamed, S., and Welling, M.",
      "orig_title": "Semi-Supervised Learning with Deep Generative Models",
      "paper_id": "1406.5298v2"
    },
    {
      "index": 22,
      "title": "Improved variational inference with inverse autoregressive flow",
      "abstract": "",
      "year": "2016",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Kingma, D. P., Salimans, T., Jozefowicz, R., Chen, X., Sutskever, I., and Welling, M."
    },
    {
      "index": 23,
      "title": "Variational Graph Auto-Encoders",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv",
      "authors": "Kipf, T. N. and Welling, M."
    },
    {
      "index": 24,
      "title": "Learning Multiple Layers of Features from Tiny Images",
      "abstract": "",
      "year": "2009",
      "venue": "University of Toronto",
      "authors": "Krizhevsky, A."
    },
    {
      "index": 25,
      "title": "Human-level concept learning through probabilistic program induction",
      "abstract": "",
      "year": "2015",
      "venue": "Science",
      "authors": "Lake, B. M., Salakhutdinov, R., and Tenenbaum, J. B."
    },
    {
      "index": 26,
      "title": "Simple and Scalable Predictive Uncertainty Estimation using Deep Ensembles",
      "abstract": "",
      "year": "2017",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Lakshminarayanan, B., Pritzel, A., and Blundell, C.",
      "orig_title": "Simple and Scalable Predictive Uncertainty Estimation using Deep Ensembles",
      "paper_id": "1612.01474v3"
    },
    {
      "index": 27,
      "title": "Learning methods for generic object recognition with invariance to pose and lighting",
      "abstract": "",
      "year": "2004",
      "venue": "IEEE Computer Society Conference on Computer Vision and Pattern Recognition",
      "authors": "LeCun, Y., Huang, F., and Bottou, L."
    },
    {
      "index": 28,
      "title": "Gradient-based learning applied to document recognition",
      "abstract": "",
      "year": "1998",
      "venue": "Proceedings of the IEEE",
      "authors": "LeCun, Y. A., Bottou, L., Bengio, Y., and Haffner, P."
    },
    {
      "index": 29,
      "title": "A Simple Unified Framework for Detecting Out-of-Distribution Samples and Adversarial Attacks",
      "abstract": "",
      "year": "2018",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Lee, K., Lee, K., Lee, H., and Shin, J.",
      "orig_title": "A Simple Unified Framework for Detecting Out-of-Distribution Samples and Adversarial Attacks",
      "paper_id": "1807.03888v2"
    },
    {
      "index": 30,
      "title": "Enhancing The Reliability of Out-of-distribution Image Detection in Neural Networks",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Learning Representations",
      "authors": "Liang, S., Li, Y., and Srikant, R.",
      "orig_title": "Enhancing the reliability of out-of-distribution image detection in neural networks",
      "paper_id": "1706.02690v5"
    },
    {
      "index": 31,
      "title": "Auxiliary Deep Generative Models",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Machine Learning",
      "authors": "Maaløe, L., Sønderby, C. K., Sønderby, S. K., and Winther, O.",
      "orig_title": "Auxiliary deep generative models",
      "paper_id": "1602.05473v4"
    },
    {
      "index": 32,
      "title": "Semi-Supervised Generation with Cluster-aware Generative Models",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv",
      "authors": "Maaløe, L., Fraccaro, M., and Winther, O.",
      "orig_title": "Semi-Supervised Generation with Cluster-aware Generative Models",
      "paper_id": "1704.00637v1"
    },
    {
      "index": 33,
      "title": "BIVA: A Very Deep Hierarchy of Latent Variables for Generative Modeling",
      "abstract": "",
      "year": "2019",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Maaløe, L., Fraccaro, M., Liévin, V., and Winther, O."
    },
    {
      "index": 34,
      "title": "Information theory, inference, and learning algorithms",
      "abstract": "",
      "year": "2003",
      "venue": "Cambridge University Press",
      "authors": "MacKay, D. J. C."
    },
    {
      "index": 35,
      "title": "Refit your encoder when new data comes by",
      "abstract": "",
      "year": "2018",
      "venue": "NeurIPS Workshop on Bayesian Deep Learning",
      "authors": "Mattei, P.-A. and Frellsen, J."
    },
    {
      "index": 36,
      "title": "Aspects of multivariate statistical theory, volume 197",
      "abstract": "",
      "year": "2009",
      "venue": "John Wiley & Sons",
      "authors": "Muirhead, R. J."
    },
    {
      "index": 37,
      "title": "Rectified linear units improve restricted boltzmann machines",
      "abstract": "",
      "year": "2010",
      "venue": "International Conference on Machine Learning",
      "authors": "Nair, V. and Hinton, G. E."
    },
    {
      "index": 38,
      "title": "Do Deep Generative Models Know What They Don’t Know?",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Learning Representations",
      "authors": "Nalisnick, E., Matsukawa, A., Teh, Y. W., Gorur, D., and Lakshminarayanan, B.",
      "orig_title": "Do Deep Generative Models Know What They Don’t Know?",
      "paper_id": "1810.09136v3"
    },
    {
      "index": 39,
      "title": "Detecting Out-of-Distribution Inputs to Deep Generative Models Using Typicality",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv",
      "authors": "Nalisnick, E., Matsukawa, A., Teh, Y. W., and Lakshminarayanan, B.",
      "orig_title": "Detecting Out-of-Distribution Inputs to Deep Generative Models Using Typicality",
      "paper_id": "1906.02994v2"
    },
    {
      "index": 40,
      "title": "Reading Digits in Natural Images with Unsupervised Feature Learning",
      "abstract": "",
      "year": "2011",
      "venue": "NeurIPS Workshop on Deep Learning and Unsupervised Feature Learning",
      "authors": "Netzer, Y., Wang, T., Coates, A., Bissacco, A., Wu, B., and Ng, A. Y."
    },
    {
      "index": 41,
      "title": "Deep Neural Networks are Easily Fooled: High Confidence Predictions for Unrecognizable Images",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Nguyen, A., Yosinski, J., and Clune, J.",
      "orig_title": "Deep neural networks are easily fooled: High confidence predictions for unrecognizable images",
      "paper_id": "1412.1897v4"
    },
    {
      "index": 42,
      "title": "WaveNet: A Generative Model for Raw Audio",
      "abstract": "",
      "year": "2016",
      "venue": "ISCA Speech Synthesis Workshop",
      "authors": "Oord, A. v. d., Dieleman, S., Zen, H., Simonyan, K., Vinyals, O., Graves, A., Kalchbrenner, N., Senior, A., and Kavukcuoglu, K.",
      "orig_title": "WaveNet: A Generative Model for Raw Audio",
      "paper_id": "1609.03499v2"
    },
    {
      "index": 43,
      "title": "Pixel Recurrent Neural Networks",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Machine Learning",
      "authors": "Oord, A. v. d., Kalchbrenner, N., and Kavukcuoglu, K.",
      "orig_title": "Pixel Recurrent Neural Networks",
      "paper_id": "1601.06759v3"
    },
    {
      "index": 44,
      "title": "Automatic differentiation in PyTorch",
      "abstract": "",
      "year": "2017",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Paszke, A., Chanan, G., Lin, Z., Gross, S., Yang, E., Antiga, L., and Devito, Z."
    },
    {
      "index": 45,
      "title": "Likelihood Ratios for Out-of-Distribution Detection",
      "abstract": "",
      "year": "2019",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Ren, J., Liu, P. J., Fertig, E., Snoek, J., Poplin, R., Depristo, M., Dillon, J., and Lakshminarayanan, B.",
      "orig_title": "Likelihood Ratios for Out-of-Distribution Detection",
      "paper_id": "1906.02845v2"
    },
    {
      "index": 46,
      "title": "Variational Inference with Normalizing Flows",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Machine Learning",
      "authors": "Rezende, D. J. and Mohamed, S."
    },
    {
      "index": 47,
      "title": "Stochastic Backpropagation and Approximate Inference in Deep Generative Models",
      "abstract": "",
      "year": "2014",
      "venue": "Proceedings of Machine Learning Research",
      "authors": "Rezende, D. J., Mohamed, S., and Wierstra, D."
    },
    {
      "index": 48,
      "title": "Weight Normalization: A Simple Reparameterization to Accelerate Training of Deep Neural Networks",
      "abstract": "",
      "year": "2016",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Salimans, T. and Kingma, D. P."
    },
    {
      "index": 49,
      "title": "PixelCNN++: Improving the PixelCNN with Discretized Logistic Mixture Likelihood and Other Modifications",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Learning Representations",
      "authors": "Salimans, T., Karpathy, A., Chen, X., and Kingma, D. P."
    },
    {
      "index": 50,
      "title": "Understanding Anomaly Detection with Deep Invertible Networks through Hierarchies of Distributions and Features",
      "abstract": "",
      "year": "2020",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Schirrmeister, R., Zhou, Y., Ball, T., and Zhang, D.",
      "orig_title": "Understanding anomaly detection with deep invertible networks through hierarchies of distributions and features",
      "paper_id": "2006.10848v3"
    },
    {
      "index": 51,
      "title": "Input Complexity and Out-of-distribution Detection with Likelihood-based Generative Models",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Learning Representations",
      "authors": "Serrà, J., Álvarez, D., Gómez, V., Slizovskaia, O., Núñez, J. F., and Luque, J.",
      "orig_title": "Input complexity and out-of-distribution detection with likelihood-based generative models",
      "paper_id": "1909.11480v3"
    },
    {
      "index": 52,
      "title": "A Mathematical Theory of Communication",
      "abstract": "",
      "year": "1948",
      "venue": "The Bell System Technical Journal",
      "authors": "Shannon, C. E."
    },
    {
      "index": 53,
      "title": "Ladder Variational Autoencoders",
      "abstract": "",
      "year": "2016",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Sønderby, C. K., Raiko, T., Maaløe, L., Sønderby, S. K., and Winther, O."
    },
    {
      "index": 54,
      "title": "A note on the evaluation of generative models",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Learning Representations",
      "authors": "Theis, L., Oord, A. v. d., and Bethge, M.",
      "orig_title": "A note on the evaluation of generative models",
      "paper_id": "1511.01844v3"
    },
    {
      "index": 55,
      "title": "Practical Lossless Compression with Latent Variables using Bits Back Coding",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Learning Representations",
      "authors": "Townsend, J., Bird, T., and Barber, D.",
      "orig_title": "Practical Lossless Compression With Latent Variables Using Bits Back Coding",
      "paper_id": "1901.04866v1"
    },
    {
      "index": 56,
      "title": "NVAE: A Deep Hierarchical Variational Autoencoder",
      "abstract": "",
      "year": "2020",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Vahdat, A. and Kautz, J.",
      "orig_title": "NVAE: A Deep Hierarchical Variational Autoencoder",
      "paper_id": "2007.03898v3"
    },
    {
      "index": 57,
      "title": "Conditional image generation with PixelCNN decoders",
      "abstract": "",
      "year": "2016",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "van den Oord, A., Kalchbrenner, N., Espeholt, L., Kavukcuoglu, K., Vinyals, O., and Graves, A."
    },
    {
      "index": 58,
      "title": "Fashion-MNIST: a Novel Image Dataset for Benchmarking Machine Learning Algorithms",
      "abstract": "",
      "year": "2017",
      "venue": "",
      "authors": "Xiao, H., Rasul, K., and Vollgraf, R.",
      "orig_title": "Fashion-MNIST: a Novel Image Dataset for Benchmarking Machine Learning Algorithms",
      "paper_id": "1708.07747v2"
    },
    {
      "index": 59,
      "title": "Likelihood Regret: An Out-of-Distribution Detection Score For Variational Auto-encoder",
      "abstract": "",
      "year": "2020",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Xiao, Z., Yan, Q., and Amit, Y.",
      "orig_title": "Likelihood Regret: An Out-of-Distribution Detection Score for Variational Auto-Encoder",
      "paper_id": "2003.02977v3"
    }
  ]
}