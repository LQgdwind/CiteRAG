{
  "paper_id": "2209.07148v3",
  "title": "Semi-Counterfactual Risk Minimization Via Neural Networks",
  "abstract": "Abstract\nCounterfactual risk minimization is a framework for offline policy optimization with logged data which consists of context, action, propensity score, and reward for each sample point.\nIn this work, we build on this framework and propose a learning method for settings where the rewards for some samples are not observed, and so the logged data consists of a subset of samples with unknown rewards and a subset of samples with known rewards. This setting arises in many application domains, including advertising and healthcare. While reward feedback is missing for some samples, it is possible to leverage the unknown-reward samples in order to minimize the risk, and we refer to this setting as semi-counterfactual risk minimization.\nTo approach this kind of learning problem,\nwe derive new upper bounds on the true risk under the inverse propensity score estimator. We then build upon these bounds to propose a regularized counterfactual risk minimization method, where the regularization term is based on the logged unknown-rewards dataset only; hence it is reward-independent. We also propose another algorithm based on generating pseudo-rewards for the logged unknown-rewards dataset. Experimental results with neural networks and benchmark datasets indicate that these algorithms can leverage the logged unknown-rewards dataset besides the logged known-reward dataset.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Apprenticeship learning via inverse reinforcement learning",
      "abstract": "",
      "year": "2004",
      "venue": "twenty-first international conference on Machine learning",
      "authors": "Pieter Abbeel and Andrew¬†Y Ng"
    },
    {
      "index": 1,
      "title": "Recommender systems, volume¬†1",
      "abstract": "",
      "year": "2016",
      "venue": "Springer",
      "authors": "Charu¬†C Aggarwal et¬†al."
    },
    {
      "index": 2,
      "title": "Bayesian Inference of Individualized Treatment Effects using Multi-task Gaussian Processes",
      "abstract": "",
      "year": "2017",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Ahmed¬†M Alaa and Mihaela van¬†der Schaar",
      "orig_title": "Bayesian inference of individualized treatment effects using multi-task gaussian processes",
      "paper_id": "1704.02801v2"
    },
    {
      "index": 3,
      "title": "An exact characterization of the generalization error for the gibbs algorithm",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Gholamali Aminian, Yuheng Bu, Laura Toni, Miguel Rodrigues, and Gregory Wornell"
    },
    {
      "index": 4,
      "title": "An information-theoretical approach to semi-supervised learning under covariate-shift",
      "abstract": "",
      "year": "2022",
      "venue": "AISTATS",
      "authors": "Gholamali Aminian, Mahed Abroshan, Mohammad¬†Mahdi Khalili, Laura Toni, and Miguel¬†RD Rodrigues"
    },
    {
      "index": 5,
      "title": "Counterfactual policy optimization using domain-adversarial neural networks",
      "abstract": "",
      "year": "2018",
      "venue": "ICML CausalML workshop",
      "authors": "Onur Atan, William¬†R Zame, and Mihaela Van Der¬†Schaar"
    },
    {
      "index": 6,
      "title": "Personalized diabetes management using electronic medical records",
      "abstract": "",
      "year": "2017",
      "venue": "Diabetes care",
      "authors": "Dimitris Bertsimas, Nathan Kallus, Alexander¬†M Weinstein, and Ying¬†Daisy Zhuo"
    },
    {
      "index": 7,
      "title": "The offset tree for learning with partial labels",
      "abstract": "",
      "year": "2009",
      "venue": "15th ACM SIGKDD international conference on Knowledge discovery and data mining",
      "authors": "Alina Beygelzimer and John Langford"
    },
    {
      "index": 8,
      "title": "Counterfactual reasoning and learning systems: The example of computational advertising",
      "abstract": "",
      "year": "2013",
      "venue": "Journal of Machine Learning Research",
      "authors": "L√©on Bottou, Jonas Peters, Joaquin Qui√±onero-Candela, Denis¬†X Charles, D¬†Max Chickering, Elon Portugaly, Dipankar Ray, Patrice Simard, and Ed¬†Snelson"
    },
    {
      "index": 9,
      "title": "Concentration inequalities: A nonasymptotic theory of independence",
      "abstract": "",
      "year": "2013",
      "venue": "Oxford university press",
      "authors": "St√©phane Boucheron, G√°bor Lugosi, and Pascal Massart"
    },
    {
      "index": 10,
      "title": "Identifiability in inverse reinforcement learning",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Haoyang Cao, Samuel Cohen, and Lukasz Szpruch",
      "orig_title": "Identifiability in inverse reinforcement learning",
      "paper_id": "2106.03498v3"
    },
    {
      "index": 11,
      "title": "Locally weighted regression: an approach to regression analysis by local fitting",
      "abstract": "",
      "year": "1988",
      "venue": "Journal of the American statistical association",
      "authors": "William¬†S Cleveland and Susan¬†J Devlin"
    },
    {
      "index": 12,
      "title": "Learning bounds for importance weighting",
      "abstract": "",
      "year": "2010",
      "venue": "Nips",
      "authors": "Corinna Cortes, Yishay Mansour, and Mehryar Mohri"
    },
    {
      "index": 13,
      "title": "Information Theory: Coding Theorems for Discrete Memoryless Systems",
      "abstract": "",
      "year": "2011",
      "venue": "Cambridge University Press",
      "authors": "Imre Csisz√°r and J√°nos K√∂rner"
    },
    {
      "index": 14,
      "title": "Propensity score methods for bias reduction in the comparison of a treatment to a non-randomized control group",
      "abstract": "",
      "year": "1998",
      "venue": "Statistics in medicine",
      "authors": "Ralph¬†B D‚ÄôAgostino¬†Jr"
    },
    {
      "index": 15,
      "title": "Doubly robust policy evaluation and optimization",
      "abstract": "",
      "year": "2014",
      "venue": "Statistical Science",
      "authors": "Miroslav Dud√≠k, Dumitru Erhan, John Langford, and Lihong Li"
    },
    {
      "index": 16,
      "title": "Distributionally Robust Counterfactual Risk Minimization",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "Louis Faury, Ugo Tanielian, Elvis Dohmatob, Elena Smirnova, and Flavian Vasile",
      "orig_title": "Distributionally robust counterfactual risk minimization",
      "paper_id": "1906.06211v2"
    },
    {
      "index": 17,
      "title": "Guided Cost Learning: Deep Inverse Optimal Control via Policy Optimization",
      "abstract": "",
      "year": "2016",
      "venue": "International conference on machine learning",
      "authors": "Chelsea Finn, Sergey Levine, and Pieter Abbeel",
      "orig_title": "Guided cost learning: Deep inverse optimal control via policy optimization",
      "paper_id": "1603.00448v3"
    },
    {
      "index": 18,
      "title": "Enhancing Counterfactual Classification via Self-Training",
      "abstract": "",
      "year": "2022",
      "venue": "AAAI conference on artificial intelligence",
      "authors": "Ruijiang Gao, Max Biggs, Wei Sun, and Ligong Han",
      "orig_title": "Enhancing counterfactual classification via self-training",
      "paper_id": "2112.04461v1"
    },
    {
      "index": 19,
      "title": "Semi-supervised learning by entropy minimization",
      "abstract": "",
      "year": "2005",
      "venue": "CAP",
      "authors": "Yves Grandvalet, Yoshua Bengio, et¬†al."
    },
    {
      "index": 20,
      "title": "Information-theoretic generalization bounds for iterative semi-supervised learning",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2110.00926",
      "authors": "Haiyun He, Hanshu Yan, and Vincent¬†YF Tan"
    },
    {
      "index": 21,
      "title": "Complete convergence and the law of large numbers",
      "abstract": "",
      "year": "1947",
      "venue": "National Academy of Sciences of the United States of America",
      "authors": "Pao-Lu Hsu and Herbert Robbins"
    },
    {
      "index": 22,
      "title": "Truncated importance sampling",
      "abstract": "",
      "year": "2008",
      "venue": "Journal of Computational and Graphical Statistics",
      "authors": "Edward¬†L Ionides"
    },
    {
      "index": 23,
      "title": "Categorical reparameterization with gumbel-softmax",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1611.01144",
      "authors": "Eric Jang, Shixiang Gu, and Ben Poole"
    },
    {
      "index": 24,
      "title": "Deep learning with logged bandit feedback",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Learning Representations",
      "authors": "Thorsten Joachims, Adith Swaminathan, and Maarten de¬†Rijke"
    },
    {
      "index": 25,
      "title": "Learning representations for counterfactual inference",
      "abstract": "",
      "year": "2016",
      "venue": "International conference on machine learning",
      "authors": "Fredrik Johansson, Uri Shalit, and David Sontag"
    },
    {
      "index": 26,
      "title": "Balanced Policy Evaluation and Learning",
      "abstract": "",
      "year": "2018",
      "venue": "Advances in neural information processing systems",
      "authors": "Nathan Kallus",
      "orig_title": "Balanced policy evaluation and learning",
      "paper_id": "1705.07384v2"
    },
    {
      "index": 27,
      "title": "Semi-supervised reward learning for offline reinforcement learning",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2012.06899",
      "authors": "Ksenia Konyushkova, Konrad Zolna, Yusuf Aytar, Alexander Novikov, Scott Reed, Serkan Cabi, and Nando de¬†Freitas",
      "orig_title": "Semi-supervised reward learning for offline reinforcement learning",
      "paper_id": "2012.06899v1"
    },
    {
      "index": 28,
      "title": "Precision medicine",
      "abstract": "",
      "year": "2019",
      "venue": "Annual review of statistics and its application",
      "authors": "Michael¬†R Kosorok and Eric¬†B Laber"
    },
    {
      "index": 29,
      "title": "Learning multiple layers of features from tiny images",
      "abstract": "",
      "year": "2009",
      "venue": "",
      "authors": "Alex Krizhevsky, Geoffrey Hinton, et¬†al."
    },
    {
      "index": 30,
      "title": "Confident off-policy evaluation and selection through self-normalized importance weighting",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Ilja Kuzborskij, Claire Vernade, Andras Gyorgy, and Csaba Szepesv√°ri"
    },
    {
      "index": 31,
      "title": "Exploration scavenging",
      "abstract": "",
      "year": "2008",
      "venue": "25th international conference on Machine learning",
      "authors": "John Langford, Alexander Strehl, and Jennifer Wortman"
    },
    {
      "index": 32,
      "title": "Improving propensity score weighting using machine learning",
      "abstract": "",
      "year": "2010",
      "venue": "Statistics in medicine",
      "authors": "Brian¬†K Lee, Justin Lessler, and Elizabeth¬†A Stuart"
    },
    {
      "index": 33,
      "title": "Weight trimming and propensity score weighting",
      "abstract": "",
      "year": "2011",
      "venue": "PloS one",
      "authors": "Brian¬†K Lee, Justin Lessler, and Elizabeth¬†A Stuart"
    },
    {
      "index": 34,
      "title": "Pseudo-label: The simple and efficient semi-supervised learning method for deep neural networks",
      "abstract": "",
      "year": "2013",
      "venue": "Workshop on Challenges in Representation Learning, ICML",
      "authors": "Dong-Hyun Lee et¬†al."
    },
    {
      "index": 35,
      "title": "Unbiased offline evaluation of contextual-bandit-based news article recommendation algorithms",
      "abstract": "",
      "year": "2011",
      "venue": "fourth ACM international conference on Web search and data mining",
      "authors": "Lihong Li, Wei Chu, John Langford, and Xuanhui Wang"
    },
    {
      "index": 36,
      "title": "Bayesian Counterfactual Risk Minimization",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv:1806.11500",
      "authors": "Ben London and Ted Sandler",
      "orig_title": "Bayesian counterfactual risk minimization",
      "paper_id": "1806.11500v6"
    },
    {
      "index": 37,
      "title": "Empirical bernstein bounds and sample variance penalization",
      "abstract": "",
      "year": "2009",
      "venue": "22nd Conference on Learning Theory (COLT) 2009.",
      "authors": "Andreas Maurer and Massimiliano Pontil"
    },
    {
      "index": 38,
      "title": "Propensity score estimation with boosted regression for evaluating causal effects in observational studies",
      "abstract": "",
      "year": "2004",
      "venue": "Psychological methods",
      "authors": "Daniel¬†F McCaffrey, Greg Ridgeway, and Andrew¬†R Morral"
    },
    {
      "index": 39,
      "title": "Optimistic policy optimization via multiple importance sampling",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Machine Learning",
      "authors": "Matteo Papini, Alberto¬†Maria Metelli, Lorenzo Lupo, and Marcello Restelli"
    },
    {
      "index": 40,
      "title": "Lecture notes on information theory",
      "abstract": "",
      "year": "2014",
      "venue": "Lecture Notes for ECE563 (UIUC)",
      "authors": "Yury Polyanskiy and Yihong Wu"
    },
    {
      "index": 41,
      "title": "The central role of the propensity score in observational studies for causal effects",
      "abstract": "",
      "year": "1983",
      "venue": "Biometrika",
      "authors": "Paul¬†R Rosenbaum and Donald¬†B Rubin"
    },
    {
      "index": 42,
      "title": "ùëì-Divergence Inequalities",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Transactions on Information Theory",
      "authors": "Igal Sason and Sergio Verd√∫",
      "orig_title": "fùëìf-divergence inequalities",
      "paper_id": "1508.00335v7"
    },
    {
      "index": 43,
      "title": "Trust Region Policy Optimization",
      "abstract": "",
      "year": "2015",
      "venue": "International conference on machine learning",
      "authors": "John Schulman, Sergey Levine, Pieter Abbeel, Michael Jordan, and Philipp Moritz",
      "orig_title": "Trust region policy optimization",
      "paper_id": "1502.05477v5"
    },
    {
      "index": 44,
      "title": "Evaluating uses of data mining techniques in propensity score estimation: a simulation study",
      "abstract": "",
      "year": "2008",
      "venue": "Pharmacoepidemiology and drug safety",
      "authors": "Soko Setoguchi, Sebastian Schneeweiss, M¬†Alan Brookhart, Robert¬†J Glynn, and E¬†Francis Cook"
    },
    {
      "index": 45,
      "title": "Estimating individual treatment effect: generalization bounds and algorithms",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Machine Learning",
      "authors": "Uri Shalit, Fredrik¬†D Johansson, and David Sontag",
      "orig_title": "Estimating individual treatment effect: generalization bounds and algorithms",
      "paper_id": "1606.03976v5"
    },
    {
      "index": 46,
      "title": "Very Deep Convolutional Networks for Large-Scale Image Recognition",
      "abstract": "",
      "year": "2014",
      "venue": "arXiv preprint arXiv:1409.1556",
      "authors": "Karen Simonyan and Andrew Zisserman",
      "orig_title": "Very deep convolutional networks for large-scale image recognition",
      "paper_id": "1409.1556v6"
    },
    {
      "index": 47,
      "title": "Learning from logged implicit exploration data",
      "abstract": "",
      "year": "2010",
      "venue": "Advances in neural information processing systems",
      "authors": "Alex Strehl, John Langford, Lihong Li, and Sham¬†M Kakade"
    },
    {
      "index": 48,
      "title": "Direct importance estimation with model selection and its application to covariate shift adaptation",
      "abstract": "",
      "year": "2007",
      "venue": "Advances in neural information processing systems",
      "authors": "Masashi Sugiyama, Shinichi Nakajima, Hisashi Kashima, Paul Buenau, and Motoaki Kawanabe"
    },
    {
      "index": 49,
      "title": "Batch learning from logged bandit feedback through counterfactual risk minimization",
      "abstract": "",
      "year": "2015",
      "venue": "Journal of Machine Learning Research",
      "authors": "Adith Swaminathan and Thorsten Joachims"
    },
    {
      "index": 50,
      "title": "The self-normalized estimator for counterfactual learning",
      "abstract": "",
      "year": "2015",
      "venue": "advances in neural information processing systems",
      "authors": "Adith Swaminathan and Thorsten Joachims"
    },
    {
      "index": 51,
      "title": "Automatic ad format selection via contextual bandits",
      "abstract": "",
      "year": "2013",
      "venue": "22nd ACM international conference on Information & Knowledge Management",
      "authors": "Liang Tang, Romer Rosales, Ajit Singh, and Deepak Agarwal"
    },
    {
      "index": 52,
      "title": "High-confidence off-policy evaluation",
      "abstract": "",
      "year": "2015",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "Philip Thomas, Georgios Theocharous, and Mohammad Ghavamzadeh"
    },
    {
      "index": 53,
      "title": "Principles for modeling propensity scores in medical research: a systematic literature review",
      "abstract": "",
      "year": "2004",
      "venue": "Pharmacoepidemiology and drug safety",
      "authors": "Sherry Weitzen, Kate¬†L Lapane, Alicia¬†Y Toledano, Anne¬†L Hume, and Vincent Mor"
    },
    {
      "index": 54,
      "title": "Variance regularized counterfactual risk minimization via variational divergence minimization",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Machine Learning",
      "authors": "Hang Wu and May Wang"
    },
    {
      "index": 55,
      "title": "Fashion-MNIST: a Novel Image Dataset for Benchmarking Machine Learning Algorithms",
      "abstract": "",
      "year": "2017",
      "venue": "",
      "authors": "Han Xiao, Kashif Rasul, and Roland Vollgraf",
      "orig_title": "Fashion-mnist: a novel image dataset for benchmarking machine learning algorithms",
      "paper_id": "1708.07747v2"
    },
    {
      "index": 56,
      "title": "Off-policy evaluation and learning from logged bandit feedback: Error reduction via surrogate policy",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Learning Representations",
      "authors": "Yuan Xie, Boyi Liu, Qiang Liu, Zhaoran Wang, Yuan Zhou, and Jian Peng"
    },
    {
      "index": 57,
      "title": "A Survey on Deep Semi-supervised Learning",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2103.00550",
      "authors": "Xiangli Yang, Zixing Song, Irwin King, and Zenglin Xu",
      "orig_title": "A survey on deep semi-supervised learning",
      "paper_id": "2103.00550v2"
    },
    {
      "index": 58,
      "title": "How to Leverage Unlabeled Data in Offline Reinforcement Learning",
      "abstract": "",
      "year": "2022",
      "venue": "arXiv preprint arXiv:2202.01741",
      "authors": "Tianhe Yu, Aviral Kumar, Yevgen Chebotar, Karol Hausman, Chelsea Finn, and Sergey Levine",
      "orig_title": "How to leverage unlabeled data in offline reinforcement learning",
      "paper_id": "2202.01741v4"
    },
    {
      "index": 59,
      "title": "Information-theoretic upper and lower bounds for statistical estimation",
      "abstract": "",
      "year": "2006",
      "venue": "IEEE Transactions on Information Theory",
      "authors": "Tong Zhang"
    }
  ]
}