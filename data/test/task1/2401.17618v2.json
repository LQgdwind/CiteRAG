{
  "paper_id": "2401.17618v2",
  "title": "Beyond Control: Exploring Novel File System Objects for Data-Only Attacks on Linux Systems",
  "abstract": "Abstract.\nThe widespread deployment of control-flow integrity has propelled non-control data attacks into the mainstream.\nIn the domain of OS kernel exploits, by corrupting critical non-control data, local attackers can directly gain root access or privilege escalation without hijacking the control flow.\nAs a result, OS kernels have been restricting the availability of such non-control data.\nThis forces attackers to continue to search for more exploitable non-control data in OS kernels.\nHowever, discovering unknown non-control data can be daunting because they are often tied heavily to semantics and lack universal patterns.\nWe make two contributions in this paper: (1) discover critical non-control objects in the file subsystem and (2) analyze their exploitability.\nThis work represents the first study, with minimal domain knowledge, to semi-automatically discover and evaluate exploitable non-control data within the file subsystem of the Linux kernel.\nOur solution utilizes a custom analysis and testing framework\nthat statically and dynamically identifies promising candidate objects.\nFurthermore, we categorize these discovered objects into types that are suitable for various exploit strategies, including a novel strategy necessary to overcome the defense that isolates many of these objects.\nThese objects have the advantage of being exploitable without requiring KASLR, thus making the exploits simpler and more reliable.\nWe use 18 real-world CVEs to evaluate the exploitability of the file system objects using various exploit strategies. We develop 10 end-to-end exploits using a subset of CVEs against the kernel with all state-of-the-art mitigations enabled.",
  "reference_labels": [
    {
      "index": 0,
      "title": "MarkUs: Drop-in use-after-free prevention for low-level languages",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Symposium on Security and Privacy",
      "authors": "Sam Ainsworth and Timothy M. Jones"
    },
    {
      "index": 1,
      "title": "Control Flow Integrity",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": "Android"
    },
    {
      "index": 2,
      "title": "apple-oss-distributions/xnu",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 3,
      "title": "Arinerron/CVE-2022-0847-DirtyPipe-Exploit: A root exploit for CVE-2022-0847 (Dirty Pipe)",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": "Aaron Esau"
    },
    {
      "index": 4,
      "title": "arttnba3/D3CTF2023_d3kcache: attachment and write up for D^3CTF 2023’s pwn challenge - d3kcache",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 5,
      "title": "BasicVfsConcepts - FreeBSD Wiki",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 6,
      "title": "{{{Control-Flow}} Bending: On the Effectiveness of {{{Control-Flow}} Integrity",
      "abstract": "",
      "year": "2015",
      "venue": "USENIX Security Symposium",
      "authors": "Nicholas Carlini et al."
    },
    {
      "index": 7,
      "title": "Non-control-data attacks are realistic threats.",
      "abstract": "",
      "year": "2005",
      "venue": "USENIX security symposium",
      "authors": "Shuo Chen et al."
    },
    {
      "index": 8,
      "title": "{{{KOOBE}}: towards facilitating exploit generation of kernel {{{Out-Of-Bounds}} write vulnerabilities",
      "abstract": "",
      "year": "2020",
      "venue": "USENIX Security Symposium",
      "authors": "Weiteng Chen, Xiaochen Zou, Guoren Li and Zhiyun Qian"
    },
    {
      "index": 9,
      "title": "A systematic study of elastic objects in kernel exploitation",
      "abstract": "",
      "year": "2020",
      "venue": "ACM SIGSAC Conference on Computer and Communications Security",
      "authors": "Yueqi Chen, Zhenpeng Lin and Xinyu Xing"
    },
    {
      "index": 10,
      "title": "Slake: Facilitating slab manipulation for exploiting vulnerabilities in the linux kernel",
      "abstract": "",
      "year": "2019",
      "venue": "ACM SIGSAC Conference on Computer and Communications Security",
      "authors": "Yueqi Chen and Xinyu Xing"
    },
    {
      "index": 11,
      "title": "Exploiting uses of uninitialized stack variables in linux kernels to leak kernel pointers",
      "abstract": "",
      "year": "2020",
      "venue": "USENIX Workshop on Offensive Technologies",
      "authors": "Haehyun Cho et al."
    },
    {
      "index": 12,
      "title": "Clang CFI Support Upstreamed For Linux 5.13 - But Only On ARM64 For Now - Phoronix",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 13,
      "title": "CVE - CVE-2022-0435",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 14,
      "title": "CVE - CVE-2022-0847",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 15,
      "title": "CVE - CVE-2022-1015",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 16,
      "title": "CVE - CVE-2022-1016",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 17,
      "title": "CVE - CVE-2022-4378",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 18,
      "title": "CVE-2021-26708 exploit",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 19,
      "title": "Camouflage: Hardware-assisted CFI for the ARM Linux kernel",
      "abstract": "",
      "year": "2020",
      "venue": "ACM/IEEE Design Automation Conference",
      "authors": "Rémi Denis-Courmont, Hans Liljestrand, Carlos Chinea and Jan-Erik Ekberg"
    },
    {
      "index": 20,
      "title": "[CVE-2021-42008] Exploiting A 16-Year-Old Vulnerability In The Linux 6pack Driver",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "DEVIL"
    },
    {
      "index": 21,
      "title": "Dirty COW (CVE-2016-5195)",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 22,
      "title": "Dirty Pagetable: A Novel Exploitation Technique To Rule Linux Kernel",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": ""
    },
    {
      "index": 23,
      "title": "MineSweeper: A “Clean Sweep” for Drop-in Use-after-Free Prevention",
      "abstract": "",
      "year": "2022",
      "venue": "ACM International Conference on Architectural Support for Programming Languages and Operating Systems",
      "authors": "Márton Erdős, Sam Ainsworth and Timothy M. Jones"
    },
    {
      "index": 24,
      "title": "Exploiting CVE-2021-43267",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 25,
      "title": "Fiemap, an extent mapping ioctl",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 26,
      "title": "FUSE for Linux Exploitation 101",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 27,
      "title": "Fine-grained control-flow integrity for kernel software",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE European Symposium on Security and Privacy",
      "authors": "Xinyang Ge, Nirupama Talele, Mathias Payer and Trent Jaeger"
    },
    {
      "index": 28,
      "title": "CVE-2022-0185 Writeup",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "Hackthebox"
    },
    {
      "index": 29,
      "title": "SETTLERS OF NETLINK: Exploiting a limited UAF in nf_tables (CVE-2022-32250)",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "Cedric Halbronn"
    },
    {
      "index": 30,
      "title": "How AUTOSLAB Changes the Memory Unsafety Game",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 31,
      "title": "Data-oriented programming: On the expressiveness of non-control data attacks",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Symposium on Security and Privacy",
      "authors": "Hong Hu et al."
    },
    {
      "index": 32,
      "title": "Block Oriented Programming: Automating Data-Only Attacks",
      "abstract": "",
      "year": "2018",
      "venue": "ACM SIGSAC Conference on Computer and Communications Security",
      "authors": "Kyriakos K. Ispoglou, Bader AlBassam, Trent Jaeger and Mathias Payer",
      "orig_title": "Block Oriented Programming: Automating Data-Only Attacks",
      "paper_id": "1805.04767v2"
    },
    {
      "index": 33,
      "title": "Kernel address space layout randomization [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 34,
      "title": "sslab-gatech/kernel-analyzer",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 35,
      "title": "Kernel Exploitation Techniques: modprobe_path",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 36,
      "title": "Behind the Scenes of iOS and Mac Security",
      "abstract": "",
      "year": "2019",
      "venue": "Blackhat USA",
      "authors": "Ivan Krstic."
    },
    {
      "index": 37,
      "title": "A Hybrid Alias Analysis and Its Application to Global Variable Protection in the Linux Kernel",
      "abstract": "",
      "year": "2023",
      "venue": "USENIX Security Symposium",
      "authors": "Guoren Li et al."
    },
    {
      "index": 38,
      "title": "GREBE: Unveiling exploitation potential for Linux kernel bugs",
      "abstract": "",
      "year": "2022",
      "venue": "IEEE Symposium on Security and Privacy",
      "authors": "Zhenpeng Lin et al."
    },
    {
      "index": 39,
      "title": "DirtyCred: Escalating Privilege in Linux Kernel",
      "abstract": "",
      "year": "2022",
      "venue": "ACM SIGSAC Conference on Computer and Communications Security",
      "authors": "Zhenpeng Lin, Yuhang Wu and Xinyu Xing"
    },
    {
      "index": 40,
      "title": "Kernel support for control-flow enforcement [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 41,
      "title": "The status of kernel hardening [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 42,
      "title": "kernel.org/doc/Documentation/security/self-protection.txt",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 43,
      "title": "LinuxFlaw/CVE-2017-7184 at master · VulnReproduction/LinuxFlaw",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 44,
      "title": "Practical Program Modularization with Type-Based Dependence Analysis",
      "abstract": "",
      "year": "2023",
      "venue": "IEEE Symposium on Security and Privacy",
      "authors": "Kangjie Lu"
    },
    {
      "index": 45,
      "title": "Migrate Type - Linux source code (v5.14.21) - Bootlin",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 46,
      "title": "[CVE-2022-34918] A crack in the Linux firewall",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "Arthur Mongodin"
    },
    {
      "index": 47,
      "title": "Samsung knox and enterprise mobile security",
      "abstract": "",
      "year": "2014",
      "venue": "ACM Workshop on Security and Privacy in Smartphones & Mobile Devices",
      "authors": "Peng Ning"
    },
    {
      "index": 48,
      "title": "x86: Add support for Clang CFI [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 49,
      "title": "The current state of kernel page-table isolation [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 50,
      "title": "Supervisor mode access prevention [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 51,
      "title": "Privilege Escalation via setuid",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 52,
      "title": "xmp: Selective memory protection for kernel and user space",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Symposium on Security and Privacy",
      "authors": "Sergej Proskurin et al."
    },
    {
      "index": 53,
      "title": "Randomized slab caches for kmalloc() [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 54,
      "title": "US-22-WANG-Ret2page-The-Art-of-Exploiting-Use-After-Free-Vulnerabilities-in-the-Dedicated-Cache.pdf",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 55,
      "title": "CVE-2023-29383: Abusing Linux chfn to Misrepresent /etc/passwd",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "sam4k"
    },
    {
      "index": 56,
      "title": "Kernel Exploitation Techniques: modprobe_path",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "sam4k"
    },
    {
      "index": 57,
      "title": "Defeating samsung knox with zero privilege",
      "abstract": "",
      "year": "2017",
      "venue": "BlackHat USA",
      "authors": "Di Shen"
    },
    {
      "index": 58,
      "title": "HeapExpo: Pinpointing Promoted Pointers to Prevent Use-After-Free Vulnerabilities",
      "abstract": "",
      "year": "2020",
      "venue": "Annual Computer Security Applications Conference",
      "authors": "Zekun Shen and Brendan Dolan-Gavitt"
    },
    {
      "index": 59,
      "title": "Evolution of iOS mitigations",
      "abstract": "",
      "year": "2019",
      "venue": "TyphoonCon",
      "authors": "Siguza"
    },
    {
      "index": 60,
      "title": "White Paper: An Overview of the Samsung KNOX Platform",
      "abstract": "",
      "year": "2015",
      "venue": "",
      "authors": "Samsung Enterprise Mobility Solutions"
    },
    {
      "index": 61,
      "title": "Enforcing Kernel Security Invariants with Data Flow Integrity.",
      "abstract": "",
      "year": "2016",
      "venue": "NDSS",
      "authors": "Chengyu Song et al."
    },
    {
      "index": 62,
      "title": "CVE-2023-32233: Privilege escalation in Linux Kernel due to a Netfilter nf_tables vulnerability",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": "S.T.A².R.S Team"
    },
    {
      "index": 63,
      "title": "CVE-2023-0179-PoC",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": "TurtleARM"
    },
    {
      "index": 64,
      "title": "PET: Prevent Discovered Errors from Being Triggered in the Linux Kernel",
      "abstract": "",
      "year": "2023",
      "venue": "USENIX Security Symposium",
      "authors": "Zicheng Wang, Yueqi Chen and Qingkai Zeng"
    },
    {
      "index": 65,
      "title": "Preventing Use-After-Free Attacks with Fast Forward Allocation",
      "abstract": "",
      "year": "2021",
      "venue": "USENIX Security Symposium",
      "authors": "Brian Wickman et al."
    },
    {
      "index": 66,
      "title": "Will’s Root: Reviving Exploits Against Cred Structs - Six Byte Cross Cache Overflow to Leakless Data-Oriented Kernel Pwnage",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 67,
      "title": "Will’s Root: Reviving Exploits Against Cred Structs - Six Byte Cross Cache Overflow to Leakless Data-Oriented Kernel Pwnage",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 68,
      "title": "{{{KEPLER}}: Facilitating control-flow hijacking primitive evaluation for Linux kernel vulnerabilities",
      "abstract": "",
      "year": "2019",
      "venue": "USENIX Security Symposium",
      "authors": "Wei Wu, Yueqi Chen, Xinyu Xing and Wei Zou"
    },
    {
      "index": 69,
      "title": "{{{FUZE}}: Towards Facilitating Exploit Generation for Kernel {{{Use-After-Free}} Vulnerabilities",
      "abstract": "",
      "year": "2018",
      "venue": "USENIX Security Symposium",
      "authors": "Wei Wu et al."
    },
    {
      "index": 70,
      "title": "Extending the use of RO and NX [LWN.net]",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 71,
      "title": "Kernel data attack is a realistic security threat",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Security and Privacy in Communication Systems",
      "authors": "Jidong Xiao, Hai Huang and Haining Wang"
    },
    {
      "index": 72,
      "title": "ARM Pointer Authentication based Forward-Edge and Backward-Edge Control Flow Integrity for Kernels",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1912.10666",
      "authors": "Yutian Yang et al.",
      "orig_title": "ARM pointer authentication based forward-edge and backward-edge control flow integrity for kernels",
      "paper_id": "1912.10666v2"
    },
    {
      "index": 73,
      "title": "VIPER: Spotting Syscall-Guard Variables for Data-Only Attacks",
      "abstract": "",
      "year": "2023",
      "venue": "USENIX Security Symposium",
      "authors": "Hengkai Ye, Song Liu, Zhechang Zhang and Hong Hu"
    },
    {
      "index": 74,
      "title": "In-Kernel Control-Flow Integrity on Commodity OSes using ARM Pointer Authentication",
      "abstract": "",
      "year": "2022",
      "venue": "USENIX Security Symposium",
      "authors": "Sungbae Yoo et al.",
      "orig_title": "{{{In-Kernel}}{{Control-Flow}} Integrity on Commodity {{{OSes}} using {{{ARM}} Pointer Authentication",
      "paper_id": "2112.07213v1"
    },
    {
      "index": 75,
      "title": "Playing for {{{K (H) eaps}}: Understanding and improving linux kernel exploit reliability",
      "abstract": "",
      "year": "2022",
      "venue": "USENIX Security Symposium",
      "authors": "Kyle Zeng et al."
    },
    {
      "index": 76,
      "title": "Statically discovering high-order taint style vulnerabilities in os kernels",
      "abstract": "",
      "year": "2021",
      "venue": "ACM SIGSAC Conference on Computer and Communications Security",
      "authors": "Hang Zhang et al."
    },
    {
      "index": 77,
      "title": "Automatic Permission Check Analysis for Linux Kernel",
      "abstract": "",
      "year": "2022",
      "venue": "IEEE Transactions on Dependable and Secure Computing",
      "authors": "Jinmeng Zhou et al."
    },
    {
      "index": 78,
      "title": "CVE-2022-27666 Writeup",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "Xiaochen Zou"
    },
    {
      "index": 79,
      "title": "{{{SyzScope}}: Revealing {{{High-Risk}} Security Impacts of {{{Fuzzer-Exposed}} Bugs in Linux kernel",
      "abstract": "",
      "year": "2022",
      "venue": "USENIX Security Symposium",
      "authors": "Xiaochen Zou et al."
    }
  ]
}