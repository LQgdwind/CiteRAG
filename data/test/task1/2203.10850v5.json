{
  "paper_id": "2203.10850v5",
  "title": "Automatic Creation of High-Bandwidth Memory Architectures from Domain-Specific Languages: The Case of Computational Fluid Dynamics",
  "abstract": "Abstract.\nNumerical simulations can help solve complex problems. Most of these algorithms are massively parallel and thus good candidates for FPGA acceleration thanks to spatial parallelism. Modern FPGA devices can leverage high-bandwidth memory technologies, but when applications are memory-bound designers must craft advanced communication and memory architectures for efficient data movement and on-chip storage. This development process requires hardware design skills that are uncommon in domain-specific experts.\nIn this paper, we propose an automated tool flow from a domain-specific language (DSL) for tensor expressions to generate massively-parallel accelerators on HBM-equipped FPGAs. Designers can use this flow to integrate and evaluate various compiler or hardware optimizations. We use computational fluid dynamics (CFD) as a paradigmatic example.\nOur flow starts from the high-level specification of tensor operations and combines an MLIR-based compiler with an in-house hardware generation flow to generate systems with parallel accelerators and a specialized memory architecture that moves data efficiently, aiming at fully exploiting the available CPU-FPGA bandwidth.\nWe simulated applications with millions of elements, achieving up to 103 GFLOPS with one compute unit and custom precision when targeting a Xilinx Alveo U280. Our FPGA implementation is up to 25×\\times more energy efficient than expert-crafted Intel CPU implementations.",
  "reference_labels": [
    {
      "index": 0,
      "title": "TensorFlow: A system for large-scale machine learning",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv",
      "authors": "Martín Abadi et al.",
      "orig_title": "TensorFlow: A system for large-scale machine learning",
      "paper_id": "1605.08695v2"
    },
    {
      "index": 1,
      "title": "TensorFlow Eager: A multi-stage, Python-embedded DSL for machine learning",
      "abstract": "",
      "year": "2019",
      "venue": "Machine Learning and Systems",
      "authors": "Akshay Agrawal et al."
    },
    {
      "index": 2,
      "title": "2nd gen AMD EPYC™ 7282",
      "abstract": "",
      "year": "2021",
      "venue": "AMD",
      "authors": ""
    },
    {
      "index": 3,
      "title": "Scheduling algorithms for high-level synthesis",
      "abstract": "",
      "year": "1996",
      "venue": "ACAM Scientific Journal",
      "authors": "Zoltan Baruch"
    },
    {
      "index": 4,
      "title": "Theano: a CPU and GPU Math Expression Compiler",
      "abstract": "",
      "year": "2010",
      "venue": "Python in Science Conference (SciPy)",
      "authors": "James Bergstra et al."
    },
    {
      "index": 5,
      "title": "PolyGym: Polyhedral Optimizations as an Environment for Reinforcement Learning",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Parallel Architectures and Compilation Techniques (PACT)",
      "authors": "Alexander Brauckmann et al."
    },
    {
      "index": 6,
      "title": "Performance assessment of FPGAs as HPC accelerators using the FPGA Empirical Roofline",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Field-Programmable Logic and Applications (FPL)",
      "authors": "Enrico Calore et al."
    },
    {
      "index": 7,
      "title": "Automatic exploration of reduced floating-point representations in iterative methods",
      "abstract": "",
      "year": "2019",
      "venue": "European conference on parallel processing",
      "authors": "Yohan Chatelain et al."
    },
    {
      "index": 8,
      "title": "TVM: An Automated End-to-End Optimizing Compiler for Deep Learning",
      "abstract": "",
      "year": "2018",
      "venue": "USENIX Conference on Operating Systems Design and Implementation (OSDI)",
      "authors": "Tianqi Chen et al."
    },
    {
      "index": 9,
      "title": "Molecular Dynamics Simulations on High-Performance Reconfigurable Computing Systems",
      "abstract": "",
      "year": "2010",
      "venue": "ACM Transactions on Reconfigurable Technology Systems",
      "authors": "Matt Chiu et al."
    },
    {
      "index": 10,
      "title": "HBM Connect: High-Performance HLS Interconnect for FPGA HBM",
      "abstract": "",
      "year": "2021",
      "venue": "ACM/SIGDA International Symposium on Field-Programmable Gate Arrays (FPGA)",
      "authors": "Young-kyu Choi et al."
    },
    {
      "index": 11,
      "title": "When HLS Meets FPGA HBM: Benchmarking and Bandwidth Optimization",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv",
      "authors": "Young-kyu Choi et al.",
      "orig_title": "When HLS Meets FPGA HBM: Benchmarking and Bandwidth Optimization",
      "paper_id": "2010.06075v1"
    },
    {
      "index": 12,
      "title": "Bandwidth Optimization Through On-Chip Memory Restructuring for HLS",
      "abstract": "",
      "year": "2017",
      "venue": "ACM/IEEE Design Automation Conference (DAC)",
      "authors": "Jason Cong et al."
    },
    {
      "index": 13,
      "title": "Source-to-Source Optimization for HLS.",
      "abstract": "",
      "year": "2016",
      "venue": "FPGAs for Software Programmers",
      "authors": "Jason Cong et al."
    },
    {
      "index": 14,
      "title": "Invited: Bambu: an Open-Source Research Framework for the High-Level Synthesis of Complex Applications",
      "abstract": "",
      "year": "2021",
      "venue": "ACM/IEEE Design Automation Conference (DAC)",
      "authors": "Fabrizio Ferrandi et al."
    },
    {
      "index": 15,
      "title": "From Domain-Specific Languages to Memory-Optimized Accelerators for Fluid Dynamics",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE International Conference on Cluster Computing (CLUSTER)",
      "authors": "Karl F.. Friebel et al.",
      "orig_title": "From Domain-Specific Languages to Memory-Optimized Accelerators for Fluid Dynamics",
      "paper_id": "2108.03326v1"
    },
    {
      "index": 16,
      "title": "HBM2 Memory System for HPC Applications on an FPGA",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE International Conference on Cluster Computing (CLUSTER)",
      "authors": "Norihisa Fujita et al."
    },
    {
      "index": 17,
      "title": "Tensor Processing Primitives: A Programming Abstraction for Efficiency and Portability in Deep Learning Workloads",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv",
      "authors": "Evangelos Georganas et al."
    },
    {
      "index": 18,
      "title": "ESP4ML: Platform-Based Design of Systems-on-Chip for Embedded Machine Learning",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/EDAA Design, Automation & Test in Europe Conference (DATE)",
      "authors": "Davide Giri et al.",
      "orig_title": "ESP4ML: platform-based design of systems-on-chip for embedded machine learning",
      "paper_id": "2004.03640v2"
    },
    {
      "index": 19,
      "title": "Domain-Specific Multi-Level IR Rewriting for GPU The Open Earth Compiler for GPU-Accelerated Climate Simulation",
      "abstract": "",
      "year": "2021",
      "venue": "ACM Trans. Archit. Code Optim.",
      "authors": "Tobias Gysi et al.",
      "orig_title": "Domain-Specific Multi-Level IR Rewriting for GPU: The Open Earth Compiler for GPU-Accelerated Climate Simulation",
      "paper_id": "2005.13014v2"
    },
    {
      "index": 20,
      "title": "Fast HBM Access with FPGAs: Analysis, Architectures, and Applications",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE International Parallel and Distributed Processing Symposium Workshops (IPDPSW)",
      "authors": "Philipp Holzinger et al."
    },
    {
      "index": 21,
      "title": "Shuhai: A Tool for Benchmarking HighBandwidth Memory on FPGAs",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE Transactions on Computers",
      "authors": "Hongjing Huang et al."
    },
    {
      "index": 22,
      "title": "Factorizing the factorization – a spectral-element solver for elliptic equations with linear operation count",
      "abstract": "",
      "year": "2017",
      "venue": "Journal of Computational Physics",
      "authors": "Immo Huismann et al.",
      "orig_title": "Factorizing the factorization – a spectral-element solver for elliptic equations with linear operation count",
      "paper_id": "1601.08179v1"
    },
    {
      "index": 23,
      "title": "Load balancing for cpu-gpu coupling in computational fluid dynamics",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Parallel Processing and Applied Mathematics",
      "authors": "Immo Huismann et al."
    },
    {
      "index": 24,
      "title": "HBM (High Bandwidth Memory) DRAM Technology and Architecture",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE International Memory Workshop (IMW)",
      "authors": "Hongshin Jun et al."
    },
    {
      "index": 25,
      "title": "High Bandwidth Memory on FPGAs: A Data Analytics Perspective",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Field-Programmable Logic and Applications (FPL)",
      "authors": "Kaan Kara et al."
    },
    {
      "index": 26,
      "title": "Spatial: A Language and Compiler for Application Accelerators",
      "abstract": "",
      "year": "2018",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation (PLDI)",
      "authors": "David Koeplinger et al."
    },
    {
      "index": 27,
      "title": "An FPGA-Based Low-Latency Accelerator for Randomly Wired Neural Networks",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Field-Programmable Logic and Applications (FPL)",
      "authors": "Ryosuke Kuramochi et al."
    },
    {
      "index": 28,
      "title": "HeteroCL: A Multi-Paradigm Programming Infrastructure for Software-Defined Reconfigurable Computing",
      "abstract": "",
      "year": "2019",
      "venue": "ACM/SIGDA International Symposium on Field-Programmable Gate Arrays (FPGA)",
      "authors": "Yi-Hsiang Lai et al."
    },
    {
      "index": 29,
      "title": "Programming and Synthesis for Software-Defined FPGA Acceleration: Status and Future Prospects",
      "abstract": "",
      "year": "2021",
      "venue": "ACM Trans. Reconfigurable Technol. Syst.",
      "authors": "Yi-Hsiang Lai et al."
    },
    {
      "index": 30,
      "title": "LLVM: A compilation framework for lifelong program analysis & transformation",
      "abstract": "",
      "year": "2004",
      "venue": "IEEE International Symposium on Code Generation and Optimization (CGO)",
      "authors": "Chris Lattner et al."
    },
    {
      "index": 31,
      "title": "MLIR: A compiler infrastructure for the end of Moore’s law",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv",
      "authors": "Chris Lattner et al."
    },
    {
      "index": 32,
      "title": "ScalaBFS: A Scalable BFS Accelerator on FPGA-HBM Platform",
      "abstract": "",
      "year": "2021",
      "venue": "ACM/SIGDA International Symposium on Field-Programmable Gate Arrays (FPGA)",
      "authors": "Chenhao Liu et al."
    },
    {
      "index": 33,
      "title": "CHIP-KNN: A Configurable and High-Performance K-Nearest Neighbors Accelerator on Cloud FPGAs",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Field-Programmable Technology (ICFPT)",
      "authors": "Alec Lu et al."
    },
    {
      "index": 34,
      "title": "Spectral element methods for the incompressible Navier-Stokes equations",
      "abstract": "",
      "year": "1989",
      "venue": "State-of-the-art surveys on computational mechanics",
      "authors": "Yvon Maday et al."
    },
    {
      "index": 35,
      "title": "Evaluating FPGA Accelerator Performance with a Parameterized OpenCL Adaptation of Selected Benchmarks of the HPCChallenge Benchmark Suite",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/ACM International Workshop on Heterogeneous High-performance Reconfigurable Computing (H2RC)",
      "authors": "Marius Meyer et al."
    },
    {
      "index": 36,
      "title": "Polygeist: Affine C in MLIR",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "William S. Moses et al."
    },
    {
      "index": 37,
      "title": "A Survey and Evaluation of FPGA High-Level Synthesis Tools",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems",
      "authors": "Razvan Nane et al."
    },
    {
      "index": 38,
      "title": "The Performance and Energy Efficiency Potential of FPGAs in Scientific Computing",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/ACM Performance Modeling, Benchmarking and Simulation of High Performance Computer Systems (PMBS)",
      "authors": "Tan Nguyen et al."
    },
    {
      "index": 39,
      "title": "EVEREST: A design environment for extreme-scale big data analytics on heterogeneous platforms",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE/EDAA Design, Automation & Test in Europe Conference (DATE)",
      "authors": "Christian Pilato et al.",
      "orig_title": "EVEREST: A design environment for extreme-scale big data analytics on heterogeneous platforms",
      "paper_id": "2103.04185v1"
    },
    {
      "index": 40,
      "title": "System-Level Optimization of Accelerator Local Memory for Heterogeneous Systems-on-Chip",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Transactions on CAD of Integrated Circuits and Systems",
      "authors": "Christian Pilato et al."
    },
    {
      "index": 41,
      "title": "Halide: A Language and Compiler for Optimizing Parallelism, Locality, and Recomputation in Image Processing Pipelines",
      "abstract": "",
      "year": "2013",
      "venue": "ACM SIGPLAN Conference on Programming Language Design and Implementation (PLDI)",
      "authors": "Jonathan Ragan-Kelley et al."
    },
    {
      "index": 42,
      "title": "Impact of Off-Chip Memories on HLS-Generated Circuits",
      "abstract": "",
      "year": "2019",
      "venue": "International Workshop on FPGAs for Software Programmers (FSP)",
      "authors": "Abhi D. Rajagopala et al."
    },
    {
      "index": 43,
      "title": "CFDlang: High-level code generation for high-order methods in fluid dynamics",
      "abstract": "",
      "year": "2018",
      "venue": "RWDSL",
      "authors": "Norman A. Rink et al."
    },
    {
      "index": 44,
      "title": "TeIL: a type-safe imperative Tensor Intermediate Language",
      "abstract": "",
      "year": "2019",
      "venue": "ACM SIGPLAN International Workshop on Libraries, Languages, and Compilers for Array Programming (ARRAY)",
      "authors": "Norman A. Rink et al."
    },
    {
      "index": 45,
      "title": "FPGA-based Streaming Computation for Lattice Boltzmann Method",
      "abstract": "",
      "year": "2007",
      "venue": "International Conference on Field-Programmable Technology",
      "authors": "Kentaro Sano et al."
    },
    {
      "index": 46,
      "title": "Large-scale Simulations of Turbulence: HPC and Numerical Experiments",
      "abstract": "",
      "year": "2011",
      "venue": "IEEE International Conference on eScience (e-Science)",
      "authors": "Philipp Schlatter et al."
    },
    {
      "index": 47,
      "title": "Solving Large Top-K Graph Eigenproblems with a Memory and Compute-optimized FPGA Design",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE Annual International Symposium on Field-Programmable Custom Computing Machines (FCCM)",
      "authors": "Francesco Sgherzi et al."
    },
    {
      "index": 48,
      "title": "An automated floating-point to fixed-point conversion methodology",
      "abstract": "",
      "year": "2003",
      "venue": "IEEE International Conference on Acoustics, Speech, and Signal Processing (ICASSP)",
      "authors": "Changchun Shi et al."
    },
    {
      "index": 49,
      "title": "FPGA-Based Near-Memory Accelerationof Modern Data-Intensive Applications",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE Micro",
      "authors": "Gagandeep Singh et al.",
      "orig_title": "FPGA-Based Near-Memory Acceleration of Modern Data-Intensive Applications",
      "paper_id": "2106.06433v2"
    },
    {
      "index": 50,
      "title": "NERO: A Near High-Bandwidth Memory Stencil Accelerator for Weather Prediction Modeling",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Field-Programmable Logic and Applications (FPL)",
      "authors": "Gagandeep Singh et al.",
      "orig_title": "NERO: A Near High-Bandwidth Memory Stencil Accelerator for Weather Prediction Modeling",
      "paper_id": "2107.08716v2"
    },
    {
      "index": 51,
      "title": "Manufacturing of weather forecasting simulations on high performance infrastructures",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE International Conference on e-Science (e-Science)",
      "authors": "V. Šipková et al."
    },
    {
      "index": 52,
      "title": "A CAD-based methodology to optimize HLS code via the Roofline model",
      "abstract": "",
      "year": "2020",
      "venue": "ACM/IEEE International Conference On Computer Aided Design (ICCAD)",
      "authors": "Marco Siracusa et al."
    },
    {
      "index": 53,
      "title": "Tensor optimization for high-level synthesis design flows",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems",
      "authors": "Marco Siracusa et al."
    },
    {
      "index": 54,
      "title": "Meta-programming for cross-domain tensor optimizations",
      "abstract": "",
      "year": "2018",
      "venue": "ACM SIGPLAN International Conference on Generative Programming: Concepts and Experiences",
      "authors": "Adilla Susungi et al."
    },
    {
      "index": 55,
      "title": "Acceleration of tensor-product operations for high-order finite element methods.",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv",
      "authors": "Kasia Swirydowicz et al.",
      "orig_title": "Acceleration of tensor-product operations for high-order finite element methods",
      "paper_id": "1711.00903v2"
    },
    {
      "index": 56,
      "title": "Pyverilog: A Python-Based Hardware Design Processing Toolkit for Verilog HDL",
      "abstract": "",
      "year": "2015",
      "venue": "Applied Reconfigurable Computing",
      "authors": "Shinya Takamaeda-Yamazaki"
    },
    {
      "index": 57,
      "title": "Composable and Modular Code Generation in MLIR: A Structured and Retargetable Approach to Tensor Compiler Construction",
      "abstract": "",
      "year": "2022",
      "venue": "arXiv",
      "authors": "Nicolas Vasilache et al."
    },
    {
      "index": 58,
      "title": "Tensor Comprehensions: Framework-Agnostic High-Performance Machine Learning Abstractions",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv",
      "authors": "Nicolas Vasilache et al.",
      "orig_title": "Tensor comprehensions: Framework-agnostic high-performance machine learning abstractions",
      "paper_id": "1802.04730v3"
    },
    {
      "index": 59,
      "title": "FPGA-Based Low-Batch Training Accelerator for Modern CNNs Featuring High Bandwidth Memory",
      "abstract": "",
      "year": "2020",
      "venue": "ACM/IEEE International Conference on Computer-Aided Design (ICCAD)",
      "authors": "Shreyas K. Venkataramanaiah et al."
    },
    {
      "index": 60,
      "title": "isl: An Integer Set Library for the Polyhedral Model",
      "abstract": "",
      "year": "2010",
      "venue": "Mathematical Software – ICMS",
      "authors": "Sven Verdoolaege"
    },
    {
      "index": 61,
      "title": "Consecutivity in the isl Polyhedral Scheduler",
      "abstract": "",
      "year": "2017",
      "venue": "",
      "authors": "Sven Verdoolaege et al."
    },
    {
      "index": 62,
      "title": "Enabling FPGAs in Hyperscale Data Centers",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE International Conference on Ubiquitous Intelligence and Computing and IEEE International Conference on Autonomic and Trusted Computing and IEEE International Conference on Scalable Computing and Communications and Its Associated Workshops (UIC-ATC-ScalCom)",
      "authors": "Jagath Weerasinghe et al."
    },
    {
      "index": 63,
      "title": "Vitis 2021.1 Acceleration Environment",
      "abstract": "",
      "year": "2021",
      "venue": "Xilinx",
      "authors": ""
    },
    {
      "index": 64,
      "title": "Phism: Polyhedral High-Level Synthesis in MLIR",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv",
      "authors": "Ruizhe Zhao et al."
    }
  ]
}