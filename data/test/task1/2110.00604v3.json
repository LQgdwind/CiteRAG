{
  "paper_id": "2110.00604v3",
  "title": "Inexact bilevel stochastic gradient methods for constrained and unconstrained lower-level problems",
  "abstract": "Abstract\nTwo-level stochastic optimization formulations have become instrumental in a number of machine learning contexts such as continual learning, neural architecture search, adversarial learning, and hyperparameter tuning. Practical stochastic bilevel optimization problems become challenging in optimization or learning scenarios where the number of variables is high or there are constraints.\nIn this paper, we introduce a bilevel stochastic gradient method for bilevel problems with nonlinear and possibly nonconvex lower-level constraints. We also present a comprehensive convergence theory that addresses both the lower-level unconstrained and constrained cases and covers all inexact calculations of the adjoint gradient (also called hypergradient), such as the inexact solution of the lower-level problem, inexact computation of the adjoint formula (due to the inexact solution of the adjoint equation or use of a truncated Neumann series), and noisy estimates of the gradients, Hessians, and Jacobians involved. To promote the use of bilevel optimization in large-scale learning, we have developed new low-rank practical bilevel stochastic gradient methods (BSG-N-FD and BSG-1) that do not require second-order derivatives and, in the lower-level unconstrained case, dismiss any matrix-vector products.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Practical Bilevel Optimization: Algorithms and Applications",
      "abstract": "",
      "year": "2010",
      "venue": "Springer Publishing Company, Incorporated",
      "authors": "J. F. Bard"
    },
    {
      "index": 1,
      "title": "First-Order Methods in Optimization",
      "abstract": "",
      "year": "2017",
      "venue": "SIAM-Society for Industrial and Applied Mathematics",
      "authors": "A. Beck"
    },
    {
      "index": 2,
      "title": "Bilevel Optimization and Machine Learning, pages 25–47",
      "abstract": "",
      "year": "2008",
      "venue": "Springer Berlin Heidelberg",
      "authors": "K. P. Bennett, G. Kunapuli, J. Hu, and J. S. Pang"
    },
    {
      "index": 3,
      "title": "Practical Gauss-Newton optimisation for deep learning",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Machine Learning",
      "authors": "A. Botev, H. Ritter, and D. Barber"
    },
    {
      "index": 4,
      "title": "Optimization Methods for Large-Scale Machine Learning",
      "abstract": "",
      "year": "2018",
      "venue": "",
      "authors": "L. Bottou, F. E. Curtis, and J. Nocedal",
      "orig_title": "Optimization methods for large-scale machine learning",
      "paper_id": "1606.04838v3"
    },
    {
      "index": 5,
      "title": "Generalized Data Weighting via Class-level Gradient Manipulation",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "C. Chen, S. Zheng, X. Chen, E. Dong, X. Liu, H. Liu, and D. Dou",
      "orig_title": "Generalized dataweighting via class-level gradient manipulation",
      "paper_id": "2111.00056v1"
    },
    {
      "index": 6,
      "title": "Gradient-based Bi-level Optimization for Deep Learning: A Survey",
      "abstract": "",
      "year": "2022",
      "venue": "arXiv preprint",
      "authors": "C. Chen, X. Chen, C. Ma, Z. Liu, and X. Liu",
      "orig_title": "Gradient-based bi-level optimization for deep learning: A survey",
      "paper_id": "2207.11719v4"
    },
    {
      "index": 7,
      "title": "A Single-Timescale Stochastic Bilevel Optimization Method",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv e-prints",
      "authors": "T. Chen, Y. Sun, and W. Yin"
    },
    {
      "index": 8,
      "title": "Closing the gap: Tighter analysis of alternating stochastic gradient methods for bilevel problems",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "T. Chen, Y. Sun, and W. Yin"
    },
    {
      "index": 9,
      "title": "On a stochastic approximation method",
      "abstract": "",
      "year": "1954",
      "venue": "Annals of Mathematical Statistics",
      "authors": "K. L. Chung"
    },
    {
      "index": 10,
      "title": "An overview of bilevel optimization",
      "abstract": "",
      "year": "2007",
      "venue": "Annals of Operations Research",
      "authors": "B. Colson, P. Marcotte, and G. Savard"
    },
    {
      "index": 11,
      "title": "Bi-level stochastic gradient for large scale support vector machine",
      "abstract": "",
      "year": "2015",
      "venue": "Neurocomputing",
      "authors": "N. Couellan and W. Wang"
    },
    {
      "index": 12,
      "title": "On the convergence of stochastic bi-level gradient methods",
      "abstract": "",
      "year": "2016",
      "venue": "",
      "authors": "N. Couellan and W. Wang"
    },
    {
      "index": 13,
      "title": "Foundations of bilevel programming, volume 61 of Nonconvex Optimization and its Applications",
      "abstract": "",
      "year": "2002",
      "venue": "Kluwer Academic Publishers",
      "authors": "S. Dempe"
    },
    {
      "index": 14,
      "title": "Bilevel Optimization: Advances and Next Challenges",
      "abstract": "",
      "year": "2020",
      "venue": "Springer International Publishing",
      "authors": "S. Dempe and A. Zemkoho"
    },
    {
      "index": 15,
      "title": "Stabilizing Bi-Level Hyperparameter Optimization using Moreau-Yosida Regularization",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv e-prints",
      "authors": "S. Dhar, U. Kurup, and M. Shah",
      "orig_title": "Stabilizing bi-Level hyperparameter optimization using Moreau-Yosida regularization",
      "paper_id": "2007.13322v1"
    },
    {
      "index": 16,
      "title": "A proposal on machine learning via dynamical systems",
      "abstract": "",
      "year": "2017",
      "venue": "Communications in Mathematics and Statistics",
      "authors": "Weinan E"
    },
    {
      "index": 17,
      "title": "Sensitivity analysis for nonlinear programming using penalty methods",
      "abstract": "",
      "year": "1976",
      "venue": "Math. Programming",
      "authors": "A. V. Fiacco"
    },
    {
      "index": 18,
      "title": "Introduction to sensitivity and stability analysis in nonlinear programming, volume 165 of Mathematics in Science and Engineering",
      "abstract": "",
      "year": "1983",
      "venue": "Academic Press, Inc.",
      "authors": "A. V. Fiacco"
    },
    {
      "index": 19,
      "title": "Nonlinear programming: Sequential unconstrained minimization techniques",
      "abstract": "",
      "year": "1968",
      "venue": "John Wiley & Sons, Inc.",
      "authors": "A. V. Fiacco and G. P. McCormick"
    },
    {
      "index": 20,
      "title": "Bilevel Programming for Hyperparameter Optimization and Meta-Learning",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Machine Learning",
      "authors": "L. Franceschi, P. Frasconi, S. Salzo, R. Grazzi, and M. Pontil",
      "orig_title": "Bilevel programming for hyperparameter optimization and meta-learning",
      "paper_id": "1806.04910v2"
    },
    {
      "index": 21,
      "title": "Catastrophic forgetting in connectionist networks",
      "abstract": "",
      "year": "1999",
      "venue": "Trends in Cognitive Sciences",
      "authors": "R. M. French"
    },
    {
      "index": 22,
      "title": "On the Promise of the Stochastic Generalized Gauss-Newton Method for Training DNNs",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv e-prints",
      "authors": "M. Gargiani, A. Zanelli, M. Diehl, and F. Hutter",
      "orig_title": "On the promise of the stochastic generalized Gauss-Newton method for training DNNs",
      "paper_id": "2006.02409v4"
    },
    {
      "index": 23,
      "title": "Approximation Methods for Bilevel Programming",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv e-prints",
      "authors": "S. Ghadimi and M. Wang"
    },
    {
      "index": 24,
      "title": "Explaining and Harnessing Adversarial Examples",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Learning Representations",
      "authors": "I. Goodfellow, J. Shlens, and C. Szegedy",
      "orig_title": "Explaining and harnessing adversarial examples",
      "paper_id": "1412.6572v3"
    },
    {
      "index": 25,
      "title": "An empirical investigation of catastrophic forgetting in gradient-based neural networks",
      "abstract": "",
      "year": "2013",
      "venue": "arXiv e-prints",
      "authors": "I. J. Goodfellow, M. Mirza, D. Xiao, A. Courville, and Y. Bengio"
    },
    {
      "index": 26,
      "title": "A Two-Timescale Framework for Bilevel Optimization: Complexity Analysis and Application to Actor-Critic",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv e-prints",
      "authors": "M. Hong, H. Wai, Z. Wang, and Z. Yang"
    },
    {
      "index": 27,
      "title": "Meta-Learning in Neural Networks: A Survey",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv e-prints",
      "authors": "T. Hospedales, A. Antoniou, P. Micaelli, and A. Storkey",
      "orig_title": "Meta-Learning in neural networks: A survey",
      "paper_id": "2004.05439v2"
    },
    {
      "index": 28,
      "title": "Bilevel Optimization: Convergence Analysis and Enhanced Design",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Machine Learning",
      "authors": "K. Ji, J. Yang, and Y. Liang",
      "orig_title": "Bilevel optimization: Convergence analysis and enhanced design",
      "paper_id": "2010.07962v3"
    },
    {
      "index": 29,
      "title": "Learning to Defend by Learning to Attack",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv e-prints",
      "authors": "H. Jiang, Z. Chen, Y. Shi, B. Dai, and T. Zhao",
      "orig_title": "Learning to defend by learning to attack",
      "paper_id": "1811.01213v5"
    },
    {
      "index": 30,
      "title": "Linearly constrained bilevel optimization: A smoothed implicit gradient approach",
      "abstract": "",
      "year": "2023",
      "venue": "International Conference on Machine Learning",
      "authors": "P. Khanduri, I. Tsaknakis, Y. Zhang, J. Liu, S. Liu, J. Zhang, and M. Hong"
    },
    {
      "index": 31,
      "title": "Learning multiple layers of features from tiny images",
      "abstract": "",
      "year": "2009",
      "venue": "",
      "authors": "A. Krizhevsky"
    },
    {
      "index": 32,
      "title": "On Penalty Methods for Nonconvex Bilevel Optimization and First-Order Stochastic Approximation",
      "abstract": "",
      "year": "2023",
      "venue": "arXiv e-prints",
      "authors": "J. Kwon, D. Kwon, S. Wright, and R. Nowak",
      "orig_title": "On Penalty Methods for Nonconvex Bilevel Optimization and First-Order Stochastic Approximation",
      "paper_id": "2309.01753v2"
    },
    {
      "index": 33,
      "title": "DARTS: Differentiable architecture search",
      "abstract": "",
      "year": "2019",
      "venue": "ArXiv",
      "authors": "H. Liu, K. Simonyan, and Y. Yang"
    },
    {
      "index": 34,
      "title": "Investigating Bi-Level Optimization for Learning and Vision from a Unified Perspective: A Survey and Beyond",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv e-prints",
      "authors": "R. Liu, J. Gao, J. Zhang, D. Meng, and Z. Lin",
      "orig_title": "Investigating bi-level optimization for learning and vision from a unified perspective: A survey and beyond",
      "paper_id": "2101.11517v3"
    },
    {
      "index": 35,
      "title": "The stochastic multi-gradient algorithm for multi-objective optimization and its application to supervised machine learning",
      "abstract": "",
      "year": "",
      "venue": "Annals of Operations Research",
      "authors": "S. Liu and L. N. Vicente",
      "orig_title": "The stochastic multi-gradient algorithm for multi-objective optimization and its application to supervised machine learning",
      "paper_id": "1907.04472v3"
    },
    {
      "index": 36,
      "title": "Gradient Episodic Memory for Continual Learning",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv e-prints",
      "authors": "D. Lopez-Paz and M. Ranzato",
      "orig_title": "Gradient episodic memory for continual learning",
      "paper_id": "1706.08840v6"
    },
    {
      "index": 37,
      "title": "Optimizing Millions of Hyperparameters by Implicit Differentiation",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv e-prints",
      "authors": "J. Lorraine, P. Vicol, and D. Duvenaud"
    },
    {
      "index": 38,
      "title": "Beyond Finite Layer Neural Networks: Bridging Deep Architectures and Numerical Differential Equations",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv e-prints",
      "authors": "Y. Lu, A. Zhong, Q. Li, and B. Dong",
      "orig_title": "Beyond Finite Layer Neural Networks: Bridging Deep Architectures and Numerical Differential Equations",
      "paper_id": "1710.10121v3"
    },
    {
      "index": 39,
      "title": "Towards Deep Learning Models Resistant to Adversarial Attacks",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Learning Representations",
      "authors": "A. Madry, A. Makelov, L. Schmidt, D. Tsipras, and A. Vladu",
      "orig_title": "Towards deep learning models resistant to adversarial attacks",
      "paper_id": "1706.06083v4"
    },
    {
      "index": 40,
      "title": "Catastrophic interference in connectionist networks: The sequential learning problem",
      "abstract": "",
      "year": "1989",
      "venue": "Psychology of Learning and Motivation",
      "authors": "M. McCloskey and N. J. Cohen"
    },
    {
      "index": 41,
      "title": "Optimality criteria in nonlinear programming",
      "abstract": "",
      "year": "1976",
      "venue": "SIAM",
      "authors": "G. P. McCormick"
    },
    {
      "index": 42,
      "title": "Robust stochastic approximation approach to stochastic programming",
      "abstract": "",
      "year": "2009",
      "venue": "SIAM Journal on Optimization",
      "authors": "A. Nemirovski, A. Juditsky, G. Lan, and A. Shapiro"
    },
    {
      "index": 43,
      "title": "Lectures on Convex Optimization",
      "abstract": "",
      "year": "2018",
      "venue": "Springer Publishing Company, Incorporated",
      "authors": "Y. Nesterov"
    },
    {
      "index": 44,
      "title": "Numerical Optimization",
      "abstract": "",
      "year": "2006",
      "venue": "Springer-Verlag",
      "authors": "J. Nocedal and S. J. Wright"
    },
    {
      "index": 45,
      "title": "Hyperparameter optimization with approximate gradient",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Machine Learning",
      "authors": "F. Pedregosa",
      "orig_title": "Hyperparameter optimization with approximate gradient",
      "paper_id": "1602.02355v6"
    },
    {
      "index": 46,
      "title": "Bilevel Continual Learning",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Q. Pham, D. Sahoo, C. Liu, and S. C. H. Hoi",
      "orig_title": "Bilevel continual learning",
      "paper_id": "2011.01168v1"
    },
    {
      "index": 47,
      "title": "Explicitly imposing constraints in deep networks via conditional gradients gives improved generalization and faster convergence",
      "abstract": "",
      "year": "2019",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "S. N. Ravi, T. Dinh, V. S. Lokhande, and V. Singh"
    },
    {
      "index": 48,
      "title": "A Comprehensive Survey of Neural Architecture Search: Challenges and Solutions",
      "abstract": "",
      "year": "2021",
      "venue": "ACM Comput. Surv.",
      "authors": "P. Ren, Y. Xiao, X. Chang, P. Huang, Z. Li, X. Chen, and X. Wang",
      "orig_title": "A comprehensive survey of neural architecture search: Challenges and solutions",
      "paper_id": "2006.02903v3"
    },
    {
      "index": 49,
      "title": "A stochastic approximation method",
      "abstract": "",
      "year": "1951",
      "venue": "Annals of Mathematical Statistics",
      "authors": "H. Robbins and S. Monro"
    },
    {
      "index": 50,
      "title": "Principles of mathematical analysis",
      "abstract": "",
      "year": "1953",
      "venue": "McGraw-Hill Book Company, Inc.",
      "authors": "W. Rudin"
    },
    {
      "index": 51,
      "title": "GMRES: A generalized minimal residual algorithm for solving nonsymmetric linear systems",
      "abstract": "",
      "year": "1986",
      "venue": "SIAM Journal on Scientific and Statistical Computing",
      "authors": "Y. Saad and M. H. Schultz"
    },
    {
      "index": 52,
      "title": "Asymptotic distribution of stochastic approximation procedures",
      "abstract": "",
      "year": "1958",
      "venue": "Annals of Mathematical Statistics",
      "authors": "J. Sacks"
    },
    {
      "index": 53,
      "title": "Constrained Optimization to Train Neural Networks on Critical and Under-Represented Classes",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv e-prints",
      "authors": "S. Sangalli, E. Erdil, A. Hoetker, O. Donati, and E. Konukoglu",
      "orig_title": "Constrained optimization to train neural networks on critical and under-represented Classes",
      "paper_id": "2102.12894v4"
    },
    {
      "index": 54,
      "title": "The steepest descent direction for the nonlinear bilevel programming problem",
      "abstract": "",
      "year": "1994",
      "venue": "Operations Research Letters",
      "authors": "G. Savard and J. Gauvin"
    },
    {
      "index": 55,
      "title": "Bilevel Continual Learning",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "A. Shaker, F. Alesiani, S. Yu, and W. Yin",
      "orig_title": "Bilevel continual learning",
      "paper_id": "2011.01168v1"
    },
    {
      "index": 56,
      "title": "On Penalty-based Bilevel Gradient Descent Method",
      "abstract": "",
      "year": "2023",
      "venue": "arXiv e-prints",
      "authors": "H. Shen, Q. Xiao, and T. Chen",
      "orig_title": "On Penalty-based Bilevel Gradient Descent Method",
      "paper_id": "2302.05185v5"
    },
    {
      "index": 57,
      "title": "A Review on Bilevel Optimization: From Classical to Evolutionary Approaches and Applications",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Transactions on Evolutionary Computation",
      "authors": "A. Sinha, P. Malo, and K. Deb",
      "orig_title": "A review on bilevel optimization: From classical to evolutionary approaches and applications",
      "paper_id": "1705.06270v2"
    },
    {
      "index": 58,
      "title": "On the Convergence Theory for Hessian-Free Bilevel Algorithms",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv e-prints",
      "authors": "D. Sow, K. Ji, and Y. Liang",
      "orig_title": "On the Convergence Theory for Hessian-Free Bilevel Algorithms",
      "paper_id": "2110.07004v3"
    },
    {
      "index": 59,
      "title": "Learning to Continuously Optimize Wireless Resource in a Dynamic Environment: A Bilevel Optimization Perspective",
      "abstract": "",
      "year": "2022",
      "venue": "IRE Transactions on Audio",
      "authors": "H. Sun, W. Pu, X. Fu, T.H. Chang, and M. Hong",
      "orig_title": "Learning to continuously optimize wireless resource in a dynamic environment: A bilevel optimization perspective",
      "paper_id": "2105.01696v1"
    },
    {
      "index": 60,
      "title": "Intriguing properties of neural networks",
      "abstract": "",
      "year": "2013",
      "venue": "arXiv e-prints",
      "authors": "C. Szegedy, W. Zaremba, I. Sutskever, J. Bruna, D. Erhan, I. Goodfellow, and R. Fergus"
    },
    {
      "index": 61,
      "title": "An implicit gradient-type method for linearly constrained bilevel problems",
      "abstract": "",
      "year": "2022",
      "venue": "ICASSP, IEEE International Conference on Acoustics, Speech and Signal Processing",
      "authors": "I. Tsaknakis, P. Khanduri, and M. Hong"
    },
    {
      "index": 62,
      "title": "Bilevel and multilevel programming: A bibliography review",
      "abstract": "",
      "year": "1994",
      "venue": "Journal of Global Optimization",
      "authors": "L. N. Vicente and P. H. Calamai"
    },
    {
      "index": 63,
      "title": "Alternating projected sgd for equality-constrained bilevel optimization",
      "abstract": "",
      "year": "2023",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Q. Xiao, H. Shen, W. Yin, and T. Chen"
    },
    {
      "index": 64,
      "title": "Primal-dual stochastic gradient method for convex programs with many functional constraints",
      "abstract": "",
      "year": "2020",
      "venue": "SIAM Journal on Optimization",
      "authors": "Y. Xu"
    },
    {
      "index": 65,
      "title": "Provably Faster Algorithms for Bilevel Optimization",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv e-prints",
      "authors": "J. Yang, K. Ji, and Y. Liang",
      "orig_title": "Provably Faster Algorithms for Bilevel Optimization",
      "paper_id": "2106.04692v2"
    }
  ]
}