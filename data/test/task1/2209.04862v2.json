{
  "paper_id": "2209.04862v2",
  "title": "Adaptive Perturbation-Based Gradient Estimation for Discrete Latent Variable Models",
  "abstract": "Abstract\nThe integration of discrete algorithmic components in deep learning architectures has numerous applications.\nRecently, Implicit Maximum Likelihood Estimation (IMLE, Niepert, Minervini, and Franceschi 2021), a class of gradient estimators for discrete exponential family distributions, was proposed by combining implicit differentiation through perturbation with the path-wise gradient estimator.\nHowever, due to the finite difference approximation of the gradients, it is especially sensitive to the choice of the finite difference step size, which needs to be specified by the user.\nIn this work, we present Adaptive IMLE (AIMLE), the first adaptive gradient estimator for complex discrete distributions: it adaptively identifies the target distribution for IMLE by trading off the density of gradient information with the degree of bias in the gradient estimates.\nWe empirically evaluate our estimator on synthetic examples, as well as on Learning to Explain, Discrete Variational Auto-Encoders, and Neural Relational Inference tasks.\nIn our experiments, we show that our adaptive gradient estimator can produce faithful estimates while requiring orders of magnitude fewer samples than other gradient estimators.\nAll source code and datasets are available at https://github.com/EdinburghNLP/torch-adaptive-imle.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Differentiable Convex Optimization Layers",
      "abstract": "",
      "year": "2019",
      "venue": "NeurIPS",
      "authors": "Agrawal, A.; Amos, B.; Barratt, S. T.; Boyd, S. P.; Diamond, S.; and Kolter, J. Z."
    },
    {
      "index": 1,
      "title": "OptNet: Differentiable Optimization as a Layer in Neural Networks",
      "abstract": "",
      "year": "2017",
      "venue": "ICML",
      "authors": "Amos, B.; and Kolter, J. Z.",
      "orig_title": "OptNet: Differentiable Optimization as a Layer in Neural Networks",
      "paper_id": "1703.00443v5"
    },
    {
      "index": 2,
      "title": "Estimating or propagating gradients through stochastic neurons for conditional computation",
      "abstract": "",
      "year": "2013",
      "venue": "arXiv preprint arXiv:1308.3432",
      "authors": "Bengio, Y.; Léonard, N.; and Courville, A."
    },
    {
      "index": 3,
      "title": "Machine learning for combinatorial optimization: a methodological tour d’horizon",
      "abstract": "",
      "year": "2020",
      "venue": "European Journal of Operational Research",
      "authors": "Bengio, Y.; Lodi, A.; and Prouvost, A."
    },
    {
      "index": 4,
      "title": "Learning with Differentiable Pertubed Optimizers",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Berthet, Q.; Blondel, M.; Teboul, O.; Cuturi, M.; Vert, J.; and Bach, F. R."
    },
    {
      "index": 5,
      "title": "Backpropagating through Markov Logic Networks",
      "abstract": "",
      "year": "2021",
      "venue": "15th International Workshop on Neural-Symbolic Learning and Reasoning",
      "authors": "Betz, P.; Niepert, M.; Minervini, P.; and Stuckenschmidt, H."
    },
    {
      "index": 6,
      "title": "Learning to Explain: An Information-Theoretic Perspective on Model Interpretation",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Machine Learning",
      "authors": "Chen, J.; Song, L.; Wainwright, M.; and Jordan, M.",
      "orig_title": "Learning to explain: An information-theoretic perspective on model interpretation",
      "paper_id": "1802.07814v2"
    },
    {
      "index": 7,
      "title": "Understanding Deep Architectures with Reasoning Layer",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Chen, X.; Zhang, Y.; Reisinger, C.; and Song, L.",
      "orig_title": "Understanding Deep Architecture with Reasoning Layer",
      "paper_id": "2006.13401v2"
    },
    {
      "index": 8,
      "title": "A note on two problems in connexion with graphs",
      "abstract": "",
      "year": "1959",
      "venue": "Numerische Mathematik",
      "authors": "Dijkstra, E. W."
    },
    {
      "index": 9,
      "title": "Implicit Differentiation by Perturbation",
      "abstract": "",
      "year": "2010",
      "venue": "NIPS",
      "authors": "Domke, J."
    },
    {
      "index": 10,
      "title": "Generic methods for optimization-based modeling",
      "abstract": "",
      "year": "2012",
      "venue": "Artificial Intelligence and Statistics",
      "authors": "Domke, J."
    },
    {
      "index": 11,
      "title": "Task-based End-to-end Model Learning in Stochastic Optimization",
      "abstract": "",
      "year": "2017",
      "venue": "NIPS",
      "authors": "Donti, P. L.; Kolter, J. Z.; and Amos, B.",
      "orig_title": "Task-based End-to-end Model Learning in Stochastic Optimization",
      "paper_id": "1703.04529v4"
    },
    {
      "index": 12,
      "title": "Smart Predict, then Optimize",
      "abstract": "",
      "year": "2022",
      "venue": "Manag. Sci.",
      "authors": "Elmachtoub, A. N.; and Grigas, P."
    },
    {
      "index": 13,
      "title": "Learning Explanatory Rules from Noisy Data",
      "abstract": "",
      "year": "2018",
      "venue": "Journal of Artificial Intelligence Research",
      "authors": "Evans, R.; and Grefenstette, E.",
      "orig_title": "Learning explanatory rules from noisy data",
      "paper_id": "1711.04574v2"
    },
    {
      "index": 14,
      "title": "MIPaaL: Mixed Integer Program as a Layer",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI",
      "authors": "Ferber, A. M.; Wilder, B.; Dilkina, B.; and Tambe, M.",
      "orig_title": "MIPaaL: Mixed Integer Program as a Layer",
      "paper_id": "1907.05912v2"
    },
    {
      "index": 15,
      "title": "Bilevel Programming for Hyperparameter Optimization and Meta-Learning",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Franceschi, L.; Frasconi, P.; Salzo, S.; Grazzi, R.; and Pontil, M.",
      "orig_title": "Bilevel Programming for Hyperparameter Optimization and Meta-Learning",
      "paper_id": "1806.04910v2"
    },
    {
      "index": 16,
      "title": "Learning Discrete Structures for Graph Neural Networks",
      "abstract": "",
      "year": "2019",
      "venue": "ICML",
      "authors": "Franceschi, L.; Niepert, M.; Pontil, M.; and He, X.",
      "orig_title": "Learning Discrete Structures for Graph Neural Networks",
      "paper_id": "1903.11960v4"
    },
    {
      "index": 17,
      "title": "Graph Drawing by Force-directed Placement",
      "abstract": "",
      "year": "1991",
      "venue": "Softw. Pract. Exp.",
      "authors": "Fruchterman, T. M. J.; and Reingold, E. M."
    },
    {
      "index": 18,
      "title": "Backpropagation through the Void: Optimizing control variates for black-box gradient estimation",
      "abstract": "",
      "year": "2018",
      "venue": "ICLR",
      "authors": "Grathwohl, W.; Choi, D.; Wu, Y.; Roeder, G.; and Duvenaud, D.",
      "orig_title": "Backpropagation through the Void: Optimizing control variates for black-box gradient estimation",
      "paper_id": "1711.00123v3"
    },
    {
      "index": 19,
      "title": "Stochastic Optimization of Sorting Networks via Continuous Relaxations",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1903.08850",
      "authors": "Grover, A.; Wang, E.; Zweig, A.; and Ermon, S.",
      "orig_title": "Stochastic optimization of sorting networks via continuous relaxations",
      "paper_id": "1903.08850v2"
    },
    {
      "index": 20,
      "title": "Warcraft II Open-Source Map Editor",
      "abstract": "",
      "year": "2017",
      "venue": "http://github.com/war2/war2edit",
      "authors": "Guyomarch, J."
    },
    {
      "index": 21,
      "title": "Mastering Atari with Discrete World Models",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2010.02193",
      "authors": "Hafner, D.; Lillicrap, T.; Norouzi, M.; and Ba, J.",
      "orig_title": "Mastering atari with discrete world models",
      "paper_id": "2010.02193v4"
    },
    {
      "index": 22,
      "title": "On the Partition Function and Random Maximum A-Posteriori Perturbations",
      "abstract": "",
      "year": "2012",
      "venue": "ICML",
      "authors": "Hazan, T.; and Jaakkola, T. S."
    },
    {
      "index": 23,
      "title": "Categorical reparameterization with gumbel-softmax",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Jang, E.; Gu, S.; and Poole, B."
    },
    {
      "index": 24,
      "title": "Exact Sampling with Integer Linear Programs and Random Perturbations",
      "abstract": "",
      "year": "2016",
      "venue": "AAAI",
      "authors": "Kim, C.; Sabharwal, A.; and Ermon, S."
    },
    {
      "index": 25,
      "title": "Adam: A Method for Stochastic Optimization",
      "abstract": "",
      "year": "2015",
      "venue": "ICLR",
      "authors": "Kingma, D. P.; and Ba, J."
    },
    {
      "index": 26,
      "title": "Auto-Encoding Variational Bayes",
      "abstract": "",
      "year": "2014",
      "venue": "ICLR",
      "authors": "Kingma, D. P.; and Welling, M."
    },
    {
      "index": 27,
      "title": "Neural Relational Inference for Interacting Systems",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Kipf, T. N.; Fetaya, E.; Wang, K.; Welling, M.; and Zemel, R. S.",
      "orig_title": "Neural Relational Inference for Interacting Systems",
      "paper_id": "1802.04687v2"
    },
    {
      "index": 28,
      "title": "Estimating Gradients for Discrete Random Variables by Sampling without Replacement",
      "abstract": "",
      "year": "2020",
      "venue": "ICLR",
      "authors": "Kool, W.; van Hoof, H.; and Welling, M.",
      "orig_title": "Estimating gradients for discrete random variables by sampling without replacement",
      "paper_id": "2002.06043v1"
    },
    {
      "index": 29,
      "title": "On the Shortest Spanning Subtree of a Graph and the Traveling Salesman Problem",
      "abstract": "",
      "year": "1956",
      "venue": "American Mathematical Society",
      "authors": "Kruskal, J. B."
    },
    {
      "index": 30,
      "title": "A tutorial on energy-based learning",
      "abstract": "",
      "year": "2006",
      "venue": "Predicting structured data",
      "authors": "LeCun, Y.; Chopra, S.; Hadsell, R.; Ranzato, M.; and Huang, F."
    },
    {
      "index": 31,
      "title": "Rationalizing Neural Predictions",
      "abstract": "",
      "year": "2016",
      "venue": "EMNLP",
      "authors": "Lei, T.; Barzilay, R.; and Jaakkola, T.",
      "orig_title": "Rationalizing Neural Predictions",
      "paper_id": "1606.04155v2"
    },
    {
      "index": 32,
      "title": "Rao-Blackwellized Stochastic Gradients for Discrete Distributions",
      "abstract": "",
      "year": "2019",
      "venue": "ICML",
      "authors": "Liu, R.; Regier, J.; Tripuraneni, N.; Jordan, M. I.; and McAuliffe, J. D.",
      "orig_title": "Rao-Blackwellized Stochastic Gradients for Discrete Distributions",
      "paper_id": "1810.04777v3"
    },
    {
      "index": 33,
      "title": "Direct Optimization through argmax for Discrete Variational Auto-Encoder",
      "abstract": "",
      "year": "2019",
      "venue": "NeurIPS",
      "authors": "Lorberbom, G.; Jaakkola, T. S.; Gane, A.; and Hazan, T.",
      "orig_title": "Direct Optimization through arg max for Discrete Variational Auto-Encoder",
      "paper_id": "1806.02867v5"
    },
    {
      "index": 34,
      "title": "The Concrete Distribution: A Continuous Relaxation of Discrete Random Variables",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Maddison, C. J.; Mnih, A.; and Teh, Y. W.",
      "orig_title": "The concrete distribution: A continuous relaxation of discrete random variables",
      "paper_id": "1611.00712v3"
    },
    {
      "index": 35,
      "title": "Smart Predict-and-Optimize for Hard Combinatorial Optimization Problems",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI",
      "authors": "Mandi, J.; Demirovic, E.; Stuckey, P. J.; and Guns, T.",
      "orig_title": "Smart Predict-and-Optimize for Hard Combinatorial Optimization Problems",
      "paper_id": "1911.10092v1"
    },
    {
      "index": 36,
      "title": "Interior Point Solving for LP-based prediction+optimisation",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Mandi, J.; and Guns, T.",
      "orig_title": "Interior Point Solving for LP-based prediction+optimisation",
      "paper_id": "2010.13943v1"
    },
    {
      "index": 37,
      "title": "Direct Loss Minimization for Structured Prediction",
      "abstract": "",
      "year": "2010",
      "venue": "NIPS",
      "authors": "McAllester, D. A.; Hazan, T.; and Keshet, J."
    },
    {
      "index": 38,
      "title": "Learning Attitudes and Attributes from Multi-aspect Reviews",
      "abstract": "",
      "year": "2012",
      "venue": "ICDM",
      "authors": "McAuley, J. J.; Leskovec, J.; and Jurafsky, D."
    },
    {
      "index": 39,
      "title": "Neural Network for Graphs: A Contextual Constructive Approach",
      "abstract": "",
      "year": "2009",
      "venue": "IEEE Trans. Neural Networks",
      "authors": "Micheli, A."
    },
    {
      "index": 40,
      "title": "Monte carlo gradient estimation in machine learning",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1906.10652",
      "authors": "Mohamed, S.; Rosca, M.; Figurnov, M.; and Mnih, A."
    },
    {
      "index": 41,
      "title": "Rectified Linear Units Improve Restricted Boltzmann Machines",
      "abstract": "",
      "year": "2010",
      "venue": "ICML",
      "authors": "Nair, V.; and Hinton, G. E."
    },
    {
      "index": 42,
      "title": "LP-SparseMAP: Differentiable Relaxed Optimization for Sparse Structured Prediction",
      "abstract": "",
      "year": "2020",
      "venue": "ICML",
      "authors": "Niculae, V.; and Martins, A. F. T.",
      "orig_title": "LP-SparseMAP: Differentiable Relaxed Optimization for Sparse Structured Prediction",
      "paper_id": "2001.04437v3"
    },
    {
      "index": 43,
      "title": "SparseMAP: Differentiable Sparse Structured Inference",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Niculae, V.; Martins, A. F. T.; Blondel, M.; and Cardie, C.",
      "orig_title": "SparseMAP: Differentiable Sparse Structured Inference",
      "paper_id": "1802.04223v2"
    },
    {
      "index": 44,
      "title": "Implicit MLE: Backpropagating Through Discrete Exponential Family Distributions",
      "abstract": "",
      "year": "2021",
      "venue": "NeurIPS",
      "authors": "Niepert, M.; Minervini, P.; and Franceschi, L."
    },
    {
      "index": 45,
      "title": "Introduction to partial differential equations",
      "abstract": "",
      "year": "2013",
      "venue": "Undergraduate Texts in Mathematics",
      "authors": "Olver, P. J."
    },
    {
      "index": 46,
      "title": "Perturb-and-MAP random fields: Using discrete optimization to learn and sample from energy models",
      "abstract": "",
      "year": "2011",
      "venue": "ICCV",
      "authors": "Papandreou, G.; and Yuille, A. L."
    },
    {
      "index": 47,
      "title": "Gradient Estimation with Stochastic Softmax Tricks",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Paulus, M. B.; Choi, D.; Tarlow, D.; Krause, A.; and Maddison, C. J.",
      "orig_title": "Gradient Estimation with Stochastic Softmax Tricks",
      "paper_id": "2006.08063v3"
    },
    {
      "index": 48,
      "title": "Differentiation of Blackbox Combinatorial Solvers",
      "abstract": "",
      "year": "2020",
      "venue": "ICLR",
      "authors": "Pogancic, M. V.; Paulus, A.; Musil, V.; Martius, G.; and Rolínek, M.",
      "orig_title": "Differentiation of Blackbox Combinatorial Solvers",
      "paper_id": "1912.02175v2"
    },
    {
      "index": 49,
      "title": "Ordered Subgraph Aggregation Networks",
      "abstract": "",
      "year": "2022",
      "venue": "arXiv preprint arXiv:2206.11168",
      "authors": "Qian, C.; Rattan, G.; Geerts, F.; Morris, C.; and Niepert, M.",
      "orig_title": "Ordered Subgraph Aggregation Networks",
      "paper_id": "2206.11168v3"
    },
    {
      "index": 50,
      "title": "On the momentum term in gradient descent learning algorithms",
      "abstract": "",
      "year": "1999",
      "venue": "Neural Networks",
      "authors": "Qian, N."
    },
    {
      "index": 51,
      "title": "Deep Graph Matching via Blackbox Differentiation of Combinatorial Solvers",
      "abstract": "",
      "year": "2020",
      "venue": "ECCV",
      "authors": "Rolínek, M.; Swoboda, P.; Zietlow, D.; Paulus, A.; Musil, V.; and Martius, G.",
      "orig_title": "Deep Graph Matching via Blackbox Differentiation of Combinatorial Solvers",
      "paper_id": "2003.11657v2"
    },
    {
      "index": 52,
      "title": "The Graph Neural Network Model",
      "abstract": "",
      "year": "2009",
      "venue": "IEEE Trans. Neural Networks",
      "authors": "Scarselli, F.; Gori, M.; Tsoi, A. C.; Hagenbuchner, M.; and Monfardini, G."
    },
    {
      "index": 53,
      "title": "Parameter Learning for Log-supermodular Distributions",
      "abstract": "",
      "year": "2016",
      "venue": "NIPS",
      "authors": "Shpakova, T.; and Bach, F. R."
    },
    {
      "index": 54,
      "title": "Training Deep Neural Networks via Direct Loss Minimization",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Machine Learning",
      "authors": "Song, Y.; Schwing, A.; Urtasun, R.; et al.",
      "orig_title": "Training deep neural networks via direct loss minimization",
      "paper_id": "1511.06411v2"
    },
    {
      "index": 55,
      "title": "REBAR: Low-variance, unbiased gradient estimates for discrete latent variable models",
      "abstract": "",
      "year": "2017",
      "venue": "NIPS",
      "authors": "Tucker, G.; Mnih, A.; Maddison, C. J.; Lawson, D.; and Sohl-Dickstein, J.",
      "orig_title": "REBAR: Low-variance, unbiased gradient estimates for discrete latent variable models",
      "paper_id": "1703.07370v4"
    },
    {
      "index": 56,
      "title": "Graphical models, exponential families, and variational inference",
      "abstract": "",
      "year": "2008",
      "venue": "Now Publishers Inc.",
      "authors": "Wainwright, M. J.; and Jordan, M. I."
    },
    {
      "index": 57,
      "title": "SATNet: Bridging deep learning and logical reasoning using a differentiable satisfiability solver",
      "abstract": "",
      "year": "2019",
      "venue": "ICML",
      "authors": "Wang, P.; Donti, P. L.; Wilder, B.; and Kolter, J. Z.",
      "orig_title": "SATNet: Bridging deep learning and logical reasoning using a differentiable satisfiability solver",
      "paper_id": "1905.12149v1"
    },
    {
      "index": 58,
      "title": "Melding the Data-Decisions Pipeline: Decision-Focused Learning for Combinatorial Optimization",
      "abstract": "",
      "year": "2019",
      "venue": "AAAI",
      "authors": "Wilder, B.; Dilkina, B.; and Tambe, M.",
      "orig_title": "Melding the Data-Decisions Pipeline: Decision-Focused Learning for Combinatorial Optimization",
      "paper_id": "1809.05504v2"
    },
    {
      "index": 59,
      "title": "Simple Statistical Gradient-Following Algorithms for Connectionist Reinforcement Learning",
      "abstract": "",
      "year": "1992",
      "venue": "Mach. Learn.",
      "authors": "Williams, R. J."
    },
    {
      "index": 60,
      "title": "Reparameterizable Subset Sampling via Continuous Relaxations",
      "abstract": "",
      "year": "2019",
      "venue": "IJCAI",
      "authors": "Xie, S. M.; and Ermon, S.",
      "orig_title": "Reparameterizable Subset Sampling via Continuous Relaxations",
      "paper_id": "1901.10517v5"
    }
  ]
}