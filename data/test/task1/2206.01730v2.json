{
  "paper_id": "2206.01730v2",
  "title": "On the complexity of nonsmooth automatic differentiation",
  "abstract": "Abstract\nUsing the notion of conservative gradient, we provide a simple model to estimate the computational costs of the backward and forward modes of algorithmic differentiation for a wide class of nonsmooth programs. The overhead complexity of the backward mode turns out to be independent of the dimension when using programs with locally Lipschitz semi-algebraic or definable elementary functions. This considerably extends Baur-Strassen’s smooth cheap gradient principle. We illustrate our results by establishing fast backpropagation results of conservative gradients through feedforward neural networks with standard activation and loss functions.\nNonsmooth backpropagation’s cheapness contrasts with concurrent forward approaches, which have, to this day, dimensional-dependent worst-case overhead estimates. We provide further results suggesting the superiority of backward propagation of conservative gradients. Indeed, we relate the complexity of computing a large number of directional derivatives to that of matrix multiplication, and we show that finding two subgradients in the Clarke subdifferential of a function is an NP-hard problem.",
  "reference_labels": [
    {
      "index": 0,
      "title": "TensorFlow: A system for large-scale machine learning",
      "abstract": "",
      "year": "2016",
      "venue": "USENIX Symposium on Operating Systems Design and Implementation (OSDI 16)",
      "authors": "Martin Abadi, Paul Barham, Jianmin Chen, Zhifeng Chen, Andy Davis, Jeffrey Dean, Matthieu Devin, Sanjay Ghemawat, Geoffrey Irving, Michael Isard, Manjunath Kudlur, Josh Levenberg, Rajat Monga, Sherry Moore, Derek G. Murray, Benoit Steiner, Paul Tucker, Vijay Vasudevan, Pete Warden, Martin Wicke, Yuan Yu, and Xiaoqiang Zheng",
      "orig_title": "Tensorflow: A system for large-scale machine learning",
      "paper_id": "1605.08695v2"
    },
    {
      "index": 1,
      "title": "A Rewriting System for Convex Optimization Problems",
      "abstract": "",
      "year": "2018",
      "venue": "Journal of Control and Decision",
      "authors": "Akshay Agrawal, Robin Verschueren, Steven Diamond, and Stephen Boyd",
      "orig_title": "A rewriting system for convex optimization problems",
      "paper_id": "1709.04494v2"
    },
    {
      "index": 2,
      "title": "Differentiating through a cone program",
      "abstract": "",
      "year": "2019",
      "venue": "J. Appl. Numer. Optim",
      "authors": "Akshay Agrawal, Shane Barratt, Stephen Boyd, Enzo Busseti, and Walaa M Moursi"
    },
    {
      "index": 3,
      "title": "A Refined Laser Method and Faster Matrix Multiplication",
      "abstract": "",
      "year": "2021",
      "venue": "ACM-SIAM Symposium on Discrete Algorithms (SODA)",
      "authors": "Josh Alman and Virginia Vassilevska Williams",
      "orig_title": "A refined laser method and faster matrix multiplication",
      "paper_id": "2010.05846v2"
    },
    {
      "index": 4,
      "title": "Understanding Deep Neural Networks with Rectified Linear Units",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Learning Representations, Conference Track Proceedings",
      "authors": "Raman Arora, Amitabh Basu, Poorya Mianjy, and Anirbit Mukherjee",
      "orig_title": "Understanding deep neural networks with rectified linear units",
      "paper_id": "1611.01491v6"
    },
    {
      "index": 5,
      "title": "Deep Equilibrium Models",
      "abstract": "",
      "year": "2019",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Shaojie Bai, J Zico Kolter, and Vladlen Koltun",
      "orig_title": "Deep equilibrium models",
      "paper_id": "1909.01377v2"
    },
    {
      "index": 6,
      "title": "Computationally relevant generalized derivatives: theory, evaluation and applications",
      "abstract": "",
      "year": "2018",
      "venue": "Optimization Methods and Software",
      "authors": "Paul I. Barton, Kamil A. Khan, Peter Stechlinski, and Harry A.J. Watson"
    },
    {
      "index": 7,
      "title": "On the complexity of partial derivatives",
      "abstract": "",
      "year": "1983",
      "venue": "Theoretical Computer Science",
      "authors": "Walter Baur and Volker Strassen",
      "orig_title": "The complexity of partial derivatives",
      "paper_id": "1607.05494v2"
    },
    {
      "index": 8,
      "title": "Automatic Differentiation in Machine Learning: a Survey",
      "abstract": "",
      "year": "2018",
      "venue": "Journal of Marchine Learning Research",
      "authors": "Atilim Gunes Baydin, Barak A Pearlmutter, Alexey Andreyevich Radul, and Jeffrey Mark Siskind",
      "orig_title": "Automatic differentiation in machine learning: a survey",
      "paper_id": "1502.05767v4"
    },
    {
      "index": 9,
      "title": "Programs for automatic differentiation for the machine BESM",
      "abstract": "",
      "year": "1959",
      "venue": "Institute for Precise Mechanics and Computation Techniques, Academy of Science, Moscow, USSR",
      "authors": "L. M. Beda, L. N. Korolev, N. V. Sukkikh, and T. S. Frolova"
    },
    {
      "index": 10,
      "title": "Numerical influence of ReLU’(0) on backpropagation",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "David Bertoin, Jérôme Bolte, Sébastien Gerchinovitz, and Edouard Pauwels",
      "orig_title": "Numerical influence of relu’(0) on backpropagation",
      "paper_id": "2106.12915v4"
    },
    {
      "index": 11,
      "title": "Implicit differentiation of Lasso-type models for hyperparameter optimization",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Machine Learning",
      "authors": "Quentin Bertrand, Quentin Klopfenstein, Mathieu Blondel, Samuel Vaiter, Alexandre Gramfort, and Joseph Salmon",
      "orig_title": "Implicit differentiation of lasso-type models for hyperparameter optimization",
      "paper_id": "2002.08943v3"
    },
    {
      "index": 12,
      "title": "Efficient and Modular Implicit Differentiation",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2105.15183",
      "authors": "Mathieu Blondel, Quentin Berthet, Marco Cuturi, Roy Frostig, Stephan Hoyer, Felipe Llinares-López, Fabian Pedregosa, and Jean-Philippe Vert",
      "orig_title": "Efficient and modular implicit differentiation",
      "paper_id": "2105.15183v5"
    },
    {
      "index": 13,
      "title": "Real algebraic geometry, volume 36",
      "abstract": "",
      "year": "2013",
      "venue": "Springer Science & Business Media",
      "authors": "Jacek Bochnak, Michel Coste, and Marie-Françoise Roy"
    },
    {
      "index": 14,
      "title": "Conservative set valued fields, automatic differentiation, stochastic gradient methods and deep learning",
      "abstract": "",
      "year": "2020",
      "venue": "Mathematical Programming",
      "authors": "Jérôme Bolte and Edouard Pauwels"
    },
    {
      "index": 15,
      "title": "Nonsmooth implicit differentiation for machine-learning and optimization",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Jérôme Bolte, Tam Le, Edouard Pauwels, and Tony Silveti-Falls"
    },
    {
      "index": 16,
      "title": "A mathematical model for automatic differentiation in machine learning",
      "abstract": "",
      "year": "2020",
      "venue": "Conference on Neural Information Processing Systems",
      "authors": "Jérôme Bolte and Edouard Pauwels",
      "orig_title": "A mathematical model for automatic differentiation in machine learning",
      "paper_id": "2006.02080v2"
    },
    {
      "index": 17,
      "title": "JAX: composable transformations of Python+NumPy programs",
      "abstract": "",
      "year": "2018",
      "venue": "",
      "authors": "James Bradbury, Roy Frostig, Peter Hawkins, Matthew James Johnson, Chris Leary, Dougal Maclaurin, George Necula, Adam Paszke, Jake VanderPlas, Skye Wanderman-Milne, and Qiao Zhang"
    },
    {
      "index": 18,
      "title": "Neural Ordinary Differential Equations",
      "abstract": "",
      "year": "2018",
      "venue": "Advances in neural information processing systems",
      "authors": "Ricky TQ Chen, Yulia Rubanova, Jesse Bettencourt, and David K Duvenaud",
      "orig_title": "Neural ordinary differential equations",
      "paper_id": "1806.07366v5"
    },
    {
      "index": 19,
      "title": "Optimization and nonsmooth analysis",
      "abstract": "",
      "year": "1983",
      "venue": "SIAM",
      "authors": "Frank H Clarke"
    },
    {
      "index": 20,
      "title": "An introduction to o-minimal geometry",
      "abstract": "",
      "year": "2000",
      "venue": "Istituti editoriali e poligrafici internazionali Pisa",
      "authors": "Michel Coste"
    },
    {
      "index": 21,
      "title": "An introduction to semialgebraic geometry",
      "abstract": "",
      "year": "2000",
      "venue": "",
      "authors": "Michel Coste"
    },
    {
      "index": 22,
      "title": "The use of adjoint equations in numerical weather prediction",
      "abstract": "",
      "year": "1997",
      "venue": "Atmosphere-Ocean",
      "authors": "P. Courtier and F. Rabier"
    },
    {
      "index": 23,
      "title": "Conservative and semismooth derivatives are equivalent for semialgebraic maps",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2102.08484",
      "authors": "Damek Davis and Dmitriy Drusvyatskiy"
    },
    {
      "index": 24,
      "title": "Fast matrix multiplication and symbolic computation",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1612.05766",
      "authors": "Jean-Guillaume Dumas and Victor Pan"
    },
    {
      "index": 25,
      "title": "Automated derivation of the adjoint of high-level transient finite element programs",
      "abstract": "",
      "year": "2013",
      "venue": "SIAM Journal on Scientific Computing",
      "authors": "Patrick E Farrell, David A Ham, Simon W Funke, and Marie E Rognes"
    },
    {
      "index": 26,
      "title": "Differentiating the method of conjugate gradients",
      "abstract": "",
      "year": "2014",
      "venue": "SIAM Journal on Matrix Analysis and Applications",
      "authors": "Serge Gratton, David Titley-Peloquin, Philippe Toint, and Jean Tshimanga Ilunga"
    },
    {
      "index": 27,
      "title": "Treating artificial neural net training as a nonsmooth global optimization problem",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Machine Learning, Optimization, and Data Science",
      "authors": "A. Griewank and A. Rojas"
    },
    {
      "index": 28,
      "title": "Beyond the oracle: Opportunities of piecewise differentiation",
      "abstract": "",
      "year": "2020",
      "venue": "Numerical Nonsmooth Optimization",
      "authors": "A. Griewank and A. Walther"
    },
    {
      "index": 29,
      "title": "On stable piecewise linearization and generalized algorithmic differentiation",
      "abstract": "",
      "year": "2013",
      "venue": "Optimization Methods and Software",
      "authors": "Andreas Griewank"
    },
    {
      "index": 30,
      "title": "Piggyback differentiation and optimization",
      "abstract": "",
      "year": "2003",
      "venue": "Large-scale PDE-constrained optimization",
      "authors": "Andreas Griewank and Christèle Faure"
    },
    {
      "index": 31,
      "title": "Evaluating derivatives: principles and techniques of algorithmic differentiation",
      "abstract": "",
      "year": "2008",
      "venue": "SIAM",
      "authors": "Andreas Griewank and Andrea Walther"
    },
    {
      "index": 32,
      "title": "On automatic differentiation",
      "abstract": "",
      "year": "1989",
      "venue": "Mathematical Programming: recent developments and applications",
      "authors": "Andreas Griewank et al."
    },
    {
      "index": 33,
      "title": "Provably correct automatic sub-differentiation for qualified programs",
      "abstract": "",
      "year": "2018",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Sham M Kakade and Jason D Lee"
    },
    {
      "index": 34,
      "title": "Branch-locking ad techniques for nonsmooth composite functions and nonsmooth implicit functions",
      "abstract": "",
      "year": "2018",
      "venue": "Optimization Methods and Software",
      "authors": "Kamil A Khan"
    },
    {
      "index": 35,
      "title": "Evaluating an element of the clarke generalized jacobian of a piecewise differentiable function",
      "abstract": "",
      "year": "2012",
      "venue": "Recent Advances in Algorithmic Differentiation",
      "authors": "Kamil A Khan and Paul I Barton"
    },
    {
      "index": 36,
      "title": "Evaluating an element of the clarke generalized jacobian of a composite piecewise differentiable function",
      "abstract": "",
      "year": "2013",
      "venue": "ACM Transactions on Mathematical Software (TOMS)",
      "authors": "Kamil A Khan and Paul I Barton"
    },
    {
      "index": 37,
      "title": "A vector forward mode of automatic differentiation for generalized derivative evaluation",
      "abstract": "",
      "year": "2015",
      "venue": "Optimization Methods and Software",
      "authors": "Kamil A Khan and Paul I Barton"
    },
    {
      "index": 38,
      "title": "Powers of Tensors and Fast Matrix Multiplication",
      "abstract": "",
      "year": "2014",
      "venue": "39th international symposium on symbolic and algebraic computation",
      "authors": "François Le Gall",
      "orig_title": "Powers of tensors and fast matrix multiplication",
      "paper_id": "1401.7714v1"
    },
    {
      "index": 39,
      "title": "Deep Learning",
      "abstract": "",
      "year": "2015",
      "venue": "nature",
      "authors": "Yann LeCun, Yoshua Bengio, and Geoffrey Hinton",
      "orig_title": "Deep learning",
      "paper_id": "1807.07987v2"
    },
    {
      "index": 40,
      "title": "The structure of conservative gradient fields",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2101.00699",
      "authors": "Adrian Lewis and Tonghua Tian",
      "orig_title": "The structure of conservative gradient fields",
      "paper_id": "2101.00699v1"
    },
    {
      "index": 41,
      "title": "Optimizing millions of hyperparameters by implicit differentiation",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Jonathan Lorraine, Paul Vicol, and David Duvenaud"
    },
    {
      "index": 42,
      "title": "Gradient-based hyperparameter optimization through reversible learning",
      "abstract": "",
      "year": "2015",
      "venue": "International conference on machine learning",
      "authors": "Dougal Maclaurin, David Duvenaud, and Ryan Adams"
    },
    {
      "index": 43,
      "title": "Automatic differentiation of some first-order methods in parametric optimization",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Sheheryar Mehmood and Peter Ochs"
    },
    {
      "index": 44,
      "title": "Lexicographic differentiation of nonsmooth functions",
      "abstract": "",
      "year": "2005",
      "venue": "Mathematical programming",
      "authors": "Yu Nesterov"
    },
    {
      "index": 45,
      "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "abstract": "",
      "year": "2019",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban Desmaison, Andreas Kopf, Edward Yang, Zachary DeVito, Martin Raison, Alykhan Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith Chintala",
      "orig_title": "Pytorch: An imperative style, high-performance deep learning library",
      "paper_id": "1912.01703v1"
    },
    {
      "index": 46,
      "title": "Gradient calculations for dynamic recurrent neural networks: A survey",
      "abstract": "",
      "year": "1995",
      "venue": "IEEE Transactions on Neural networks",
      "authors": "Barak A Pearlmutter"
    },
    {
      "index": 47,
      "title": "A review of the adjoint-state method for computing the gradient of a functional with geophysical applications",
      "abstract": "",
      "year": "2006",
      "venue": "Geophysical Journal International",
      "authors": "R-E Plessix"
    },
    {
      "index": 48,
      "title": "On the expressive power of deep neural networks",
      "abstract": "",
      "year": "2017",
      "venue": "international conference on machine learning",
      "authors": "Maithra Raghu, Ben Poole, Jon Kleinberg, Surya Ganguli, and Jascha Sohl-Dickstein"
    },
    {
      "index": 49,
      "title": "Toward an optimal algorithm for matrix multiplication",
      "abstract": "",
      "year": "2005",
      "venue": "SIAM news",
      "authors": "Sara Robinson"
    },
    {
      "index": 50,
      "title": "Learning Representations by Back-propagating Errors",
      "abstract": "",
      "year": "1986",
      "venue": "Nature",
      "authors": "David E. Rumelhart, Geoffrey E. Hinton, and Ronald J. Williams"
    },
    {
      "index": 51,
      "title": "Introduction to piecewise differentiable equations",
      "abstract": "",
      "year": "2012",
      "venue": "Springer Science & Business Media",
      "authors": "Stefan Scholtes"
    },
    {
      "index": 52,
      "title": "Theory of linear and integer programming",
      "abstract": "",
      "year": "1998",
      "venue": "John Wiley & Sons",
      "authors": "Alexander Schrijver"
    },
    {
      "index": 53,
      "title": "On concepts of directional differentiability",
      "abstract": "",
      "year": "1990",
      "venue": "Journal of optimization theory and applications",
      "authors": "Alexander Shapiro"
    },
    {
      "index": 54,
      "title": "Differentiation of the cholesky algorithm",
      "abstract": "",
      "year": "1995",
      "venue": "Journal of Computational and Graphical Statistics",
      "authors": "Stephen P Smith"
    },
    {
      "index": 55,
      "title": "Gaussian elimination is not optimal",
      "abstract": "",
      "year": "1969",
      "venue": "Numerische mathematik",
      "authors": "Volker Strassen et al."
    },
    {
      "index": 56,
      "title": "Efficient approximation of jacobian matrices involving a non-uniform fast fourier transform (nufft)",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "Guanhua Wang and Jeffrey A. Fessler"
    },
    {
      "index": 57,
      "title": "A simple automatic derivative evaluation program",
      "abstract": "",
      "year": "1964",
      "venue": "Communications of the ACM",
      "authors": "Robert Edwin Wengert"
    },
    {
      "index": 58,
      "title": "Multiplying matrices faster than coppersmith-winograd",
      "abstract": "",
      "year": "2012",
      "venue": "forty-fourth annual ACM symposium on Theory of computing",
      "authors": "Virginia Vassilevska Williams"
    },
    {
      "index": 59,
      "title": "Monotone operator equilibrium networks",
      "abstract": "",
      "year": "2020",
      "venue": "Advances in neural information processing systems",
      "authors": "Ezra Winston and J Zico Kolter",
      "orig_title": "Monotone operator equilibrium networks",
      "paper_id": "2006.08591v2"
    },
    {
      "index": 60,
      "title": "Checking the calculation of gradients",
      "abstract": "",
      "year": "1982",
      "venue": "ACM Transactions on Mathematical Software (TOMS)",
      "authors": "Philip Wolfe"
    }
  ]
}