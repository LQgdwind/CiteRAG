{
  "paper_id": "2104.08015v2",
  "title": "On the Complexity of SHAP-Score-Based Explanations: Tractability via Knowledge Compilation and Non-Approximability Results",
  "abstract": "Abstract\nScores based on Shapley values are\nwidely used for providing\nexplanations to classification results over machine learning models. A prime\nexample of this is the influentialÂ ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-score, a version of the Shapley\nvalue that can help explain the result of a learned model on a specific entity\nby assigning a score to every feature.\nWhile in general computing Shapley values is a computationally intractable\nproblem, we prove a strong positive result stating that the ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-score can be\ncomputed in polynomial time over deterministic and decomposable Boolean\ncircuits under the so-called product distributions on entities.\nSuch\ncircuits are\nstudied in the field of Knowledge Compilation and generalize a\nwide range of Boolean circuits and binary decision diagrams classes, including\nbinary decision trees, Ordered Binary Decision Diagrams (OBDDs) and Free Binary Decision Diagrams (FBDDs).\nOur positive result extends even beyond binary classifiers, as it continues to hold if each feature is associated with a finite domain of possible values.\nWe also establish the computational limits of the notion of\nSHAP-score by observing that, under a mild condition, computing it over a\nclass of Boolean models is always polynomially as hard as the model counting\nproblem for that class.\nThis implies that\nboth determinism and decomposability are essential properties for the circuits that we\nconsider, as removing one or the other renders the problem of\ncomputing theÂ ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-score intractable (namely,Â #â€‹P#P\\#\\text{{P}}-hard). It also implies that\ncomputing ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-scores is #â€‹P#P\\#\\text{{P}}-hard even over the class of propositional formulas in DNF.\nBased on this negative result, we look for the existence of fully-polynomial randomized approximation schemes (FPRAS)\nfor computing ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-scores over such class. In stark contrast to the model counting problem for DNF formulas, which admits an FPRAS, we prove that\nno such FPRAS exists (under widely believed complexity assumptions) for the computation of ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-scores. Surprisingly, this negative result holds even for the class of monotone formulas in DNF. These techniques can be further\nextended to prove another strong negative result: Under widely believed\ncomplexity assumptions, there is no polynomial-time algorithm that checks, given a monotone DNF formula Ï†ğœ‘\\varphi and features x,yğ‘¥ğ‘¦x,y, whether the ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-score of xğ‘¥x in Ï†ğœ‘\\varphi is smaller than the ğ–²ğ–§ğ– ğ–¯ğ–²ğ–§ğ– ğ–¯\\mathsf{SHAP}-score of yğ‘¦y in Ï†ğœ‘\\varphi.",
  "reference_labels": [
    {
      "index": 0,
      "title": "CausalWorld: A Robotic Manipulation Benchmark for Causal Structure and Transfer Learning",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv",
      "authors": "Ossama Ahmed, Frederik TrÃ¤uble, Anirudh Goyal, Alexander Neitz, Manuel WÃ¼thrich, Yoshua Bengio, Bernhard SchÃ¶lkopf, and Stefan Bauer",
      "orig_title": "Causalworld: A robotic manipulation benchmark for causal structure and transfer learning",
      "paper_id": "2010.04296v2"
    },
    {
      "index": 1,
      "title": "Connecting Knowledge Compilation Classes and Width Parameters",
      "abstract": "",
      "year": "2020",
      "venue": "Theory Comput. Syst.",
      "authors": "Antoine Amarilli, Florent Capelli, MikaÃ«l Monet, and Pierre Senellart",
      "orig_title": "Connecting knowledge compilation classes and width parameters",
      "paper_id": "1811.02944v2"
    },
    {
      "index": 2,
      "title": "The Tractability of SHAP-Score-Based Explanations over Deterministic and Decomposable Boolean Circuits",
      "abstract": "",
      "year": "2021",
      "venue": "AAAI",
      "authors": "Marcelo Arenas, Pablo BarcelÃ³, Leopoldo Bertossi, and MikaÃ«l Monet",
      "orig_title": "The tractability of SHAP-score-based explanations over deterministic and decomposable boolean circuits",
      "paper_id": "2007.14045v3"
    },
    {
      "index": 3,
      "title": "Computational Complexity - A Modern Approach",
      "abstract": "",
      "year": "2009",
      "venue": "Cambridge University Press",
      "authors": "Sanjeev Arora and Boaz Barak"
    },
    {
      "index": 4,
      "title": "Probabilistic checking of proofs: A new characterization of NP",
      "abstract": "",
      "year": "1998",
      "venue": "Journal of the ACM (JACM)",
      "authors": "Sanjeev Arora and Shmuel Safra"
    },
    {
      "index": 5,
      "title": "Proof verification and the hardness of approximation problems",
      "abstract": "",
      "year": "1998",
      "venue": "Journal of the ACM (JACM)",
      "authors": "Sanjeev Arora, Carsten Lund, Rajeev Motwani, Madhu Sudan, and Mario Szegedy"
    },
    {
      "index": 6,
      "title": "Attribution-Scores and Causal Counterfactuals as Explanations in Artificial Intelligence",
      "abstract": "",
      "year": "2023",
      "venue": "CoRR",
      "authors": "Leopoldo Bertossi",
      "orig_title": "Attribution-scores and causal counterfactuals as explanations in artificial intelligence",
      "paper_id": "2303.02829v2"
    },
    {
      "index": 7,
      "title": "Opening up the neural network classifier for Shap score computation",
      "abstract": "",
      "year": "2023",
      "venue": "CoRR",
      "authors": "Leopoldo Bertossi and JorgeÂ E. Leon"
    },
    {
      "index": 8,
      "title": "Causality-based Explanation of Classification Outcomes",
      "abstract": "",
      "year": "2020",
      "venue": "Fourth International Workshop on Data Management for End-to-End Machine Learning",
      "authors": "Leopoldo Bertossi, Jordan Li, Maximilian Schleich, Dan Suciu, and Zografoula Vagena",
      "orig_title": "Causality-based explanation of classification outcomes",
      "paper_id": "2003.06868v2"
    },
    {
      "index": 9,
      "title": "Polynomial calculation of the Shapley value based on sampling",
      "abstract": "",
      "year": "2009",
      "venue": "Computers & Operations Research",
      "authors": "Javier Castro, Daniel GÃ³mez, and Juan Tejada"
    },
    {
      "index": 10,
      "title": "An application of the Shapley value to the analysis of co-expression networks",
      "abstract": "",
      "year": "2018",
      "venue": "Applied Network Science",
      "authors": "Giulia Cesari, EncarnaciÃ³n Algaba, Stefano Moretti, and JuanÂ A. Nepomuceno"
    },
    {
      "index": 11,
      "title": "An Interpretable Model with Globally Consistent Explanations for Credit Risk",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv",
      "authors": "Chaofan Chen, Kangcheng Lin, Cynthia Rudin, Yaron Shaposhnik, Sijia Wang, and Tong Wang",
      "orig_title": "An interpretable model with globally consistent explanations for credit risk",
      "paper_id": "1811.12615v1"
    },
    {
      "index": 12,
      "title": "On Symbolically Encoding the Behavior of Random Forests",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv",
      "authors": "Arthur Choi, Andy Shih, Anchal Goyanka, and Adnan Darwiche",
      "orig_title": "On symbolically encoding the behavior of random forests",
      "paper_id": "2007.01493v1"
    },
    {
      "index": 13,
      "title": "Improving KernelSHAP: Practical Shapley value estimation using linear regression",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Ian Covert and Su-In Lee"
    },
    {
      "index": 14,
      "title": "On the tractable counting of theory models and its application to truth maintenance and belief revision",
      "abstract": "",
      "year": "2001",
      "venue": "Journal of Applied Non-Classical Logics",
      "authors": "Adnan Darwiche"
    },
    {
      "index": 15,
      "title": "On the reasons behind decisions",
      "abstract": "",
      "year": "2020",
      "venue": "ECAI",
      "authors": "Adnan Darwiche and Auguste Hirth"
    },
    {
      "index": 16,
      "title": "A knowledge compilation map",
      "abstract": "",
      "year": "2002",
      "venue": "Journal of Artificial Intelligence Research",
      "authors": "Adnan Darwiche and Pierre Marquis"
    },
    {
      "index": 17,
      "title": "Algorithmic transparency via quantitative input influence: Theory and experiments with learning systems",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE symposium on security and privacy (SP)",
      "authors": "Anupam Datta, Shayak Sen, and Yair Zick"
    },
    {
      "index": 18,
      "title": "On the complexity of cooperative solution concepts",
      "abstract": "",
      "year": "1994",
      "venue": "Mathematics of Operations Research",
      "authors": "Xiaotie Deng and ChristosÂ H Papadimitriou"
    },
    {
      "index": 19,
      "title": "Explanations for data repair through Shapley values",
      "abstract": "",
      "year": "2021",
      "venue": "ACM International Conference on Information & Knowledge Management",
      "authors": "Daniel Deutch, Nave Frost, Amir Gilad, and Oren Sheffer"
    },
    {
      "index": 20,
      "title": "Computing the Shapley Value of Facts in Query Answering",
      "abstract": "",
      "year": "2022",
      "venue": "International Conference on Management of Data",
      "authors": "Daniel Deutch, Nave Frost, Benny Kimelfeld, and MikaÃ«l Monet",
      "orig_title": "Computing the Shapley value of facts in query answering",
      "paper_id": "2112.08874v2"
    },
    {
      "index": 21,
      "title": "The Shapley value for cooperative games under precedence constraints",
      "abstract": "",
      "year": "1992",
      "venue": "International Journal of Game Theory",
      "authors": "Ulrich Faigle and Walter Kern"
    },
    {
      "index": 22,
      "title": "Interactive proofs and the hardness of approximating cliques",
      "abstract": "",
      "year": "1996",
      "venue": "Journal of the ACM (JACM)",
      "authors": "Uriel Feige, Shafi Goldwasser, LÃ¡szlÃ³ LovÃ¡sz, Shmuel Safra, and Mario Szegedy"
    },
    {
      "index": 23,
      "title": "When Explainability Meets Adversarial Learning: Detecting Adversarial Examples using SHAP Signatures",
      "abstract": "",
      "year": "2020",
      "venue": "International Joint Conference on Neural Networks (IJCNN)",
      "authors": "Gil Fidel, Ron Bitton, and Asaf Shabtai",
      "orig_title": "When explainability meets adversarial learning: Detecting adversarial examples using SHAP signatures",
      "paper_id": "1909.03418v1"
    },
    {
      "index": 24,
      "title": "Computational complexity: a conceptual perspective",
      "abstract": "",
      "year": "2008",
      "venue": "Cambridge University Press",
      "authors": "Oded Goldreich"
    },
    {
      "index": 25,
      "title": "On the measure of conflicts: Shapley inconsistency values",
      "abstract": "",
      "year": "2010",
      "venue": "Artificial Intelligence",
      "authors": "Anthony Hunter and SÃ©bastien Konieczny"
    },
    {
      "index": 26,
      "title": "Monte-carlo approximation algorithms for enumeration problems",
      "abstract": "",
      "year": "1989",
      "venue": "Journal of algorithms",
      "authors": "RichardÂ M Karp, Michael Luby, and Neal Madras"
    },
    {
      "index": 27,
      "title": "Some observations on the probabilistic algorithms and NP-hard problems",
      "abstract": "",
      "year": "1982",
      "venue": "Information Processing Letters",
      "authors": "Ker-I Ko"
    },
    {
      "index": 28,
      "title": "Problems with Shapley-value-based explanations as feature importance measures",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Machine Learning",
      "authors": "IÂ Elizabeth Kumar, Suresh Venkatasubramanian, Carlos Scheidegger, and Sorelle Friedler"
    },
    {
      "index": 29,
      "title": "The Shapley Value of Tuples in Query Answering",
      "abstract": "",
      "year": "2020",
      "venue": "ICDT",
      "authors": "Ester Livshits, Leopoldo Bertossi, Benny Kimelfeld, and Moshe Sebag",
      "orig_title": "The Shapley value of tuples in query answering",
      "paper_id": "1904.08679v5"
    },
    {
      "index": 30,
      "title": "The Shapley Value of Tuples in Query Answering",
      "abstract": "",
      "year": "2021",
      "venue": "Log. Methods Comput. Sci.",
      "authors": "Ester Livshits, Leopoldo Bertossi, Benny Kimelfeld, and Moshe Sebag",
      "orig_title": "The Shapley value of tuples in query answering",
      "paper_id": "1904.08679v5"
    },
    {
      "index": 31,
      "title": "A Unified Approach to Interpreting Model Predictions",
      "abstract": "",
      "year": "2017",
      "venue": "NeurIPS",
      "authors": "ScottÂ M Lundberg and Su-In Lee",
      "orig_title": "A unified approach to interpreting model predictions",
      "paper_id": "1705.07874v2"
    },
    {
      "index": 32,
      "title": "From local explanations to global understanding with explainable AI for trees",
      "abstract": "",
      "year": "2020",
      "venue": "Nature Machine Intelligence",
      "authors": "ScottÂ M Lundberg, Gabriel Erion, Hugh Chen, Alex DeGrave, JordanÂ M Prutkin, Bala Nair, Ronit Katz, Jonathan Himmelfarb, Nisha Bansal, and Su-In Lee"
    },
    {
      "index": 33,
      "title": "Logic-Based Explainability in Machine Learning",
      "abstract": "",
      "year": "2022",
      "venue": "CoRR",
      "authors": "JoÃ£o Marques-Silva",
      "orig_title": "Logic-based explainability in machine learning",
      "paper_id": "2211.00541v3"
    },
    {
      "index": 34,
      "title": "The Explanation Game: Explaining Machine Learning Models Using Shapley Values",
      "abstract": "",
      "year": "2020",
      "venue": "CD-MAKE",
      "authors": "Luke Merrick and Ankur Taly",
      "orig_title": "The explanation game: Explaining machine learning models using Shapley values",
      "paper_id": "1909.08128v3"
    },
    {
      "index": 35,
      "title": "Efficient computation of the Shapley value for game-theoretic network centrality",
      "abstract": "",
      "year": "2013",
      "venue": "Journal of Artificial Intelligence Research",
      "authors": "TomaszÂ P Michalak, KarthikÂ V Aadithya, PiotrÂ L Szczepanski, Balaraman Ravindran, and NicholasÂ R Jennings"
    },
    {
      "index": 36,
      "title": "Sampling Permutations for Shapley Value Estimation",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "Rory Mitchell, Joshua Cooper, Eibe Frank, and Geoffrey Holmes",
      "orig_title": "Sampling permutations for Shapley value estimation",
      "paper_id": "2104.12199v2"
    },
    {
      "index": 37,
      "title": "Interpretable machine learning: A guide for making black box models explainable",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "C.Â Molnar"
    },
    {
      "index": 38,
      "title": "A Multilinear Sampling Algorithm to Estimate Shapley Values",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Pattern Recognition (ICPR)",
      "authors": "Ramin Okhrati and Aldo Lipani",
      "orig_title": "A multilinear sampling algorithm to estimate Shapley values",
      "paper_id": "2010.12082v1"
    },
    {
      "index": 39,
      "title": "Einsum Networks: Fast and Scalable Learning of Tractable Probabilistic Circuits",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv",
      "authors": "Robert Peharz, Steven Lang, Antonio Vergari, Karl Stelzner, Alejandro Molina, Martin Trapp, Guy VanÂ den Broeck, Kristian Kersting, and Zoubin Ghahramani",
      "orig_title": "Einsum networks: Fast and scalable learning of tractable probabilistic circuits",
      "paper_id": "2004.06231v1"
    },
    {
      "index": 40,
      "title": "The complexity of counting cuts and of computing the probability that a graph is connected",
      "abstract": "",
      "year": "1983",
      "venue": "SIAM Journal on Computing",
      "authors": "JÂ Scott Provan and MichaelÂ O Ball"
    },
    {
      "index": 41,
      "title": "Generating counterfactual and contrastive explanations using SHAP",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv",
      "authors": "Shubham Rathi"
    },
    {
      "index": 42,
      "title": "â€œWhy Should I Trust You?â€ Explaining the Predictions of Any Classifier",
      "abstract": "",
      "year": "2016",
      "venue": "SIGKDD",
      "authors": "MarcoÂ TÃºlio Ribeiro, Sameer Singh, and Carlos Guestrin",
      "orig_title": "â€œWhy should I trust you?â€: Explaining the predictions of any classifier",
      "paper_id": "1602.04938v3"
    },
    {
      "index": 43,
      "title": "The Shapley value: essays in honor of Lloyd S. Shapley",
      "abstract": "",
      "year": "1988",
      "venue": "Cambridge University Press",
      "authors": "AlvinÂ E Roth"
    },
    {
      "index": 44,
      "title": "Stop explaining black box machine learning models for high stakes decisions and use interpretable models instead",
      "abstract": "",
      "year": "2019",
      "venue": "Nature Machine Intelligence",
      "authors": "CynthiaÂ C. Rudin"
    },
    {
      "index": 45,
      "title": "Explaining deep neural networks and beyond: A review of methods and applications",
      "abstract": "",
      "year": "2021",
      "venue": "Proceedings of the IEEE",
      "authors": "Wojciech Samek, GrÃ©goire Montavon, Sebastian Lapuschkin, ChristopherÂ J Anders, and Klaus-Robert MÃ¼ller"
    },
    {
      "index": 46,
      "title": "Toward causal representation learning",
      "abstract": "",
      "year": "2021",
      "venue": "Proceedings of the IEEE",
      "authors": "Bernhard SchÃ¶lkopf, Francesco Locatello, Stefan Bauer, NanÂ Rosemary Ke, Nal Kalchbrenner, Anirudh Goyal, and Yoshua Bengio"
    },
    {
      "index": 47,
      "title": "A value for n-person games",
      "abstract": "",
      "year": "1953",
      "venue": "Contributions to the Theory of Games",
      "authors": "LloydÂ S. Shapley"
    },
    {
      "index": 48,
      "title": "On Tractable Representations of Binary Neural Networks",
      "abstract": "",
      "year": "2020",
      "venue": "KR",
      "authors": "Weijia Shi, Andy Shih, Adnan Darwiche, and Arthur Choi",
      "orig_title": "On tractable representations of binary neural networks",
      "paper_id": "2004.02082v2"
    },
    {
      "index": 49,
      "title": "Formal verification of Bayesian network classifiers",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Probabilistic Graphical Models",
      "authors": "Andy Shih, Arthur Choi, and Adnan Darwiche"
    },
    {
      "index": 50,
      "title": "A Symbolic Approach to Explaining Bayesian Network Classifiers",
      "abstract": "",
      "year": "2018",
      "venue": "IJCAI",
      "authors": "Andy Shih, Arthur Choi, and Adnan Darwiche",
      "orig_title": "A symbolic approach to explaining Bayesian network classifiers",
      "paper_id": "1805.03364v1"
    },
    {
      "index": 51,
      "title": "Verifying binarized neural networks by Angluin-style learning",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Theory and Applications of Satisfiability Testing",
      "authors": "Andy Shih, Adnan Darwiche, and Arthur Choi"
    },
    {
      "index": 52,
      "title": "Smoothing Structured Decomposable Circuits",
      "abstract": "",
      "year": "2019",
      "venue": "NeurIPS",
      "authors": "Andy Shih, GuyÂ Van den Broeck, Paul Beame, and Antoine Amarilli",
      "orig_title": "Smoothing structured decomposable circuits",
      "paper_id": "1906.00311v2"
    },
    {
      "index": 53,
      "title": "Algorithms for random generation and counting - a Markov chain approach",
      "abstract": "",
      "year": "1993",
      "venue": "Progress in theoretical computer science. BirkhÃ¤user",
      "authors": "Alistair Sinclair"
    },
    {
      "index": 54,
      "title": "An efficient explanation of individual classifications using game theory",
      "abstract": "",
      "year": "2010",
      "venue": "The Journal of Machine Learning Research",
      "authors": "Erik Strumbelj and Igor Kononenko"
    },
    {
      "index": 55,
      "title": "Model-based problem solving",
      "abstract": "",
      "year": "2008",
      "venue": "Foundations of Artificial Intelligence",
      "authors": "Peter Struss"
    },
    {
      "index": 56,
      "title": "On anomaly interpretation via Shapley values",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv",
      "authors": "Naoya Takeishi and Yoshinobu Kawahara"
    },
    {
      "index": 57,
      "title": "The complexity of computing the permanent",
      "abstract": "",
      "year": "1979",
      "venue": "Theoretical computer science",
      "authors": "LeslieÂ G Valiant"
    },
    {
      "index": 58,
      "title": "Tractable probabilistic models: Representations, algorithms, learning, and applications, 2019",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Guy VanÂ den Broeck, Nicola DiÂ Mauro, and Antonio Vergari"
    },
    {
      "index": 59,
      "title": "On the Tractability of SHAP Explanations",
      "abstract": "",
      "year": "2021",
      "venue": "AAAI",
      "authors": "Guy VanÂ den Broeck, Anton Lykov, Maximilian Schleich, and Dan Suciu",
      "orig_title": "On the tractability of SHAP explanations",
      "paper_id": "2009.08634v2"
    },
    {
      "index": 60,
      "title": "On the Tractability of SHAP Explanations",
      "abstract": "",
      "year": "2022",
      "venue": "Journal of Artificial Intelligence Research",
      "authors": "Guy VanÂ den Broeck, Anton Lykov, Maximilian Schleich, and Dan Suciu",
      "orig_title": "On the tractability of SHAP explanations",
      "paper_id": "2009.08634v2"
    }
  ]
}