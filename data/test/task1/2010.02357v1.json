{
  "paper_id": "2010.02357v1",
  "title": "Understanding the Mechanics of SPIGOT: Surrogate Gradients for Latent Structure Learning",
  "abstract": "Abstract\nLatent structure models are a powerful tool for modeling language data:\nthey can mitigate the error propagation and annotation bottleneck in pipeline\nsystems, while simultaneously uncovering linguistic insights about the data.\nOne challenge with end-to-end training of these models is the argmax operation, which has null gradient.\nIn this paper, we focus on surrogate gradients, a popular strategy to deal with this problem. We explore latent structure learning through the angle of pulling back\nthe downstream learning objective. In this paradigm, we discover\na principled motivation for both the straight-through estimator (STE) as well as\nthe recently-proposed SPIGOT—a variant of STE for structured models.\nOur perspective leads to\nnew algorithms in the same family.\nWe empirically compare the known and the novel pulled-back estimators against\nthe popular alternatives, yielding new insight for practitioners\nand revealing intriguing failure cases.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Mirror descent and nonlinear projected subgradient methods for convex optimization",
      "abstract": "",
      "year": "2003",
      "venue": "Operations Research Letters",
      "authors": "Amir Beck and Marc Teboulle"
    },
    {
      "index": 1,
      "title": "Cython: the best of both worlds",
      "abstract": "",
      "year": "2011",
      "venue": "Computing in Science & Engineering",
      "authors": "Stefan Behnel, Robert Bradshaw, Craig Citro, Lisandro Dalcin, Dag Sverre Seljebotn, and Kurt Smith"
    },
    {
      "index": 2,
      "title": "Estimating or propagating gradients through stochastic neurons for conditional computation",
      "abstract": "",
      "year": "2013",
      "venue": "arXiv:1308.3432",
      "authors": "Yoshua Bengio, Nicholas Léonard, and Aaron Courville"
    },
    {
      "index": 3,
      "title": "Nonlinear Programming",
      "abstract": "",
      "year": "1999",
      "venue": "Athena Scientific Belmont",
      "authors": "Dimitri P Bertsekas"
    },
    {
      "index": 4,
      "title": "A large annotated corpus for learning natural language inference",
      "abstract": "",
      "year": "2015",
      "venue": "EMNLP",
      "authors": "Samuel R Bowman, Gabor Angeli, Christopher Potts, and Christopher D Manning",
      "orig_title": "A large annotated corpus for learning natural language inference",
      "paper_id": "1508.05326v1"
    },
    {
      "index": 5,
      "title": "Straight-Through Estimator as Projected Wasserstein Gradient Flow",
      "abstract": "",
      "year": "2018",
      "venue": "Third workshop on Bayesian Deep Learning (NeurIPS 2018)",
      "authors": "Pengyu Cheng, Chang Liu, Chunyuan Li, Dinghan Shen, Ricardo Henao, and Lawrence Carin",
      "orig_title": "Straight-through estimator as projected Wasserstein gradient flow",
      "paper_id": "1910.02176v1"
    },
    {
      "index": 6,
      "title": "Learning to compose task-specific tree structures",
      "abstract": "",
      "year": "2018",
      "venue": "AAAI",
      "authors": "Jihun Choi, Kang Min Yoo, and Sang-goo Lee"
    },
    {
      "index": 7,
      "title": "Differentiable Perturb-and-Parse: Semi-Supervised Parsing with a Structured Variational Autoencoder",
      "abstract": "",
      "year": "2019",
      "venue": "ICLR",
      "authors": "Caio Corro and Ivan Titov",
      "orig_title": "Differentiable Perturb-and-Parse: Semi-supervised parsing with a structured variational autoencoder",
      "paper_id": "1807.09875v2"
    },
    {
      "index": 8,
      "title": "Learning latent trees with stochastic perturbations and differentiable dynamic programming",
      "abstract": "",
      "year": "2019",
      "venue": "ACL",
      "authors": "Caio Corro and Ivan Titov"
    },
    {
      "index": 9,
      "title": "Solving the problem of cascading errors: Approximate bayesian inference for linguistic annotation pipelines",
      "abstract": "",
      "year": "2006",
      "venue": "EMNLP",
      "authors": "Jenny Rose Finkel, Christopher D Manning, and Andrew Y Ng"
    },
    {
      "index": 10,
      "title": "Likelihood ratio gradient estimation for stochastic systems",
      "abstract": "",
      "year": "1990",
      "venue": "Commun. ACM",
      "authors": "Peter W Glynn"
    },
    {
      "index": 11,
      "title": "Convex programming in hilbert space",
      "abstract": "",
      "year": "1964",
      "venue": "Bulletin of the American Mathematical Society",
      "authors": "Alan A Goldstein"
    },
    {
      "index": 12,
      "title": "Array Programming with NumPy",
      "abstract": "",
      "year": "2020",
      "venue": "Nature",
      "authors": "Charles R. Harris, K. Jarrod Millman, Stéfan J van der Walt, Ralf Gommers, Pauli Virtanen, David Cournapeau, Eric Wieser, Julian Taylor, Sebastian Berg, Nathaniel J. Smith, Robert Kern, Matti Picus, Stephan Hoyer, Marten H. van Kerkwijk, Matthew Brett, Allan Haldane, Jaime Fernández del Río, Mark Wiebe, Pearu Peterson, Pierre Gérard-Marchant, Kevin Sheppard, Tyler Reddy, Warren Weckesser, Hameer Abbasi, Christoph Gohlke, and Travis E. Oliphant",
      "orig_title": "Array programming with NumPy",
      "paper_id": "2006.10256v1"
    },
    {
      "index": 13,
      "title": "Cooperative learning of disjoint syntax and semantics",
      "abstract": "",
      "year": "2019",
      "venue": "NAACL: Volume 1 (Long and Short Papers)",
      "authors": "Serhii Havrylov, Germán Kruszewski, and Armand Joulin"
    },
    {
      "index": 14,
      "title": "Neural networks for machine learning",
      "abstract": "",
      "year": "2012",
      "venue": "Coursera video lectures",
      "authors": "Geoffrey Hinton"
    },
    {
      "index": 15,
      "title": "Binarized neural networks",
      "abstract": "",
      "year": "2016",
      "venue": "NeurIPS",
      "authors": "Itay Hubara, Matthieu Courbariaux, Daniel Soudry, Ran El-Yaniv, and Yoshua Bengio"
    },
    {
      "index": 16,
      "title": "Categorical reparametrization with Gumbel-Softmax",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Eric Jang, Shixiang Gu, and Ben Poole"
    },
    {
      "index": 17,
      "title": "Structured Attention Networks",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Yoon Kim, Carl Denton, Loung Hoang, and Alexander M Rush",
      "orig_title": "Structured attention networks",
      "paper_id": "1702.00887v3"
    },
    {
      "index": 18,
      "title": "Adam: A method for stochastic optimization",
      "abstract": "",
      "year": "2014",
      "venue": "ICLR",
      "authors": "Diederik P Kingma and Jimmy Ba"
    },
    {
      "index": 19,
      "title": "Exponentiated gradient versus gradient descent for linear predictors",
      "abstract": "",
      "year": "1997",
      "venue": "Information and Computation",
      "authors": "Jyrki Kivinen and Manfred K Warmuth"
    },
    {
      "index": 20,
      "title": "Optimization and sensitivity analysis of computer simulation models by the score function method",
      "abstract": "",
      "year": "1996",
      "venue": "European Journal of Operational Research",
      "authors": "Jack PC Kleijnen and Reuven Y Rubinstein"
    },
    {
      "index": 21,
      "title": "Conditional random fields: Probabilistic models for segmenting and labeling sequence data",
      "abstract": "",
      "year": "2001",
      "venue": "ICML",
      "authors": "John Lafferty, Andrew McCallum, and Fernando CN Pereira"
    },
    {
      "index": 22,
      "title": "Constrained minimization methods",
      "abstract": "",
      "year": "1966",
      "venue": "USSR Computational mathematics and mathematical physics",
      "authors": "Evgeny S Levitin and Boris T Polyak"
    },
    {
      "index": 23,
      "title": "Learning Structured Text Representations",
      "abstract": "",
      "year": "2018",
      "venue": "TACL",
      "authors": "Yang Liu and Mirella Lapata",
      "orig_title": "Learning structured text representations",
      "paper_id": "1705.09207v4"
    },
    {
      "index": 24,
      "title": "Decoupled Weight Decay Regularization",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv:1711.05101",
      "authors": "Ilya Loshchilov and Frank Hutter",
      "orig_title": "Decoupled weight decay regularization",
      "paper_id": "1711.05101v3"
    },
    {
      "index": 25,
      "title": "The Concrete Distribution: A Continuous Relaxation of Discrete Random Variables",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Chris J Maddison, Andriy Mnih, and Yee Whye Teh",
      "orig_title": "The concrete distribution: A continuous relaxation of discrete random variables",
      "paper_id": "1611.00712v3"
    },
    {
      "index": 26,
      "title": "Latent Tree Learning with Differentiable Parsers: Shift-Reduce Parsing and Chart Parsing",
      "abstract": "",
      "year": "2018",
      "venue": "ACL",
      "authors": "Jean Maillard and Stephen Clark"
    },
    {
      "index": 27,
      "title": "Jointly Learning Sentence Embeddings and Syntax with Unsupervised Tree-LSTMs",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv:1705.09189",
      "authors": "Jean Maillard, Stephen Clark, and Dani Yogatama",
      "orig_title": "Jointly learning sentence embeddings and syntax with unsupervised tree-LSTMs",
      "paper_id": "1705.09189v1"
    },
    {
      "index": 28,
      "title": "From softmax to sparsemax: A sparse model of attention and multi-label classification",
      "abstract": "",
      "year": "2016",
      "venue": "ICML",
      "authors": "André FT Martins and Ramón Fernandez Astudillo"
    },
    {
      "index": 29,
      "title": "Training binary neural networks using the bayesian learning rule",
      "abstract": "",
      "year": "2020",
      "venue": "ICML",
      "authors": "Xiangming Meng, Roman Bachmann, and Mohammad Emtiyaz Khan"
    },
    {
      "index": 30,
      "title": "Differentiable dynamic programming for structured prediction and attention",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Arthur Mensch and Mathieu Blondel"
    },
    {
      "index": 31,
      "title": "SparseMAP: Differentiable Sparse Structured Inference",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Vlad Niculae, André FT Martins, Mathieu Blondel, and Claire Cardie",
      "orig_title": "SparseMAP: Differentiable sparse structured inference",
      "paper_id": "1802.04223v2"
    },
    {
      "index": 32,
      "title": "Towards Dynamic Computation Graphs via Sparse Latent Structure",
      "abstract": "",
      "year": "2018",
      "venue": "EMNLP",
      "authors": "Vlad Niculae, André FT Martins, and Claire Cardie",
      "orig_title": "Towards dynamic computation graphs via sparse latent structure",
      "paper_id": "1809.00653v1"
    },
    {
      "index": 33,
      "title": "Perturb-and-map random fields: Using discrete optimization to learn and sample from energy models",
      "abstract": "",
      "year": "2011",
      "venue": "ICCV",
      "authors": "George Papandreou and Alan L Yuille"
    },
    {
      "index": 34,
      "title": "A Decomposable Attention Model for Natural Language Inference",
      "abstract": "",
      "year": "2016",
      "venue": "EMNLP",
      "authors": "Ankur P Parikh, Oscar Täckström, Dipanjan Das, and Jakob Uszkoreit",
      "orig_title": "A decomposable attention model for natural language inference",
      "paper_id": "1606.01933v2"
    },
    {
      "index": 35,
      "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "abstract": "",
      "year": "2019",
      "venue": "NeurIPS",
      "authors": "Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban Desmaison, Andreas Kopf, Edward Yang, Zachary DeVito, Martin Raison, Alykhan Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith Chintala",
      "orig_title": "Pytorch: An imperative style, high-performance deep learning library",
      "paper_id": "1912.01703v1"
    },
    {
      "index": 36,
      "title": "Scikit-learn: Machine learning in Python",
      "abstract": "",
      "year": "2011",
      "venue": "JMLR",
      "authors": "F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay"
    },
    {
      "index": 37,
      "title": "Backpropagating through Structured Argmax using a spigot",
      "abstract": "",
      "year": "2018",
      "venue": "ACL",
      "authors": "Hao Peng, Sam Thomson, and Noah A Smith",
      "orig_title": "Backpropagating through structured argmax using a SPIGOT",
      "paper_id": "1805.04658v1"
    },
    {
      "index": 38,
      "title": "GloVe: Global vectors for word representation",
      "abstract": "",
      "year": "2014",
      "venue": "EMNLP",
      "authors": "Jeffrey Pennington, Richard Socher, and Christopher Manning"
    },
    {
      "index": 39,
      "title": "V-measure: A conditional entropy-based external cluster evaluation measure",
      "abstract": "",
      "year": "2007",
      "venue": "EMNLP-CoNLL",
      "authors": "Andrew Rosenberg and Julia Hirschberg"
    },
    {
      "index": 40,
      "title": "Torch-Struct: Deep Structured Prediction Library",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Alexander M. Rush",
      "orig_title": "Torch-struct: Deep structured prediction library.",
      "paper_id": "2002.00876v1"
    },
    {
      "index": 41,
      "title": "Minimum Risk Training for Neural Machine Translation",
      "abstract": "",
      "year": "2016",
      "venue": "ACL: Volume 1 (Long Papers)",
      "authors": "Shiqi Shen, Yong Cheng, Zhongjun He, Wei He, Hua Wu, Maosong Sun, and Yang Liu",
      "orig_title": "Minimum risk training for neural machine translation",
      "paper_id": "1512.02433v3"
    },
    {
      "index": 42,
      "title": "Minimum risk annealing for training log-linear models",
      "abstract": "",
      "year": "2006",
      "venue": "COLING/ACL",
      "authors": "David A Smith and Jason Eisner"
    },
    {
      "index": 43,
      "title": "Recursive deep models for semantic compositionality over a sentiment treebank",
      "abstract": "",
      "year": "2013",
      "venue": "EMNLP",
      "authors": "Richard Socher, Alex Perelygin, Jean Wu, Jason Chuang, Christopher D Manning, Andrew Ng, and Christopher Potts"
    },
    {
      "index": 44,
      "title": "Empirical risk minimization of graphical model parameters given approximate inference, decoding, and model structure",
      "abstract": "",
      "year": "2011",
      "venue": "AISTATS",
      "authors": "Veselin Stoyanov, Alexander Ropson, and Jason Eisner"
    },
    {
      "index": 45,
      "title": "Joint parsing and semantic role labeling",
      "abstract": "",
      "year": "2005",
      "venue": "CoNLL",
      "authors": "Charles Sutton and Andrew McCallum"
    },
    {
      "index": 46,
      "title": "BERT Rediscovers the Classical NLP Pipeline",
      "abstract": "",
      "year": "2019",
      "venue": "ACL",
      "authors": "Ian Tenney, Dipanjan Das, and Ellie Pavlick",
      "orig_title": "BERT rediscovers the classical NLP pipeline",
      "paper_id": "1905.05950v2"
    },
    {
      "index": 47,
      "title": "END-TO-END FEEDBACK LOSS IN SPEECH CHAIN FRAMEWORK VIA STRAIGHT-THROUGH ESTIMATOR",
      "abstract": "",
      "year": "2019",
      "venue": "ICASSP",
      "authors": "Andros Tjandra, Sakriani Sakti, and Satoshi Nakamura",
      "orig_title": "End-to-end feedback loss in speech chain framework via straight-through estimator",
      "paper_id": "1810.13107v1"
    },
    {
      "index": 48,
      "title": "Effective statistical models for syntactic and semantic disambiguation",
      "abstract": "",
      "year": "2005",
      "venue": "Stanford University",
      "authors": "Kristina Nikolova Toutanova"
    },
    {
      "index": 49,
      "title": "The NumPy array: a structure for efficient numerical computation",
      "abstract": "",
      "year": "2011",
      "venue": "Computing in Science & Engineering",
      "authors": "Stéfan J van der Walt, S Chris Colbert, and Gael Varoquaux"
    },
    {
      "index": 50,
      "title": "Python 3 Reference Manual",
      "abstract": "",
      "year": "2009",
      "venue": "CreateSpace, Scotts Valley, CA",
      "authors": "Guido Van Rossum and Fred L. Drake"
    },
    {
      "index": 51,
      "title": "Attention Is All You Need",
      "abstract": "",
      "year": "2017",
      "venue": "NeurIPS",
      "authors": "Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N. Gomez, Lukasz Kaiser, and Illia Polosukhin",
      "orig_title": "Attention is all you need",
      "paper_id": "1706.03762v7"
    },
    {
      "index": 52,
      "title": "SciPy 1.0—Fundamental Algorithms for Scientific Computing in Python",
      "abstract": "",
      "year": "2020",
      "venue": "Nature Methods",
      "authors": "Pauli Virtanen, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, Pearu Peterson, Warren Weckesser, Jonathan Bright, Stéfan J van der Walt, Matthew Brett, Joshua Wilson, K Jarrod Millman, Nikolay Mayorov, Andrew RJ Nelson, Eric Jones, Robert Kern, Eric Larson, CJ Carey, İlhan Polat, Yu Feng, Eric W. Moore, Jake VanderPlas, Denis Laxalde, Josef Perktold, Robert Cimrman, Ian Henriksen, EA Quintero, Charles R Harris, Anne M Archibald, Antônio H Ribeiro, Fabian Pedregosa, Paul van Mulbregt, and SciPy 1.0 Contributors",
      "orig_title": "SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python",
      "paper_id": "1907.10121v1"
    },
    {
      "index": 53,
      "title": "Differentiation of Blackbox Combinatorial Solvers",
      "abstract": "",
      "year": "2020",
      "venue": "ICLR",
      "authors": "Marin Vlastelica, Anselm Paulus, Vit Musil, Georg Martius, and Michal Rolinek",
      "orig_title": "Differentiation of blackbox combinatorial solvers",
      "paper_id": "1912.02175v2"
    },
    {
      "index": 54,
      "title": "Graphical models, exponential families, and variational inference",
      "abstract": "",
      "year": "2008",
      "venue": "Found. Trends Mach. Learn.",
      "authors": "Martin J Wainwright and Michael I Jordan"
    },
    {
      "index": 55,
      "title": "Do latent tree learning models identify meaningful structure in sentences?",
      "abstract": "",
      "year": "2018",
      "venue": "TACL",
      "authors": "Adina Williams, Andrew Drozdov, and Samuel R Bowman"
    },
    {
      "index": 56,
      "title": "Simple statistical gradient-following algorithms for connectionist reinforcement learning",
      "abstract": "",
      "year": "1992",
      "venue": "Machine Learning",
      "authors": "Ronald J Williams"
    },
    {
      "index": 57,
      "title": "A Study of Reinforcement Learning for Neural Machine Translation",
      "abstract": "",
      "year": "2018",
      "venue": "EMNLP",
      "authors": "Lijun Wu, Fei Tian, Tao Qin, Jianhuang Lai, and Tie-Yan Liu",
      "orig_title": "A study of reinforcement learning for neural machine translation",
      "paper_id": "1808.08866v1"
    },
    {
      "index": 58,
      "title": "Understanding Straight-Through Estimator in Training Activation Quantized Neural Nets",
      "abstract": "",
      "year": "2019",
      "venue": "ICLR",
      "authors": "Penghang Yin, Jiancheng Lyu, Shuai Zhang, Stanley Osher, Yingyong Qi, and Jack Xin",
      "orig_title": "Understanding straight-through estimator in training activation quantized neural nets",
      "paper_id": "1903.05662v4"
    },
    {
      "index": 59,
      "title": "Learning to Compose Words into Sentences with Reinforcement Learning",
      "abstract": "",
      "year": "2017",
      "venue": "ICLR",
      "authors": "Dani Yogatama, Phil Blunsom, Chris Dyer, Edward Grefenstette, and Wang Ling",
      "orig_title": "Learning to compose words into sentences with reinforcement learning",
      "paper_id": "1611.09100v1"
    }
  ]
}