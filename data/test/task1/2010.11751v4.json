{
  "paper_id": "2010.11751v4",
  "title": "Cross-platform programming model for many-core lattice Boltzmann simulation",
  "abstract": "Abstract\nWe present a novel, hardware-agnostic implementation strategy for lattice Boltzmann (LB) simulations, which yields massive performance on homogeneous and heterogeneous many-core platforms. Based solely on C++17 Parallel Algorithms, our approach does not rely on any language extensions, external libraries, vendor-specific code annotations, or pre-compilation steps. Thanks in particular to a recently proposed GPU back-end to C++17 Parallel Algorithms, it is shown that a single code can compile and reach state-of-the-art performance on both many-core CPU and GPU environments for the solution of a given non trivial fluid dynamics problem. The proposed strategy is tested with six different, commonly used implementation schemes to test the performance impact of memory access patterns on different platforms. Nine different LB collision models are included in the tests and exhibit good performance, demonstrating the versatility of our parallel approach. This work shows that it is less than ever necessary to draw a distinction between research and production software, as a concise and generic LB implementation yields performances comparable to those achievable in a hardware specific programming language. The results also highlight the gains of performance achieved by modern many-core CPUs and their apparent capability to narrow the gap with the traditionally massively faster GPU platforms. All code is made available to the community in form of the open-source project stlbm, which serves both as a stand-alone simulation software and as a collection of reusable patterns for the acceleration of pre-existing LB codes.",
  "reference_labels": [
    {
      "index": 0,
      "title": "Palabos: Parallel Lattice Boltzmann Solver",
      "abstract": "",
      "year": "2021",
      "venue": "Computers & Mathematics with Applications",
      "authors": "Latt J, Malaspinas O, Kontaxakis D, Parmigiani A, Lagrava D, Brogi F, et al."
    },
    {
      "index": 1,
      "title": "Numerical simulations of particulate suspensions via a discretized Boltzmann equation. Part 1. Theoretical foundation",
      "abstract": "",
      "year": "1994",
      "venue": "Journal of Fluid Mechanics",
      "authors": "Ladd AJC"
    },
    {
      "index": 2,
      "title": "The Lattice Boltzmann Method: Principles and Practice",
      "abstract": "",
      "year": "2017",
      "venue": "Springer International Publishing",
      "authors": "Krüger T, Kusumaatmaja H, Kuzmin A, Shardt O, Silva G, Viggen EM"
    },
    {
      "index": 3,
      "title": "Enhanced single-node boundary condition for the Lattice Boltzmann Method",
      "abstract": "",
      "year": "",
      "venue": "Physical Review E",
      "authors": "Marson F, Thorimbert Y, Chopard B, Ginzburg I, Latt J"
    },
    {
      "index": 4,
      "title": "An efficient kernel-based implementation of POSIX threads",
      "abstract": "",
      "year": "1994",
      "venue": "USENIX Summer 1994 Technical Conference",
      "authors": "Alfieri RA"
    },
    {
      "index": 5,
      "title": "Parallel programming models for heterogeneous many-cores: a comprehensive survey",
      "abstract": "",
      "year": "2020",
      "venue": "CCF Trans HPC",
      "authors": "Fang J, Huang C, Tang T, Wang Z"
    },
    {
      "index": 6,
      "title": "PACXX: Towards a Unified Programming Model for Programming Accelerators Using C++14",
      "abstract": "",
      "year": "2014",
      "venue": "2014 LLVM Compiler Infrastructure in HPC",
      "authors": "Haidl M, Gorlatch S"
    },
    {
      "index": 7,
      "title": "Thrust: A productivity-oriented library for CUDA",
      "abstract": "",
      "year": "2012",
      "venue": "GPU computing gems Jade edition",
      "authors": "Bell N, Hoberock J"
    },
    {
      "index": 8,
      "title": "Multicore Desktop Programming with Intel Threading Building Blocks",
      "abstract": "",
      "year": "2011",
      "venue": "IEEE Software",
      "authors": "Kim W, Voss M"
    },
    {
      "index": 9,
      "title": "Optimization and profiling of the cache performance of parallel lattice Boltzmann codes",
      "abstract": "",
      "year": "2003",
      "venue": "Parallel Process Lett.",
      "authors": "Pohl T, Kowarschik M, Wilke J, Iglberger K, Rüde U"
    },
    {
      "index": 10,
      "title": "waLBerla: A block-structured high-performance framework for multiphysics simulations",
      "abstract": "",
      "year": "2020",
      "venue": "Computers & Mathematics with Applications",
      "authors": "Bauer M, Eibl S, Godenschwager C, Kohl N, Kuron M, Rettinger C, et al.",
      "orig_title": "waLBerla: A block-structured high-performance framework for multiphysics simulations",
      "paper_id": "1909.13772v1"
    },
    {
      "index": 11,
      "title": "An efficient swap algorithm for the lattice Boltzmann method",
      "abstract": "",
      "year": "2007",
      "venue": "Computer Physics Communications",
      "authors": "Mattila K, Hyväluoma J, Rossi T, Aspnäs M, Westerholm J"
    },
    {
      "index": 12,
      "title": "Accelerating Lattice Boltzmann Fluid Flow Simulations Using Graphics Processors",
      "abstract": "",
      "year": "2009",
      "venue": "2009 International Conference on Parallel Processing",
      "authors": "Bailey P, Myre J, Walsh SDC, Lilja DJ, Saar MO"
    },
    {
      "index": 13,
      "title": "Auto-vectorization friendly parallel lattice Boltzmann streaming scheme for direct addressing",
      "abstract": "",
      "year": "2019",
      "venue": "Computers & Fluids",
      "authors": "Mohrhard M, Thäter G, Bludau J, Horvat B, Krause MJ"
    },
    {
      "index": 14,
      "title": "Optimization principles and application performance evaluation of a multithreaded GPU using CUDA",
      "abstract": "",
      "year": "2008",
      "venue": "ACM SIGPLAN Symposium on Principles and practice of parallel programming",
      "authors": "Ryoo S, Rodrigues CI, Baghsorkhi SS, Stone SS, Kirk DB, Hwu WmW"
    },
    {
      "index": 15,
      "title": "Implementation of a Lattice Boltzmann kernel using the Compute Unified Device Architecture developed by nVIDIA",
      "abstract": "",
      "year": "2010",
      "venue": "Comput Visual Sci.",
      "authors": "Tölke J"
    },
    {
      "index": 16,
      "title": "LBM based flow simulation using GPU computing processor",
      "abstract": "",
      "year": "2010",
      "venue": "Computers & Mathematics with Applications",
      "authors": "Kuznik F, Obrecht C, Rusaouen G, Roux JJ"
    },
    {
      "index": 17,
      "title": "A new approach to the lattice Boltzmann method for graphics processing units",
      "abstract": "",
      "year": "2011",
      "venue": "Computers & Mathematics with Applications",
      "authors": "Obrecht C, Kuznik F, Tourancheau B, Roux JJ"
    },
    {
      "index": 18,
      "title": "Memory transfer optimization for a lattice Boltzmann solver on Kepler architecture nVidia GPUs",
      "abstract": "",
      "year": "2014",
      "venue": "Computer Physics Communications",
      "authors": "Mawson MJ, Revell AJ"
    },
    {
      "index": 19,
      "title": "Performance Optimization of 3D Lattice Boltzmann Flow Solver on a GPU",
      "abstract": "",
      "year": "2017",
      "venue": "Scientific Programming",
      "authors": "Tran NP, Lee M, Hong S"
    },
    {
      "index": 20,
      "title": "Evaluation of a performance portable lattice Boltzmann code using OpenCL",
      "abstract": "",
      "year": "2014",
      "venue": "International Workshop on OpenCL",
      "authors": "McIntosh-Smith S, Curran D"
    },
    {
      "index": 21,
      "title": "Performance Evaluation of an OpenCL Implementation of the Lattice Boltzmann Method on the Intel Xeon Phi",
      "abstract": "",
      "year": "2015",
      "venue": "Parallel Process Lett.",
      "authors": "Obrecht C, Tourancheau B, Kuznik F"
    },
    {
      "index": 22,
      "title": "Sailfish: A flexible multi-GPU implementation of the lattice Boltzmann method",
      "abstract": "",
      "year": "2014",
      "venue": "Computer Physics Communications",
      "authors": "Januszewski M, Kostur M"
    },
    {
      "index": 23,
      "title": "Advances in multi-domain lattice Boltzmann grid refinement",
      "abstract": "",
      "year": "2012",
      "venue": "Journal of Computational Physics",
      "authors": "Lagrava D, Malaspinas O, Latt J, Chopard B"
    },
    {
      "index": 24,
      "title": "Analysis and reduction of spurious noise generated at grid refinement interfaces with the lattice Boltzmann method",
      "abstract": "",
      "year": "2020",
      "venue": "J Comput Phys.",
      "authors": "Astoul T, Wissocq G, Boussuge JF, Sengissen A, Sagaut P"
    },
    {
      "index": 25,
      "title": "The Lattice Boltzmann Equation for Fluid Dynamics and Beyond",
      "abstract": "",
      "year": "2001",
      "venue": "Clarendon Press",
      "authors": "Succi S"
    },
    {
      "index": 26,
      "title": "Cellular Automata Modeling of Physical Systems",
      "abstract": "",
      "year": "2012",
      "venue": "Springer New York",
      "authors": "Chopard B"
    },
    {
      "index": 27,
      "title": "Numerical simulations of particulate suspensions via a discretized Boltzmann equation. Part 1. Theoretical foundation",
      "abstract": "",
      "year": "1994",
      "venue": "J Fluid Mech.",
      "authors": "Ladd AJC"
    },
    {
      "index": 28,
      "title": "Two-relaxation-time Lattice Boltzmann Scheme: About Parametrization, Velocity, Pressure and Mixed Boundary Conditions",
      "abstract": "",
      "year": "2008",
      "venue": "Communications in Computational Physics",
      "authors": "Ginzburg I, Verhaeghe F, d’Humières D"
    },
    {
      "index": 29,
      "title": "Initial and boundary conditions for the lattice Boltzmann method",
      "abstract": "",
      "year": "1993",
      "venue": "Phys Rev E.",
      "authors": "Skordos PA"
    },
    {
      "index": 30,
      "title": "Comprehensive comparison of collision models in the lattice Boltzmann framework: Theoretical investigations",
      "abstract": "",
      "year": "2019",
      "venue": "Phys Rev E.",
      "authors": "Coreixas C, Chopard B, Latt J"
    },
    {
      "index": 31,
      "title": "Impact of collision models on the physical properties and the stability of lattice Boltzmann methods",
      "abstract": "",
      "year": "2020",
      "venue": "Phil Trans R Soc A.",
      "authors": "Coreixas C, Wissocq G, Chopard B, Latt J"
    },
    {
      "index": 32,
      "title": "Lattice BGK Models for Navier-Stokes Equation",
      "abstract": "",
      "year": "1992",
      "venue": "Europhys Lett.",
      "authors": "Qian YH, D’Humières D, Lallemand P"
    },
    {
      "index": 33,
      "title": "Multiphysics flow simulations using D3Q19 lattice Boltzmann methods based on central moments",
      "abstract": "",
      "year": "2020",
      "venue": "Phys Fluids.",
      "authors": "De Rosis A, Coreixas C"
    },
    {
      "index": 34,
      "title": "Viscosity independent numerical errors for Lattice Boltzmann models: From recurrence equations to “magic” collision numbers",
      "abstract": "",
      "year": "2009",
      "venue": "Comput Math Appl.",
      "authors": "d’Humières D, Ginzburg I"
    },
    {
      "index": 35,
      "title": "Generalized lattice-Boltzmann equations",
      "abstract": "",
      "year": "1992",
      "venue": "Prog Astronaut Aeronaut.",
      "authors": "d’Humières D"
    },
    {
      "index": 36,
      "title": "Theory of the lattice Boltzmann method: Dispersion, dissipation, isotropy, Galilean invariance, and stability",
      "abstract": "",
      "year": "2000",
      "venue": "Phys Rev E.",
      "authors": "Lallemand P, Luo LS"
    },
    {
      "index": 37,
      "title": "Multiple-relaxation-time lattice Boltzmann models in three dimensions",
      "abstract": "",
      "year": "2002",
      "venue": "Philos Trans R Soc London, Ser A.",
      "authors": "d’Humières D"
    },
    {
      "index": 38,
      "title": "Lattice Boltzmann Method with Regularized Pre-collision Distribution Functions",
      "abstract": "",
      "year": "2006",
      "venue": "Math Comput Simul.",
      "authors": "Latt J, Chopard B"
    },
    {
      "index": 39,
      "title": "A general multiple-relaxation-time Boltzmann collision model",
      "abstract": "",
      "year": "2007",
      "venue": "Int J Mod Phys C.",
      "authors": "Shan X, Chen H"
    },
    {
      "index": 40,
      "title": "Duality in matrix lattice Boltzmann models",
      "abstract": "",
      "year": "2008",
      "venue": "Phys Rev E.",
      "authors": "Adhikari R, Succi S"
    },
    {
      "index": 41,
      "title": "Recovery of Galilean invariance in thermal lattice Boltzmann models for arbitrary Prandtl number",
      "abstract": "",
      "year": "2014",
      "venue": "Int J Mod Phys C.",
      "authors": "Chen H, Gopalakrishnan P, Zhang R"
    },
    {
      "index": 42,
      "title": "Cascaded digital lattice Boltzmann automata for high Reynolds number flow",
      "abstract": "",
      "year": "2006",
      "venue": "Phys Rev E.",
      "authors": "Geier M, Greiner A, Korvink JG"
    },
    {
      "index": 43,
      "title": "Aerodynamic Simulations of a High-Lift configuration by Lattice Boltzmann Method with Block-Structured Cartesian Grid",
      "abstract": "",
      "year": "2019",
      "venue": "AIAA Scitech 2019 Forum",
      "authors": "Ishida T"
    },
    {
      "index": 44,
      "title": "Simulations of Aerodynamic Separated Flows Using the Lattice Boltzmann Solver XFlow",
      "abstract": "",
      "year": "2020",
      "venue": "Energies",
      "authors": "Chávez-Modena M, Martínez JL, Cabello JA, Ferrer E"
    },
    {
      "index": 45,
      "title": "High-order regularization in lattice-Boltzmann equations",
      "abstract": "",
      "year": "2017",
      "venue": "Phys Fluids.",
      "authors": "Mattila KK, Philippi PC, Hegele Jr LA"
    },
    {
      "index": 46,
      "title": "Central-moment-based Galilean-invariant multiple-relaxation-time collision model",
      "abstract": "",
      "year": "2019",
      "venue": "Phys Rev E.",
      "authors": "Shan X"
    },
    {
      "index": 47,
      "title": "Compressibility in lattice Boltzmann on standard stencils: effects of deviation from reference temperature",
      "abstract": "",
      "year": "2020",
      "venue": "Phil Trans R Soc A.",
      "authors": "Hosseini SA, Darabiha N, Thévenin D"
    },
    {
      "index": 48,
      "title": "The cumulant lattice Boltzmann equation in three dimensions: Theory and validation",
      "abstract": "",
      "year": "2015",
      "venue": "Comput Math Appl.",
      "authors": "Geier M, Schönherr M, Pasquali A, Krafczyk M"
    },
    {
      "index": 49,
      "title": "Scrutinizing lattice Boltzmann methods for direct numerical simulations of turbulent channel flows",
      "abstract": "",
      "year": "2017",
      "venue": "Comput Fluids.",
      "authors": "Gehrke M, Janßen CF, Rung T"
    },
    {
      "index": 50,
      "title": "A filtered cumulant lattice Boltzmann method for violent two-phase flows",
      "abstract": "",
      "year": "2019",
      "venue": "J Comput Phys.",
      "authors": "Sitompul YP, Aoki T"
    },
    {
      "index": 51,
      "title": "Implicit Large-Eddy Simulation of rotating and non-rotating machinery with Cumulant Lattice Boltzmann method aiming for industrial applications",
      "abstract": "",
      "year": "2019",
      "venue": "AIAA Aviation 2019 Forum",
      "authors": "Nishimura S, Hayashi K, Nakaye S, Yoshimoto M, Suga K, Inamuro T"
    },
    {
      "index": 52,
      "title": "Increasing stability and accuracy of the lattice Boltzmann scheme: Recursivity and regularization",
      "abstract": "",
      "year": "2015",
      "venue": "arXiv",
      "authors": "Malaspinas O"
    },
    {
      "index": 53,
      "title": "Recursive regularization step for high-order lattice Boltzmann methods",
      "abstract": "",
      "year": "2017",
      "venue": "Phys Rev E.",
      "authors": "Coreixas C, Wissocq G, Puigt G, Boussuge JF, Sagaut P"
    },
    {
      "index": 54,
      "title": "Hermite regularization of the lattice Boltzmann method for open source computational aeroacoustics",
      "abstract": "",
      "year": "2017",
      "venue": "J Acoust Soc Am.",
      "authors": "Brogi F, Malaspinas O, Chopard B, Bonadonna C"
    },
    {
      "index": 55,
      "title": "A new hybrid recursive regularised Bhatnagar-Gross-Krook collision model for Lattice Boltzmann method-based Large Eddy Simulation",
      "abstract": "",
      "year": "2018",
      "venue": "J Turb.",
      "authors": "Jacob J, Malaspinas O, Sagaut P"
    },
    {
      "index": 56,
      "title": "Linear stability of athermal regularized lattice Boltzmann methods",
      "abstract": "",
      "year": "2020",
      "venue": "Phys. Rev. E.",
      "authors": "Wissocq G, Coreixas C, Boussuge J"
    },
    {
      "index": 57,
      "title": "Universal formulation of central-moments-based lattice Boltzmann method with external forcing for the simulation of multiphysics phenomena",
      "abstract": "",
      "year": "2019",
      "venue": "Phys Fluids.",
      "authors": "De Rosis A, Huang R, Coreixas C"
    },
    {
      "index": 58,
      "title": "Three-dimensional cascaded lattice Boltzmann method: Improved implementation and consistent forcing scheme",
      "abstract": "",
      "year": "2018",
      "venue": "Phys. Rev. E.",
      "authors": "Fei L, Luo KH, Li Q"
    },
    {
      "index": 59,
      "title": "High-Reynolds-number turbulent cavity flow using the lattice Boltzmann method",
      "abstract": "",
      "year": "2018",
      "venue": "Phys Rev E.",
      "authors": "Hegele LA, Scagliarini A, Sbragaglia M, Mattila KK, Philippi PC, Puleri DF, et al."
    },
    {
      "index": 60,
      "title": "Reynolds number and end-wall effects on a lid-driven cavity flow",
      "abstract": "",
      "year": "1989",
      "venue": "Physics of Fluids A: Fluid Dynamics",
      "authors": "Prasad AK, Koseff JR"
    },
    {
      "index": 61,
      "title": "Accurate three-dimensional lid-driven cavity flow",
      "abstract": "",
      "year": "2005",
      "venue": "Journal of Computational Physics",
      "authors": "Albensoeder S, Kuhlmann HC"
    },
    {
      "index": 62,
      "title": "Summary of the LAGOON solutions from the Benchmark problems for Airframe Noise Computations-III Workshop",
      "abstract": "",
      "year": "2015",
      "venue": "AIAA/CEAS Aeroacoustics Conference",
      "authors": "Manoha E, Caruelle B"
    },
    {
      "index": 63,
      "title": "Efficient LBM on GPUs for dense moving objects using immersed boundary condition",
      "abstract": "",
      "year": "2018",
      "venue": "CILAMCE Ibero-Latin American Congress on Computational Methods in Engineering",
      "authors": "Beny J, Latt J",
      "orig_title": "Efficient LBM on GPUs for dense moving objects using immersed boundary condition",
      "paper_id": "1904.02108v1"
    }
  ]
}