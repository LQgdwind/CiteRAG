{
  "paper_id": "2105.02001v1",
  "title": "Contrastive Learning and Self-Training for Unsupervised Domain Adaptation in Semantic Segmentation",
  "sections": {
    "experimental settings": "Network Architecture: Similar to [ref]40 8    [ref]20   we deploy the DeepLab-V2  framework with a ResNet-101 as feature extractor ‚Ñ±‚Ñ±\\mathcal{F}. As is common practice, we initialize ‚Ñ±‚Ñ±\\mathcal{F} with weights pre-trained on ImageNet and freeze all batch normalization layers. The final segmentation head ùíüùíü\\mathcal{D} consists of an Atrous Spatial Pyramid Pooling (ASPP) head. We fix the dilation rates of the ASPP head to {6, 12, 18, 24} as it was done in previous work. To create a symmetrical network architecture, we use a similar ASPP head for the projector ùí´ùí´\\mathcal{P} as described before. The only difference is that the projector outputs a tensor with K‚Ä≤=256superscriptùêæ‚Ä≤256K^{\\prime}=256 channels and does not use any non-linearity. Implementation Details:\nOur implementation adopts the PyTorch deep learning framework . Most of the hyperparameters are taken directly from the base architecture from 8. We train the network using SGD with Nesterov acceleration to speed up convergence. We deploy a polynomial learning rate decay with an initial learning rate set to 2.5√ó10‚àí42.5superscript1042.5\\times 10^{-4} and an exponent of 0.90.90.9. The momentum of the optimizer is set to 0.90.90.9 and we use a weight decay of 5√ó10‚àí45superscript1045\\times 10^{-4}. Furthermore, we use 0.10.10.1 for both ŒªS‚ÄãTsubscriptùúÜùëÜùëá\\lambda_{ST} and ŒªC‚ÄãLsubscriptùúÜùê∂ùêø\\lambda_{CL}. For the momentum term œàùúì\\psi in Eq. 8 we use a cosine decay starting from 0.020.020.02. For training and testing, we rescale all source images to size 720√ó12807201280720\\times 1280 and all target images to 512√ó10245121024512\\times 1024 8. In addition, we also investigate the impact of color jittering and Gaussian blur, which was recently used in 7. We train our model using batches with 2 source images and 2 target images. The model is pre-trained for 666k iterations on the source domain before we switch to the loss function from Eq. 10. The pseudo-labels from the temporal ensemble are used after 151515k iterations. Œ≥ùõæ\\gamma is initially set to 1 and incremented by 1 every 252525k iterations. All iteration-related parameters were chosen to be approximately multiples of the number of target images and received no tuning. We set Œ≤ùõΩ\\beta to 555, which limits the weighting of classes that occur in less than 20%percent2020\\% of the images in the dataset. This was set by inspecting the class occurence probabilities in the GTA5 dataset and was also not tuned. Datasets and Metric: We evaluate our approach in the challenging synthetic-to-real scenario, where Cityscapes  is used as the real-world target domain. Cityscapes contains 2975 training and 500 validation images with a resolution of 1024√ó2048102420481024\\times 2048. One of the synthetic source datasets is GTA5 , which contains 24966 synthesized frames of size 1052√ó1914105219141052\\times 1914 of the well known Grand Theft Auto V video game. We evaluate GTA5 ‚Üí‚Üí\\rightarrow Cityscapes using the common 19 classes. The second synthetic source dataset is SYNTHIA 0, which has 9400 images in total and only shares 16 classes with Cityscapes. Following [ref]40  [ref]20 7 , we evaluate this transfer with respect to all 16 classes and for a subset consisting of 13 classes. We train our model using all source images and evaluate it on the Cityscapes validation set. As a metric, we use the widely adopted mean-intersection-over-union (mIoU)."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "Deeplab: Semantic image segmentation with deep convolutional nets, atrous convolution, and fully connected crfs",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE transactions on pattern analysis and machine intelligence",
      "authors": "Liang-Chieh Chen, George Papandreou, Iasonas Kokkinos, Kevin Murphy, and Alan L Yuille"
    },
    {
      "index": 1,
      "title": "Encoder-Decoder with Atrous Separable Convolution for Semantic Image Segmentation",
      "abstract": "",
      "year": "2018",
      "venue": "European conference on computer vision (ECCV)",
      "authors": "Liang-Chieh Chen, Yukun Zhu, George Papandreou, Florian Schroff, and Hartwig Adam",
      "orig_title": "Encoder-decoder with atrous separable convolution for semantic image segmentation",
      "paper_id": "1802.02611v3"
    },
    {
      "index": 2,
      "title": "Domain adaptation for semantic segmentation with maximum squares loss",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Minghao Chen, Hongyang Xue, and Deng Cai"
    },
    {
      "index": 3,
      "title": "A Simple Framework for Contrastive Learning of Visual Representations",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2002.05709",
      "authors": "Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton",
      "orig_title": "A simple framework for contrastive learning of visual representations",
      "paper_id": "2002.05709v3"
    },
    {
      "index": 4,
      "title": "Big Self-Supervised Models are Strong Semi-Supervised Learners",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2006.10029",
      "authors": "Ting Chen, Simon Kornblith, Kevin Swersky, Mohammad Norouzi, and Geoffrey Hinton",
      "orig_title": "Big self-supervised models are strong semi-supervised learners",
      "paper_id": "2006.10029v2"
    },
    {
      "index": 5,
      "title": "No More Discrimination: Cross City Adaptation of Road Scene Segmenters",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Yi-Hsin Chen, Wei-Yu Chen, Yu-Ting Chen, Bo-Cheng Tsai, Yu-Chiang Frank Wang, and Min Sun",
      "orig_title": "No more discrimination: Cross city adaptation of road scene segmenters",
      "paper_id": "1704.08509v1"
    },
    {
      "index": 6,
      "title": "Self-ensembling with gan-based data augmentation for domain adaptation in semantic segmentation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE international conference on computer vision",
      "authors": "Jaehoon Choi, Taekyung Kim, and Changick Kim"
    },
    {
      "index": 7,
      "title": "The Cityscapes Dataset for Semantic Urban Scene Understanding",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "Marius Cordts, Mohamed Omran, Sebastian Ramos, Timo Rehfeld, Markus Enzweiler, Rodrigo Benenson, Uwe Franke, Stefan Roth, and Bernt Schiele",
      "orig_title": "The cityscapes dataset for semantic urban scene understanding",
      "paper_id": "1604.01685v2"
    },
    {
      "index": 8,
      "title": "Self-ensembling for visual domain adaptation",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1706.05208",
      "authors": "Geoffrey French, Michal Mackiewicz, and Mark Fisher",
      "orig_title": "Self-ensembling for visual domain adaptation",
      "paper_id": "1706.05208v4"
    },
    {
      "index": 9,
      "title": "Generative adversarial nets",
      "abstract": "",
      "year": "2014",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio"
    },
    {
      "index": 10,
      "title": "Bootstrap Your Own Latent A New Approach to Self-Supervised Learning",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2006.07733",
      "authors": "Jean-Bastien Grill, Florian Strub, Florent Altch√©, Corentin Tallec, Pierre H Richemond, Elena Buchatskaya, Carl Doersch, Bernardo Avila Pires, Zhaohan Daniel Guo, Mohammad Gheshlaghi Azar, et al.",
      "orig_title": "Bootstrap your own latent: A new approach to self-supervised learning",
      "paper_id": "2006.07733v3"
    },
    {
      "index": 11,
      "title": "Dimensionality reduction by learning an invariant mapping",
      "abstract": "",
      "year": "2006",
      "venue": "2006 IEEE Computer Society Conference on Computer Vision and Pattern Recognition (CVPR‚Äô06)",
      "authors": "Raia Hadsell, Sumit Chopra, and Yann LeCun"
    },
    {
      "index": 12,
      "title": "Momentum Contrast for Unsupervised Visual Representation Learning",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick",
      "orig_title": "Momentum contrast for unsupervised visual representation learning",
      "paper_id": "1911.05722v3"
    },
    {
      "index": 13,
      "title": "Data-Efficient Image Recognition with Contrastive Predictive Coding",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Machine Learning",
      "authors": "Olivier Henaff",
      "orig_title": "Data-efficient image recognition with contrastive predictive coding",
      "paper_id": "1905.09272v3"
    },
    {
      "index": 14,
      "title": "CyCADA: Cycle-Consistent Adversarial Domain Adaptation",
      "abstract": "",
      "year": "2018",
      "venue": "International conference on machine learning",
      "authors": "Judy Hoffman, Eric Tzeng, Taesung Park, Jun-Yan Zhu, Phillip Isola, Kate Saenko, Alexei Efros, and Trevor Darrell",
      "orig_title": "Cycada: Cycle-consistent adversarial domain adaptation",
      "paper_id": "1711.03213v3"
    },
    {
      "index": 15,
      "title": "Fcns in the wild: Pixel-level adversarial and constraint-based adaptation",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1612.02649",
      "authors": "Judy Hoffman, Dequan Wang, Fisher Yu, and Trevor Darrell"
    },
    {
      "index": 16,
      "title": "Domain transfer through deep activation matching",
      "abstract": "",
      "year": "2018",
      "venue": "European Conference on Computer Vision (ECCV)",
      "authors": "Haoshuo Huang, Qixing Huang, and Philipp Krahenbuhl"
    },
    {
      "index": 17,
      "title": "Arbitrary style transfer in real-time with adaptive instance normalization",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Xun Huang and Serge Belongie"
    },
    {
      "index": 18,
      "title": "Contrastive Adaptation Network for Unsupervised Domain Adaptation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Guoliang Kang, Lu Jiang, Yi Yang, and Alexander G Hauptmann",
      "orig_title": "Contrastive adaptation network for unsupervised domain adaptation",
      "paper_id": "1901.00976v2"
    },
    {
      "index": 19,
      "title": "Pixel-Level Cycle Association: A New Perspective for Domain Adaptive Semantic Segmentation",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2011.00147",
      "authors": "Guoliang Kang, Yunchao Wei, Yi Yang, Yueting Zhuang, and Alexander G Hauptmann",
      "orig_title": "Pixel-level cycle association: A new perspective for domain adaptive semantic segmentation",
      "paper_id": "2011.00147v1"
    },
    {
      "index": 20,
      "title": "Temporal Ensembling for Semi-Supervised Learning",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv preprint arXiv:1610.02242",
      "authors": "Samuli Laine and Timo Aila",
      "orig_title": "Temporal ensembling for semi-supervised learning",
      "paper_id": "1610.02242v3"
    },
    {
      "index": 21,
      "title": "Content-consistent matching for domain adaptive semantic segmentation",
      "abstract": "",
      "year": "2020",
      "venue": "European Conference on Computer Vision",
      "authors": "Guangrui Li, Guoliang Kang, Wu Liu, Yunchao Wei, and Yi Yang"
    },
    {
      "index": 22,
      "title": "Bidirectional learning for domain adaptation of semantic segmentation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Yunsheng Li, Lu Yuan, and Nuno Vasconcelos"
    },
    {
      "index": 23,
      "title": "Taking A Closer Look at Domain Shift: Category-level Adversaries for Semantics Consistent Domain Adaptation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Yawei Luo, Liang Zheng, Tao Guan, Junqing Yu, and Yi Yang",
      "orig_title": "Taking a closer look at domain shift: Category-level adversaries for semantics consistent domain adaptation",
      "paper_id": "1809.09478v3"
    },
    {
      "index": 24,
      "title": "UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv preprint arXiv:1802.03426",
      "authors": "Leland McInnes, John Healy, and James Melville",
      "orig_title": "Umap: Uniform manifold approximation and projection for dimension reduction",
      "paper_id": "1802.03426v3"
    },
    {
      "index": 25,
      "title": "Instance Adaptive Self-Training for Unsupervised Domain Adaptation",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2008.12197",
      "authors": "Ke Mei, Chuang Zhu, Jiaqi Zou, and Shanghang Zhang",
      "orig_title": "Instance adaptive self-training for unsupervised domain adaptation",
      "paper_id": "2008.12197v1"
    },
    {
      "index": 26,
      "title": "Unified Deep Supervised Domain Adaptation and Generalization",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE international conference on computer vision",
      "authors": "Saeid Motiian, Marco Piccirilli, Donald A Adjeroh, and Gianfranco Doretto",
      "orig_title": "Unified deep supervised domain adaptation and generalization",
      "paper_id": "1709.10190v1"
    },
    {
      "index": 27,
      "title": "Automatic differentiation in pytorch",
      "abstract": "",
      "year": "2017",
      "venue": "",
      "authors": "Adam Paszke, Sam Gross, Soumith Chintala, Gregory Chanan, Edward Yang, Zachary DeVito, Zeming Lin, Alban Desmaison, Luca Antiga, and Adam Lerer"
    },
    {
      "index": 28,
      "title": "Playing for data: Ground truth from computer games",
      "abstract": "",
      "year": "2016",
      "venue": "European conference on computer vision",
      "authors": "Stephan R Richter, Vibhav Vineet, Stefan Roth, and Vladlen Koltun"
    },
    {
      "index": 29,
      "title": "The synthia dataset: A large collection of synthetic images for semantic segmentation of urban scenes",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "German Ros, Laura Sellart, Joanna Materzynska, David Vazquez, and Antonio M Lopez"
    },
    {
      "index": 30,
      "title": "Equivalence of distance-based and rkhs-based statistics in hypothesis testing",
      "abstract": "",
      "year": "2013",
      "venue": "The Annals of Statistics",
      "authors": "Dino Sejdinovic, Bharath Sriperumbudur, Arthur Gretton, and Kenji Fukumizu"
    },
    {
      "index": 31,
      "title": "Regularizing proxies with multi-adversarial training for unsupervised domain-adaptive semantic segmentation",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1907.12282",
      "authors": "Tong Shen, Dong Gong, Wei Zhang, Chunhua Shen, and Tao Mei"
    },
    {
      "index": 32,
      "title": "Improved deep metric learning with multi-class n-pair loss objective",
      "abstract": "",
      "year": "2016",
      "venue": "30th International Conference on Neural Information Processing Systems",
      "authors": "Kihyuk Sohn"
    },
    {
      "index": 33,
      "title": "High-Resolution Representations for Labeling Pixels and Regions",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1904.04514",
      "authors": "Ke Sun, Yang Zhao, Borui Jiang, Tianheng Cheng, Bin Xiao, Dong Liu, Yadong Mu, Xinggang Wang, Wenyu Liu, and Jingdong Wang",
      "orig_title": "High-resolution representations for labeling pixels and regions",
      "paper_id": "1904.04514v1"
    },
    {
      "index": 34,
      "title": "Mean teachers are better role models: Weight-averaged consistency targets improve semi-supervised deep learning results",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1703.01780",
      "authors": "Antti Tarvainen and Harri Valpola",
      "orig_title": "Mean teachers are better role models: Weight-averaged consistency targets improve semi-supervised deep learning results",
      "paper_id": "1703.01780v6"
    },
    {
      "index": 35,
      "title": "Unsupervised domain adaptation for mobile semantic segmentation based on cycle consistency and feature alignment",
      "abstract": "",
      "year": "2020",
      "venue": "Image and Vision Computing",
      "authors": "Marco Toldo, Umberto Michieli, Gianluca Agresti, and Pietro Zanuttigh"
    },
    {
      "index": 36,
      "title": "DACS: Domain Adaptation via Cross-domain Mixed Sampling",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE/CVF Winter Conference on Applications of Computer Vision",
      "authors": "Wilhelm Tranheden, Viktor Olsson, Juliano Pinto, and Lennart Svensson",
      "orig_title": "Dacs: Domain adaptation via cross-domain mixed sampling",
      "paper_id": "2007.08702v2"
    },
    {
      "index": 37,
      "title": "Learning to Adapt Structured Output Space for Semantic Segmentation",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Yi-Hsuan Tsai, Wei-Chih Hung, Samuel Schulter, Kihyuk Sohn, Ming-Hsuan Yang, and Manmohan Chandraker",
      "orig_title": "Learning to adapt structured output space for semantic segmentation",
      "paper_id": "1802.10349v3"
    },
    {
      "index": 38,
      "title": "Domain Adaptation for Structured Output via Discriminative Patch Representations",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Yi-Hsuan Tsai, Kihyuk Sohn, Samuel Schulter, and Manmohan Chandraker",
      "orig_title": "Domain adaptation for structured output via discriminative patch representations",
      "paper_id": "1901.05427v4"
    },
    {
      "index": 39,
      "title": "ADVENT: Adversarial Entropy Minimization for Domain Adaptation in Semantic Segmentation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "Tuan-Hung Vu, Himalaya Jain, Maxime Bucher, Matthieu Cord, and Patrick P√©rez",
      "orig_title": "Advent: Adversarial entropy minimization for domain adaptation in semantic segmentation",
      "paper_id": "1811.12833v2"
    },
    {
      "index": 40,
      "title": "Differential Treatment for Stuff and Things: A Simple Unsupervised Domain Adaptation Method for Semantic Segmentation",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Zhonghao Wang, Mo Yu, Yunchao Wei, Rogerio Feris, Jinjun Xiong, Wen-mei Hwu, Thomas S Huang, and Honghui Shi",
      "orig_title": "Differential treatment for stuff and things: A simple unsupervised domain adaptation method for semantic segmentation",
      "paper_id": "2003.08040v3"
    },
    {
      "index": 41,
      "title": "Self-ensembling attention networks: Addressing domain shift for semantic segmentation",
      "abstract": "",
      "year": "2019",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "Yonghao Xu, Bo Du, Lefei Zhang, Qian Zhang, Guoli Wang, and Liangpei Zhang"
    },
    {
      "index": 42,
      "title": "Mind the Class Weight Bias: Weighted Maximum Mean Discrepancy for Unsupervised Domain Adaptation",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Hongliang Yan, Yukang Ding, Peihua Li, Qilong Wang, Yong Xu, and Wangmeng Zuo",
      "orig_title": "Mind the class weight bias: Weighted maximum mean discrepancy for unsupervised domain adaptation",
      "paper_id": "1705.00609v1"
    },
    {
      "index": 43,
      "title": "FDA: Fourier Domain Adaptation for Semantic Segmentation",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Yanchao Yang and Stefano Soatto",
      "orig_title": "Fda: Fourier domain adaptation for semantic segmentation",
      "paper_id": "2004.05498v1"
    },
    {
      "index": 44,
      "title": "Category Anchor-Guided Unsupervised Domain Adaptation for Semantic Segmentation",
      "abstract": "",
      "year": "2019",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Qiming Zhang, Jing Zhang, Wei Liu, and Dacheng Tao",
      "orig_title": "Category anchor-guided unsupervised domain adaptation for semantic segmentation",
      "paper_id": "1910.13049v2"
    },
    {
      "index": 45,
      "title": "Unsupervised Scene Adaptation with Memory Regularization in vivo",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1912.11164",
      "authors": "Zhedong Zheng and Yi Yang",
      "orig_title": "Unsupervised scene adaptation with memory regularization in vivo",
      "paper_id": "1912.11164v3"
    },
    {
      "index": 46,
      "title": "Rectifying Pseudo Label Learning via Uncertainty Estimation for Domain Adaptive Semantic Segmentation",
      "abstract": "",
      "year": "2021",
      "venue": "International Journal of Computer Vision",
      "authors": "Zhedong Zheng and Yi Yang",
      "orig_title": "Rectifying pseudo label learning via uncertainty estimation for domain adaptive semantic segmentation",
      "paper_id": "2003.03773v3"
    },
    {
      "index": 47,
      "title": "Unpaired image-to-image translation using cycle-consistent adversarial networks",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE international conference on computer vision",
      "authors": "Jun-Yan Zhu, Taesung Park, Phillip Isola, and Alexei A Efros"
    },
    {
      "index": 48,
      "title": "Confidence regularized self-training",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Yang Zou, Zhiding Yu, Xiaofeng Liu, BVK Kumar, and Jinsong Wang"
    },
    {
      "index": 49,
      "title": "Unsupervised domain adaptation for semantic segmentation via class-balanced self-training",
      "abstract": "",
      "year": "2018",
      "venue": "European conference on computer vision (ECCV)",
      "authors": "Yang Zou, Zhiding Yu, BVK Vijaya Kumar, and Jinsong Wang"
    }
  ]
}