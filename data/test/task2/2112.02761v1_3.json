{
  "paper_id": "2112.02761v1",
  "title": "BCD Nets: Scalable Variational Approaches for Bayesian Causal Discovery",
  "sections": {
    "synthetic data": "We study our model‚Äôs performance in the low-data regime, with n=100ùëõ100n=100 data points. We expect that when there is little data, the maximum-likelihood DAG may not be particularly representative of the DAGs that could have plausibly made the data, and so a Bayesian approach which can assign posterior density to multiple candidates may correctly identify more edges.\nIn this experiment, we draw Erd≈ës-Renyi graphs¬† with average degree equal to 1 or 2, denoted ER1 and ER2. The weights are generated uniformly in {‚àí2,‚àí0.5}‚à™{0.5,2}20.50.52\\left\\{-2,-0.5\\right\\}\\cup\\left\\{0.5,2\\right\\} following¬†.\nThe data is generated in the equal-variance case so that the ground-truth is identifiable and the SHD is meaningful. We evaluate with Gaussian noise as well as with Gumbel noise to test how our method behaves under a misspecified likelihood. The distribution over the weights also induces some misspecification, since the weights are not drawn from the modelled prior of a horseshoe. We compare against GOLEM¬†, which attempts to find the maximum-likelihood solution of equation¬†(1) using the continuous relaxation introduced in¬†[ref]62. We found that the hyperparameters given by the authors did not lead to optimal performance with low data, so we found the best ones via a cross-validation scheme given in appendix B. We also include results from GADGET [ref]58, a recent highly-optimized state-of-the-art Monte Carlo method for Bayesian causal discovery for DAGs, using 300,000 iterations with 48 parallel chains. To compare against a baseline that is widely used in practice, we also evaluate the DirectLiNGAM method¬†, designed for non-Gaussian likelihoods. Also included are two methods designed specifically for Gaussian DAGs, the greedy directed acyclic graph search with equal error variance (GDSEEV) method , and the main method (‚ÄòGhoshal‚Äô) from . For the latter, we were unable to find an implementation by the authors and used our own implementation.\nWe use the equal-variance formulations of GOLEM and BCD Nets. Results are shown in figure¬†2. The null baseline is a method that simply predicts no edges.\nWe observe that we reliably obtain significantly lower SHD than MLE approaches, especially at higher dùëëd and degree where we tend to recover a significant fraction of the edges.\nFor example, in the Gaussian noise case with average degree 2, for dimension 64 we get an SHD of 59¬±14plus-or-minus591459\\pm 14 compared to GOLEM‚Äôs 205¬±30plus-or-minus20530205\\pm 30.\nThis corresponds to double the true positive rate while having a false discovery rate one-third of GOLEM‚Äôs.\nWe give full plots of the true positive rate, false positive rate and false discovery rates in the appendix, Section¬†D.1.\nThe Bayesian GADGET method also obtains better results than MLE methods, with BCD Nets‚Äô match to this exact sampling method suggesting that our approach finds a variational posterior close to the real posterior.\nCompared to GADGET, our method is generally faster (see table 2) and gives an explicit parametric form for the posterior, instead of simply giving samples. Furthermore, the ELBO is a natural metric to evaluate convergence, while for GADGET it is unclear how many iterations are required to mix333An earlier version of this paper reported worse SHDs for GADGET after using 50,000 steps. Increasing the number of iterations by 6 times resulted in much better mixing. DirectLiNGAM is competitive on the Gumbel likelihood, fitting its linear non-Gaussian framework."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "Information theory and an extension of the maximum likelihood principle",
      "abstract": "",
      "year": "1998",
      "venue": "Selected Papers of Hirotugu Akaike",
      "authors": "Hirotogu Akaike"
    },
    {
      "index": 1,
      "title": "Fitting autoregressive models for prediction",
      "abstract": "",
      "year": "1969",
      "venue": "Annals of the institute of Statistical Mathematics",
      "authors": "Hirotugu Akaike"
    },
    {
      "index": 2,
      "title": "A Tight Analysis of Bethe Approximation for Permanent",
      "abstract": "",
      "year": "2019",
      "venue": "FOCS",
      "authors": "Nima Anari and Alireza Rezaei",
      "orig_title": "A tight analysis of bethe approximation for permanent",
      "paper_id": "1811.02933v2"
    },
    {
      "index": 3,
      "title": "Estimating or propagating gradients through stochastic neurons for conditional computation",
      "abstract": "",
      "year": "2013",
      "venue": "arXiv",
      "authors": "Yoshua Bengio, Nicholas L√©onard, and Aaron Courville"
    },
    {
      "index": 4,
      "title": "Probabilistic Permutation Synchronization using the Riemannian Structure of the Birkhoff Polytope",
      "abstract": "",
      "year": "2019",
      "venue": "CVPR",
      "authors": "Tolga Birdal and Umut Simsekli",
      "orig_title": "Probabilistic permutation synchronization using the riemannian structure of the birkhoff polytope",
      "paper_id": "1904.05814v1"
    },
    {
      "index": 5,
      "title": "Variational Inference: A Review for Statisticians",
      "abstract": "",
      "year": "2017",
      "venue": "JASA",
      "authors": "David M Blei, Alp Kucukelbir, and Jon D McAuliffe",
      "orig_title": "Variational inference: A review for statisticians",
      "paper_id": "1601.00670v9"
    },
    {
      "index": 6,
      "title": "Handling sparsity via the horseshoe",
      "abstract": "",
      "year": "2009",
      "venue": "AISTATS",
      "authors": "Carlos M Carvalho, Nicholas G Polson, and James G Scott"
    },
    {
      "index": 7,
      "title": "Learning bayesian networks is NP-complete",
      "abstract": "",
      "year": "1996",
      "venue": "Learning from Data. Springer",
      "authors": "David Maxwell Chickering"
    },
    {
      "index": 8,
      "title": "Approximating discrete probability distributions with dependence trees",
      "abstract": "",
      "year": "1968",
      "venue": "IEEE transactions on Information Theory",
      "authors": "C Chow and Cong Liu"
    },
    {
      "index": 9,
      "title": "Relaxing bijectivity constraints with continuously indexed normalising flows",
      "abstract": "",
      "year": "2020",
      "venue": "ICML",
      "authors": "Rob Cornish, Anthony Caterini, George Deligiannidis, and Arnaud Doucet"
    },
    {
      "index": 10,
      "title": "Bayesian network learning with cutting planes",
      "abstract": "",
      "year": "2012",
      "venue": "arXiv preprint arXiv:1202.3713",
      "authors": "James Cussens"
    },
    {
      "index": 11,
      "title": "Bayesian Network Structure Learning with Integer Programming: Polytopes, Facets and Complexity",
      "abstract": "",
      "year": "2017",
      "venue": "JAIR",
      "authors": "James Cussens, Matti J√§rvisalo, Janne H. Korhonen, and Mark Bartlett"
    },
    {
      "index": 12,
      "title": "Structure learning of linear Gaussian structural equation models with weak edges",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1707.07560",
      "authors": "Marco F Eigenmann, Preetam Nandy, and Marloes H Maathuis"
    },
    {
      "index": 13,
      "title": "On the evolution of random graphs",
      "abstract": "",
      "year": "1960",
      "venue": "Publ. Math. Inst. Hung. Acad. Sci",
      "authors": "Paul Erd≈ës and Alfr√©d R√©nyi"
    },
    {
      "index": 14,
      "title": "Lung cancer and cigarettes?",
      "abstract": "",
      "year": "1958",
      "venue": "Nature",
      "authors": "Ronald A Fisher"
    },
    {
      "index": 15,
      "title": "Bayesian model averaging: A systematic review and conceptual classification",
      "abstract": "",
      "year": "2018",
      "venue": "International Statistical Review",
      "authors": "Tiago M Fragoso, Wesley Bertoli, and Francisco Louzada"
    },
    {
      "index": 16,
      "title": "Sparse inverse covariance estimation with the graphical lasso",
      "abstract": "",
      "year": "2008",
      "venue": "Biostatistics",
      "authors": "Jerome Friedman, Trevor Hastie, and Robert Tibshirani"
    },
    {
      "index": 17,
      "title": "Being Bayesian about network structure. A Bayesian approach to structure discovery in Bayesian networks",
      "abstract": "",
      "year": "2003",
      "venue": "Machine learning",
      "authors": "Nir Friedman and Daphne Koller"
    },
    {
      "index": 18,
      "title": "Bayesian Data Analysis, Third Edition",
      "abstract": "",
      "year": "2013",
      "venue": "CRC Press",
      "authors": "Andrew Gelman, John B. Carlin, Hal S. Stern, David B. Dunson, Aki Vehtari, and Donald B. Rubin"
    },
    {
      "index": 19,
      "title": "MADE: Masked Autoencoder for Distribution Estimation",
      "abstract": "",
      "year": "2015",
      "venue": "ICML",
      "authors": "Mathieu Germain, Karol Gregor, Iain Murray, and Hugo Larochelle",
      "orig_title": "Made: Masked autoencoder for distribution estimation",
      "paper_id": "1502.03509v2"
    },
    {
      "index": 20,
      "title": "Learning linear structural equation models in polynomial time and sample complexity",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Artificial Intelligence and Statistics",
      "authors": "Asish Ghoshal and Jean Honorio"
    },
    {
      "index": 21,
      "title": "An efficient bayesian approach for gaussian bayesian network structure learning",
      "abstract": "",
      "year": "2017",
      "venue": "Communications in Statistics-Simulation and Computation",
      "authors": "Shengtong Han, Hongmei Zhang, Ramin Homayouni, and Wilfried Karmaus"
    },
    {
      "index": 22,
      "title": "A bayesian approach to causal discovery",
      "abstract": "",
      "year": "1999",
      "venue": "Computation, causation, and discovery",
      "authors": "David Heckerman, Christopher Meek, and Gregory Cooper"
    },
    {
      "index": 23,
      "title": "Bayesian parameter estimation via variational methods",
      "abstract": "",
      "year": "2000",
      "venue": "Statistics and Computing",
      "authors": "Tommi S Jaakkola and Michael I Jordan"
    },
    {
      "index": 24,
      "title": "Locally Masked Convolution for Autoregressive Models",
      "abstract": "",
      "year": "2020",
      "venue": "UAI",
      "authors": "Ajay Jain, Pieter Abbeel, and Deepak Pathak",
      "orig_title": "Locally Masked Convolution for Autoregressive Models",
      "paper_id": "2006.12486v3"
    },
    {
      "index": 25,
      "title": "Probabilistic Graphical Models: Principles and Techniques",
      "abstract": "",
      "year": "2009",
      "venue": "MIT press",
      "authors": "Daphne Koller and Nir Friedman"
    },
    {
      "index": 26,
      "title": "The Hungarian method for the assignment problem",
      "abstract": "",
      "year": "1955",
      "venue": "Naval research logistics quarterly",
      "authors": "Harold W Kuhn"
    },
    {
      "index": 27,
      "title": "Discovering autoregressive orderings with variational inference",
      "abstract": "",
      "year": "2021",
      "venue": "ICLR",
      "authors": "Xuanlin Li, Brandon Trabucco, Dong Huk Park, Yang Gao, Michael Luo, Sheng Shen, and Trevor Darrell"
    },
    {
      "index": 28,
      "title": "Causal effects in clinical and epidemiological studies via potential outcomes: Concepts and analytical approaches",
      "abstract": "",
      "year": "2000",
      "venue": "Annual review of public health",
      "authors": "Roderick J Little and Donald B Rubin"
    },
    {
      "index": 29,
      "title": "As-asl: Algorithm selection with auto-sklearn",
      "abstract": "",
      "year": "2017",
      "venue": "Open Algorithm Selection Challenge 2017. PMLR",
      "authors": "Brandon Malone, Kustaa Kangas, Matti J√§rvisalo, Mikko Koivisto, and Petri Myllym√§ki"
    },
    {
      "index": 30,
      "title": "Learning Latent Permutations with Gumbel-Sinkhorn Networks",
      "abstract": "",
      "year": "2018",
      "venue": "ICLR",
      "authors": "Gonzalo Mena, David Belanger, Scott Linderman, and Jasper Snoek",
      "orig_title": "Learning Latent Permutations with Gumbel-Sinkhorn Networks",
      "paper_id": "1802.08665v1"
    },
    {
      "index": 31,
      "title": "Sinkhorn permutation variational marginal inference",
      "abstract": "",
      "year": "2020",
      "venue": "AABI",
      "authors": "Gonzalo Mena, Erdem Varol, Amin Nejatbakhsh, Eviatar Yemini, and Liam Paninski"
    },
    {
      "index": 32,
      "title": "Blavaan: Bayesian structural equation models via parameter expansion",
      "abstract": "",
      "year": "2018",
      "venue": "JOURNAL OF STATISTICAL SOFTWARE",
      "authors": "Edgar C Merkle and Yves Rosseel"
    },
    {
      "index": 33,
      "title": "Monte Carlo Gradient Estimation in Machine Learning",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv:1906.10652",
      "authors": "Shakir Mohamed, Mihaela Rosca, Michael Figurnov, and Andriy Mnih"
    },
    {
      "index": 34,
      "title": "On the Role of Sparsity and DAG Constraints for Learning Linear DAGs",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Ignavier Ng, AmirEmad Ghassami, and Kun Zhang",
      "orig_title": "On the Role of Sparsity and DAG Constraints for Learning Linear DAGs",
      "paper_id": "2006.10201v3"
    },
    {
      "index": 35,
      "title": "Learning Bayesian networks with bounded tree-width via guided search",
      "abstract": "",
      "year": "2016",
      "venue": "AAAI",
      "authors": "Siqi Nie, Cassio de Campos, and Qiang Ji"
    },
    {
      "index": 36,
      "title": "Causality",
      "abstract": "",
      "year": "2009",
      "venue": "Cambridge university press",
      "authors": "Judea Pearl"
    },
    {
      "index": 37,
      "title": "Identifiability of Gaussian structural equation models with equal error variances",
      "abstract": "",
      "year": "2014",
      "venue": "Biometrika",
      "authors": "Jonas Peters and Peter B√ºhlmann"
    },
    {
      "index": 38,
      "title": "Causal discovery with continuous additive noise models",
      "abstract": "",
      "year": "2014",
      "venue": "JMLR",
      "authors": "Jonas Peters, Joris M Mooij, Dominik Janzing, and Bernhard Sch√∂lkopf"
    },
    {
      "index": 39,
      "title": "On the hyperprior choice for the global shrinkage parameter in the horseshoe prior",
      "abstract": "",
      "year": "2017",
      "venue": "AISTATS",
      "authors": "Juho Piironen and Aki Vehtari"
    },
    {
      "index": 40,
      "title": "Variational inference with normalizing flows",
      "abstract": "",
      "year": "2015",
      "venue": "ICML",
      "authors": "Danilo Rezende and Shakir Mohamed"
    },
    {
      "index": 41,
      "title": "Ancestral graph markov models",
      "abstract": "",
      "year": "2002",
      "venue": "The Annals of Statistics",
      "authors": "Thomas Richardson, Peter Spirtes, et al."
    },
    {
      "index": 42,
      "title": "Sticking the Landing: Simple, Lower-Variance Gradient Estimators for Variational Inference",
      "abstract": "",
      "year": "2017",
      "venue": "NIPS",
      "authors": "Geoffrey Roeder, Yuhuai Wu, and David K Duvenaud",
      "orig_title": "Sticking the landing: Simple, lower-variance gradient estimators for variational inference",
      "paper_id": "1703.09194v3"
    },
    {
      "index": 43,
      "title": "Causal protein-signaling networks derived from multiparameter single-cell data",
      "abstract": "",
      "year": "2005",
      "venue": "Science (New York, N.Y.)",
      "authors": "Karen Sachs, Omar Perez, Dana Pe‚Äôer, Douglas A. Lauffenburger, and Garry P. Nolan"
    },
    {
      "index": 44,
      "title": "Learning bayesian networks with thousands of variables",
      "abstract": "",
      "year": "2015",
      "venue": "NIPS",
      "authors": "Mauro Scanagatta, Cassio Polpo de Campos, Giorgio Corani, and Marco Zaffalon"
    },
    {
      "index": 45,
      "title": "Estimating the dimension of a model",
      "abstract": "",
      "year": "1978",
      "venue": "Annals of statistics",
      "authors": "Gideon Schwarz et al."
    },
    {
      "index": 46,
      "title": "Estimating individual treatment effect: generalization bounds and algorithms",
      "abstract": "",
      "year": "2016",
      "venue": "arXiv:1606.03976 [cs, stat]",
      "authors": "Uri Shalit, Fredrik D. Johansson, and David Sontag",
      "orig_title": "Estimating individual treatment effect: Generalization bounds and algorithms",
      "paper_id": "1606.03976v5"
    },
    {
      "index": 47,
      "title": "Improved maximum likelihood reconstruction of complex multi-generational pedigrees",
      "abstract": "",
      "year": "2014",
      "venue": "Theoretical population biology",
      "authors": "Nuala A Sheehan, Mark Bartlett, and James Cussens"
    },
    {
      "index": 48,
      "title": "Directlingam: A direct method for learning a linear non-gaussian structural equation model",
      "abstract": "",
      "year": "2011",
      "venue": "The Journal of Machine Learning Research",
      "authors": "Shohei Shimizu, Takanori Inazumi, Yasuhiro Sogawa, Aapo Hyv√§rinen, Yoshinobu Kawahara, Takashi Washio, Patrik O Hoyer, and Kenneth Bollen"
    },
    {
      "index": 49,
      "title": "A relationship between arbitrary positive matrices and doubly stochastic matrices",
      "abstract": "",
      "year": "1964",
      "venue": "The annals of mathematical statistics",
      "authors": "Richard Sinkhorn"
    },
    {
      "index": 50,
      "title": "An algorithm for fast recovery of sparse causal graphs",
      "abstract": "",
      "year": "1991",
      "venue": "Social science computer review",
      "authors": "Peter Spirtes and Clark Glymour"
    },
    {
      "index": 51,
      "title": "Causation, Prediction, and Search",
      "abstract": "",
      "year": "1993",
      "venue": "Springer-Verlag",
      "authors": "Peter Spirtes, Clark Glymour, and Richard Scheines"
    },
    {
      "index": 52,
      "title": "Ordering-based search: A simple and effective algorithm for learning Bayesian networks",
      "abstract": "",
      "year": "2005",
      "venue": "UAI",
      "authors": "Marc Teyssier and Daphne Koller"
    },
    {
      "index": 53,
      "title": "Regression shrinkage and selection via the lasso",
      "abstract": "",
      "year": "1996",
      "venue": "Journal of the Royal Statistical Society: Series B (Methodological)",
      "authors": "Robert Tibshirani"
    },
    {
      "index": 54,
      "title": "On some properties of the low-dimensional gumbel perturbations in the perturb-and-map model",
      "abstract": "",
      "year": "2016",
      "venue": "Statistics & Probability Letters",
      "authors": "Jakub M Tomczak"
    },
    {
      "index": 55,
      "title": "The max-min hill-climbing bayesian network structure learning algorithm",
      "abstract": "",
      "year": "2006",
      "venue": "Machine learning",
      "authors": "Ioannis Tsamardinos, Laura E Brown, and Constantin F Aliferis"
    },
    {
      "index": 56,
      "title": "Causal inference in economics and marketing",
      "abstract": "",
      "year": "2016",
      "venue": "PNaS",
      "authors": "Hal R Varian"
    },
    {
      "index": 57,
      "title": "Towards Scalable Bayesian Learning of Causal DAGs",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Jussi Viinikka, Antti Hyttinen, Johan Pensar, and Mikko Koivisto",
      "orig_title": "Towards scalable bayesian learning of causal dags",
      "paper_id": "2010.00684v2"
    },
    {
      "index": 58,
      "title": "DAGs with No Fears: A Closer Look at Continuous Optimization for Learning Bayesian Networks",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Dennis Wei, Tian Gao, and Yue Yu",
      "orig_title": "DAGs with no fears: A closer look at continuous optimization for learning bayesian networks",
      "paper_id": "2010.09133v1"
    },
    {
      "index": 59,
      "title": "Simple statistical gradient-following algorithms for connectionist reinforcement learning",
      "abstract": "",
      "year": "1992",
      "venue": "Machine learning",
      "authors": "Ronald J Williams"
    },
    {
      "index": 60,
      "title": "DAG-GNN: DAG Structure Learning with Graph Neural Networks",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv:1904.10098 [cs, stat]",
      "authors": "Yue Yu, Jie Chen, Tian Gao, and Mo Yu"
    },
    {
      "index": 61,
      "title": "Dags with no tears: Continuous optimization for structure learning",
      "abstract": "",
      "year": "2018",
      "venue": "NeurIPS",
      "authors": "Xun Zheng, Bryon Aragam, Pradeep Ravikumar, and Eric P Xing"
    },
    {
      "index": 62,
      "title": "AdaBelief Optimizer: Adapting Stepsizes by the Belief in Observed Gradients",
      "abstract": "",
      "year": "2020",
      "venue": "NeurIPS",
      "authors": "Juntang Zhuang, Tommy Tang, Sekhar Tatikonda, Nicha Dvornek, Yifan Ding, Xenophon Papademetris, and James S Duncan",
      "orig_title": "Adabelief optimizer: Adapting stepsizes by the belief in observed gradients",
      "paper_id": "2010.07468v5"
    }
  ]
}