{
  "paper_id": "2001.01523v3",
  "title": "Think Locally, Act Globally: Federated Learning with Local and Global Representations",
  "sections": {
    "model performance & communication efficiency": "CIFAR-10: We compare our approach with existing federated learning methods with respect to model performance and communication. We randomly assign each device to examples of two classes (highly unbalanced). We consider two settings during testing: 1) Local Test, where we know which device the data belongs to (i.e. new predictions on an existing device) and choose that particular trained local model. For this setting, we split each device’s data into train, validation, and test data, similar to . 2) New Test, in which we do not know which device the data belongs to (i.e. new predictions on new devices) [ref]38, so we use an ensemble approach by averaging all trained local model logits before choosing the most likely class [ref]6. For ensembling, all local model weights are sent to the server only once and averaged. We include this parameter exchange step and still show substantial communication improvement. We find that averaging model weights performs similarly (0.5%percent0.50.5\\% for CIFAR) to averaging model outputs since deep ReLU nets are mostly linear). We choose LeNet-5 [ref]28 as our base model and we compare 4 methods: 1) FedAvg [ref]38 which is the traditional federated learning approach, 2) Local only  as an extreme setting with only local models, 3) MTL  which trains local models with parameter sharing in a multi-task fashion, and 4) LG-FedAvg which is our proposed method with local and global models. The results in Table 1 show that LG-FedAvg gives strong performance with low communication cost. For CIFAR local test, LG-FedAvg significantly outperforms FedAvg since local models allow us to better model the local device data distribution. For new test, LG-FedAvg achieves similar performance to FedAvg while using around 50%percent5050\\% of the total parameters, and better performance with the same number of parameters. LG-FedAvg also outperforms using local models only and local models trained with multitask learning (MTL). This shows that our end-to-end training strategy for local and global models is particularly suitable for large neural networks. We show MNIST results and sensitivity analysis wrt data and model splits in Appendix C.2 and find similar observations. Visual Question Answering (VQA): VQA is a large-scale multimodal benchmark with 0.250.250.25M images, 0.760.760.76M questions, and 101010M answers . We split the dataset in a non-i.i.d. manner and evaluate the accuracy under the local test setting. We use LSTM  and ResNet-18  unimodal encoders as our local models and a global model which performs early fusion  of text and image features for answer prediction. In Table 2, we observe that LG-FedAvg reaches a goal accuracy of 40%percent4040\\% while requiring lower communication costs (more VQA results and details in Appendix C.2.3)."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "VQA: Visual Question Answering",
      "abstract": "",
      "year": "2015",
      "venue": "ICCV",
      "authors": "Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra, C. Lawrence Zitnick, and Devi Parikh"
    },
    {
      "index": 1,
      "title": "Multimodal Machine Learning: A Survey and Taxonomy",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Pattern Anal. Mach. Intell.",
      "authors": "Tadas Baltrusaitis, Chaitanya Ahuja, and Louis-Philippe Morency",
      "orig_title": "Multimodal machine learning: A survey and taxonomy",
      "paper_id": "1705.09406v2"
    },
    {
      "index": 2,
      "title": "Demystifying Parallel and Distributed Deep Learning: An In-Depth Concurrency Analysis",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Tal Ben-Nun and Torsten Hoefler",
      "orig_title": "Demystifying parallel and distributed deep learning: An in-depth concurrency analysis",
      "paper_id": "1802.09941v2"
    },
    {
      "index": 3,
      "title": "Man is to computer programmer as woman is to homemaker? Debiasing word embeddings",
      "abstract": "",
      "year": "2016",
      "venue": "NIPS",
      "authors": "Tolga Bolukbasi, Kai-Wei Chang, James Y Zou, Venkatesh Saligrama, and Adam T Kalai"
    },
    {
      "index": 4,
      "title": "Towards federated learning at scale: System design",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "Keith Bonawitz, Hubert Eichner, Wolfgang Grieskamp, Dzmitry Huba, Alex Ingerman, Vladimir Ivanov, Chloé Kiddon, Jakub Konecný, Stefano Mazzocchi, H. Brendan McMahan, Timon Van Overveldt, David Petrou, Daniel Ramage, and Jason Roselander"
    },
    {
      "index": 5,
      "title": "Bagging predictors",
      "abstract": "",
      "year": "1996",
      "venue": "Machine learning",
      "authors": "Leo Breiman"
    },
    {
      "index": 6,
      "title": "Expanding the Reach of Federated Learning by Reducing Client Resource Requirements",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Sebastian Caldas, Jakub Konecný, H. Brendan McMahan, and Ameet Talwalkar",
      "orig_title": "Expanding the reach of federated learning by reducing client resource requirements",
      "paper_id": "1812.07210v2"
    },
    {
      "index": 7,
      "title": "LEAF: A Benchmark for Federated Settings",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Sebastian Caldas, Peter Wu, Tian Li, Jakub Konecný, H. Brendan McMahan, Virginia Smith, and Ameet Talwalkar",
      "orig_title": "LEAF: A benchmark for federated settings",
      "paper_id": "1812.01097v3"
    },
    {
      "index": 8,
      "title": "Improved Adversarial Learning for Fair Classification",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "L. Elisa Celis and Vijay Keswani",
      "orig_title": "Improved adversarial learning for fair classification",
      "paper_id": "1901.10443v1"
    },
    {
      "index": 9,
      "title": "Why Is My Classifier Discriminatory?",
      "abstract": "",
      "year": "2018",
      "venue": "NIPS",
      "authors": "Irene Chen, Fredrik D Johansson, and David Sontag",
      "orig_title": "Why is my classifier discriminatory?",
      "paper_id": "1805.12002v2"
    },
    {
      "index": 10,
      "title": "Compressing Neural Networks with the Hashing Trick",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Machine Learning",
      "authors": "Wenlin Chen, James Wilson, Stephen Tyree, Kilian Weinberger, and Yixin Chen",
      "orig_title": "Compressing neural networks with the hashing trick",
      "paper_id": "1504.04788v1"
    },
    {
      "index": 11,
      "title": "Communication-efficient distributed learning of discrete distributions",
      "abstract": "",
      "year": "2017",
      "venue": "NIPS",
      "authors": "Ilias Diakonikolas, Elena Grigorescu, Jerry Li, Abhiram Natarajan, Krzysztof Onak, and Ludwig Schmidt"
    },
    {
      "index": 12,
      "title": "Differential privacy",
      "abstract": "",
      "year": "2006",
      "venue": "ICALP",
      "authors": "Cynthia Dwork"
    },
    {
      "index": 13,
      "title": "The algorithmic foundations of differential privacy",
      "abstract": "",
      "year": "2014",
      "venue": "Found. Trends Theor. Comput. Sci.",
      "authors": "Cynthia Dwork and Aaron Roth"
    },
    {
      "index": 14,
      "title": "Adversarial Removal of Demographic Attributes from Text Data",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Yanai Elazar and Yoav Goldberg",
      "orig_title": "Adversarial removal of demographic attributes from text data",
      "paper_id": "1808.06640v2"
    },
    {
      "index": 15,
      "title": "Regularized multi–task learning",
      "abstract": "",
      "year": "2004",
      "venue": "ACM SIGKDD International Conference on Knowledge Discovery and Data Mining",
      "authors": "Theodoros Evgeniou and Massimiliano Pontil"
    },
    {
      "index": 16,
      "title": "Learning Fair Representations via an Adversarial Framework",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "Rui Feng, Yang Yang, Yuehan Lyu, Chenhao Tan, Yizhou Sun, and Chunping Wang",
      "orig_title": "Learning fair representations via an adversarial framework",
      "paper_id": "1904.13341v1"
    },
    {
      "index": 17,
      "title": "Risk factors for suicidal thoughts and behaviors: a meta-analysis of 50 years of research",
      "abstract": "",
      "year": "2017",
      "venue": "Psychological bulletin",
      "authors": "Joseph C Franklin, Jessica D Ribeiro, Kathryn R Fox, Kate H Bentley, Evan M Kleiman, Xieyining Huang, Katherine M Musacchio, Adam C Jaroszewski, Bernard P Chang, and Matthew K Nock"
    },
    {
      "index": 18,
      "title": "Generative adversarial nets",
      "abstract": "",
      "year": "2014",
      "venue": "NIPS",
      "authors": "Ian J. Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio"
    },
    {
      "index": 19,
      "title": "One-Shot Federated Learning",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "Neel Guha, Ameet Talwalkar, and Virginia Smith",
      "orig_title": "One-shot federated learning",
      "paper_id": "1902.11175v2"
    },
    {
      "index": 20,
      "title": "Surprises in High-Dimensional Ridgeless Least Squares Interpolation",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1903.08560",
      "authors": "Trevor Hastie, Andrea Montanari, Saharon Rosset, and Ryan J Tibshirani",
      "orig_title": "Surprises in high-dimensional ridgeless least squares interpolation",
      "paper_id": "1903.08560v5"
    },
    {
      "index": 21,
      "title": "Deep Residual Learning for Image Recognition",
      "abstract": "",
      "year": "2015",
      "venue": "CoRR",
      "authors": "Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun",
      "orig_title": "Deep residual learning for image recognition",
      "paper_id": "1512.03385v1"
    },
    {
      "index": 22,
      "title": "Long short-term memory",
      "abstract": "",
      "year": "1997",
      "venue": "Neural computation",
      "authors": "Sepp Hochreiter and Jürgen Schmidhuber"
    },
    {
      "index": 23,
      "title": "Scaling up the accuracy of naive-bayes classifiers: a decision-tree hybrid",
      "abstract": "",
      "year": "1996",
      "venue": "International Conference on Knowledge Discovery and Data Mining",
      "authors": "Ron Kohavi"
    },
    {
      "index": 24,
      "title": "Generalization in a linear perceptron in the presence of noise",
      "abstract": "",
      "year": "1992",
      "venue": "Journal of Physics A: Mathematical and General",
      "authors": "Anders Krogh and John A Hertz"
    },
    {
      "index": 25,
      "title": "In-patient suicide: selection of people at risk, failure of protection and the possibility of causation",
      "abstract": "",
      "year": "2017",
      "venue": "BJPsych open",
      "authors": "Matthew Michael Large, Daniel Thomas Chung, Michael Davidson, Mark Weiser, and Christopher James Ryan"
    },
    {
      "index": 26,
      "title": "The association of income and education for males by region, race, and age",
      "abstract": "",
      "year": "1965",
      "venue": "Southern Economic Journal",
      "authors": "Roy L. Lassiter"
    },
    {
      "index": 27,
      "title": "Gradient-based learning applied to document recognition",
      "abstract": "",
      "year": "1998",
      "venue": "IEEE",
      "authors": "Yann Lecun, Léon Bottou, Yoshua Bengio, and Patrick Haffner"
    },
    {
      "index": 28,
      "title": "Federated Learning: Challenges, Methods, and Future Directions",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1908.07873",
      "authors": "Tian Li, Anit Kumar Sahu, Ameet Talwalkar, and Virginia Smith",
      "orig_title": "Federated learning: Challenges, methods, and future directions",
      "paper_id": "1908.07873v1"
    },
    {
      "index": 29,
      "title": "Federated optimization in heterogeneous networks",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and Virginia Smith"
    },
    {
      "index": 30,
      "title": "Towards Debiasing Sentence Representations",
      "abstract": "",
      "year": "2020",
      "venue": "Annual Meeting of the Association for Computational Linguistics",
      "authors": "Paul Pu Liang, Irene Li, Emily Zheng, Yao Chong Lim, Ruslan Salakhutdinov, and Louis-Philippe Morency",
      "orig_title": "Towards debiasing sentence representations",
      "paper_id": "2007.08100v1"
    },
    {
      "index": 31,
      "title": "Strong and simple baselines for multimodal utterance embeddings",
      "abstract": "",
      "year": "2019",
      "venue": "NAACL",
      "authors": "Paul Pu Liang, Yao Chong Lim, Yao-Hung Hubert Tsai, Ruslan Salakhutdinov, and Louis-Philippe Morency"
    },
    {
      "index": 32,
      "title": "Deep Gradient Compression: Reducing the Communication Bandwidth for Distributed Training",
      "abstract": "",
      "year": "2018",
      "venue": "",
      "authors": "Yujun Lin, Song Han, Huizi Mao, Yu Wang, and William Dally",
      "orig_title": "Deep gradient compression: Reducing the communication bandwidth for distributed training",
      "paper_id": "1712.01887v3"
    },
    {
      "index": 33,
      "title": "Bias amplification in artificial intelligence systems",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Kirsten Lloyd"
    },
    {
      "index": 34,
      "title": "Learning to pivot with adversarial networks",
      "abstract": "",
      "year": "2017",
      "venue": "NIPS",
      "authors": "Gilles Louppe, Michael Kagan, and Kyle Cranmer"
    },
    {
      "index": 35,
      "title": "Threats to Federated Learning: A Survey",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2003.02133",
      "authors": "Lingjuan Lyu, Han Yu, and Qiang Yang",
      "orig_title": "Threats to federated learning: A survey",
      "paper_id": "2003.02133v1"
    },
    {
      "index": 36,
      "title": "On measuring social biases in sentence encoders",
      "abstract": "",
      "year": "2019",
      "venue": "Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies",
      "authors": "Chandler May, Alex Wang, Shikha Bordia, Samuel R. Bowman, and Rachel Rudinger"
    },
    {
      "index": 37,
      "title": "Communication-efficient learning of deep networks from decentralized data",
      "abstract": "",
      "year": "2016",
      "venue": "AISTATS",
      "authors": "H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Agüera y Arcas"
    },
    {
      "index": 38,
      "title": "Mean-field theory of two-layers neural networks: dimension-free bounds and kernel limit",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1902.06015",
      "authors": "Song Mei, Theodor Misiakiewicz, and Andrea Montanari",
      "orig_title": "Mean-field theory of two-layers neural networks: dimension-free bounds and kernel limit",
      "paper_id": "1902.06015v1"
    },
    {
      "index": 39,
      "title": "The generalization error of random features regression: Precise asymptotics and double descent curve",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1908.05355",
      "authors": "Song Mei and Andrea Montanari"
    },
    {
      "index": 40,
      "title": "Agnostic Federated Learning",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "Mehryar Mohri, Gary Sivek, and Ananda Theertha Suresh",
      "orig_title": "Agnostic federated learning",
      "paper_id": "1902.00146v1"
    },
    {
      "index": 41,
      "title": "Introduction to Linear Regression Analysis (4th ed.)",
      "abstract": "",
      "year": "2006",
      "venue": "Wiley & Sons",
      "authors": "Douglas C. Montgomery, Elizabeth A. Peck, and Geoffrey G. Vining"
    },
    {
      "index": 42,
      "title": "Just-in-time adaptive interventions (jitais) in mobile health: key components and design principles for ongoing health behavior support",
      "abstract": "",
      "year": "2018",
      "venue": "Annals of Behavioral Medicine",
      "authors": "Inbal Nahum-Shani, Shawna N Smith, Bonnie J Spring, Linda M Collins, Katie Witkiewitz, Ambuj Tewari, and Susan A Murphy"
    },
    {
      "index": 43,
      "title": "A performance evaluation of federated learning algorithms",
      "abstract": "",
      "year": "2018",
      "venue": "DIDL",
      "authors": "Adrian Nilsson, Simon Smith, Gregor Ulm, Emil Gustavsson, and Mats Jirstrand"
    },
    {
      "index": 44,
      "title": "Unsupervised learning of visual representations by solving jigsaw puzzles",
      "abstract": "",
      "year": "2016",
      "venue": "CoRR",
      "authors": "Mehdi Noroozi and Paolo Favaro"
    },
    {
      "index": 45,
      "title": "Investigating user perception of gender bias in image search: The role of sexism",
      "abstract": "",
      "year": "2018",
      "venue": "International ACM SIGIR Conference on Research & Development in Information Retrieval",
      "authors": "Jahna Otterbacher, Alessandro Checco, Gianluca Demartini, and Paul Clough"
    },
    {
      "index": 46,
      "title": "Model Compression via Distillation and Quantization",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Antonio Polino, Razvan Pascanu, and Dan Alistarh",
      "orig_title": "Model compression via distillation and quantization",
      "paper_id": "1802.05668v1"
    },
    {
      "index": 47,
      "title": "Overcoming Catastrophic Forgetting with Hard Attention to the Task",
      "abstract": "",
      "year": "2018",
      "venue": "ICML",
      "authors": "Joan Serra, Didac Suris, Marius Miron, and Alexandros Karatzoglou",
      "orig_title": "Overcoming catastrophic forgetting with hard attention to the task",
      "paper_id": "1801.01423v3"
    },
    {
      "index": 48,
      "title": "Very Deep Convolutional Networks for Large-Scale Image Recognition",
      "abstract": "",
      "year": "2015",
      "venue": "International Conference on Learning Representations",
      "authors": "Karen Simonyan and Andrew Zisserman",
      "orig_title": "Very deep convolutional networks for large-scale image recognition",
      "paper_id": "1409.1556v6"
    },
    {
      "index": 49,
      "title": "Federated Multi-Task Learning",
      "abstract": "",
      "year": "2017",
      "venue": "Neural Information Processing Systems",
      "authors": "Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet Talwalkar",
      "orig_title": "Federated multi-task learning",
      "paper_id": "1705.10467v2"
    },
    {
      "index": 50,
      "title": "Hardware/software security patches for internet of trillions of things",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "John A. Stankovic, Tu Le, Abdeltawab M. Hendawi, and Yuan Tian"
    },
    {
      "index": 51,
      "title": "Distributed Mean Estimation with Limited Communication",
      "abstract": "",
      "year": "2017",
      "venue": "ICML",
      "authors": "Ananda Theertha Suresh, Felix X. Yu, Sanjiv Kumar, and H. Brendan McMahan",
      "orig_title": "Distributed mean estimation with limited communication",
      "paper_id": "1611.00429v3"
    },
    {
      "index": 52,
      "title": "Variance-based Gradient Compression for Efficient Distributed Deep Learning",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Yusuke Tsuzuku, Hiroto Imachi, and Takuya Akiba",
      "orig_title": "Variance-based gradient compression for efficient distributed deep learning",
      "paper_id": "1802.06058v2"
    },
    {
      "index": 53,
      "title": "Efficient distributed learning with sparsity",
      "abstract": "",
      "year": "2017",
      "venue": "ICML",
      "authors": "Jialei Wang, Mladen Kolar, Nathan Srebro, and Tong Zhang"
    },
    {
      "index": 54,
      "title": "Cooperative SGD: A Unified Framework for the Design and Analysis of Communication-Efficient SGD Algorithms",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Jianyu Wang and Gauri Joshi",
      "orig_title": "Cooperative sgd: A unified framework for the design and analysis of communication-efficient sgd algorithms",
      "paper_id": "1808.07576v3"
    },
    {
      "index": 55,
      "title": "Adversarial removal of gender from deep image representations",
      "abstract": "",
      "year": "2018",
      "venue": "CoRR",
      "authors": "Tianlu Wang, Jieyu Zhao, Mark Yatskar, Kai-Wei Chang, and Vicente Ordonez"
    },
    {
      "index": 56,
      "title": "Learning fair representations",
      "abstract": "",
      "year": "2013",
      "venue": "ICML",
      "authors": "Richard Zemel, Yu Wu, Kevin Swersky, Toniann Pitassi, and Cynthia Dwork"
    },
    {
      "index": 57,
      "title": "Inherent tradeoffs in learning fair representation",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "Han Zhao and Geoffrey J. Gordon"
    },
    {
      "index": 58,
      "title": "Gender Bias in Contextualized Word Embeddings",
      "abstract": "",
      "year": "2019",
      "venue": "Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies",
      "authors": "Jieyu Zhao, Tianlu Wang, Mark Yatskar, Ryan Cotterell, Vicente Ordonez, and Kai-Wei Chang",
      "orig_title": "Gender bias in contextualized word embeddings",
      "paper_id": "1904.03310v1"
    },
    {
      "index": 59,
      "title": "Quantized Epoch-SGD for Communication-Efficient Distributed Learning",
      "abstract": "",
      "year": "2019",
      "venue": "CoRR",
      "authors": "Shen-Yi Zhao, Hao Gao, and Wu-Jun Li",
      "orig_title": "Quantized epoch-sgd for communication-efficient distributed learning",
      "paper_id": "1901.03040v1"
    },
    {
      "index": 60,
      "title": "Learning Not to Learn in the Presence of Noisy Labels",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "Liu Ziyin, Blair Chen, Ru Wang, Paul Pu Liang, Ruslan Salakhutdinov, Louis-Philippe Morency, and Masahito Ueda",
      "orig_title": "Learning not to learn in the presence of noisy labels",
      "paper_id": "2002.06541v1"
    }
  ]
}