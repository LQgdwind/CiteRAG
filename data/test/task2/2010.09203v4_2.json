{
  "paper_id": "2010.09203v4",
  "title": "1 Introduction",
  "sections": {
    "introduction": "Graphs are a fundamental data structure in information science.\nRecently, design of novel graph structures has become a hot topic\nin artificial neural network (ANN) studies.\nIn particular, extensive studies have been done on designing\nchemical graphs having desired chemical properties\nbecause of its potential application to drug design.\nFor example, variational autoencoders [ref]9,\nrecurrent neural networks 1 8,\ngrammar variational autoencoders ,\ngenerative adversarial networks ,\nand\ninvertible flow models  \nhave been applied. On the other hand,\ncomputer-aided design of chemical graphs has a long\nhistory in the field of chemo-informatics,\nunder the name of inverse quantitative structure activity/property\nrelationships (inverse QSAR/QSPR).\nIn this framework,\nchemical compounds are usually represented\nas vectors of real or integer numbers,\nwhich are often called descriptors and\ncorrespond to feature vectors in machine learning.\nUsing these chemical descriptors,\nvarious heuristic and statistical methods have been developed for\nfinding optimal or near optimal chemical graphs   .\nIn many of such methods,\ninference or enumeration of graph structures from a given set of\ndescriptors is a crucial subtask, and thus\nvarious methods have been developed    .\nHowever, enumeration in itself is a challenging task,\nsince the number of\nmolecules (i.e., chemical graphs) with up to 30 atoms (vertices)\nC, N, O, and S,\nmay exceed 1060superscript106010^{60} .\nFurthermore, even inference is a challenging task since it is NP-hard\nexcept for some simple cases  7.\nIndeed, most existing methods including ANN-based ones\ndo not guarantee optimal or exact solutions. In order to guarantee the optimality mathematically,\na novel approach has been proposed  for ANNs,\nusing mixed integer linear programming (MILP).\nHowever, this method outputs feature vectors only, not chemical structures.\nTo overcome this issue, a new framework has been proposed\n  9\nby combining two previous approaches; efficient enumeration\nof tree-like graphs , and\nMILP-based formulation of the inverse problem on ANNs .\nThis combined framework for inverse QSAR/QSPR mainly consists of two phases.\nThe first phase solves (I) Prediction Problem, where\na feature vector f​(G)𝑓𝐺f(G) of a chemical graph G𝐺G is introduced\nand\na prediction function ψ𝒩subscript𝜓𝒩\\psi_{\\mathcal{N}} on a chemical property π𝜋\\pi\nis constructed with an ANN 𝒩𝒩\\mathcal{N}\nusing a data set of chemical compounds G𝐺G and their values a​(G)𝑎𝐺a(G) of π𝜋\\pi.\nThe second phase solves (II) Inverse Problem,\nwhere (II-a) given a target value y∗superscript𝑦y^{*} of the chemical property π𝜋\\pi,\na feature vector x∗superscript𝑥x^{*} is inferred from the trained ANN 𝒩𝒩\\mathcal{N}\nso that ψ𝒩​(x∗)subscript𝜓𝒩superscript𝑥\\psi_{\\mathcal{N}}(x^{*}) is close to y∗superscript𝑦y^{*}\nand (II-b) then a set of chemical structures G∗superscript𝐺G^{*}\nsuch that f​(G∗)=x∗𝑓superscript𝐺superscript𝑥f(G^{*})=x^{*} is enumerated by a graph search algorithm.\nIn (II-a) of the above-mentioned previous methods   9,\nan MILP is formulated for acyclic chemical compounds.\nAfterwards, Ito et al. 1 and Zhu et al. 0\ndesigned a method of inferring chemical graphs\nwith rank (or cycle index) 1 and 2, respectively\nby formulating a new MILP and using\nan efficient algorithm for enumerating chemical graphs with rank 1\n4 and rank 2 6 7.\nThe computational results conducted on instances with\nn𝑛n non-hydrogen atoms show that\na feature vector x∗superscript𝑥x^{*} can be inferred for up to around n=40𝑛40n=40\nwhereas graphs G∗superscript𝐺G^{*} can be enumerated for up to around n=15𝑛15n=15.\nRecently Azam et al. \nintroduced a new characterization of acyclic graph structure,\ncalled “branch-height” to define a class of acyclic graphs\nwith a restricted structure that still covers the most of the acyclic\nchemical compounds in the database.\nThey also employed the dynamic programming method\nto design a new algorithm for generating chemical acyclic graphs\nwhich now works for instances with size n​(G∗)=50𝑛superscript𝐺50n(G^{*})=50. The framework has been applied so far to a case of\nchemical compounds with a rather abstract topological structure such as\nacyclic or monocyclic graphs and\ngraphs with a specified polymer topology\nwith rank up to 2.\nWhen there is a more specific requirement on some part of\nthe graph structure and the assignment of chemical elements\nin a chemical graph to be inferred,\nnone of the above-mentioned methods can be used directly.\nThe main reason is that generating chemical graphs\nfrom a given feature vector is a considerably hard problem:\nan efficient algorithm needed to be newly designed\nfor each of different classes of graphs.\nIn this paper, we discover a new mechanism of\ngenerating chemical graphs that can avoid the necessity that\nwe design a new algorithm whenever a graph class changes\n(see Section 6 for the details).\nBased on this, we propose a new method based on the framework\nso that a target chemical graph to be inferred can be specified\nin a more flexible way.\nWith our specification, we can include a prescribed\nsubstructure of graphs such as a benzene ring into a target chemical graph\nwhile imposing constraints on a global topological structure of a target\ngraph at the same time. The paper is organized as follows.\nSection 2 introduces some notions on graphs,\na modeling of chemical compounds and a choice of descriptors.\nSection 3 reviews the framework for inferring\nchemical compounds based on ANNs and MILPs.\nSection 4 introduces a method of\nspecifying topological substructures of target chemical graphs to be inferred.\nSection 5 presents a formulation\nof an MILP that can infer a chemical graph\nunder a given specification to target chemical graphs.\nSection 6 describes a new\ndynamic programming type of algorithm\nthat generates chemical graphs that are\nisomorphic to a given chemical graph G†superscript𝐺†G^{\\dagger}\nin the sense that all generated chemical graphs\nG∗superscript𝐺G^{*} have the same feature vector f​(G∗)=f​(G†)𝑓superscript𝐺𝑓superscript𝐺†f(G^{*})=f(G^{\\dagger}).\nSection 7 makes some concluding remarks.\nAppendix A describes the details of all variables and constraints\nin our MILP formulation."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "“Inferring a graph from path frequency",
      "abstract": "",
      "year": "2012",
      "venue": "",
      "authors": ""
    },
    {
      "index": 1,
      "title": "Inferring a graph from path frequency",
      "abstract": "",
      "year": "2012",
      "venue": "Discrete Applied Mathematics",
      "authors": "T. Akutsu, D. Fukagawa, J. Jansson, and K. Sadakane"
    },
    {
      "index": 2,
      "title": "A mixed integer linear programming formulation to artificial neural networks",
      "abstract": "",
      "year": "2019",
      "venue": "2nd International Conference on Information Science and Systems",
      "authors": "T. Akutsu and H. Nagamochi"
    },
    {
      "index": 3,
      "title": "A method for the inverse QSAR/QSPR based on artificial neural networks and mixed integer linear programming",
      "abstract": "",
      "year": "2020",
      "venue": "BIOINFORMATICS2020",
      "authors": "N. A. Azam, R. Chiewvanichakorn, F. Zhang, A. Shurbevski, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 4,
      "title": "A novel method for inference of acyclic chemical compounds with bounded branch-height based on artificial neural networks and integer programming",
      "abstract": "",
      "year": "",
      "venue": "arXiv:2009.09646",
      "authors": "N. A. Azam, J. Zhu, Y. Sun, Y. Shi, A. Shurbevski, L. Zhao, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 5,
      "title": "The art and practice of structure-based drug design: A molecular modeling perspective",
      "abstract": "",
      "year": "1996",
      "venue": "Medicinal Research Reviews",
      "authors": "R. S. Bohacek, C. McMartin, and W. C. Guida"
    },
    {
      "index": 6,
      "title": "A method for the inverse QSAR/QSPR based on artificial neural networks and mixed integer linear programming",
      "abstract": "",
      "year": "2020",
      "venue": "10th International Conference on Bioscience, Biochemistry and Bioinformatics (ICBBB’20)",
      "authors": "R. Chiewvanichakorn, C. Wang, Z. Zhang, A. Shurbevski, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 7,
      "title": "MolGAN: An implicit generative model for small molecular graphs",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv:1805.11973",
      "authors": "N. De Cao and T. Kipf",
      "orig_title": "MolGAN: An implicit generative model for small molecular graphs",
      "paper_id": "1805.11973v2"
    },
    {
      "index": 8,
      "title": "Enumerating treelike chemical graphs with given path frequency",
      "abstract": "",
      "year": "2008",
      "venue": "Journal of Chemical Information and Modeling",
      "authors": "H. Fujiwara, J. Wang, L. Zhao, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 9,
      "title": "Automatic Chemical Design Using a Data-Driven Continuous Representation of Molecules",
      "abstract": "",
      "year": "2018",
      "venue": "ACS Central Science",
      "authors": "R. Gómez-Bombarelli, J. N. Wei, D. Duvenaud, J. M. Hernández-Lobato, B. Sánchez-Lengeling, D. Sheberla, J. Aguilera-Iparraguirre, T. D. Hirzel, R. P. Adams, and A. Aspuru-Guzik",
      "orig_title": "Automatic chemical design using a data-driven continuous representation of molecules",
      "paper_id": "1610.02415v3"
    },
    {
      "index": 10,
      "title": "Bayesian molecular design with a chemical language model",
      "abstract": "",
      "year": "2017",
      "venue": "Journal of Computer-aided Molecular Design",
      "authors": "H. Ikebata, K. Hongo, T. Isomura, R. Maezono, and R. Yoshida"
    },
    {
      "index": 11,
      "title": "A novel method for the inverse QSAR/QSPR to monocyclic chemical compounds based on artificial neural networks and integer programming",
      "abstract": "",
      "year": "2020",
      "venue": "BIOCOMP2020",
      "authors": "R. Ito, N. A. Azam, C. Wang, A. Shurbevski, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 12,
      "title": "MOLGEN 4.0",
      "abstract": "",
      "year": "1998",
      "venue": "Match Communications in Mathematical and in Computer Chemistry",
      "authors": "A. Kerber, R. Laue, T. Grüner, and M. Meringer"
    },
    {
      "index": 13,
      "title": "Grammar variational autoencoder",
      "abstract": "",
      "year": "2017",
      "venue": "34th International Conference on Machine Learning-Volume 70",
      "authors": "M. J. Kusner, B. Paige, and J. M. Hernández-Lobato"
    },
    {
      "index": 14,
      "title": "Enumerating substituted benzene isomers of tree-like chemical graphs",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE/ACM Transactions on Computational Biology and Bioinformatics",
      "authors": "J. Li, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 15,
      "title": "GraphNVP: An Invertible Flow Model for Generating Molecular Graphs",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv:1905.11600",
      "authors": "K. Madhawa, K. Ishiguro, K. Nakago, and M. Abe",
      "orig_title": "GraphNVP: an invertible flow model for generating molecular graphs",
      "paper_id": "1905.11600v1"
    },
    {
      "index": 16,
      "title": "Inverse QSPR/QSAR analysis for chemical structure generation (from y to x)",
      "abstract": "",
      "year": "2016",
      "venue": "Journal of Chemical Information and Modeling",
      "authors": "T. Miyao, H. Kaneko, and K. Funatsu"
    },
    {
      "index": 17,
      "title": "A detachment algorithm for inferring a graph from path frequency",
      "abstract": "",
      "year": "2009",
      "venue": "Algorithmica",
      "authors": "H. Nagamochi"
    },
    {
      "index": 18,
      "title": "Current status of methods for defining the applicability domain of (quantitative) structure-activity relationships: The report and recommendations of ECVAM workshop 52",
      "abstract": "",
      "year": "2005",
      "venue": "Alternatives to Laboratory Animals",
      "authors": "T. I. Netzeva et al."
    },
    {
      "index": 19,
      "title": "The chemical space project",
      "abstract": "",
      "year": "2015",
      "venue": "Accounts of Chemical Research",
      "authors": "J.-L. Reymond"
    },
    {
      "index": 20,
      "title": "Strategy to discover diverse optimal molecules in the small molecule universe",
      "abstract": "",
      "year": "2015",
      "venue": "Journal of Chemical Information and Modeling",
      "authors": "C. Rupakheti, A. Virshup, W. Yang, and D. N. Beratan"
    },
    {
      "index": 21,
      "title": "Generating Focussed Molecule Libraries for Drug Discovery with Recurrent Neural Networks",
      "abstract": "",
      "year": "2017",
      "venue": "ACS Central Science",
      "authors": "M. H. S. Segler, T. Kogej, C. Tyrchan, and M. P. Waller",
      "orig_title": "Generating focused molecule libraries for drug discovery with recurrent neural networks",
      "paper_id": "1701.01329v1"
    },
    {
      "index": 22,
      "title": "GraphAF: a Flow-based Autoregressive Model for Molecular Graph Generation",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv:2001.09382",
      "authors": "C. Shi, M. Xu, Z. Zhu, W. Zhang, M. Zhang, and J. Tang",
      "orig_title": "GraphAF: a flow-based autoregressive model for molecular graph generation",
      "paper_id": "2001.09382v2"
    },
    {
      "index": 23,
      "title": "Inverse problem in QSAR/QSPR studies for the case of topological indices characterizing molecular shape (Kier indices)",
      "abstract": "",
      "year": "1993",
      "venue": "Journal of Chemical Information and Computer Sciences",
      "authors": "M. I. Skvortsova, I. I. Baskin, O. L. Slovokhotova, V. A. Palyulin, and N. S. Zefirov"
    },
    {
      "index": 24,
      "title": "Efficient enumeration of monocyclic chemical graphs with given path frequencies",
      "abstract": "",
      "year": "2014",
      "venue": "Journal of Cheminformatics",
      "authors": "M. Suzuki, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 25,
      "title": "Topological polymer chemistry",
      "abstract": "",
      "year": "2002",
      "venue": "Progress in Polymer Science",
      "authors": "Y. Tezuka and H. Oike"
    },
    {
      "index": 26,
      "title": "Enumerating chemical graphs with mono-block 2-augmented tree structure from given upper and lower bounds on path frequencies",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv:2004.06367",
      "authors": "Y. Tamura, Y. Y. Nishiyama, C. Wang, Y. Sun, A. Shurbevski, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 27,
      "title": "Enumerating chemical graphs with two disjoint cycles satisfying given path frequency specifications",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv:2004.08381",
      "authors": "K. Yamashita, R. Masui, X. Zhou, C. Wang, A. Shurbevski, H. Nagamochi, and T. Akutsu"
    },
    {
      "index": 28,
      "title": "ChemTS: An Efficient Python Library for de novo Molecular Generation",
      "abstract": "",
      "year": "2017",
      "venue": "Science and Technology of Advanced Materials",
      "authors": "X. Yang, J. Zhang, K. Yoshizoe, K. Terayama, and K. Tsuda",
      "orig_title": "ChemTS: an efficient python library for de novo molecular generation",
      "paper_id": "1710.00616v1"
    },
    {
      "index": 29,
      "title": "A new integer linear programming formulation to the inverse QSAR/QSPR for acyclic chemical compounds using skeleton trees",
      "abstract": "",
      "year": "2020",
      "venue": "33rd International Conference on Industrial, Engineering and Other Applications of Applied Intelligent Systems",
      "authors": "F. Zhang, J. Zhu, R. Chiewvanichakorn, A. Shurbevski, H. Nagamochi, T. Akutsu"
    }
  ]
}