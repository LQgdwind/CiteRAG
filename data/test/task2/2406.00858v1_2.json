{
  "paper_id": "2406.00858v1",
  "title": "Chiplet-Gym: Optimizing Chiplet-based AI Accelerator Design with Reinforcement Learning",
  "sections": {
    "optimized architecture evaluation": "Table VI shows the optimized parameter found by the optimizer for both cases for a specific α,β,γ𝛼𝛽𝛾\\alpha,\\beta,\\gamma value (user-defined weights on the objective function as explained in Eqn. 17). We observe that best parameter was found by RL PPO algorithm. It is imperative to note that multiple design configurations may exist, achieving almost identical (less than 1 variation) cost model value. The optimum design point for case (i) consists of thirty 3D AI chiplet pairs arranged in a 5×6565\\times 6 mesh topology, resulting in 60 chiplets in total. 2 chiplets (forming a pair) are connected with SoIC 3D integration technology with a data rate of 42Gbps per link and link count of 3200 providing up to 131.25 Tbps of bandwidth. Each chiplet pair is connected with other chiplet pair with 2.5D EMIB integration with a data rate of 20Gbps and a link count of 3100 delivering up to 60 Tbps of bandwidth. Four 16GB HBM chiplets, located at top, right, bottom, and middle of the 5×6565\\times 6 mesh topology, are connected to two to four neighboring AI chiplets with EMIB 2.5D integration technology with a data rate of 20Gbps per link and a link count of 4900, resulting in a bandwidth of 95 Tbps. The trace length for each 2.5D interconnect is selected as the minimum trace length possible (minimum chiplet-to-chiplet distance). In case (ii), when we increase the maximum number of chiplets to 128, we observe that the optimum design configuration contains 112 chiplets (56 chiplet pairs) and the communication bandwidth decreases for all cases. This is because, as the number of chiplets increases, area per chiplet decreases, resulting in smaller throughput per chiplet, less bandwidth demand, and high system utilization. We observe that 3D architecture, even with area penalty for TSV and TSV-associated keep-out zone, achieves 1.52×1.52\\times more logic density than its 2D/2.5D counterpart at the same package size. We synthesize the chiplet module, found by the optimizer, with Synopsys Fusion Compiler using their 14nm PDK  at 1GHz clock frequency and obtain the peak throughput per chiplet, (o​p​s/s​e​c)A​I​_​c​h​i​psubscript𝑜𝑝𝑠𝑠𝑒𝑐𝐴𝐼_𝑐ℎ𝑖𝑝(ops/sec)_{AI\\_chip}, and energy consumption per MAC operation, Eo​p⁣∗subscript𝐸𝑜𝑝E_{op*}. We use these values in our analytical model to estimate the throughput and energy efficiency of the 60 and 112 chiplet system. For cost estimation we use the model from . Fig. 12 compares the 60-chiplet, 112-chiplet and monolithic GPU for MLPerf benchmark .\nChiplet-based 3D system achieves higher throughput for all the benchmarks than monolithic chip because of its 1.52×1.52\\times more logic density (Fig. 12 (a)). The benchmark features are briefly summarized in Table VII.\nThe 112-chiplet system experiences higher communication latency compared to the 60-chiplet system. However, the lower bandwidth penalty of the 112-chiplet system, in contrast to the 60-chiplet system, outweighs the higher latency, resulting in a superior overall throughput compared to the 60-chiplet system. 60 and 112-chiplet systems are 3.7×3.7\\times and 3.6×3.6\\times more energy-efficient (inverse of energy consumption) than the monolithic counterpart, respectively (Fig. 12(b)).\nThe fact that chiplet architectures, which requires comparatively slower inter-chiplet links provide 1.5x more\nthroughput, and 3.7x energy efficiency compared to the monolithic one, is counter-intuitive. Because, there is no better solution than housing as many logic and cache as possible on the same die, given the hypothetical scenario that there is no yield, cost, or reticle size limitations (however this is not practically achievable). On the contrary, due to 3D stacking, the logic density, hence the throughput, has increased at the same area footprint. To achieve the same amount of throughput with the monolithic chip, more than one monolithic chip need to be linked off-board on the PCB, which consumes at least one order of magnitude more energy[ref]4 than on-package communication. This is the reason, 3D-stacked chiplet based architecture offers 1.5x throughput and 3.7x energy-efficiency\ncompared to its monolithic counterpart. Fig. 12(c) illustrates that the die cost of the monolithic chip is 76×76\\times and 143×143\\times higher than that of the 60 and 112 chiplet systems, respectively. This significant cost difference arises from the low yield (48%) of the monolithic chip of 826mm2, compared to the 97% and 98% die yield of the 60 and 112 chiplet systems, with a die size of 26mm2 and 14mm2, respectively, at 7nm node. In addition to that, the cost of the cost of Known Good Dies (KGD) is inversely proportional to the number of KGD (NK​G​Dsubscript𝑁𝐾𝐺𝐷N_{KGD}). As the die area (A) increases, the number of good dies (NK​G​Dsubscript𝑁𝐾𝐺𝐷N_{KGD}) decreases, leading to a substantial increase in cost. The relationship between the cost and die area can be approximated as c​o​s​tK​G​D∝A52proportional-to𝑐𝑜𝑠subscript𝑡𝐾𝐺𝐷superscript𝐴52cost_{KGD}\\propto A^{\\frac{5}{2}} (taking up to 2 terms of Taylor series expansion of die yield) [ref]4. Please note that, we implement our chiplet in synopsys 14nm free PDK. However, use estimate the cost for 7nm to have a fair comparison between the monolithic one, which was fabricated in 7nm technode. We consider chiplet I/O pad bonding yield of 99%percent9999\\% to estimate the packaging cost. In fact with better process control this bonding yield can reach 100%percent100100\\% as reported by TSMC in . Furthermore, even if there are faulty bondings, 100%percent100100\\% TSV/Hybrid-Bonding bonding yield can be achieved by using the TSV/pad repair techniques with spare TSV/pad [ref]51. We observe that the packaging cost of chiplet-based architecture is higher, 1.62×1.62\\times and 2.46×2.46\\times, than the monolithic one. However, with near perfect TSV bonding yield[ref]51, the packaging cost of chiplet-based architecture is only 1.28×1.28\\times (for 60-chiplets) and 1.63×1.63\\times of the monolithic one. Despite the package cost of the chiplet-based architecture being 1.62×1.62\\times (1.28×1.28\\times for 100%percent100100\\% bonding yield) higher than that of the monolithic architecture,\nthe advantages of smaller dies in the chiplet-based design offset the additional package expenses, as the silicon die cost contributes most to the overall manufacturing RE cost."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "A Survey on Evaluation of Large Language Models",
      "abstract": "",
      "year": "2024",
      "venue": "ACM Trans. Intell. Syst. Technol.",
      "authors": "Y. Chang et .al",
      "orig_title": "A survey on evaluation of large language models",
      "paper_id": "2307.03109v9"
    },
    {
      "index": 1,
      "title": "Zeus: Understanding and Optimizing GPU Energy Consumption of DNN Training",
      "abstract": "",
      "year": "2023",
      "venue": "20th USENIX Symposium on Networked Systems Design and Implementation (NSDI 23)",
      "authors": "You, Jie et. al."
    },
    {
      "index": 2,
      "title": "Heterogeneous Integration Roadmap",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 3,
      "title": "Automated Design of Chiplets",
      "abstract": "",
      "year": "2023",
      "venue": "International Symposium on Physical Design",
      "authors": "Sangiovanni-Vincentelli, Alberto et. al."
    },
    {
      "index": 4,
      "title": "Chiplet Cloud: Building AI Supercomputers for Serving Large Generative Language Models",
      "abstract": "",
      "year": "2023",
      "venue": "arXiv preprint arXiv:2307.02666",
      "authors": "Peng, Huwan et al.",
      "orig_title": "Chiplet Cloud: Building AI Supercomputers for Serving Large Generative Language Models",
      "paper_id": "2307.02666v4"
    },
    {
      "index": 5,
      "title": "Chiplet Actuary: A Quantitative Cost Model and Multi-Chiplet Architecture Exploration",
      "abstract": "",
      "year": "2022",
      "venue": "59th ACM/IEEE Design Automation Conference",
      "authors": "Y. Feng and K. Ma",
      "orig_title": "Chiplet Actuary: A Quantitative Cost Model and Multi-Chiplet Architecture Exploration",
      "paper_id": "2203.12268v4"
    },
    {
      "index": 6,
      "title": "Intel’s Ponte Vecchio GPU : Architecture, systems & software",
      "abstract": "",
      "year": "2022",
      "venue": "2022 IEEE Hot Chips 34 Symposium",
      "authors": "H. Jiang"
    },
    {
      "index": 7,
      "title": "Pioneering Chiplet Technology and Design for the AMD EPYC™ and Ryzen™ Processor Families : Industrial Product",
      "abstract": "",
      "year": "2021",
      "venue": "2021 ACM/IEEE 48th Annual International Symposium on Computer Architecture",
      "authors": "Naffziger, Samuel et al."
    },
    {
      "index": 8,
      "title": "Monad: Towards Cost-effective Specialization for Chiplet-based Spatial Accelerators",
      "abstract": "",
      "year": "2023",
      "venue": "IEEE/ACM International Conference on Computer Aided Design (ICCAD)",
      "authors": "Hao, Xiaochen et. al.",
      "orig_title": "Monad: Towards Cost-Effective Specialization for Chiplet-Based Spatial Accelerators",
      "paper_id": "2302.11256v3"
    },
    {
      "index": 9,
      "title": "Application Defined On-chip Networks for Heterogeneous Chiplets: An Implementation Perspective",
      "abstract": "",
      "year": "2022",
      "venue": "2022 IEEE International Symposium on High-Performance Computer Architecture",
      "authors": "Wang, Tianqi et al."
    },
    {
      "index": 10,
      "title": "Cross-Layer Co-Optimization of Network Design and Chiplet Placement in 2.5-D Systems",
      "abstract": "",
      "year": "2022",
      "venue": "IEEE TRANSACTIONS ON COMPUTER-AIDED DESIGN OF INTEGRATED CIRCUITS AND SYSTEMS",
      "authors": "Coskun, Ayse et al."
    },
    {
      "index": 11,
      "title": "A Deep Reinforcement Learning Framework for Architectural Exploration: A Routerless NoC Case Study",
      "abstract": "",
      "year": "2020",
      "venue": "2020 IEEE International Symposium on High Performance Computer Architecture",
      "authors": "Lin, Ting-Ru et al."
    },
    {
      "index": 12,
      "title": "Simba: Scaling deep-learning inference with multi-chip-module-based architecture",
      "abstract": "",
      "year": "2019",
      "venue": "52nd Annual IEEE/ACM International Symposium on Microarchitecture",
      "authors": "Shao, Yakun Sophia et al."
    },
    {
      "index": 13,
      "title": "NN-Baton: DNN Workload Orchestration and Chiplet Granularity Exploration for Multichip Accelerators",
      "abstract": "",
      "year": "2021",
      "venue": "2021 ACM/IEEE 48th Annual International Symposium on Computer Architecture",
      "authors": "Tan, Zhanhong et al."
    },
    {
      "index": 14,
      "title": "Scaling Deep-Learning Inference with Chiplet-based Architecture and Photonic Interconnects",
      "abstract": "",
      "year": "2021",
      "venue": "2021 58th ACM/IEEE Design Automation Conference (DAC)",
      "authors": "Y. Li, A. Louri, and A. Karanth"
    },
    {
      "index": 15,
      "title": "Zero-Shot Text-to-Image Generation",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Machine Learning",
      "authors": "A. Ramesh, M. Pavlov, G. Goh, S. Gray, C. Voss, A. Radford, M. Chen, and I. Sutskever",
      "orig_title": "Zero-shot text-to-image generation",
      "paper_id": "2102.12092v2"
    },
    {
      "index": 16,
      "title": "Attention Is All You Need",
      "abstract": "",
      "year": "2017",
      "venue": "Advances in neural information processing systems",
      "authors": "A. Vaswani et al.",
      "orig_title": "Attention is all you need",
      "paper_id": "1706.03762v7"
    },
    {
      "index": 17,
      "title": "Deep Residual Learning for Image Recognition",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "K. He, X. Zhang, S. Ren, and J. Sun",
      "orig_title": "Deep residual learning for image recognition",
      "paper_id": "1512.03385v1"
    },
    {
      "index": 18,
      "title": "Tpu v4: An optically reconfigurable supercomputer for machine learning with hardware support for embeddings",
      "abstract": "",
      "year": "2023",
      "venue": "50th Annual International Symposium on Computer Architecture",
      "authors": "Jouppi, Norm et. al."
    },
    {
      "index": 19,
      "title": "System and Design Technology Co-optimization of SOT-MRAM for High-Performance AI Accelerator Memory System",
      "abstract": "",
      "year": "2023",
      "venue": "IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems",
      "authors": "K. Mishty and M. Sadi",
      "orig_title": "System and Design Technology Co-Optimization of SOT-MRAM for High-Performance AI Accelerator Memory System",
      "paper_id": "2303.12310v2"
    },
    {
      "index": 20,
      "title": "Designs of Communication Circuits for Side-by-Side and Stacked Chiplets",
      "abstract": "",
      "year": "2021",
      "venue": "ISSCC 2021 Forums",
      "authors": "K. C.-H. Hsieh"
    },
    {
      "index": 21,
      "title": "Embedded Multi-die Interconnect Bridge (EMIB) – A High Density, High Bandwidth Packaging Interconnect",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE 66th Electronic Components and Technology Conference",
      "authors": "Mahajan, Ravi et al."
    },
    {
      "index": 22,
      "title": "Thermal-aware design space exploration of 3-D systolic ml accelerators",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE Journal on Exploratory Solid-State Computational Devices and Circuits",
      "authors": "Mathur, Rahul et. al."
    },
    {
      "index": 23,
      "title": "Foveros: 3D Integration and the use of Face-to-Face Chip Stacking for Logic Devices",
      "abstract": "",
      "year": "2019",
      "venue": "2019 IEEE International Electron Devices Meeting",
      "authors": "Ingerly, D. B. et a;."
    },
    {
      "index": 24,
      "title": "System on integrated chips (SoICTM) for 3d heterogeneous integration",
      "abstract": "",
      "year": "2019",
      "venue": "2019 IEEE 69th Electronic Components and Technology Conference",
      "authors": "Chen, F.C. et al."
    },
    {
      "index": 25,
      "title": "IEEE Std P1838: DfT standard-under-development for 2.5D-, 3D-, and 5.5D-SICs",
      "abstract": "",
      "year": "2016",
      "venue": "2016 21th IEEE European Test Symposium (ETS)",
      "authors": "E. J. Marinissen, T. McLaurin, and H. Jiao"
    },
    {
      "index": 26,
      "title": "Architecture, dataflow and physical design implications of 3D-ICs for DNN-accelerators",
      "abstract": "",
      "year": "2021",
      "venue": "22nd International Symposium on Quality Electronic Design",
      "authors": "Joseph, Jan Moritz et. al."
    },
    {
      "index": 27,
      "title": "How to Evaluate Deep Neural Network Processors: TOPS/W (Alone) Considered Harmful",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Solid-State Circuits Magazine",
      "authors": "Sze, Vivienne et. al."
    },
    {
      "index": 28,
      "title": "Kite: A Family of Heterogeneous Interposer Topologies Enabled via Accurate Interconnect Modeling",
      "abstract": "",
      "year": "2020",
      "venue": "2020 57th ACM/IEEE Design Automation Conference (DAC)",
      "authors": "Bharadwaj, Srikant et. al."
    },
    {
      "index": 29,
      "title": "System and Design Technology Co-optimization of Chiplet-based AI Accelerator with Machine Learning",
      "abstract": "",
      "year": "2023",
      "venue": "Great Lakes Symposium on VLSI",
      "authors": "K. Mishty and M. Sadi"
    },
    {
      "index": 30,
      "title": "Hbm3",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": ""
    },
    {
      "index": 31,
      "title": "Amd mi300",
      "abstract": "",
      "year": "2023",
      "venue": "",
      "authors": ""
    },
    {
      "index": 32,
      "title": "Cost-Aware Exploration for Chiplet-Based Architecture with Advanced Packaging Technologies",
      "abstract": "",
      "year": "2022",
      "venue": "arXiv preprint arXiv:2206.07308",
      "authors": "T. Tang and Y. Xie"
    },
    {
      "index": 33,
      "title": "A systematic methodology for characterizing scalability of dnn accelerators using scale-sim",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE International Symposium on Performance Analysis of Systems and Software",
      "authors": "A. Samajdar et al."
    },
    {
      "index": 34,
      "title": "Timeloop: A systematic approach to dnn accelerator evaluation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE International Symposium on Performance Analysis of Systems and Software",
      "authors": "Parashar, Angshuman et. al."
    },
    {
      "index": 35,
      "title": "Maestro: A data-centric approach to understand reuse, performance, and hardware cost of dnn mappings",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Micro",
      "authors": "Kwon, Hyoukjun et. al."
    },
    {
      "index": 36,
      "title": "ASTRA-sim2.0: Modeling Hierarchical Networks and Disaggregated Systems for Large-model Training at Scale",
      "abstract": "",
      "year": "2023",
      "venue": "2023 IEEE International Symposium on Performance Analysis of Systems and Software (ISPASS)",
      "authors": "Won, William et.al.",
      "orig_title": "Astra-sim2.0: Modeling hierarchical networks and disaggregated systems for large-model training at scale",
      "paper_id": "2303.14006v1"
    },
    {
      "index": 37,
      "title": "Stonne: Enabling cycle-level microarchitectural simulation for dnn inference accelerators",
      "abstract": "",
      "year": "2021",
      "venue": "2021 IEEE International Symposium on Workload Characterization (IISWC)",
      "authors": "Muñoz-Martínez, Francisco et. al."
    },
    {
      "index": 38,
      "title": "ConfuciuX: Autonomous Hardware Resource Assignment for DNN Accelerators using Reinforcement Learning",
      "abstract": "",
      "year": "2020",
      "venue": "2020 53rd Annual IEEE/ACM International Symposium on Microarchitecture (MICRO)",
      "authors": "Kao, Sheng-Chun et. al.",
      "orig_title": "Confuciux: Autonomous hardware resource assignment for dnn accelerators using reinforcement learning",
      "paper_id": "2009.02010v1"
    },
    {
      "index": 39,
      "title": "Architecture, chip, and package codesign flow for interposer-based 2.5-d chiplet integration enabling heterogeneous ip reuse",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Transactions on Very Large Scale Integration (VLSI) Systems",
      "authors": "Kim, Jinwoo et. al."
    },
    {
      "index": 40,
      "title": "Reinforcement learning: An introduction",
      "abstract": "",
      "year": "2018",
      "venue": "MIT press",
      "authors": "R. S. Sutton and A. G. Barto"
    },
    {
      "index": 41,
      "title": "Openai gym",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": ""
    },
    {
      "index": 42,
      "title": "Proximal policy optimization algorithms",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1707.06347",
      "authors": "Schulman, John et. al."
    },
    {
      "index": 43,
      "title": "Stable-baselines3",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": ""
    },
    {
      "index": 44,
      "title": "Systolic building block for logic-on-logic 3d-ic implementations of convolutional neural networks",
      "abstract": "",
      "year": "2019",
      "venue": "2019 IEEE International Symposium on Circuits and Systems (ISCAS)",
      "authors": "Kung, H. T. et. al."
    },
    {
      "index": 45,
      "title": "Temperature-Aware Sizing of Multi-Chip Module Accelerators for Multi-DNN Workloads",
      "abstract": "",
      "year": "2023",
      "venue": "2023 Design, Automation & Test in Europe Conference & Exhibition (DATE)",
      "authors": "Shukla, Prachi et. al."
    },
    {
      "index": 46,
      "title": "IntAct: A 96-Core Processor With Six Chiplets 3D-Stacked on an Active Interposer With Distributed Interconnects and Integrated Power Management",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE Journal of Solid-State Circuits",
      "authors": "Vivet, Pascal et. al."
    },
    {
      "index": 47,
      "title": "Synopsys 14nm PDK",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 48,
      "title": "MLPerf Benchmark",
      "abstract": "",
      "year": "2024",
      "venue": "",
      "authors": ""
    },
    {
      "index": 49,
      "title": "NVIDIA Ampere100 GPU.",
      "abstract": "",
      "year": "",
      "venue": "",
      "authors": ""
    },
    {
      "index": 50,
      "title": "On effective through-silicon via repair for 3-d-stacked ics",
      "abstract": "",
      "year": "2013",
      "venue": "IEEE Transactions on Computer-Aided Design of Integrated Circuits and Systems",
      "authors": "Q. X. L. Jiang and B. Eklow"
    },
    {
      "index": 51,
      "title": "Centaur: A Chiplet-based, Hybrid Sparse-Dense Accelerator for Personalized Recommendations",
      "abstract": "",
      "year": "2020",
      "venue": "ACM/IEEE 47th Annual International Symposium on Computer Architecture",
      "authors": "Hwang, Ranggi et al.",
      "orig_title": "Centaur: A Chiplet-based, Hybrid Sparse-Dense Accelerator for Personalized Recommendations",
      "paper_id": "2005.05968v1"
    },
    {
      "index": 52,
      "title": "The Next Era for Chiplet Innovation",
      "abstract": "",
      "year": "2023",
      "venue": "2023 Design, Automation & Test in Europe Conference & Exhibition (DATE)",
      "authors": "G. H. Loh and R. Swaminathan"
    },
    {
      "index": 53,
      "title": "Multi-Agent Reinforcement Learning for Microprocessor Design Space Exploration",
      "abstract": "",
      "year": "2022",
      "venue": "",
      "authors": "Krishnan, Srivatsan et al."
    },
    {
      "index": 54,
      "title": "Chip Placement with Deep Reinforcement Learning",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2004.10746",
      "authors": "Mirhoseini, Azalia et. al.",
      "orig_title": "Chip placement with deep reinforcement learning",
      "paper_id": "2004.10746v1"
    },
    {
      "index": 55,
      "title": "GCN-RL Circuit Designer: Transferable Transistor Sizing with Graph Neural Networks and Reinforcement Learning",
      "abstract": "",
      "year": "",
      "venue": "2020 57th ACM/IEEE Design Automation Conference",
      "authors": "Wang, Hanrui et. al.",
      "orig_title": "GCN-RL circuit designer: Transferable transistor sizing with graph neural networks and reinforcement learning",
      "paper_id": "2005.00406v1"
    },
    {
      "index": 56,
      "title": "AutoCkt: Deep reinforcement learning of analog circuit designs",
      "abstract": "",
      "year": "2020",
      "venue": "2020 Design, Automation & Test in Europe Conference & Exhibition (DATE)",
      "authors": "Settaluri, Keertana et. al."
    }
  ]
}