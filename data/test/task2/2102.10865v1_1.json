{
  "paper_id": "2102.10865v1",
  "title": "Handling Epistemic and Aleatory Uncertainties in Probabilistic Circuits",
  "sections": {
    "introduction": "Even in simple collaboration scenarios—like those in which an artificial intelligence (AI) system assists a human operator with predictions—the success of the team hinges on the human correctly deciding when to follow the recommendations of the AI system and when to override them .\nExtracting benefits from collaboration with the AI system depends on the human developing insights (i.e., a mental model) of when to trust the AI system with its recommendations . If the human mistakenly trusts the AI system in regions where it is likely to err, catastrophic failures may occur. This is a strong argument in favour of Bayesian approaches to probabilistic reasoning: research in the intersection of AI and HCI has found that interaction improves when setting expectations right about what the system can do and how well it performs  . Guidelines have been produced , and they recommend to Make clear what the system can do (G1), and Make clear how well the system can do what it can\ndo (G2). To identify such regions where the AI system is likely to err, we need to distinguish between (at least) two different sources of uncertainty: aleatory (or aleatoric), and epistemic uncertainty  . Aleatory uncertainty refers to the variability in the outcome of an experiment which is due to inherently random effects (e.g. flipping a fair coin): no additional source of information but Laplace’s daemon111“An\nintelligence that, at a given instant, could comprehend all the forces by\nwhich nature is animated and the respective situation of the beings that\nmake it up” [41, p.2]. can reduce such a variability. Epistemic uncertainty refers to the epistemic state of the agent using the model, hence its lack of knowledge that—in principle—can be reduced on the basis of additional data samples.\nParticularly when considering sparse data, the epistemic uncertainty\naround the learnt model can significantly affect decision making  , for instance when used for computing an expected utility 8. In this paper, we propose an approach to probabilistic reasoning\nthat manipulates distributions of probabilities without assuming independence and without resorting to sampling approaches\nwithin the unifying computational formalism provided by arithmetic circuits 9, sometimes named probabilistic circuits when manipulating probabilities, or simply circuits.\nThis is clearly a novel contribution as the few approaches  9 0 resorting to distribution estimation via moment matching like we also propose, still assume statistical independence in particular when manipulating distributions within the circuit.\nInstead, we provide an algorithm for Bayesian learning from sparse—albeit complete—observations, and for probabilistic inferences that keep track of the dependencies between variables when they are manipulated within the circuit.\nIn particular, we focus on the large class of approaches to probabilistic reasoning that rely upon algebraic model counting (AMC) 7 (Section 2.1), which has been proven to encompass probabilistic inferences under 0’s semantics, thus covering not only Bayesian networks , but also probabilistic logic programming approaches such as ProbLog 1, and others as discussed by 1.\nAs AMC is defined in\nterms of the set of models of a propositional logic theory, we can\nexploit the results of 6 (Section 2.2) who studied the succinctness relations between various\ntypes of circuits and thus their applicability to model counting.\nTo stress the applicability of this setting, circuit\ncompilation techniques 3 4  are behind state-of-the-art algorithms for (1) exact and approximate inference in discrete probabilistic graphical\nmodels 2 8 2;\nand (2) probabilistic programs 1 . Also, learning tractable circuits is the current method of choice for discrete\ndensity estimation 3  7 6 . Finally, 0 also used circuits to enforce logical constraints on deep neural networks. In this paper, we label each leaf of the circuit with a beta-distributed random variable (Section 3). The beta distribution is a well-defined theoretical framework that specifies a distribution of probabilities representing all the possible values of a probability when the exact value is unknown. In this way, the expected value of a beta-distributed random variable relates to the aleatory uncertainty of the phenomenon, and the variance to the epistemic uncertainty: the higher the variance, the less certain the machine is, thus targeting directly [1, G1 and G2].\nIn previous work 0 we provided operators for manipulating beta-distributed random variables under strong independence assumptions (Section 4). This paper significantly extends and improves our previous approach by eliminating the independence assumption in manipulating beta-distributed random variables within a circuit. Indeed, our main contribution (Section 5) is an algorithm for reasoning over a circuit whose leaves are labelled with beta-distributed random variables, with the additional piece of information describing which of those are actually independent (Section 5.1). This is the input to an algorithm that shadows the circuit by superimposing a second circuit for computing the probability of a query conditioned on a set of pieces of evidence (Section 5.2) in a single feed forward. While this at first might seems unnecessary, it is actually essential when inspecting the main algorithm that evaluates such a shadowed circuit (Section 5.3), where a covariance matrix plays an essential role by keeping track of the dependencies between random variables while they are manipulated within the circuit. We also include discussions on memory management of the covariance matrix in Section 5.4. We evaluate our approach against a set of competing approaches in an extensive set of experiments detailed in Section 6, comparing against leading approaches to dealing with uncertain probabilities, notably: (1) Monte Carlo sampling; (2) our previous proposal 0 taken as representative of the class of approaches using moment matching with strong independence assumptions; (3) Subjective Logic 0, that provides an alternative representation of beta distributions as well as a calculus for manipulating them applied already in a variety of domains, e.g. 1  2; (4) Subjective Bayesian Network (SBN) on circuits derived from singly-connected Bayesian networks 8 2 3, that already showed higher performance against other traditional approaches dealing with uncertain probabilities, such as (5) Dempster-Shafer Theory of Evidence 8 3, and (6) replacing single probability values with closed intervals representing the possible range of probability values 1.\nWe achieve better estimation of epistemic uncertainty than state-of-the-art approaches, including highly engineered ones for a narrow domain such as SBN, while being able to handle general circuits and with just a modest increase in the computational effort compared to using point probabilities."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "Guidelines for human-AI interaction",
      "abstract": "",
      "year": "2019",
      "venue": "Conference on Human Factors in Computing Systems",
      "authors": "Saleema Amershi, Dan Weld, Mihaela Vorvoreanu, Adam Fourney, Besmira Nushi, Penny Collisson, Jina Suh, Shamsi Iqbal, Paul N. Bennett, Kori Inkpen, Jaime Teevan, Ruth Kikin-Gil, and Eric Horvitz"
    },
    {
      "index": 1,
      "title": "Using a bayesian model for confidence to make decisions that consider epistemic regret",
      "abstract": "",
      "year": "2016",
      "venue": "19th International Conference on Information Fusion",
      "authors": "R. Anderson, N. Hare, and S. Maskell"
    },
    {
      "index": 2,
      "title": "Decision making with hierarchical credal sets",
      "abstract": "",
      "year": "2014",
      "venue": "Information Processing and Management of Uncertainty in Knowledge-Based Systems",
      "authors": "Alessandro Antonucci, Alexander Karlsson, and David Sundgren"
    },
    {
      "index": 3,
      "title": "Solving #Sat and bayesian inference with backtracking search",
      "abstract": "",
      "year": "2009",
      "venue": "Journal of Artificial Intelligence Research",
      "authors": "Fahiem Bacchus, Shannon Dalmao, and Toniann Pitassi"
    },
    {
      "index": 4,
      "title": "Beyond Accuracy: The Role of Mental Models in Human-AI Team Performance",
      "abstract": "",
      "year": "2019",
      "venue": "HCOMP. AAAI",
      "authors": "Gagan Bansal, Besmira Nushi, Ece Kamar, Walter Lasecki, Dan Weld, and Eric Horvitz"
    },
    {
      "index": 5,
      "title": "Updates in Human-AI Teams: Understanding and Addressing the Performance/Compatibility Tradeoff",
      "abstract": "",
      "year": "2019",
      "venue": "AAAI",
      "authors": "Gagan Bansal, Besmira Nushi, Ece Kamar, Daniel S Weld, Walter S Lasecki, and Eric Horvitz"
    },
    {
      "index": 6,
      "title": "Path problems in networks",
      "abstract": "",
      "year": "2010",
      "venue": "Synthesis Lectures on Communication Networks",
      "authors": "John S. Baras and George Theodorakopoulos"
    },
    {
      "index": 7,
      "title": "Expectation Maximization over Binary Decision Diagrams for Probabilistic Logic Programs",
      "abstract": "",
      "year": "2013",
      "venue": "Intell. Data Anal.",
      "authors": "Elena Bellodi and Fabrizio Riguzzi"
    },
    {
      "index": 8,
      "title": "Prolog programming for artificial intelligence",
      "abstract": "",
      "year": "2001",
      "venue": "Addison Wesley",
      "authors": "Ivan Bratko"
    },
    {
      "index": 9,
      "title": "Probabilistic logic programming with beta-distributed random variables",
      "abstract": "",
      "year": "2019",
      "venue": "The Thirty-Third AAAI Conference on Artificial Intelligence, AAAI 2019, The Thirty-First Innovative Applications of Artificial Intelligence Conference, IAAI 2019, The Ninth AAAI Symposium on Educational Advances in Artificial Intelligence, EAAI 2019",
      "authors": "Federico Cerutti, Lance M. Kaplan, Angelika Kimmig, and Murat Sensoy"
    },
    {
      "index": 10,
      "title": "A general approach to reasoning with probabilities",
      "abstract": "",
      "year": "2019",
      "venue": "Int. J. Approx. Reason.",
      "authors": "Federico Cerutti and Matthias Thimm"
    },
    {
      "index": 11,
      "title": "On probabilistic inference by weighted model counting",
      "abstract": "",
      "year": "2008",
      "venue": "Artificial Intelligence",
      "authors": "Mark Chavira and Adnan Darwiche"
    },
    {
      "index": 12,
      "title": "Dynamic minimization of Sentential Decision Diagrams",
      "abstract": "",
      "year": "2013",
      "venue": "27th AAAI Conference on Artificial Intelligence, AAAI 2013",
      "authors": "Arthur Choi and Adnan Darwiche"
    },
    {
      "index": 13,
      "title": "New Advances in Compiling CNF to Decomposable Negation Normal Form",
      "abstract": "",
      "year": "2004",
      "venue": "16th European Conference on Artificial Intelligence, ECAI’04",
      "authors": "Adnan Darwiche"
    },
    {
      "index": 14,
      "title": "SDD: A New Canonical Representation of Propositional Knowledge Bases",
      "abstract": "",
      "year": "2011",
      "venue": "Twenty-Second International Joint Conference on Artificial Intelligence, IJCAI’11",
      "authors": "Adnan Darwiche"
    },
    {
      "index": 15,
      "title": "A Knowledge Compilation Map",
      "abstract": "",
      "year": "2002",
      "venue": "J. Artif. Int. Res.",
      "authors": "Adnan Darwiche and Pierre Marquis"
    },
    {
      "index": 16,
      "title": "ProbLog: A probabilistic Prolog and its application in link discovery",
      "abstract": "",
      "year": "2007",
      "venue": "20th International Joint Conference on Artificial Intelligence",
      "authors": "Luc De Raedt, Angelika Kimmig, and Hannu Toivonen"
    },
    {
      "index": 17,
      "title": "A generalization of bayesian inference",
      "abstract": "",
      "year": "1968",
      "venue": "Journal of the Royal Statistical Society. Series B (Methodological)",
      "authors": "A. P. Dempster"
    },
    {
      "index": 18,
      "title": "Parameter Estimation for Probabilistic Finite-State Transducers",
      "abstract": "",
      "year": "2002",
      "venue": "40th Annual Meeting of the Association for Computational Linguistics",
      "authors": "Jason Eisner"
    },
    {
      "index": 19,
      "title": "Compiling comp ling: Practical weighted dynamic programming and the dyna language",
      "abstract": "",
      "year": "2005",
      "venue": "Conference on Human Language Technology and Empirical Methods in Natural Language Processing, HLT ’05",
      "authors": "Jason Eisner, Eric Goldlust, and Noah A. Smith"
    },
    {
      "index": 20,
      "title": "Inference and learning in probabilistic logic programs using weighted {B}oolean formulas",
      "abstract": "",
      "year": "2015",
      "venue": "Theory and Practice of Logic Programming",
      "authors": "Daan Fierens, Guy den Broeck, Joris Renkens, Dimitar Shterionov, Bernd Gutmann, Ingo Thon, Gerda Janssens, and Luc De Raedt"
    },
    {
      "index": 21,
      "title": "Approximate Knowledge Compilation by Online Collapsed Importance Sampling",
      "abstract": "",
      "year": "2018",
      "venue": "Advances in Neural Information Processing Systems 31",
      "authors": "Tal Friedman and Guy den Broeck",
      "orig_title": "Approximate Knowledge Compilation by Online Collapsed Importance Sampling",
      "paper_id": "1805.12565v1"
    },
    {
      "index": 22,
      "title": "Learning the structure of sum-product networks",
      "abstract": "",
      "year": "2013",
      "venue": "30th International Conference on Machine Learning, ICML 2013",
      "authors": "Robert Gens and Pedro Domingos"
    },
    {
      "index": 23,
      "title": "Semiring Parsing",
      "abstract": "",
      "year": "1999",
      "venue": "Computational Linguistics",
      "authors": "Joshua Goodman"
    },
    {
      "index": 24,
      "title": "Probability Models in Engineering and Science",
      "abstract": "",
      "year": "2005",
      "venue": "CRC Press",
      "authors": "Seon Mi Han Mark Nagurka Haym Benaroya, Seon Mi Han"
    },
    {
      "index": 25,
      "title": "Aleatory and epistemic uncertainty in probability elicitation with an example from hazardous waste management",
      "abstract": "",
      "year": "1996",
      "venue": "Reliability Engineering & System Safety",
      "authors": "Stephen C. Hora"
    },
    {
      "index": 26,
      "title": "Aleatoric and epistemic uncertainty in machine learning: A tutorial introduction",
      "abstract": "",
      "year": "2019",
      "venue": "",
      "authors": "Eyke Hüllermeier and Willem Waegeman"
    },
    {
      "index": 27,
      "title": "Subjective networks: Perspectives and challenges",
      "abstract": "",
      "year": "2015",
      "venue": "4th International Workshop on Graph Structures for Knowledge Representation and Reasoning",
      "authors": "Magdalena Ivanovska, Audun Jøsang, Lance Kaplan, and Francesco Sambo"
    },
    {
      "index": 28,
      "title": "Online algorithms for sum-product networks with continuous variables",
      "abstract": "",
      "year": "2016",
      "venue": "Conference on Probabilistic Graphical Models",
      "authors": "Priyank Jaini, Abdullah Rashwan, Han Zhao, Yue Liu, Ershad Banijamali, Zhitang Chen, and Pascal Poupart"
    },
    {
      "index": 29,
      "title": "Subjective Logic: A Formalism for Reasoning Under Uncertainty",
      "abstract": "",
      "year": "2016",
      "venue": "Springer",
      "authors": "Audun Jøsang"
    },
    {
      "index": 30,
      "title": "Trust network analysis with subjective logic",
      "abstract": "",
      "year": "2006",
      "venue": "29th Australasian Computer Science Conference",
      "authors": "Audun Jøsang, Ross Hayward, and Simon Pope"
    },
    {
      "index": 31,
      "title": "Efficient subjective Bayesian network belief propagation for trees",
      "abstract": "",
      "year": "2016",
      "venue": "19th International Conference on Information Fusion",
      "authors": "Lance Kaplan and Magdalena Ivanovska"
    },
    {
      "index": 32,
      "title": "Efficient belief propagation in second-order bayesian networks for singly-connected graphs",
      "abstract": "",
      "year": "2018",
      "venue": "International Journal of Approximate Reasoning",
      "authors": "Lance Kaplan and Magdalena Ivanovska"
    },
    {
      "index": 33,
      "title": "Second-order inference in uncertain Bayesian networks",
      "abstract": "",
      "year": "2020",
      "venue": "International Journal of Artificial Intelligence",
      "authors": "Lance Kaplan, Magdalena Ivanovska, Kumar Vijay Mishra, Federico Cerutti, and Murat Sensoy"
    },
    {
      "index": 34,
      "title": "An empirical comparison of Bayesian and credal networks for dependable high-level information fusion",
      "abstract": "",
      "year": "2008",
      "venue": "Intl. Conf. on Information Fusion (FUSION)",
      "authors": "Alexander Karlsson, Ronnie Johansson, and Sten F Andler"
    },
    {
      "index": 35,
      "title": "An algebraic prolog for reasoning about possible worlds",
      "abstract": "",
      "year": "2011",
      "venue": "Twenty-Fifth AAAI Conference on Artificial Intelligence",
      "authors": "Angelika Kimmig, Guy Van den Broeck, and Luc De Raedt"
    },
    {
      "index": 36,
      "title": "Algebraic model counting",
      "abstract": "",
      "year": "2017",
      "venue": "J. of Applied Logic",
      "authors": "Angelika Kimmig, Guy Van den Broeck, and Luc De Raedt"
    },
    {
      "index": 37,
      "title": "Probabilistic Sentential Decision Diagrams",
      "abstract": "",
      "year": "2014",
      "venue": "Fourteenth International Conference on Principles of Knowledge Representation and Reasoning, KR’14",
      "authors": "Doga Kisa, Guy den Broeck, Arthur Choi, and Adnan Darwiche"
    },
    {
      "index": 38,
      "title": "Will you accept an imperfect AI? Exploring Designs for Adjusting End-user Expectations of AI Systems",
      "abstract": "",
      "year": "2019",
      "venue": "Conference on Human Factors in Computing Systems",
      "authors": "Rafal Kocielnik, Saleema Amershi, and Paul N. Bennett"
    },
    {
      "index": 39,
      "title": "The early years of logic programming",
      "abstract": "",
      "year": "1988",
      "venue": "Communications of the ACM",
      "authors": "Robert A. Kowalski"
    },
    {
      "index": 40,
      "title": "A Philosophical Essay on Probabilities",
      "abstract": "",
      "year": "1825",
      "venue": "Springer",
      "authors": "Pierre Simon Laplace"
    },
    {
      "index": 41,
      "title": "Learning the structure of probabilistic sentential decision diagrams",
      "abstract": "",
      "year": "2017",
      "venue": "Uncertainty in Artificial Intelligence - 33rd Conference, UAI 2017",
      "authors": "Yitao Liang, Jessa Bekker, and Guy Van Den Broeck"
    },
    {
      "index": 42,
      "title": "Multi-criteria decision assessments using subjective logic: Methodology and the case of urban water strategies",
      "abstract": "",
      "year": "2012",
      "venue": "Journal of Hydrology",
      "authors": "Magnus Moglia, Ashok K. Sharma, and Shiroma Maheepala"
    },
    {
      "index": 43,
      "title": "A Top-down Compiler for Sentential Decision Diagrams",
      "abstract": "",
      "year": "2015",
      "venue": "24th International Conference on Artificial Intelligence, IJCAI’15",
      "authors": "Umut Oztok and Adnan Darwiche"
    },
    {
      "index": 44,
      "title": "Fusion, propagation, and structuring in belief networks",
      "abstract": "",
      "year": "1986",
      "venue": "Artificial Intelligence",
      "authors": "Judea Pearl"
    },
    {
      "index": 45,
      "title": "Abducing through negation as failure: stable models within the independent choice logic",
      "abstract": "",
      "year": "2000",
      "venue": "The Journal of Logic Programming",
      "authors": "David Poole"
    },
    {
      "index": 46,
      "title": "Online and distributed bayesian moment matching for parameter learning in sum-product networks",
      "abstract": "",
      "year": "2016",
      "venue": "Artificial Intelligence and Statistics",
      "authors": "Abdullah Rashwan, Han Zhao, and Pascal Poupart"
    },
    {
      "index": 47,
      "title": "Learning Sum-Product Networks with Direct and Indirect Variable Interactions",
      "abstract": "",
      "year": "2014",
      "venue": "31st International Conference on Machine Learning, ICML’14",
      "authors": "Amirmohammad Rooshenas and Daniel Lowd"
    },
    {
      "index": 48,
      "title": "Performing bayesian inference by weighted model counting",
      "abstract": "",
      "year": "2005",
      "venue": "20th National Conference on Artificial Intelligence",
      "authors": "Tian Sang, Paul Bearne, and Henry Kautz"
    },
    {
      "index": 49,
      "title": "A statistical learning method for logic programs with distribution semantics",
      "abstract": "",
      "year": "1995",
      "venue": "12th International Conference on Logic Programming (ICLP-95)",
      "authors": "Taisuke Sato"
    },
    {
      "index": 50,
      "title": "Parameter learning of logic programs for symbolic-statistical modeling",
      "abstract": "",
      "year": "2001",
      "venue": "Journal of Artificial Intelligence Research",
      "authors": "Taisuke Sato and Yoshitaka Kameya"
    },
    {
      "index": 51,
      "title": "Evidential Deep Learning to Quantify Classification Uncertainty",
      "abstract": "",
      "year": "2018",
      "venue": "32nd Conference on Neural Information Processing Systems (NIPS 2018)",
      "authors": "Murat Sensoy, Lance Kaplan, and Melih Kandemir",
      "orig_title": "Evidential deep learning to quantify classification uncertainty",
      "paper_id": "1806.01768v3"
    },
    {
      "index": 52,
      "title": "Belief functions: The disjunctive rule of combination and the generalized Bayesian theorem",
      "abstract": "",
      "year": "1993",
      "venue": "International Journal of Approximate Reasoning",
      "authors": "P. Smets"
    },
    {
      "index": 53,
      "title": "Bayesian Learning of Sum-Product Networks",
      "abstract": "",
      "year": "2019",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Martin Trapp, Robert Peharz, Hong Ge, Franz Pernkopf, and Zoubin Ghahramani",
      "orig_title": "Bayesian learning of sum-product networks",
      "paper_id": "1905.10884v3"
    },
    {
      "index": 54,
      "title": "Quantifying the uncertainty of a belief net response: Bayesian error-bars for belief net inference",
      "abstract": "",
      "year": "2008",
      "venue": "Artificial Intelligence",
      "authors": "Tim Van Allen, Ajit Singh, Russell Greiner, and Peter Hooper"
    },
    {
      "index": 55,
      "title": "Simplifying, Regularizing and Strengthening Sum-Product Network Structure Learning",
      "abstract": "",
      "year": "2015",
      "venue": "Machine Learning and Knowledge Discovery in Databases",
      "authors": "Antonio Vergari, Nicola Di Mauro, and Floriana Esposito"
    },
    {
      "index": 56,
      "title": "Automatic Bayesian Density Analysis",
      "abstract": "",
      "year": "2019",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "Antonio Vergari, Alejandro Molina, Robert Peharz, Zoubin Ghahramani, Kristian Kersting, and Isabel Valera",
      "orig_title": "Automatic Bayesian density analysis",
      "paper_id": "1807.09306v3"
    },
    {
      "index": 57,
      "title": "Theory of games and economic behavior (commemorative edition)",
      "abstract": "",
      "year": "2007",
      "venue": "Princeton university press",
      "authors": "John Von Neumann and Oskar Morgenstern"
    },
    {
      "index": 58,
      "title": "Algebraic Complexity Theory",
      "abstract": "",
      "year": "1988",
      "venue": "Annual Review of Computer Science",
      "authors": "Joachim von zur Gathen"
    },
    {
      "index": 59,
      "title": "A Semantic Loss Function for Deep Learning with Symbolic Knowledge",
      "abstract": "",
      "year": "2018",
      "venue": "35th International Conference on Machine Learning, ICML 2018",
      "authors": "Jingyi Xu, Zilu Zhang, Tal Friedman, Yitao Liang, and Guy Van Den Broeck",
      "orig_title": "A semantic loss function for deep learning with symbolic knowledge",
      "paper_id": "1711.11157v2"
    },
    {
      "index": 60,
      "title": "2U: An exact interval propagation algorithm for polytrees with binary variables",
      "abstract": "",
      "year": "1998",
      "venue": "Artificial Intelligence",
      "authors": "M. Zaffalon and E. Fagiuoli"
    },
    {
      "index": 61,
      "title": "Collapsed variational inference for sum-product networks",
      "abstract": "",
      "year": "2016",
      "venue": "International Conference on Machine Learning",
      "authors": "Han Zhao, Tameem Adel, Geoff Gordon, and Brandon Amos"
    },
    {
      "index": 62,
      "title": "A Unified Approach for Learning the Parameters of Sum-Product Networks",
      "abstract": "",
      "year": "2016",
      "venue": "30th International Conference on Neural Information Processing Systems, NIPS’16",
      "authors": "Han Zhao, Pascal Poupart, and Geoff Gordon",
      "orig_title": "A Unified Approach for Learning the Parameters of Sum-Product Networks",
      "paper_id": "1601.00318v4"
    }
  ]
}