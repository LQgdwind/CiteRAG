{
  "paper_id": "2104.09841v1",
  "title": "SelfReg: Self-supervised Contrastive Regularization for Domain Generalization",
  "sections": {
    "related work": "The main goal of domain generalization (DG) is to generate domain-invariant features so that the model is generalizable to unseen target domains, which are generally outside the training distribution. Of a landmark work, Vapnik et al.  introduces Empirical Risk Minimization (ERM) that minimizes the sum of errors across domains. Notable variants have been introduced to learn domain-invariant features by matching distributions across different domains. Ganin et al.  utilizes an adversarial network to match such distributions, while Li et al. [ref]29 instead matches the conditional distributions across domains. Such a shared feature space is optimized by minimizing maximum mean discrepancy , transformed feature distribution distance , or covariances [ref]38. In this work, we also follow this stream of work, but we explore the benefit of self-supervised contrastive learning that can inherently learn to domain-invariant discriminating feature by explicitly mapping the “same-class” latent representations close together. To our best knowledge, there are few that applied contrastive learning in the domain generalization setting. Classification and contrastive semantic alignment (CCSA)  and model-agnostic learning of semantic features (MASF) [ref]11 aimed to reduce the distance of same-class (positive pair) feature distributions while increasing the distance of different-class (negative pair) feature distributions. However, using such negative pairs often make the training unstable unless useful negative samples are available in the same batch, which is often challenging. To address this issue, we focus on minimizing a distance between the same-class (positive pair) features in the embedding space as recently studied for the self-supervised learning task   , including BYOL  and SimSiam . Inter-domain mixup    techniques are introduced to perform empirical risk minimization on linearly interpolated examples from random pairs across domains. We also utilize such a mixup, but we only interpolate same-class features to preserve the class-specific features. We observe that such a same-class mixup help obtaining robust performance for unseen domain data. As another branch, JiGen  utilizes a self-supervised signal by solving a jigsaw puzzle as a secondary task to improve generalization. Meta-learning frameworks  are also explored for domain generalization to meta-learn how to generalize across domains by leveraging MAML . Some also explored splitting the model into domain-invariant and domain-variant components by low-rank parameterization , style-agnostic network , domain-specific aggregation modules ."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "Invariant risk minimization",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1907.02893",
      "authors": "Martin Arjovsky, Léon Bottou, Ishaan Gulrajani, and David Lopez-Paz"
    },
    {
      "index": 1,
      "title": "Recognition in Terra Incognita",
      "abstract": "",
      "year": "2018",
      "venue": "European Conference on Computer Vision (ECCV)",
      "authors": "Sara Beery, Grant Van Horn, and Pietro Perona",
      "orig_title": "Recognition in terra incognita",
      "paper_id": "1807.04975v2"
    },
    {
      "index": 2,
      "title": "Domain generalization by marginal transfer learning",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1711.07910",
      "authors": "Gilles Blanchard, Aniket Anand Deshmukh, Urun Dogan, Gyemin Lee, and Clayton Scott"
    },
    {
      "index": 3,
      "title": "Generalizing from several related classification tasks to a new unlabeled sample",
      "abstract": "",
      "year": "2011",
      "venue": "Advances in neural information processing systems",
      "authors": "Gilles Blanchard, Gyemin Lee, and Clayton Scott"
    },
    {
      "index": 4,
      "title": "Domain Generalization by Solving Jigsaw Puzzles",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Fabio M Carlucci, Antonio D’Innocente, Silvia Bucci, Barbara Caputo, and Tatiana Tommasi",
      "orig_title": "Domain generalization by solving jigsaw puzzles",
      "paper_id": "1903.06864v2"
    },
    {
      "index": 5,
      "title": "Domain generalization needs stochastic weight averaging for robustness on domain shifts",
      "abstract": "",
      "year": "2021",
      "venue": "",
      "authors": "Junbum Cha, Hancheol Cho, Kyungjae Lee, Seunghyun Park, Yunsung Lee, and Sungrae Park"
    },
    {
      "index": 6,
      "title": "A Simple Framework for Contrastive Learning of Visual Representations",
      "abstract": "",
      "year": "2020",
      "venue": "International conference on machine learning",
      "authors": "Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton",
      "orig_title": "A simple framework for contrastive learning of visual representations",
      "paper_id": "2002.05709v3"
    },
    {
      "index": 7,
      "title": "Exploring Simple Siamese Representation Learning",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2011.10566",
      "authors": "Xinlei Chen and Kaiming He",
      "orig_title": "Exploring simple siamese representation learning",
      "paper_id": "2011.10566v1"
    },
    {
      "index": 8,
      "title": "Imagenet: A large-scale hierarchical image database",
      "abstract": "",
      "year": "2009",
      "venue": "2009 IEEE conference on computer vision and pattern recognition",
      "authors": "Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei"
    },
    {
      "index": 9,
      "title": "A deep convolutional activation feature for generic visual recognition",
      "abstract": "",
      "year": "",
      "venue": "UC Berkeley & ICSI, Berkeley, CA, USA",
      "authors": "Jeff Donahue, Yangqing Jia, Oriol Vinyals, Judy Hoffman, Ning Zhang, Eric Tzeng, and Trevor Darrell"
    },
    {
      "index": 10,
      "title": "Domain Generalization via Model-Agnostic Learning of Semantic Features",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1910.13580",
      "authors": "Qi Dou, Daniel C Castro, Konstantinos Kamnitsas, and Ben Glocker",
      "orig_title": "Domain generalization via model-agnostic learning of semantic features",
      "paper_id": "1910.13580v1"
    },
    {
      "index": 11,
      "title": "Domain Generalization with Domain-Specific Aggregation Modules",
      "abstract": "",
      "year": "2018",
      "venue": "German Conference on Pattern Recognition",
      "authors": "Antonio D’Innocente and Barbara Caputo",
      "orig_title": "Domain generalization with domain-specific aggregation modules",
      "paper_id": "1809.10966v1"
    },
    {
      "index": 12,
      "title": "Unbiased metric learning: On the utilization of multiple datasets and web images for softening bias",
      "abstract": "",
      "year": "2013",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Chen Fang, Ye Xu, and Daniel N Rockmore"
    },
    {
      "index": 13,
      "title": "Model-Agnostic Meta-Learning for Fast Adaptation of Deep Networks",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Machine Learning",
      "authors": "Chelsea Finn, Pieter Abbeel, and Sergey Levine",
      "orig_title": "Model-agnostic meta-learning for fast adaptation of deep networks",
      "paper_id": "1703.03400v3"
    },
    {
      "index": 14,
      "title": "Domain-Adversarial Training of Neural Networks",
      "abstract": "",
      "year": "2016",
      "venue": "The journal of machine learning research",
      "authors": "Yaroslav Ganin, Evgeniya Ustinova, Hana Ajakan, Pascal Germain, Hugo Larochelle, François Laviolette, Mario Marchand, and Victor Lempitsky",
      "orig_title": "Domain-adversarial training of neural networks",
      "paper_id": "1505.07818v4"
    },
    {
      "index": 15,
      "title": "Domain generalization for object recognition with multi-task autoencoders",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE international conference on computer vision",
      "authors": "Muhammad Ghifary, W Bastiaan Kleijn, Mengjie Zhang, and David Balduzzi"
    },
    {
      "index": 16,
      "title": "Bootstrap Your Own Latent A New Approach to Self-Supervised Learning",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2006.07733",
      "authors": "Jean-Bastien Grill, Florian Strub, Florent Altché, Corentin Tallec, Pierre H Richemond, Elena Buchatskaya, Carl Doersch, Bernardo Avila Pires, Zhaohan Daniel Guo, Mohammad Gheshlaghi Azar, et al.",
      "orig_title": "Bootstrap your own latent: A new approach to self-supervised learning",
      "paper_id": "2006.07733v3"
    },
    {
      "index": 17,
      "title": "In Search of Lost Domain Generalization",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2007.01434",
      "authors": "Ishaan Gulrajani and David Lopez-Paz",
      "orig_title": "In search of lost domain generalization",
      "paper_id": "2007.01434v1"
    },
    {
      "index": 18,
      "title": "Asymmetric Valleys: Beyond Sharp and Flat Local Minima",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1902.00744",
      "authors": "Haowei He, Gao Huang, and Yang Yuan",
      "orig_title": "Asymmetric valleys: Beyond sharp and flat local minima",
      "paper_id": "1902.00744v2"
    },
    {
      "index": 19,
      "title": "Momentum Contrast for Unsupervised Visual Representation Learning",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Kaiming He, Haoqi Fan, Yuxin Wu, Saining Xie, and Ross Girshick",
      "orig_title": "Momentum contrast for unsupervised visual representation learning",
      "paper_id": "1911.05722v3"
    },
    {
      "index": 20,
      "title": "Deep Residual Learning for Image Recognition",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun",
      "orig_title": "Deep residual learning for image recognition",
      "paper_id": "1512.03385v1"
    },
    {
      "index": 21,
      "title": "Self-Challenging Improves Cross-Domain Generalization",
      "abstract": "",
      "year": "2020",
      "venue": "ECCV",
      "authors": "Zeyi Huang, Haohan Wang, Eric P. Xing, and Dong Huang",
      "orig_title": "Self-challenging improves cross-domain generalization",
      "paper_id": "2007.02454v1"
    },
    {
      "index": 22,
      "title": "Averaging Weights Leads to Wider Optima and Better Generalization",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv preprint arXiv:1803.05407",
      "authors": "Pavel Izmailov, Dmitrii Podoprikhin, Timur Garipov, Dmitry Vetrov, and Andrew Gordon Wilson",
      "orig_title": "Averaging weights leads to wider optima and better generalization",
      "paper_id": "1803.05407v3"
    },
    {
      "index": 23,
      "title": "On convergence and stability of gans",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1705.07215",
      "authors": "Naveen Kodali, Jacob Abernethy, James Hays, and Zsolt Kira"
    },
    {
      "index": 24,
      "title": "Out-of-distribution generalization via risk extrapolation (rex)",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2003.00688",
      "authors": "David Krueger, Ethan Caballero, Joern-Henrik Jacobsen, Amy Zhang, Jonathan Binas, Dinghuai Zhang, Remi Le Priol, and Aaron Courville"
    },
    {
      "index": 25,
      "title": "Deeper, Broader and Artier Domain Generalization",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Computer Vision",
      "authors": "Da Li, Yongxin Yang, Yi-Zhe Song, and Timothy Hospedales",
      "orig_title": "Deeper, broader and artier domain generalization",
      "paper_id": "1710.03077v1"
    },
    {
      "index": 26,
      "title": "Learning to Generalize: Meta-Learning for Domain Generalization",
      "abstract": "",
      "year": "2018",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "Da Li, Yongxin Yang, Yi-Zhe Song, and Timothy Hospedales",
      "orig_title": "Learning to generalize: Meta-learning for domain generalization",
      "paper_id": "1710.03463v1"
    },
    {
      "index": 27,
      "title": "Domain generalization with adversarial feature learning",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Conference on Computer Vision and Pattern Recognition",
      "authors": "Haoliang Li, Sinno Jialin Pan, Shiqi Wang, and Alex C Kot"
    },
    {
      "index": 28,
      "title": "Deep domain generalization via conditional invariant adversarial networks",
      "abstract": "",
      "year": "2018",
      "venue": "European Conference on Computer Vision (ECCV)",
      "authors": "Ya Li, Xinmei Tian, Mingming Gong, Yajing Liu, Tongliang Liu, Kun Zhang, and Dacheng Tao"
    },
    {
      "index": 29,
      "title": "Unified Deep Supervised Domain Adaptation and Generalization",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE international conference on computer vision",
      "authors": "Saeid Motiian, Marco Piccirilli, Donald A Adjeroh, and Gianfranco Doretto",
      "orig_title": "Unified deep supervised domain adaptation and generalization",
      "paper_id": "1709.10190v1"
    },
    {
      "index": 30,
      "title": "Domain generalization via invariant feature representation",
      "abstract": "",
      "year": "2013",
      "venue": "International Conference on Machine Learning",
      "authors": "Krikamol Muandet, David Balduzzi, and Bernhard Schölkopf"
    },
    {
      "index": 31,
      "title": "Reducing domain gap via style-agnostic networks",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1910.11645",
      "authors": "Hyeonseob Nam, HyunJae Lee, Jongchan Park, Wonjun Yoon, and Donggeun Yoo"
    },
    {
      "index": 32,
      "title": "Representation Learning with Contrastive Predictive Coding",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv preprint arXiv:1807.03748",
      "authors": "Aaron van den Oord, Yazhe Li, and Oriol Vinyals",
      "orig_title": "Representation learning with contrastive predictive coding",
      "paper_id": "1807.03748v2"
    },
    {
      "index": 33,
      "title": "Moment Matching for Multi-Source Domain Adaptation",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Xingchao Peng, Qinxun Bai, Xide Xia, Zijun Huang, Kate Saenko, and Bo Wang",
      "orig_title": "Moment matching for multi-source domain adaptation",
      "paper_id": "1812.01754v4"
    },
    {
      "index": 34,
      "title": "Learning Deep Object Detectors from 3D Models",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE International Conference on Computer Vision",
      "authors": "Xingchao Peng, Baochen Sun, Karim Ali, and Kate Saenko",
      "orig_title": "Learning deep object detectors from 3d models",
      "paper_id": "1412.7122v4"
    },
    {
      "index": 35,
      "title": "Distributionally Robust Neural Networks for Group Shifts: On the Importance of Regularization for Worst-Case Generalization",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv preprint arXiv:1911.08731",
      "authors": "Shiori Sagawa, Pang Wei Koh, Tatsunori B Hashimoto, and Percy Liang",
      "orig_title": "Distributionally robust neural networks for group shifts: On the importance of regularization for worst-case generalization",
      "paper_id": "1911.08731v2"
    },
    {
      "index": 36,
      "title": "Grad-CAM: Visual Explanations from Deep Networks via Gradient-based Localization",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE international conference on computer vision",
      "authors": "Ramprasaath R Selvaraju, Michael Cogswell, Abhishek Das, Ramakrishna Vedantam, Devi Parikh, and Dhruv Batra",
      "orig_title": "Grad-cam: Visual explanations from deep networks via gradient-based localization",
      "paper_id": "1610.02391v4"
    },
    {
      "index": 37,
      "title": "Deep CORAL: Correlation Alignment for Deep Domain Adaptation",
      "abstract": "",
      "year": "2016",
      "venue": "European conference on computer vision",
      "authors": "Baochen Sun and Kate Saenko",
      "orig_title": "Deep coral: Correlation alignment for deep domain adaptation",
      "paper_id": "1607.01719v1"
    },
    {
      "index": 38,
      "title": "Visualizing Data using GTSNE",
      "abstract": "",
      "year": "2008",
      "venue": "Journal of machine learning research",
      "authors": "Laurens Van der Maaten and Geoffrey Hinton",
      "orig_title": "Visualizing data using t-sne",
      "paper_id": "2108.01301v1"
    },
    {
      "index": 39,
      "title": "Statistical learning theory new york",
      "abstract": "",
      "year": "1998",
      "venue": "NY: Wiley",
      "authors": "V Vapnik"
    },
    {
      "index": 40,
      "title": "An overview of statistical learning theory",
      "abstract": "",
      "year": "1999",
      "venue": "IEEE transactions on neural networks",
      "authors": "Vladimir N Vapnik"
    },
    {
      "index": 41,
      "title": "Deep Hashing Network for Unsupervised Domain Adaptation",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE conference on computer vision and pattern recognition",
      "authors": "Hemanth Venkateswara, Jose Eusebio, Shayok Chakraborty, and Sethuraman Panchanathan",
      "orig_title": "Deep hashing network for unsupervised domain adaptation",
      "paper_id": "1706.07522v1"
    },
    {
      "index": 42,
      "title": "Heterogeneous Domain Generalization via Domain Mixup",
      "abstract": "",
      "year": "2020",
      "venue": "ICASSP 2020-2020 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)",
      "authors": "Yufei Wang, Haoliang Li, and Alex C Kot",
      "orig_title": "Heterogeneous domain generalization via domain mixup",
      "paper_id": "2009.05448v1"
    },
    {
      "index": 43,
      "title": "Adversarial Domain Adaptation with Domain Mixup",
      "abstract": "",
      "year": "2020",
      "venue": "AAAI Conference on Artificial Intelligence",
      "authors": "Minghao Xu, Jian Zhang, Bingbing Ni, Teng Li, Chengjie Wang, Qi Tian, and Wenjun Zhang",
      "orig_title": "Adversarial domain adaptation with domain mixup",
      "paper_id": "1912.01805v1"
    },
    {
      "index": 44,
      "title": "Improve Unsupervised Domain Adaptation with Mixup Training",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2001.00677",
      "authors": "Shen Yan, Huan Song, Nanxiang Li, Lincan Zou, and Liu Ren",
      "orig_title": "Improve unsupervised domain adaptation with mixup training",
      "paper_id": "2001.00677v1"
    },
    {
      "index": 45,
      "title": "mixup: Beyond Empirical Risk Minimization",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1710.09412",
      "authors": "Hongyi Zhang, Moustapha Cisse, Yann N Dauphin, and David Lopez-Paz",
      "orig_title": "mixup: Beyond empirical risk minimization",
      "paper_id": "1710.09412v2"
    },
    {
      "index": 46,
      "title": "Adaptive risk minimization: A meta-learning approach for tackling group shift",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2007.02931",
      "authors": "Marvin Zhang, Henrik Marklund, Abhishek Gupta, Sergey Levine, and Chelsea Finn"
    },
    {
      "index": 47,
      "title": "On learning invariant representations for domain adaptation",
      "abstract": "",
      "year": "2019",
      "venue": "International Conference on Machine Learning",
      "authors": "Han Zhao, Remi Tachet Des Combes, Kun Zhang, and Geoffrey Gordon"
    }
  ]
}