{
  "paper_id": "2303.07543v4",
  "title": "WDiscOOD: Out-of-Distribution Detection via Whitened Linear Discriminant Analysis",
  "sections": {
    "introduction": "Deep learning models are typically designed with a closed-world\nassumption [ref]46, where test data is assumed to be drawn from the same distribution as the training data.\nWithout any built-in mechanism to distinguish novel concepts, deep neural networks are prone to generate incorrect answers with high confidence when presented with out-of-distribution (OOD) data.\nSuch a misleading decision could result in catastrophic consequences in applications, which makes the deep neural network hard to deploy in the open world.\nTo address this issue, significant research efforts have been devoted to the\nproblem of OOD detection, which aims to establish a robust method for\nidentifying when the testing data is “unknown.” Specifically, OOD detection requires establishing a scoring function to\nseparate ID and OOD data.\nDesigned for deep visual classifiers, the majority of works examine\nactivation patterns from the classification layer.\nFor example, a popular baseline is to leverage the maximum posterior\nprobability output of a softmax classifier to indicate ID-ness , assuming that the network is more confident with its decision for ID data.\nThe idea is enhanced by neural network calibration techniques   , which aim to align network confidence with actual likelihood. The technique has been shown to improve OOD detection performance.\nOther classifier-based scores explore unnormalized posterior probabilities\nknown as logits  , and norms of gradients\nbackpropagated from the classification layer  . Recently, ViM  argues that both class-dependent and class-agnostic information can potentially facilitate the OOD detection task.\nBased on the idea, it designs a scoring function by mapping the\nfeature-space principle component residual to the logit space.\nDespite the great performance achieved, ViM still requires supervision to\ntrain the classification layer.\nMeanwhile, advances in pretraining large-scale visual encoders using\ncontrastive learning techniques  [ref]27 have occured in recent\nyears.\nThese methods no longer rely on jointly training deep visual encoders with task heads, but instead formulate objectives directly in the feature space to produce high-quality visual representations.\nThe learnt encoder can be applied to downstream tasks with little or no fine-tuning required 6 9,\nsuggesting a new paradign for addressing computer vision problems.\nWhile it is non-trivial to adopt classifier-based OOD detection methods directly to visual encoders, applying feature space methods is straightforward.\nFor example, SSD 8 applies Mahalanobis 1 distance in\nthe contrastive feature space, and demonstrates superior performance\ncompared to a typical classification visual encoder. In this work, we aim to reason about both class-specific and class-agnostic information solely within the feature space.\nTo achieve this, we utilize Whitened Linear Discriminant Analysis (WLDA) to project visual features into two subspaces: a discriminative subspace and a residual subspace.\nThe former contains compact class-discriminative signals, while the latter constrains shared information.\nWe refer to these subspaces as Whitened Discriminative Subspace (WD) and Whitened Discriminative Residual Subspace (WDR), respectively.\nGiven the compactness of the WD space, we detect anomalies by measuring the distance to the nearest class center.\nConversely, in the WDR space where in-distribution (ID) classes are entangled, we examine the distance to the centroid of all training data as an OOD indicator.\nThe final proposed scoring function unifies the information from both subspaces by computing a weighted sum of the scores in each space. While subspace techniques for OOD detection have been explored previously  , our approach differs significantly. Assuming ID data lies on a low-dimensional manifold, existing approaches measure the residual magnitude as an indicator for OOD-ness 4.\nIn contrast, we assume the residual space captures rich class-shared information.\nFurthermore, while past literature examines the residual to principles  or classifier weights ,\nwe explore the remaining information to discriminative components.\nThis design enables us to jointly reason with both discriminative and residual information without relying on task heads, which is more applicable to stand-alone visual encoders. As shown in Fig. 1, WDiscOOD achieves superior performance on large-scale ImageNet-1k benchmark compared to a wide range of baselines,\nunder both classic CNN and recent Visual Transformer (ViT) architectures.\nIn addition, our method surpasses other feature-space approaches in distinguishing novel concepts from stand-alone contrastive encoders, involving Supervised Contrastive (SupCon) model [ref]27 and Contrastive Language-Image Pre-Training (CLIP) model 6.\nWhat’s more, we discover that the Whitened Discriminative Residual Space is\nmore effective in identifying anomalous responses compared to other subspace techniques or even a subset of classifier-based scoring methods,\nverifying the importance of the class-agnostic feature component for the task. In summary, our contribution involves: A new OOD detection score, based on WLDA, that jointly considers\nclass-discriminative and class-agnostic information solely within the\nfeature space. A new insight into the effectiveness of the Whitened Discriminative Residual Subspace space, which\ncaptures the shared information stripped of discriminative signals, for\ndetecting anomalies in OOD samples. New state-of-the-art results achieved by our method on the\nlarge-scale ImageNet OOD detection benchmark, for various visual\nclassifiers (CNN and ViT) as well as contrastive visual encoders (SupCon\nand CLIP)."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "Towards Open Set Deep Networks",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Abhijit Bendale and Terrance E Boult",
      "orig_title": "Towards open set deep networks",
      "paper_id": "1511.06233v1"
    },
    {
      "index": 1,
      "title": "Kernel null space methods for novelty detection",
      "abstract": "",
      "year": "2013",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Paul Bodesheim, Alexander Freytag, Erik Rodner, Michael Kemmler, and Joachim Denzler"
    },
    {
      "index": 2,
      "title": "A Simple Framework for Contrastive Learning of Visual Representations",
      "abstract": "",
      "year": "2020",
      "venue": "International Conference on Machine Learning",
      "authors": "Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton",
      "orig_title": "A simple framework for contrastive learning of visual representations",
      "paper_id": "2002.05709v3"
    },
    {
      "index": 3,
      "title": "Describing textures in the wild",
      "abstract": "",
      "year": "2014",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Mircea Cimpoi, Subhransu Maji, Iasonas Kokkinos, Sammy Mohamed, and Andrea Vedaldi"
    },
    {
      "index": 4,
      "title": "Outlier Detection through Null Space Analysis of Neural Networks",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2007.01263",
      "authors": "Matthew Cook, Alina Zare, and Paul Gader",
      "orig_title": "Outlier detection through null space analysis of neural networks",
      "paper_id": "2007.01263v1"
    },
    {
      "index": 5,
      "title": "Imagenet: A large-scale hierarchical image database",
      "abstract": "",
      "year": "2009",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei"
    },
    {
      "index": 6,
      "title": "Learning Confidence for Out-of-Distribution Detection in Neural Networks",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv preprint arXiv:1802.04865",
      "authors": "Terrance DeVries and Graham W Taylor",
      "orig_title": "Learning confidence for out-of-distribution detection in neural networks",
      "paper_id": "1802.04865v1"
    },
    {
      "index": 7,
      "title": "Reducing Network Agnostophobia",
      "abstract": "",
      "year": "2018",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Akshay Raj Dhamija, Manuel Günther, and Terrance Boult",
      "orig_title": "Reducing network agnostophobia",
      "paper_id": "1811.04110v2"
    },
    {
      "index": 8,
      "title": "Deep Linear Discriminant Analysis",
      "abstract": "",
      "year": "2015",
      "venue": "arXiv preprint arXiv:1511.04707",
      "authors": "Matthias Dorfer, Rainer Kelz, and Gerhard Widmer",
      "orig_title": "Deep linear discriminant analysis",
      "paper_id": "1511.04707v5"
    },
    {
      "index": 9,
      "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2010.11929",
      "authors": "Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn, Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg Heigold, Sylvain Gelly, et al.",
      "orig_title": "An image is worth 16x16 words: Transformers for image recognition at scale",
      "paper_id": "2010.11929v2"
    },
    {
      "index": 10,
      "title": "VOS: Learning What You Don’t Know by Virtual Outlier Synthesis",
      "abstract": "",
      "year": "2022",
      "venue": "arXiv preprint arXiv:2202.01197",
      "authors": "Xuefeng Du, Zhaoning Wang, Mu Cai, and Yixuan Li",
      "orig_title": "Vos: Learning what you don’t know by virtual outlier synthesis",
      "paper_id": "2202.01197v4"
    },
    {
      "index": 11,
      "title": "An optimal transformation for discriminant and principal component analysis",
      "abstract": "",
      "year": "1988",
      "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence",
      "authors": "J Duchene and S Leclercq"
    },
    {
      "index": 12,
      "title": "An optimal set of discriminant vectors",
      "abstract": "",
      "year": "1975",
      "venue": "IEEE Transactions on computers",
      "authors": "Donald H. Foley and John W Sammon"
    },
    {
      "index": 13,
      "title": "Exploring the Limits of Out-of-Distribution Detection",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Stanislav Fort, Jie Ren, and Balaji Lakshminarayanan",
      "orig_title": "Exploring the limits of out-of-distribution detection",
      "paper_id": "2106.03004v3"
    },
    {
      "index": 14,
      "title": "Generative Adversarial Networks",
      "abstract": "",
      "year": "2020",
      "venue": "Communications of the ACM",
      "authors": "Ian Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio",
      "orig_title": "Generative adversarial networks",
      "paper_id": "2203.00667v1"
    },
    {
      "index": 15,
      "title": "DenseHybrid: Hybrid Anomaly Detection for Dense Open-set Recognition",
      "abstract": "",
      "year": "2022",
      "venue": "European Conference on Computer Vision",
      "authors": "Matej Grcić, Petra Bevandić, and Siniša Šegvić",
      "orig_title": "Densehybrid: Hybrid anomaly detection for dense open-set recognition",
      "paper_id": "2207.02606v1"
    },
    {
      "index": 16,
      "title": "On Calibration of Modern Neural Networks",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Machine Learning",
      "authors": "Chuan Guo, Geoff Pleiss, Yu Sun, and Kilian Q Weinberger",
      "orig_title": "On calibration of modern neural networks",
      "paper_id": "1706.04599v2"
    },
    {
      "index": 17,
      "title": "Discriminative decorrelation for clustering and classification",
      "abstract": "",
      "year": "2012",
      "venue": "Computer Vision–ECCV 2012: 12th European Conference on Computer Vision",
      "authors": "Bharath Hariharan, Jitendra Malik, and Deva Ramanan"
    },
    {
      "index": 18,
      "title": "Deep Residual Learning for Image Recognition",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun",
      "orig_title": "Deep residual learning for image recognition",
      "paper_id": "1512.03385v1"
    },
    {
      "index": 19,
      "title": "Scaling out-of-distribution detection for real-world settings",
      "abstract": "",
      "year": "2022",
      "venue": "International Conference on Machine Learning",
      "authors": "Dan Hendrycks, Steven Basart, Mantas Mazeika, Andy Zou, Joseph Kwon, Mohammadreza Mostajabi, Jacob Steinhardt, and Dawn Song"
    },
    {
      "index": 20,
      "title": "A Baseline for Detecting Misclassified and Out-of-Distribution Examples in Neural Networks",
      "abstract": "",
      "year": "2017",
      "venue": "International Conference on Learning Representations",
      "authors": "Dan Hendrycks and Kevin Gimpel",
      "orig_title": "A baseline for detecting misclassified and out-of-distribution examples in neural networks",
      "paper_id": "1610.02136v3"
    },
    {
      "index": 21,
      "title": "Deep Anomaly Detection with Outlier Exposure",
      "abstract": "",
      "year": "2018",
      "venue": "arXiv preprint arXiv:1812.04606",
      "authors": "Dan Hendrycks, Mantas Mazeika, and Thomas Dietterich",
      "orig_title": "Deep anomaly detection with outlier exposure",
      "paper_id": "1812.04606v3"
    },
    {
      "index": 22,
      "title": "Natural Adversarial Examples",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Dan Hendrycks, Kevin Zhao, Steven Basart, Jacob Steinhardt, and Dawn Song",
      "orig_title": "Natural adversarial examples",
      "paper_id": "1907.07174v4"
    },
    {
      "index": 23,
      "title": "Generalized ODIN: Detecting Out-of-distribution Image without Learning from Out-of-distribution Data",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Yen-Chang Hsu, Yilin Shen, Hongxia Jin, and Zsolt Kira",
      "orig_title": "Generalized odin: Detecting out-of-distribution image without learning from out-of-distribution data",
      "paper_id": "2002.11297v2"
    },
    {
      "index": 24,
      "title": "On the Importance of Gradients for Detecting Distributional Shifts in the Wild",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Rui Huang, Andrew Geng, and Yixuan Li",
      "orig_title": "On the importance of gradients for detecting distributional shifts in the wild",
      "paper_id": "2110.00218v2"
    },
    {
      "index": 25,
      "title": "MOS: Towards Scaling Out-of-distribution Detection for Large Semantic Space",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Rui Huang and Yixuan Li",
      "orig_title": "Mos: Towards scaling out-of-distribution detection for large semantic space",
      "paper_id": "2105.01879v1"
    },
    {
      "index": 26,
      "title": "Supervised Contrastive Learning",
      "abstract": "",
      "year": "2020",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Prannay Khosla, Piotr Teterwak, Chen Wang, Aaron Sarna, Yonglong Tian, Phillip Isola, Aaron Maschinot, Ce Liu, and Dilip Krishnan",
      "orig_title": "Supervised contrastive learning",
      "paper_id": "2004.11362v5"
    },
    {
      "index": 27,
      "title": "Simple and Scalable Predictive Uncertainty Estimation using Deep Ensembles",
      "abstract": "",
      "year": "2017",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Balaji Lakshminarayanan, Alexander Pritzel, and Charles Blundell",
      "orig_title": "Simple and scalable predictive uncertainty estimation using deep ensembles",
      "paper_id": "1612.01474v3"
    },
    {
      "index": 28,
      "title": "Gradients as a measure of uncertainty in neural networks",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE International Conference on Image Processing (ICIP)",
      "authors": "Jinsol Lee and Ghassan AlRegib"
    },
    {
      "index": 29,
      "title": "Training Confidence-calibrated Classifiers for Detecting Out-of-Distribution Samples",
      "abstract": "",
      "year": "2017",
      "venue": "arXiv preprint arXiv:1711.09325",
      "authors": "Kimin Lee, Honglak Lee, Kibok Lee, and Jinwoo Shin",
      "orig_title": "Training confidence-calibrated classifiers for detecting out-of-distribution samples",
      "paper_id": "1711.09325v3"
    },
    {
      "index": 30,
      "title": "A Simple Unified Framework for Detecting Out-of-Distribution Samples and Adversarial Attacks",
      "abstract": "",
      "year": "2018",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Kimin Lee, Kibok Lee, Honglak Lee, and Jinwoo Shin",
      "orig_title": "A simple unified framework for detecting out-of-distribution samples and adversarial attacks",
      "paper_id": "1807.03888v2"
    },
    {
      "index": 31,
      "title": "Enhancing The Reliability of Out-of-distribution Image Detection in Neural Networks",
      "abstract": "",
      "year": "2018",
      "venue": "International Conference on Learning Representations",
      "authors": "Shiyu Liang, Yixuan Li, and R Srikant",
      "orig_title": "Enhancing the reliability of out-of-distribution image detection in neural networks",
      "paper_id": "1706.02690v5"
    },
    {
      "index": 32,
      "title": "Energy-based Out-of-distribution Detection",
      "abstract": "",
      "year": "2020",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Weitang Liu, Xiaoyun Wang, John Owens, and Yixuan Li",
      "orig_title": "Energy-based out-of-distribution detection",
      "paper_id": "2010.03759v4"
    },
    {
      "index": 33,
      "title": "Out-of-distribution detection with subspace techniques and probabilistic modeling of features",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2012.04250",
      "authors": "Ibrahima Ndiour, Nilesh Ahuja, and Omesh Tickoo"
    },
    {
      "index": 34,
      "title": "Whitened lda for face recognition",
      "abstract": "",
      "year": "2007",
      "venue": "ACM international conference on Image and video retrieval",
      "authors": "Vo Dinh Minh Nhat, Sung Young Lee, and Hee Yong Youn"
    },
    {
      "index": 35,
      "title": "Learning Transferable Visual Models From Natural Language Supervision",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Machine Learning",
      "authors": "Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh, Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark, et al.",
      "orig_title": "Learning transferable visual models from natural language supervision",
      "paper_id": "2103.00020v1"
    },
    {
      "index": 36,
      "title": "Prediction Error Meta Classification in Semantic Segmentation: Detection via Aggregated Dispersion Measures of Softmax Probabilities",
      "abstract": "",
      "year": "2020",
      "venue": "International Joint Conference on Neural Networks",
      "authors": "Matthias Rottmann, Pascal Colling, Thomas Paul Hack, Robin Chan, Fabian Hüger, Peter Schlicht, and Hanno Gottschalk",
      "orig_title": "Prediction error meta classification in semantic segmentation: Detection via aggregated dispersion measures of softmax probabilities",
      "paper_id": "1811.00648v2"
    },
    {
      "index": 37,
      "title": "SSD: A Unified Framework for Self-Supervised Outlier Detection",
      "abstract": "",
      "year": "2021",
      "venue": "International Conference on Learning Representations",
      "authors": "Vikash Sehwag, Mung Chiang, and Prateek Mittal",
      "orig_title": "Ssd: A unified framework for self-supervised outlier detection",
      "paper_id": "2103.12051v1"
    },
    {
      "index": 38,
      "title": "CLIPort: What and Where Pathways for Robotic Manipulation",
      "abstract": "",
      "year": "2022",
      "venue": "Conference on Robot Learning",
      "authors": "Mohit Shridhar, Lucas Manuelli, and Dieter Fox",
      "orig_title": "Cliport: What and where pathways for robotic manipulation",
      "paper_id": "2109.12098v1"
    },
    {
      "index": 39,
      "title": "ReAct: Out-of-distribution Detection With Rectified Activations",
      "abstract": "",
      "year": "2021",
      "venue": "Advances in Neural Information Processing Systems",
      "authors": "Yiyou Sun, Chuan Guo, and Yixuan Li",
      "orig_title": "React: Out-of-distribution detection with rectified activations",
      "paper_id": "2111.12797v1"
    },
    {
      "index": 40,
      "title": "Out-of-Distribution Detection with Deep Nearest Neighbors",
      "abstract": "",
      "year": "2022",
      "venue": "International Conference on Machine Learning",
      "authors": "Yiyou Sun, Yifei Ming, Xiaojin Zhu, and Yixuan Li",
      "orig_title": "Out-of-distribution detection with deep nearest neighbors",
      "paper_id": "2204.06507v3"
    },
    {
      "index": 41,
      "title": "No True State-of-the-Art? OOD Detection Methods are Inconsistent across Datasets",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2109.05554",
      "authors": "Fahim Tajwar, Ananya Kumar, Sang Michael Xie, and Percy Liang",
      "orig_title": "No true state-of-the-art? ood detection methods are inconsistent across datasets",
      "paper_id": "2109.05554v1"
    },
    {
      "index": 42,
      "title": "The iNaturalist Species Classification and Detection Dataset",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Grant Van Horn, Oisin Mac Aodha, Yang Song, Yin Cui, Chen Sun, Alex Shepard, Hartwig Adam, Pietro Perona, and Serge Belongie",
      "orig_title": "The inaturalist species classification and detection dataset",
      "paper_id": "1707.06642v2"
    },
    {
      "index": 43,
      "title": "ViM: Out-Of-Distribution with Virtual-logit Matching",
      "abstract": "",
      "year": "2022",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Haoqi Wang, Zhizhong Li, Litong Feng, and Wayne Zhang",
      "orig_title": "Vim: Out-of-distribution with virtual-logit matching",
      "paper_id": "2203.10807v1"
    },
    {
      "index": 44,
      "title": "Sun database: Large-scale scene recognition from abbey to zoo",
      "abstract": "",
      "year": "2010",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Jianxiong Xiao, James Hays, Krista A Ehinger, Aude Oliva, and Antonio Torralba"
    },
    {
      "index": 45,
      "title": "Generalized out-of-distribution detection: A survey",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2110.11334",
      "authors": "Jingkang Yang, Kaiyang Zhou, Yixuan Li, and Ziwei Liu"
    },
    {
      "index": 46,
      "title": "Unsupervised Out-of-Distribution Detection by Maximum Classifier Discrepancy",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE/CVF International Conference on Computer Vision",
      "authors": "Qing Yu and Kiyoharu Aizawa",
      "orig_title": "Unsupervised out-of-distribution detection by maximum classifier discrepancy",
      "paper_id": "1908.04951v1"
    },
    {
      "index": 47,
      "title": "Out-of-distribution detection using union of 1-dimensional subspaces",
      "abstract": "",
      "year": "2021",
      "venue": "IEEE/CVF Conference on Computer Vision and Pattern Recognition",
      "authors": "Alireza Zaeemzadeh, Niccolo Bisagno, Zeno Sambugaro, Nicola Conci, Nazanin Rahnavard, and Mubarak Shah"
    },
    {
      "index": 48,
      "title": "Places: A 10 million image database for scene recognition",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Transactions on Pattern Analysis and Machine Intelligence",
      "authors": "Bolei Zhou, Agata Lapedriza, Aditya Khosla, Aude Oliva, and Antonio Torralba"
    }
  ]
}