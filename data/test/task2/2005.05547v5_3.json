{
  "paper_id": "2005.05547v5",
  "title": "List homomorphism problems for signed trees1footnote 11footnote 1The first author received funding from the European Unionâ€™s Horizon 2020 project H2020-MSCA-RISE-2018: Research and Innovation Staff Exchange and from the Charles University Grant Agency project 1580119. The second author was supported by his NSERC Canada Discovery Grant. The fourth and fifth author were also partially supported by the fourth authorâ€™s NSERC Canada Discovery Grant. The fifth author was also supported by the Charles University Grant Agency project 1198419 and by the Czech Science Foundation (GA-ÄŒR) project 19-17314J.",
  "sections": {
    "basic facts": "We first mention the dichotomy classification of the problems S-Hom(H^)^ğ»(\\widehat{H})\nfrom [ref]8. A subgraph G^^ğº\\widehat{G} of the signed graph H^^ğ»\\widehat{H} is the\ns-core of H^^ğ»\\widehat{H} if there is homomorphism f:H^â†’G^:ğ‘“â†’^ğ»^ğºf:\\widehat{H}\\to\\widehat{G}, and\nevery homomorphism G^â†’G^â†’^ğº^ğº\\widehat{G}\\to\\widehat{G} is a bijection on Vâ€‹(G)ğ‘‰ğºV(G). The letter sğ‘ s stands\nfor signed. It is again easy to see that the sğ‘ s-core is unique up to isomorphism and\nswitching equivalence. [ref]8\nThe problem S-Hom(H^)^ğ»(\\widehat{H}) is polynomial-time solvable\nif the s-core of H^^ğ»\\widehat{H} has at most two edges, and is NP-complete otherwise. When the signature Ï€ğœ‹\\pi has all edges positive, the problem S-Hom(H,Ï€)ğ»ğœ‹(H,\\pi)\nis equivalent to the unsigned graph homomorphism problem, and the s-core of (H,Ï€)ğ»ğœ‹(H,\\pi)\nis just the core of Hğ»H. To compare TheoremÂ 5 with the graph dichotomy\ntheorem ofÂ  as discussed at the beginning SectionÂ 1, we observe that\nthe core of a graph cannot have exactly two edges, as a core must be either a single vertex\n(possibly with a loop), or a single edge, or a graph with at least three edges. Thus Theorem\n5 is stronger than the graph dichotomy theorem fromÂ , which states\nthat the graph homomorphism problem to Hğ»H is polynomial-time solvable if the core of Hğ»H\nhas at most one edge and is NP-complete otherwise. (However, we note that the proof of\nTheoremÂ 5 inÂ [ref]8 uses the graph dichotomy theoremÂ .) Observe that an instance of the problem S-Homâ€‹(H^)S-Hom^ğ»\\textsc{S-Hom}(\\widehat{H}) can be\nalso viewed as an instance of List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) with all\nlists Lâ€‹(v)=Vâ€‹(H)ğ¿ğ‘£ğ‘‰ğ»L(v)=V(H), therefore if S-Homâ€‹(H^)S-Hom^ğ»\\textsc{S-Hom}(\\widehat{H}) is NP-complete,\nthen so is List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}). Moreover, if H^â€²superscript^ğ»â€²\\widehat{H}^{\\prime} is\nan induced subgraph of H^^ğ»\\widehat{H}, then any instance of\nList-S-Homâ€‹(H^â€²)List-S-Homsuperscript^ğ»â€²\\textsc{List-S-Hom}(\\widehat{H}^{\\prime}) can be viewed as an instance of\nList-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) (with the same lists), therefore if the\nproblem List-S-Homâ€‹(H^â€²)List-S-Homsuperscript^ğ»â€²\\textsc{List-S-Hom}(\\widehat{H}^{\\prime}) is NP-complete, then so is the\nproblem List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}). This yields the NP-completeness of\nList-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) for all signed graphs (H^)^ğ»(\\widehat{H}) that\ncontain an induced subgraph H^â€²superscript^ğ»â€²\\widehat{H}^{\\prime} whose s-core has more than two\nedges. Furthermore, when the signed graph H^^ğ»\\widehat{H} is uni-balanced, then we\nmay assume that all edges are at least blue, and the list homomorphism\nproblem for Hğ»H can be reduced to List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}). In particular,\nwe emphasize that List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) is NP-complete if H^^ğ»\\widehat{H}\nis a uni-balanced signed graph (or, by a symmetric argument, an anti-uni-balanced signed\ngraph), and the underlying graph Hğ»H is not a bi-arc graphÂ . Next we focus on the class of signed graphs that have no bicoloured loops and no bicoloured\nedges. In this case, the following simple dichotomy describes the classification. (This result\nwas previously announced inÂ .) It follows from our earlier remarks that these\nsigned graphs are balanced if and only if they are uni-balanced, and similarly they are anti-balanced\nif and only if they are anti-uni-balanced. Suppose H^^ğ»\\widehat{H} is a connected signed graph without bicoloured loops and edges.\nIf the underlying graph Hğ»H is a bi-arc graph, and H^^ğ»\\widehat{H} is balanced or\nanti-balanced, then the problem List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) is polynomial-time\nsolvable. Otherwise, the problem is NP-complete. The polynomial cases follow from Feder et al.Â , by the following argument.\nSuppose H^^ğ»\\widehat{H} is balanced; we may assume all edges are blue. InÂ ,\nthere is a polynomial-time algorithm to decide if the input signed graph G^^ğº\\widehat{G} is\nbalanced. If it is not balanced, there is no homomorphism of G^^ğº\\widehat{G} to H^^ğ»\\widehat{H}.\nOtherwise, we may assume that G^^ğº\\widehat{G} has also all edges blue and hence there is a\nhomomorphism of G^^ğº\\widehat{G} to H^^ğ»\\widehat{H} if and only if there is a homomorphism of GğºG\nto Hğ»H. Since Hğ»H is a bi-arc graph, this can be decided in polynomial time by the algorithm in\n. The argument is similar if H^^ğ»\\widehat{H} is anti-balanced. Otherwise, H^^ğ»\\widehat{H}\ncontains a cycle which cannot be switched to a blue cycle and a cycle which cannot be switched\nto a red cycle, in which case the s-core of H^^ğ»\\widehat{H} contains at least three edges.\n(This is true even if the cycles are just loops.)\n\\qed We have observed that List-S-Hom(H^)^ğ»(\\widehat{H}) is NP-complete if the\ns-core of H^^ğ»\\widehat{H} has more than two edges. Thus we will focus on signed\ngraphs H^^ğ»\\widehat{H} whose s-cores have at most two edges. This is not as simple\nas it sounds, as there are many complex signed graphs with this property, including,\nfor example, all irreflexive bipartite signed graphs that contain a bicoloured edge,\nand all signed graphs that contain a bicoloured loop. That these cases are not easy\nunderlines the fact that the assumptions in TheoremÂ 6 cannot be\nweakened without significant new breakthroughs. Consider, for example, allowing\nbicoloured edges but not bicoloured loops. In this situation, we may focus on the\ncase when there is a bicoloured edge (else TheoremÂ 6 applies),\nand so if there is any loop at all, the s-core would have more than two edges. Thus\nwe consider irreflexive signed graphs. The s-core is still too big if the underlying\ngraph has an odd cycle. So in this case it remains to classify the irreflexive bipartite\nsigned graphs that contain a bicoloured edge. Even this case is complex. We explore\nhomomorphisms to irreflexive bipartite signed graphs in a companion paper. In this paper we focus on List-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) when the underlying\ngraph of H^^ğ»\\widehat{H} is a tree with possible loops. We have treated the special cases\nof reflexive and irreflexive trees inÂ  and in the conference version of this paperÂ ;\nin the general case presented here, the polynomial algorithms are much more involved\nand technical, and the structure of these trees turns out to be surprisingly complex.\nNevertheless, they seem to suggest that nice characterizations may be possible, in\nanalogy to bi-arc trees , see also . We now introduce our basic tool for proving NP-completeness. Let (U,D)ğ‘ˆğ·(U,D) be two walks in H^^ğ»\\widehat{H} of equal length, say Uğ‘ˆU, with\nvertices u=u0,u1,â€¦,uk=vformulae-sequenceğ‘¢subscriptğ‘¢0subscriptğ‘¢1â€¦subscriptğ‘¢ğ‘˜ğ‘£u=u_{0},u_{1},\\ldots,u_{k}=v and Dğ·D, with vertices u=d0,d1,â€¦,dk=vformulae-sequenceğ‘¢subscriptğ‘‘0subscriptğ‘‘1â€¦subscriptğ‘‘ğ‘˜ğ‘£u=d_{0},d_{1},\\ldots,d_{k}=v. We say that (U,D)ğ‘ˆğ·(U,D) is a chain, provided uâ€‹u1,dkâˆ’1â€‹vğ‘¢subscriptğ‘¢1subscriptğ‘‘ğ‘˜1ğ‘£uu_{1},d_{k-1}v are unicoloured edges and uâ€‹d1,ukâˆ’1â€‹vğ‘¢subscriptğ‘‘1subscriptğ‘¢ğ‘˜1ğ‘£ud_{1},u_{k-1}v are bicoloured edges, and\nfor eachÂ iğ‘–i, 1â‰¤iâ‰¤kâˆ’21ğ‘–ğ‘˜21\\leq i\\leq k-2, we have both uiâ€‹ui+1subscriptğ‘¢ğ‘–subscriptğ‘¢ğ‘–1u_{i}u_{i+1} and diâ€‹di+1subscriptğ‘‘ğ‘–subscriptğ‘‘ğ‘–1d_{i}d_{i+1} are edges of H^^ğ»\\widehat{H}\nwhile diâ€‹ui+1subscriptğ‘‘ğ‘–subscriptğ‘¢ğ‘–1d_{i}u_{i+1} is not an edge of H^^ğ»\\widehat{H}, or both uiâ€‹ui+1subscriptğ‘¢ğ‘–subscriptğ‘¢ğ‘–1u_{i}u_{i+1} and diâ€‹di+1subscriptğ‘‘ğ‘–subscriptğ‘‘ğ‘–1d_{i}d_{i+1} are bicoloured edges of H^^ğ»\\widehat{H}\nwhile diâ€‹ui+1subscriptğ‘‘ğ‘–subscriptğ‘¢ğ‘–1d_{i}u_{i+1} is not a bicoloured edge ofÂ H^^ğ»\\widehat{H}. If a signed graph H^^ğ»\\widehat{H} contains a chain, then\nList-S-Homâ€‹(H^)List-S-Hom^ğ»\\textsc{List-S-Hom}(\\widehat{H}) is NP-complete. Suppose that H^^ğ»\\widehat{H} has a chain (U,D)ğ‘ˆğ·(U,D) as specified above. We shall\nreduce from Not-All-Equal SAT. (Each clause has three unnegated\nvariables, and we seek a truth assignment in which at least one variable is\ntrue and at least one is false, in each clause.) For each clause xâˆ¨yâˆ¨zğ‘¥ğ‘¦ğ‘§x\\lor y\\lor z, we take three vertices x,y,zğ‘¥ğ‘¦ğ‘§x,y,z, each with list {u}ğ‘¢\\{u\\}, and three\nvertices xâ€²,yâ€²,zâ€²superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘§â€²x^{\\prime},y^{\\prime},z^{\\prime}, each with list {v}ğ‘£\\{v\\}. For the triple x,y,zğ‘¥ğ‘¦ğ‘§x,y,z, we add\nthree new vertices pâ€‹(x,y)ğ‘ğ‘¥ğ‘¦p(x,y), pâ€‹(y,z)ğ‘ğ‘¦ğ‘§p(y,z), and pâ€‹(z,x)ğ‘ğ‘§ğ‘¥p(z,x), each with list\n{u1,d1}subscriptğ‘¢1subscriptğ‘‘1\\{u_{1},d_{1}\\}, and for the triple xâ€²,yâ€²,zâ€²superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘§â€²x^{\\prime},y^{\\prime},z^{\\prime}, we add three new vertices\npâ€‹(xâ€²,yâ€²),pâ€‹(yâ€²,zâ€²),pâ€‹(zâ€²,xâ€²)ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²ğ‘superscriptğ‘¦â€²superscriptğ‘§â€²ğ‘superscriptğ‘§â€²superscriptğ‘¥â€²p(x^{\\prime},y^{\\prime}),p(y^{\\prime},z^{\\prime}),p(z^{\\prime},x^{\\prime}), each with list {ukâˆ’1,dkâˆ’1}subscriptğ‘¢ğ‘˜1subscriptğ‘‘ğ‘˜1\\{u_{k-1},d_{k-1}\\}. We\nconnect these vertices as follows: pâ€‹(x,y)ğ‘ğ‘¥ğ‘¦p(x,y) adjacent to xğ‘¥x by a red edge and to yğ‘¦y by a blue edge, pâ€‹(y,z)ğ‘ğ‘¦ğ‘§p(y,z) adjacent to yğ‘¦y by a red edge and to zğ‘§z by a blue edge, pâ€‹(z,x)ğ‘ğ‘§ğ‘¥p(z,x) adjacent to zğ‘§z by a red edge and to xğ‘¥x by a blue edge. Analogously, the hexagon xâ€²,pâ€‹(xâ€²,yâ€²),yâ€²,pâ€‹(yâ€²,zâ€²),zâ€²,pâ€‹(zâ€²,xâ€²)superscriptğ‘¥â€²ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘¦â€²ğ‘superscriptğ‘¦â€²superscriptğ‘§â€²superscriptğ‘§â€²ğ‘superscriptğ‘§â€²superscriptğ‘¥â€²x^{\\prime},p(x^{\\prime},y^{\\prime}),y^{\\prime},p(y^{\\prime},z^{\\prime}),z^{\\prime},p(z^{\\prime},x^{\\prime}) will also\nbe alternating in blue and red colours, with (say) pâ€‹(xâ€²,yâ€²)ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²p(x^{\\prime},y^{\\prime}) adjacent to xâ€²superscriptğ‘¥â€²x^{\\prime}\nby a red edge. Moreover, we join each pair of vertices pâ€‹(x,y)ğ‘ğ‘¥ğ‘¦p(x,y) and pâ€‹(xâ€²,yâ€²)ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²p(x^{\\prime},y^{\\prime}) by a separate\npath Pâ€‹(x,y)ğ‘ƒğ‘¥ğ‘¦P(x,y) with kâˆ’1ğ‘˜1k-1 vertices, say pâ€‹(x,y)=a1,a2,â€¦,akâˆ’2,akâˆ’1=pâ€‹(xâ€²,yâ€²)formulae-sequenceğ‘ğ‘¥ğ‘¦subscriptğ‘1subscriptğ‘2â€¦subscriptğ‘ğ‘˜2subscriptğ‘ğ‘˜1ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²p(x,y)=a_{1},a_{2},\\ldots,a_{k-2},a_{k-1}=p(x^{\\prime},y^{\\prime}), where aisubscriptğ‘ğ‘–a_{i} has list {ui,di}subscriptğ‘¢ğ‘–subscriptğ‘‘ğ‘–\\{u_{i},d_{i}\\} and the edge\naiâ€‹ai+1subscriptğ‘ğ‘–subscriptğ‘ğ‘–1a_{i}a_{i+1} is blue unless both uiâ€‹ui+1subscriptğ‘¢ğ‘–subscriptğ‘¢ğ‘–1u_{i}u_{i+1} and diâ€‹di+1subscriptğ‘‘ğ‘–subscriptğ‘‘ğ‘–1d_{i}d_{i+1} are bicoloured,\nin which case aiâ€‹ai+1subscriptğ‘ğ‘–subscriptğ‘ğ‘–1a_{i}a_{i+1} is also bicoloured. Paths Pâ€‹(z,x)ğ‘ƒğ‘§ğ‘¥P(z,x) and Pâ€‹(y,z)ğ‘ƒğ‘¦ğ‘§P(y,z) are\ndefined analogously. See FigureÂ 1 for an illustration. We observe for future reference that the path x,pâ€‹(x,y)=a1,a2,â€¦,akâˆ’2,formulae-sequenceğ‘¥ğ‘ğ‘¥ğ‘¦subscriptğ‘1subscriptğ‘2â€¦subscriptğ‘ğ‘˜2x,p(x,y)=a_{1},a_{2},\\ldots,a_{k-2}, akâˆ’1=pâ€‹(xâ€²,yâ€²),xâ€²subscriptğ‘ğ‘˜1ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘¥â€²a_{k-1}=p(x^{\\prime},y^{\\prime}),x^{\\prime}, when considered by itself, admits a list\nhomomorphism both to Uğ‘ˆU and to Dğ·D. (To see this invoke Zaslavskyâ€™s theorem\ncharacterizing switching equivalent signatures, and use the fact that both\nUğ‘ˆU and Dğ·D contain a bicoloured edge.) Further we note there is no list\nhomomorphism to any other subgraph of UâˆªDğ‘ˆğ·U\\cup D where pâ€‹(x,y)ğ‘ğ‘¥ğ‘¦p(x,y) maps\nto d1subscriptğ‘‘1d_{1} and pâ€‹(xâ€²,yâ€²)ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²p(x^{\\prime},y^{\\prime}) maps to ukâˆ’1subscriptğ‘¢ğ‘˜1u_{k-1}. (This follows from the conditions\nin the definition of chain.) If xğ‘¥x occurs in several clauses, we now have several vertices corresponding\nto xğ‘¥x. We link all these occurrences by a new vertex pâ€‹(x)ğ‘ğ‘¥p(x) with the list {u1}subscriptğ‘¢1\\{u_{1}\\},\nand joined by blue edges to all the occurrences of xğ‘¥x. Since the edge\nuâ€‹u1ğ‘¢subscriptğ‘¢1uu_{1} is unicoloured, this will ensure that all occurrences of the vertex xğ‘¥x are\nswitched or no occurrence of xğ‘¥x is switched. We denote the resulting graph (G,Ïƒ)ğºğœ(G,\\sigma). We now claim that this instance of\nNot-All-Equal SAT is satisfiable if and only if (G,Ïƒ)ğºğœ(G,\\sigma)\nadmits a list homomorphism to (H,Ï€)ğ»ğœ‹(H,\\pi). Let G^â€‹(x,y,z)^ğºğ‘¥ğ‘¦ğ‘§\\widehat{G}(x,y,z) denote the subgraph of (G,Ïƒ)ğºğœ(G,\\sigma) induced by\nPâ€‹(x,y),Pâ€‹(z,x),Pâ€‹(y,z)ğ‘ƒğ‘¥ğ‘¦ğ‘ƒğ‘§ğ‘¥ğ‘ƒğ‘¦ğ‘§P(x,y),P(z,x),P(y,z) and x,y,z,xâ€²,yâ€²,zâ€²ğ‘¥ğ‘¦ğ‘§superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘§â€²x,y,z,x^{\\prime},y^{\\prime},z^{\\prime}. We claim that\n(i)\nany list homomorphism of G^â€‹(x,y,z)^ğºğ‘¥ğ‘¦ğ‘§\\widehat{G}(x,y,z) to UâˆªDğ‘ˆğ·U\\cup D must switch at\neither one or two of the vertices x,y,zğ‘¥ğ‘¦ğ‘§x,y,z, and that \n(ii) there are\nlist homomorphisms of G^â€‹(x,y,z)^ğºğ‘¥ğ‘¦ğ‘§\\widehat{G}(x,y,z) to UâˆªDğ‘ˆğ·U\\cup D that switch at any\none or any two of the vertices x,y,zğ‘¥ğ‘¦ğ‘§x,y,z. Once this claim is proved, we can associate with every truth assignment a list\nhomomorphism of G^â€‹(x,y,z)^ğºğ‘¥ğ‘¦ğ‘§\\widehat{G}(x,y,z) to UâˆªDğ‘ˆğ·U\\cup D where a vertex\ncorresponding to a variable is switched if and only if that variable is true,\nand conversely, setting a variable true if its corresponding vertex was\nswitched in the list homomorphism.\nSince we have ensured that all occurrences of a variable are switched or all\nare not switched, we conclude that all occurrences of a variable take on the\nsame truth value. We now prove (i). Since the lists are so restrictive, any list homomorphism is\nfully described by what happens to the paths Pâ€‹(x,y)ğ‘ƒğ‘¥ğ‘¦P(x,y), Pâ€‹(z,x)ğ‘ƒğ‘§ğ‘¥P(z,x), Pâ€‹(y,z)ğ‘ƒğ‘¦ğ‘§P(y,z),\nand whether or not the vertices corresponding to x,y,zğ‘¥ğ‘¦ğ‘§x,y,z (and xâ€²,yâ€²,zâ€²superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘§â€²x^{\\prime},y^{\\prime},z^{\\prime})\nare switched. Note that Uğ‘ˆU begins with a unicoloured edge and Dğ·D ends with a\nunicoloured edge. If neither xğ‘¥x nor yğ‘¦y or both xğ‘¥x and yğ‘¦y\nare switched, the edges xâ€‹pâ€‹(x,y)ğ‘¥ğ‘ğ‘¥ğ‘¦xp(x,y) and pâ€‹(x,y)â€‹yğ‘ğ‘¥ğ‘¦ğ‘¦p(x,y)y are different colours, and\nin any list homomorphism of G^â€‹(x,y,z)^ğºğ‘¥ğ‘¦ğ‘§\\widehat{G}(x,y,z) to UâˆªDğ‘ˆğ·U\\cup D we must map\nPâ€‹(x,y)ğ‘ƒğ‘¥ğ‘¦P(x,y) to Dğ·D. In particular, xâ€²â€‹pâ€‹(xâ€²,yâ€²)superscriptğ‘¥â€²ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²x^{\\prime}p(x^{\\prime},y^{\\prime}) and pâ€‹(xâ€²,yâ€²)â€‹yâ€²ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘¦â€²p(x^{\\prime},y^{\\prime})y^{\\prime} map to a unicoloured\nedge and must have the same colour. Thus, if none or all of the vertices x,y,zğ‘¥ğ‘¦ğ‘§x,y,z\nwere switched, then the hexagon xâ€²,pâ€‹(xâ€²,yâ€²),yâ€²,pâ€‹(yâ€²,zâ€²),zâ€²,pâ€‹(zâ€²,xâ€²)superscriptğ‘¥â€²ğ‘superscriptğ‘¥â€²superscriptğ‘¦â€²superscriptğ‘¦â€²ğ‘superscriptğ‘¦â€²superscriptğ‘§â€²superscriptğ‘§â€²ğ‘superscriptğ‘§â€²superscriptğ‘¥â€²x^{\\prime},p(x^{\\prime},y^{\\prime}),y^{\\prime},p(y^{\\prime},z^{\\prime}),z^{\\prime},p(z^{\\prime},x^{\\prime}) has an\neven number of red and even number of blue edges, which is impossible. (It\nstarted with an odd number of each.) For (ii), it remains to show that one or two of the vertices x,y,zğ‘¥ğ‘¦ğ‘§x,y,z can be\nswitched under a list homomorphism of G^â€‹(x,y,z)^ğºğ‘¥ğ‘¦ğ‘§\\widehat{G}(x,y,z) to UâˆªDğ‘ˆğ·U\\cup D. Suppose\nfirst that only one was switched; by symmetry assume it was xğ‘¥x (so yğ‘¦y and\nzğ‘§z were not switched). Now edges x,pâ€‹(x,y)ğ‘¥ğ‘ğ‘¥ğ‘¦x,p(x,y) and pâ€‹(x,y),yğ‘ğ‘¥ğ‘¦ğ‘¦p(x,y),y have the same\ncolour, and z,pâ€‹(z,x)ğ‘§ğ‘ğ‘§ğ‘¥z,p(z,x) and pâ€‹(z,x),xğ‘ğ‘§ğ‘¥ğ‘¥p(z,x),x have the same colour. By the above\nobservation, we can map Pâ€‹(x,y)ğ‘ƒğ‘¥ğ‘¦P(x,y) and Pâ€‹(z,x)ğ‘ƒğ‘§ğ‘¥P(z,x) to Uğ‘ˆU, and map Pâ€‹(y,z)ğ‘ƒğ‘¦ğ‘§P(y,z) to Dğ·D.\nNote that the switchings necessary for these list homomorphisms affect\ndisjoint sets of vertices (the paths Pâ€‹(x,y),Pâ€‹(y,z),Pâ€‹(z,x)ğ‘ƒğ‘¥ğ‘¦ğ‘ƒğ‘¦ğ‘§ğ‘ƒğ‘§ğ‘¥P(x,y),P(y,z),P(z,x)), so the\nobservation applies. If two vertices, say yğ‘¦y and zğ‘§z were switched, the\nargument is almost the same and we omit it.\n\\qed"
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "Absolute reflexive retracts and absolute bipartite retracts",
      "abstract": "",
      "year": "1993",
      "venue": "Discrete Applied Mathematics",
      "authors": "H.-J. Bandelt, M. Farber, and P. Hell"
    },
    {
      "index": 1,
      "title": "The complexity of colouring by semicomplete digraphs",
      "abstract": "",
      "year": "1988",
      "venue": "SIAM J. Discrete Math.",
      "authors": "JÃ¸rgen Bang-Jensen, Pavol Hell, and Gary MacGillivray"
    },
    {
      "index": 2,
      "title": "List homomorphism problems for signed graphs",
      "abstract": "",
      "year": "2020",
      "venue": "International Symposium on Mathematical Foundations of Computer Science (MFCS 2020)",
      "authors": "Jan Bok, Richard C. Brewster, TomÃ¡s Feder, Pavol Hell, and Nikola JedliÄkovÃ¡"
    },
    {
      "index": 3,
      "title": "List homomorphisms of signed graphs",
      "abstract": "",
      "year": "2019",
      "venue": "Bordeaux Graph Workshop",
      "authors": "Jan Bok, Richard C. Brewster, Pavol Hell, and Nikola JedliÄkovÃ¡"
    },
    {
      "index": 4,
      "title": "Vertex colourings of edge-coloured graphs",
      "abstract": "",
      "year": "1993",
      "venue": "ProQuest LLC",
      "authors": "Richard C. Brewster"
    },
    {
      "index": 5,
      "title": "The complexity of signed graph and edge-coloured graph homomorphisms",
      "abstract": "",
      "year": "2017",
      "venue": "Discrete Mathematics",
      "authors": "Richard C. Brewster, Florent Foucaud, Pavol Hell, and Reza Naserasr",
      "orig_title": "The complexity of signed graph and edge-coloured graph homomorphisms",
      "paper_id": "1510.05502v2"
    },
    {
      "index": 6,
      "title": "Edge-switching homomorphisms of edge-coloured graphs",
      "abstract": "",
      "year": "2009",
      "venue": "Discrete Math.",
      "authors": "Richard C. Brewster and Timothy Graves"
    },
    {
      "index": 7,
      "title": "A complexity dichotomy for signed hâ„h-colouring",
      "abstract": "",
      "year": "2018",
      "venue": "Discrete Mathematics",
      "authors": "Richard C. Brewster and Mark Siggers"
    },
    {
      "index": 8,
      "title": "A dichotomy theorem for nonuniform CSPs",
      "abstract": "",
      "year": "2017",
      "venue": "Annual IEEE Symposium on Foundations of Computer Scienceâ€”FOCS 2017",
      "authors": "Andrei A. Bulatov",
      "orig_title": "A dichotomy theorem for nonuniform CSPs",
      "paper_id": "1703.03021v2"
    },
    {
      "index": 9,
      "title": "List homomorphisms to reflexive graphs",
      "abstract": "",
      "year": "1998",
      "venue": "Journal of Combinatorial Theory, Series B",
      "authors": "TomÃ¡s Feder and Pavol Hell"
    },
    {
      "index": 10,
      "title": "List homomorphisms and circular arc graphs",
      "abstract": "",
      "year": "1999",
      "venue": "Combinatorica",
      "authors": "TomÃ¡s Feder, Pavol Hell, and Jing Huang"
    },
    {
      "index": 11,
      "title": "Bi-arc graphs and the complexity of list homomorphisms",
      "abstract": "",
      "year": "2003",
      "venue": "Journal of Graph Theory",
      "authors": "TomÃ¡s Feder, Pavol Hell, and Jing Huang"
    },
    {
      "index": 12,
      "title": "The structure of bi-arc trees",
      "abstract": "",
      "year": "2007",
      "venue": "Discrete Mathematics",
      "authors": "TomÃ¡s Feder, Pavol Hell, and Jing Huang"
    },
    {
      "index": 13,
      "title": "Retractions to pseudoforests",
      "abstract": "",
      "year": "2010",
      "venue": "SIAM J. Discrete Math.",
      "authors": "TomÃ¡s Feder, Pavol Hell, Peter Johnsson, Andrei Krokhin, and Gustav Nordh"
    },
    {
      "index": 14,
      "title": "The computational structure of monotone monadic SNP and constraint satisfaction: a study through Datalog and group theory",
      "abstract": "",
      "year": "1993",
      "venue": "STOC",
      "authors": "TomÃ¡s Feder and Moshe Y. Vardi"
    },
    {
      "index": 15,
      "title": "The complexity of homomorphisms of signed graphs and signed constraint satisfaction",
      "abstract": "",
      "year": "2014",
      "venue": "Latin American Symposium on Theoretical Informatics",
      "authors": "Florent Foucaud and Reza Naserasr"
    },
    {
      "index": 16,
      "title": "Packing odd circuit covers: A conjecture",
      "abstract": "",
      "year": "2005",
      "venue": "Manuscript",
      "authors": "Bertrand Guenin"
    },
    {
      "index": 17,
      "title": "On the notion of balance of a signed graph",
      "abstract": "",
      "year": "1953",
      "venue": "Michigan Math. J.",
      "authors": "Frank Harary"
    },
    {
      "index": 18,
      "title": "A simple algorithm to detect balance in signed graphs",
      "abstract": "",
      "year": "1980",
      "venue": "Math. Social Sci.",
      "authors": "Frank Harary and Jerald A. Kabell"
    },
    {
      "index": 19,
      "title": "On the complexity of Hğ»H-coloring",
      "abstract": "",
      "year": "1990",
      "venue": "J. Combin. Theory Ser. B",
      "authors": "Pavol Hell and Jaroslav NeÅ¡etÅ™il"
    },
    {
      "index": 20,
      "title": "Graphs and homomorphisms, volume 28 of Oxford Lecture Series in Mathematics and its Applications",
      "abstract": "",
      "year": "2004",
      "venue": "Oxford University Press",
      "authors": "Pavol Hell and Jaroslav NeÅ¡etÅ™il"
    },
    {
      "index": 21,
      "title": "On the algebraic structure of combinatorial problems",
      "abstract": "",
      "year": "1998",
      "venue": "Theoret. Comput. Sci.",
      "authors": "Peter Jeavons"
    },
    {
      "index": 22,
      "title": "Towards a dichotomy for the switch list homomorphism problem for signed graphs",
      "abstract": "",
      "year": "2021",
      "venue": "Manuscript",
      "authors": "Hyobin Kim and Mark Siggers"
    },
    {
      "index": 23,
      "title": "Homomorphisms of signed graphs",
      "abstract": "",
      "year": "2015",
      "venue": "J. Graph Theory",
      "authors": "Reza Naserasr, Edita RollovÃ¡, and Ã‰ric Sopena"
    },
    {
      "index": 24,
      "title": "Homomorphisms of signed graphs: An update, 2019",
      "abstract": "",
      "year": "2019",
      "venue": "arXiv",
      "authors": "Reza Naserasr, Ã‰ric Sopena, and Thomas Zaslavsky"
    },
    {
      "index": 25,
      "title": "Characterizations of signed graphs",
      "abstract": "",
      "year": "1981",
      "venue": "J. Graph Theory",
      "authors": "Thomas Zaslavsky"
    },
    {
      "index": 26,
      "title": "Signed graph coloring",
      "abstract": "",
      "year": "1982",
      "venue": "Discrete Math.",
      "authors": "Thomas Zaslavsky"
    },
    {
      "index": 27,
      "title": "Signed graphs",
      "abstract": "",
      "year": "1982",
      "venue": "Discrete Appl. Math.",
      "authors": "Thomas Zaslavsky"
    },
    {
      "index": 28,
      "title": "Is there a matroid theory of signed graph embedding?",
      "abstract": "",
      "year": "1997",
      "venue": "Ars Combin.",
      "authors": "Thomas Zaslavsky"
    },
    {
      "index": 29,
      "title": "A mathematical bibliography of signed and gain graphs and allied areas",
      "abstract": "",
      "year": "1998",
      "venue": "Electron. J. Combin.",
      "authors": "Thomas Zaslavsky"
    },
    {
      "index": 30,
      "title": "A proof of CSP dichotomy conjecture",
      "abstract": "",
      "year": "2017",
      "venue": "Annual IEEE Symposium on Foundations of Computer Scienceâ€”FOCS 2017",
      "authors": "Dmitriy Zhuk"
    }
  ]
}