{
  "paper_id": "2012.05457v2",
  "title": "Neural-Swarm2: Planning and Control of Heterogeneous Multirotor Swarms using Learned Interactions",
  "sections": {
    "i introduction": "The ongoing commoditization of unmanned aerial vehicles (UAVs) requires robots to fly in much closer proximity to each other than before, which necessitates advanced planning and control methods for large aerial swarms  .\nFor example, consider a search-and-rescue mission where an aerial swarm must enter and search a collapsed building.\nIn such scenarios, close-proximity flight enables the swarm to navigate the building much faster compared to swarms that must maintain large distances from each other.\nOther important applications of close-proximity flight include manipulation, search, surveillance, and mapping.\nIn many scenarios, heterogeneous teams with robots of different sizes and sensing or manipulation capabilities are beneficial due to their significantly higher adaptability. For example, in a search-and-rescue mission, larger UAVs can be used for manipulation tasks or to transport goods, while smaller ones are more suited for exploration and navigation. A major challenge of close-proximity control and planning is that small distances between UAVs create complex aerodynamic interactions.\nFor instance, one multirotor flying above another causes the so-called downwash effect on the lower one, which is difficult to model using conventional model-based approaches .\nWithout accurate downwash interaction modeling, a large safety distance between vehicles is necessary, thereby preventing a compact 3-D formation shape, e.g., 60 cmtimes60cm60\\text{\\,}\\mathrm{c}\\mathrm{m} for the small Crazyflie 2.0 quadrotor (9 cmtimes9cm9\\text{\\,}\\mathrm{c}\\mathrm{m} rotor-to-rotor) [ref]4. Moreover, the downwash is sometimes avoided by restricting the relative position between robots in the 2-D horizontal plane .\nFor heterogeneous teams, even larger and asymmetric safety distances are required .\nHowever, the downwash for two small Crazyflie quadrotors hovering 30 cmtimes30cm30\\text{\\,}\\mathrm{c}\\mathrm{m} on top of each other is only 9 gtimes9g9\\text{\\,}\\mathrm{g}, which is well within their thrust capabilities, and suggests that proper modeling of downwash and other interaction effects can lead to more precise motion planning and dense formation control. In this paper, we present a learning-based approach, Neural-Swarm2, which enhances the precision, safety, and density of close-proximity motion planning and control of heterogeneous multirotor swarms.\nIn the example shown in Fig. 1, we safely operate the same drones with vertical distances less than half of those of prior work [ref]4.\nIn particular, we train deep neural networks (DNNs) to predict the residual interaction forces that are not captured by the nominal models of free-space aerodynamics. To the best of our knowledge, this is the first model for aerodynamic interactions between two or more multirotors in flight.\nOur DNN architecture supports heterogeneous inputs in a permutation-invariant manner without reducing the expressiveness.\nThe DNN only requires relative positions and velocities of neighboring multirotors as inputs, similar to the existing collision-avoidance techniques [ref]7, which enables fully-decentralized computation.\nWe use the predicted interaction forces to augment the nominal dynamics and derive novel methods to directly consider them during motion planning and as part of the multirotors’ controller. From a learning perspective, we leverage and extend two state-of-the-art tools to derive effective DNN models.\nFirst, we extend deep sets [ref]8 to the heterogeneous case and prove its representation power.\nOur novel encoding is used to model interactions between heterogeneous vehicle types in an index-free or permutation-invariant manner, enabling better generalization to new formations and a varying number of vehicles.\nThe second is spectral normalization , which ensures the DNN is Lipschitz continuous and helps the DNN generalize well on test examples that lie outside the training set.\nWe demonstrate that the interaction forces can be computationally efficiently and accurately learned such that a small 32-bit microcontroller can predict such forces in real-time. From a planning and control perspective, we derive novel methods that directly consider the predicted interaction forces.\nFor motion planning, we use a two-stage approach. In the first stage, we extend an existing kinodynamic sampling-based planner for a single robot to the interaction-aware multi-robot case.\nIn the second stage, we adopt an optimization-based planner to refine the solutions of the first stage.\nEmpirically, we demonstrate that our interaction-aware motion planner both avoids dangerous robot configurations that would saturate the multirotors’ motors and reduces the tracking error significantly.\nFor the nonlinear control we leverage the Lipschitz continuity of our learned interaction forces to derive stability guarantees similar to our prior work 0 1.\nThe controller can be used to reduce the tracking error of arbitrary desired trajectories, including ones that were not planned with an interaction-aware planner. We validate our approach using two to sixteen quadrotors of two different sizes, and we also integrate ground effect and other unmodeled dynamics into our model, by viewing the physical environment as a special robot.\nTo our knowledge, our approach is the first that models interactions between two or more multirotor vehicles and demonstrates how to use such a model effectively and efficiently for motion planning and control of aerial teams."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "A Survey on Aerial Swarm Robotics",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Trans. Robot.",
      "authors": "Soon-Jo Chung, Aditya A. Paranjape, Philip M. Dames, Shaojie Shen and Vijay Kumar"
    },
    {
      "index": 1,
      "title": "Swarm assignment and trajectory optimization using variable-swarm, distributed auction assignment and sequential convex programming",
      "abstract": "",
      "year": "2016",
      "venue": "I. J. Robotics Res.",
      "authors": "Daniel Morgan, Giri Prashanth Subramanian, Soon-Jo Chung and Fred Y. Hadaegh"
    },
    {
      "index": 2,
      "title": "Modeling of aerodynamic disturbances for proximity flight of multirotors",
      "abstract": "",
      "year": "2019",
      "venue": "Int. Conf. Unmanned Aircraft Syst.",
      "authors": "K.. Jain, T. Fortmuller, J. Byun, S.. Mäkiharju and M.. Mueller"
    },
    {
      "index": 3,
      "title": "Trajectory Planning for Quadrotor Swarms",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Trans. Robot.",
      "authors": "Wolfgang Hönig, James A. Preiss, T.. Kumar, Gaurav S. Sukhatme and Nora Ayanian"
    },
    {
      "index": 4,
      "title": "Fast and In Sync: Periodic Swarm Patterns for Quadrotors",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Xintong Du, Carlos E. Luis, Marijan Vukosavljev and Angela P. Schoellig",
      "orig_title": "Fast and In Sync: Periodic Swarm Patterns for Quadrotors",
      "paper_id": "1810.03572v2"
    },
    {
      "index": 5,
      "title": "Trajectory Planning for Heterogeneous Robot Teams",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE/RSJ Int. Conf. Intell. Robots Syst.",
      "authors": "Mark Debord, Wolfgang Hönig and Nora Ayanian"
    },
    {
      "index": 6,
      "title": "Reciprocal n-Body Collision Avoidance",
      "abstract": "",
      "year": "2009",
      "venue": "Int. Symp. on Robot. Res.",
      "authors": "Jur Berg, Stephen J. Guy, Ming C. Lin and Dinesh Manocha"
    },
    {
      "index": 7,
      "title": "Deep Sets",
      "abstract": "",
      "year": "2017",
      "venue": "Neural Inf. Process. Syst.",
      "authors": "Manzil Zaheer, Satwik Kottur, Siamak Ravanbakhsh, Barnabás Póczos, Ruslan Salakhutdinov and Alexander J. Smola",
      "orig_title": "Deep Sets",
      "paper_id": "1703.06114v3"
    },
    {
      "index": 8,
      "title": "Spectrally-normalized margin bounds for neural networks",
      "abstract": "",
      "year": "2017",
      "venue": "Neural Inf. Process. Syst.",
      "authors": "Peter L. Bartlett, Dylan J. Foster and Matus Telgarsky",
      "orig_title": "Spectrally-normalized margin bounds for neural networks",
      "paper_id": "1706.08498v2"
    },
    {
      "index": 9,
      "title": "Neural Lander: Stable Drone Landing Control Using Learned Dynamics",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Guanya Shi, Xichen Shi, Michael O’Connell, Rose Yu, Kamyar Azizzadenesheli, Animashree Anandkumar, Yisong Yue and Soon-Jo Chung",
      "orig_title": "Neural Lander: Stable Drone Landing Control Using Learned Dynamics",
      "paper_id": "1811.08027v2"
    },
    {
      "index": 10,
      "title": "Neural-Swarm: Decentralized Close-Proximity Multirotor Control Using Learned Interactions",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Guanya Shi, Wolfgang Hönig, Yisong Yue and Soon-Jo Chung",
      "orig_title": "Neural-Swarm: Decentralized Close-Proximity Multirotor Control Using Learned Interactions",
      "paper_id": "2003.02992v1"
    },
    {
      "index": 11,
      "title": "The effect of ground on a helicopter rotor in forward flight",
      "abstract": "",
      "year": "1955",
      "venue": "Aeronautical Research Council Reports And Memoranda",
      "authors": "IC Cheeseman and WE Bennett"
    },
    {
      "index": 12,
      "title": "An Empirical Model of Rotorcrafy UAV Downwash for Disturbance Localization and Avoidance",
      "abstract": "",
      "year": "2015",
      "venue": "AIAA Atmospheric Flight Mechanics Conf.",
      "authors": "Derrick Yeo, Elena Shrestha, Derek A. Paley and Ella M. Atkins"
    },
    {
      "index": 13,
      "title": "Analysis of Ground Effect for Small-Scale UAVs in Forward Flight",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "X. Kan, J. Thomas, H. Teng, H.. Tanner, V. Kumar and K. Karydis"
    },
    {
      "index": 14,
      "title": "Multirotor Drone Aerodynamic Interaction Investigation",
      "abstract": "",
      "year": "2018",
      "venue": "Drones",
      "authors": "Dhwanil Shukla and Narayanan Komerath"
    },
    {
      "index": 15,
      "title": "Meta-Learning-Based Robust Adaptive Flight Control Under Uncertain Wind Conditions",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2103.01932",
      "authors": "Michael O’Connell, Guanya Shi, Xichen Shi and Soon-Jo Chung",
      "orig_title": "Meta-learning-based robust adaptive flight control under uncertain wind conditions",
      "paper_id": "2103.01932v3"
    },
    {
      "index": 16,
      "title": "Smooth Imitation Learning for Online Sequence Prediction",
      "abstract": "",
      "year": "2016",
      "venue": "Int. Conf. Machine Learning",
      "authors": "Hoang Minh Le, Andrew Kang, Yisong Yue and Peter Carr",
      "orig_title": "Smooth Imitation Learning for Online Sequence Prediction",
      "paper_id": "1606.00968v1"
    },
    {
      "index": 17,
      "title": "Episodic Learning with Control Lyapunov Functions for Uncertain Robotic Systems*",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE/RSJ Int. Conf. Intell. Robots Syst.",
      "authors": "Andrew J. Taylor, Victor D. Dorobantu, Hoang M. Le, Yisong Yue and Aaron D. Ames",
      "orig_title": "Episodic Learning with Control Lyapunov Functions for Uncertain Robotic Systems",
      "paper_id": "1903.01577v1"
    },
    {
      "index": 18,
      "title": "Control Regularization for Reduced Variance Reinforcement Learning",
      "abstract": "",
      "year": "2019",
      "venue": "Int. Conf. Machine Learning",
      "authors": "Richard Cheng, Abhinav Verma, Gábor Orosz, Swarat Chaudhuri, Yisong Yue and Joel Burdick",
      "orig_title": "Control Regularization for Reduced Variance Reinforcement Learning",
      "paper_id": "1905.05380v1"
    },
    {
      "index": 19,
      "title": "Learn Fast, Forget Slow: Safe Predictive Learning Control for Systems with Unknown and Changing Dynamics Performing Repetitive Tasks",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Christopher D. McKinnon and Angela P. Schoellig",
      "orig_title": "Learn Fast, Forget Slow: Safe Predictive Learning Control for Systems With Unknown and Changing Dynamics Performing Repetitive Tasks",
      "paper_id": "1810.06681v3"
    },
    {
      "index": 20,
      "title": "Data-efficient control policy search using residual dynamics learning",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE/RSJ Int. Conf. Intell. Robots Syst.",
      "authors": "Matteo Saveriano, Yuchao Yin, Pietro Falco and Dongheui Lee"
    },
    {
      "index": 21,
      "title": "Residual Reinforcement Learning for Robot Control",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Tobias Johannink, Shikhar Bahl, Ashvin Nair, Jianlan Luo, Avinash Kumar, Matthias Loskyll, Juan Aparicio Ojea, Eugen Solowjow and Sergey Levine",
      "orig_title": "Residual Reinforcement Learning for Robot Control",
      "paper_id": "1812.03201v2"
    },
    {
      "index": 22,
      "title": "The graph neural network model",
      "abstract": "",
      "year": "2008",
      "venue": "IEEE Trans. Neural Netw.",
      "authors": "Franco Scarselli, Marco Gori, Ah Chung Tsoi, Markus Hagenbuchner and Gabriele Monfardini"
    },
    {
      "index": 23,
      "title": "Learning Decentralized Controllers for Robot Swarms with Graph Neural Networks",
      "abstract": "",
      "year": "2020",
      "venue": "Conf. Robot Learning",
      "authors": "Ekaterina Tolstaya, Fernando Gama, James Paulos, George Pappas, Vijay Kumar and Alejandro Ribeiro",
      "orig_title": "Learning decentralized controllers for robot swarms with graph neural networks",
      "paper_id": "1903.10527v4"
    },
    {
      "index": 24,
      "title": "Heterogeneous graph neural network",
      "abstract": "",
      "year": "2019",
      "venue": "ACM SIGKDD Int. Conf. Knowledge Discovery & Data Mining",
      "authors": "Chuxu Zhang, Dongjin Song, Chao Huang, Ananthram Swami and Nitesh V Chawla"
    },
    {
      "index": 25,
      "title": "GLAS: Global-to-Local Safe Autonomy Synthesis for Multi-Robot Motion Planning with End-to-End Learning",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Benjamin Rivière, Wolfgang Hönig, Yisong Yue and Soon-Jo Chung",
      "orig_title": "GLAS: Global-to-Local Safe Autonomy Synthesis for Multi-Robot Motion Planning With End-to-End Learning",
      "paper_id": "2002.11807v3"
    },
    {
      "index": 26,
      "title": "Model predictive control of swarms of spacecraft using sequential convex programming",
      "abstract": "",
      "year": "2014",
      "venue": "J. Guid., Control, Dyn.",
      "authors": "Daniel Morgan, Soon-Jo Chung and Fred Y Hadaegh"
    },
    {
      "index": 27,
      "title": "Mixed-integer quadratic program trajectory generation for heterogeneous quadrotor teams",
      "abstract": "",
      "year": "2012",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Daniel Mellinger, Aleksandr Kushleyev and Vijay Kumar"
    },
    {
      "index": 28,
      "title": "Approximation with artificial neural networks",
      "abstract": "",
      "year": "2001",
      "venue": "Faculty of Sciences, Etvs Lornd University, Hungary",
      "authors": "Balázs Csanád Csáji"
    },
    {
      "index": 29,
      "title": "Robust regression for safe exploration in control",
      "abstract": "",
      "year": "2020",
      "venue": "Learning for Dynamics and Control",
      "authors": "Anqi Liu, Guanya Shi, Soon-Jo Chung, Anima Anandkumar and Yisong Yue"
    },
    {
      "index": 30,
      "title": "Trajectory Generation for Multiagent Point-To-Point Transitions via Distributed Model Predictive Control",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Carlos E. Luis and Angela P. Schoellig",
      "orig_title": "Trajectory Generation for Multiagent Point-To-Point Transitions via Distributed Model Predictive Control",
      "paper_id": "1809.04230v2"
    },
    {
      "index": 31,
      "title": "Prioritized Planning Algorithms for Trajectory Coordination of Multiple Mobile Robots",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE Trans. Autom. Sci. Eng.",
      "authors": "Michal Čáp, Peter Novák, Alexander Kleiner and Martin Selecký",
      "orig_title": "Prioritized Planning Algorithms for Trajectory Coordination of Multiple Mobile Robots",
      "paper_id": "1409.2399v1"
    },
    {
      "index": 32,
      "title": "Optimal Guidance and Control with Nonlinear Dynamics Using Sequential Convex Programming",
      "abstract": "",
      "year": "2020",
      "venue": "J. Guid., Control, Dyn.",
      "authors": "Rebecca Foust, Soon-Jo Chung and Fred Y. Hadaegh"
    },
    {
      "index": 33,
      "title": "Local Convergence of Sequential Convex Programming for Nonconvex Optimization",
      "abstract": "",
      "year": "2010",
      "venue": "Recent Advances in Optimization and Its Applications in Engineering",
      "authors": "Quoc Tran Dinh and Moritz Diehl"
    },
    {
      "index": 34,
      "title": "Asymptotically Optimal Planning by Feasible Kinodynamic Planning in State-Cost Space",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Trans. Robotics",
      "authors": "Kris Hauser and Yilun Zhou",
      "orig_title": "Asymptotically Optimal Planning by Feasible Kinodynamic Planning in a State-Cost Space",
      "paper_id": "1505.04098v1"
    },
    {
      "index": 35,
      "title": "Multidimensional Binary Search Trees Used for Associative Searching",
      "abstract": "",
      "year": "1975",
      "venue": "Commun. ACM",
      "authors": "Jon Louis Bentley"
    },
    {
      "index": 36,
      "title": "Kinodynamic RRTs with Fixed Time Step and Best-Input Extension Are Not Probabilistically Complete",
      "abstract": "",
      "year": "2015",
      "venue": "Int. Workshop Algorithmic Foundations of Robotics",
      "authors": "Tobias Kunz and Mike Stilman"
    },
    {
      "index": 37,
      "title": "Sampling-Based Algorithms for Optimal Motion Planning",
      "abstract": "",
      "year": "2011",
      "venue": "I. J. Robotics Res.",
      "authors": "Sertac Karaman and Emilio Frazzoli"
    },
    {
      "index": 38,
      "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "abstract": "",
      "year": "2019",
      "venue": "Neural Inf. Process. Syst.",
      "authors": "Adam Paszke et al.",
      "orig_title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "paper_id": "1912.01703v1"
    },
    {
      "index": 39,
      "title": "Chance-Constrained Trajectory Optimization for Safe Exploration and Learning of Nonlinear Systems",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Robotics and Automation Letters",
      "authors": "Yashwanth Kumar Nakka, Anqi Liu, Guanya Shi, Anima Anandkumar, Yisong Yue and Soon-Jo Chung",
      "orig_title": "Chance-constrained trajectory optimization for safe exploration and learning of nonlinear systems",
      "paper_id": "2005.04374v3"
    },
    {
      "index": 40,
      "title": "Nonlinear attitude control of spacecraft with a large captured object",
      "abstract": "",
      "year": "2016",
      "venue": "J. Guid., Control, Dyn.",
      "authors": "Saptarshi Bandyopadhyay, Soon-Jo Chung and Fred Y Hadaegh"
    },
    {
      "index": 41,
      "title": "Nonlinear control of autonomous flying cars with wings and distributed electric propulsion",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Conf. Decis. Control",
      "authors": "Xichen Shi, Kyunam Kim, Salar Rahili and Soon-Jo Chung"
    },
    {
      "index": 42,
      "title": "Numerical Predictive Control for Delay Compensation",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2009.14450",
      "authors": "Xichen Shi, Michael O’Connell and Soon-Jo Chung",
      "orig_title": "Numerical Predictive Control for Delay Compensation",
      "paper_id": "2009.14450v1"
    },
    {
      "index": 43,
      "title": "Crazyswarm: A large nano-quadcopter swarm",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "James A. Preiss, Wolfgang Hönig, Gaurav S. Sukhatme and Nora Ayanian"
    },
    {
      "index": 44,
      "title": "Crazyflie 2.0 Thrust Investigation",
      "abstract": "",
      "year": "2015",
      "venue": "",
      "authors": "Bitcraze"
    },
    {
      "index": 45,
      "title": "System Identification of the Crazyflie 2.0 Nano Quadrocopter",
      "abstract": "",
      "year": "2015",
      "venue": "ETH Zurich",
      "authors": "Julian Förster"
    },
    {
      "index": 46,
      "title": "Thrust Mixing, Saturation, and Body-Rate Control for Accurate Aggressive Quadrotor Flight",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Matthias Faessler, Davide Falanga and Davide Scaramuzza"
    },
    {
      "index": 47,
      "title": "Real-time obstacle avoidance for manipulators and mobile robots",
      "abstract": "",
      "year": "1985",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Oussama Khatib"
    },
    {
      "index": 48,
      "title": "CVXPY: A Python-embedded modeling language for convex optimization",
      "abstract": "",
      "year": "2016",
      "venue": "J. Machine Learning Research",
      "authors": "Steven Diamond and Stephen Boyd"
    },
    {
      "index": 49,
      "title": "Gurobi Optimizer Reference Manual",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "LLC Gurobi Optimization"
    }
  ]
}