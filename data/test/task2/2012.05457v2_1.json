{
  "paper_id": "2012.05457v2",
  "title": "Neural-Swarm2: Planning and Control of Heterogeneous Multirotor Swarms using Learned Interactions",
  "sections": {
    "ii related work": "The aerodynamic interaction force applied to a single UAV flying near the ground (ground effect), has been modeled analytically   .\nIn many cases, the ground effect is not considered in typical multirotor controllers and thus increases the tracking error of a multirotor when operating close to the ground.\nHowever, it is possible to use ground effect prediction in real-time to reduce the tracking error  [ref]10. The interaction between two rotor blades of a single multirotor has been studied in a lab setting to optimize the placement of rotors on the vehicle [ref]15.\nHowever, it remains an open question how this influences the flight of two or more multirotors in close proximity.\nInteractions between two multirotors can be estimated using a propeller velocity field model .\nUnfortunately, this method is hard to generalize to the multi-robot or heterogeneous case and it only considers the stationary case, which is inaccurate for real flights. The use of DNNs to learn higher-order residual dynamics or control actions is gaining attention in the areas of control and reinforcement learning settings [ref]10       .\nFor swarms, a common encoding approach is to discretize the whole space and employ convolutional neural networks (CNNs), which yields a permutation-invariant encoding. Another common encoding for robot swarms is a Graphic Neural Network (GNN)  . GNNs have been extended to heterogeneous graphs , but it remains an open research question how such a structure would apply to heterogeneous robot teams.\nWe extend a different architecture, which is less frequently used in robotics applications, called deep sets .\nDeep sets enable distributed computation without communication requirements.\nCompared to CNNs, our approach: i) requires less training data and computation; ii) is not restricted to a pre-determined resolution and input domain; and iii) directly supports the heterogeneous swarm.\nCompared to GNNs, we do not require any direct communication between robots.\nDeep sets have been used in robotics for homogeneous  and heterogeneous  teams.\nCompared to the latter , our heterogeneous deep set extension has a more compact encoding and we prove its representation power. For motion planning, empirical models have been used to avoid harmful interactions  7 [ref]4  8.\nTypical safe boundaries along multi-vehicle motions form ellipsoids [ref]4 or cylinders  along the motion trajectories.\nEstimating such shapes experimentally would potentially lead to many collisions and dangerous flight tests and those collision-free regions are in general conservative.\nIn contrast, we use deep learning to estimate the interaction forces accurately in heterogeneous multi-robot teams.\nThis model allows us to directly control the magnitude of the interaction forces to accurately and explicitly control the risk, removing the necessity of conservative collision shapes. We generalize and extend the results of our prior work  as follows. i) We derive heterogeneous deep sets to extend to the heterogeneous case and prove its expressiveness, which also unifies the approach with respect to single-agent residual dynamics learning (e.g., learning the ground effect for improved multirotor landing [ref]10) by regarding the environment as a special neighbor. ii) We present a novel two-stage method to use the learned interaction forces for multi-robot motion planning. iii) We explicitly compensate for the delay in motor speed commands in our position and attitude controllers, resulting in stronger experimental results for both our baseline and Neural-Swarm2. iv) Leveraging i)-iii), this paper presents a result of close-proximity flight with minimum vertical distance 24 cmtimes24cm24\\text{\\,}\\mathrm{c}\\mathrm{m} (the prior work [ref]4 requires at least 60 cmtimes60cm60\\text{\\,}\\mathrm{c}\\mathrm{m} as the safe distance) of a 16-robot heterogeneous team in challenging tasks (e.g., the 3-ring task in Fig. 1(b,c)). Our prior work  only demonstrated 5-robot flights in relatively simple tasks."
  },
  "reference_labels": [
    {
      "index": 0,
      "title": "A Survey on Aerial Swarm Robotics",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Trans. Robot.",
      "authors": "Soon-Jo Chung, Aditya A. Paranjape, Philip M. Dames, Shaojie Shen and Vijay Kumar"
    },
    {
      "index": 1,
      "title": "Swarm assignment and trajectory optimization using variable-swarm, distributed auction assignment and sequential convex programming",
      "abstract": "",
      "year": "2016",
      "venue": "I. J. Robotics Res.",
      "authors": "Daniel Morgan, Giri Prashanth Subramanian, Soon-Jo Chung and Fred Y. Hadaegh"
    },
    {
      "index": 2,
      "title": "Modeling of aerodynamic disturbances for proximity flight of multirotors",
      "abstract": "",
      "year": "2019",
      "venue": "Int. Conf. Unmanned Aircraft Syst.",
      "authors": "K.. Jain, T. Fortmuller, J. Byun, S.. Mäkiharju and M.. Mueller"
    },
    {
      "index": 3,
      "title": "Trajectory Planning for Quadrotor Swarms",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Trans. Robot.",
      "authors": "Wolfgang Hönig, James A. Preiss, T.. Kumar, Gaurav S. Sukhatme and Nora Ayanian"
    },
    {
      "index": 4,
      "title": "Fast and In Sync: Periodic Swarm Patterns for Quadrotors",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Xintong Du, Carlos E. Luis, Marijan Vukosavljev and Angela P. Schoellig",
      "orig_title": "Fast and In Sync: Periodic Swarm Patterns for Quadrotors",
      "paper_id": "1810.03572v2"
    },
    {
      "index": 5,
      "title": "Trajectory Planning for Heterogeneous Robot Teams",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE/RSJ Int. Conf. Intell. Robots Syst.",
      "authors": "Mark Debord, Wolfgang Hönig and Nora Ayanian"
    },
    {
      "index": 6,
      "title": "Reciprocal n-Body Collision Avoidance",
      "abstract": "",
      "year": "2009",
      "venue": "Int. Symp. on Robot. Res.",
      "authors": "Jur Berg, Stephen J. Guy, Ming C. Lin and Dinesh Manocha"
    },
    {
      "index": 7,
      "title": "Deep Sets",
      "abstract": "",
      "year": "2017",
      "venue": "Neural Inf. Process. Syst.",
      "authors": "Manzil Zaheer, Satwik Kottur, Siamak Ravanbakhsh, Barnabás Póczos, Ruslan Salakhutdinov and Alexander J. Smola",
      "orig_title": "Deep Sets",
      "paper_id": "1703.06114v3"
    },
    {
      "index": 8,
      "title": "Spectrally-normalized margin bounds for neural networks",
      "abstract": "",
      "year": "2017",
      "venue": "Neural Inf. Process. Syst.",
      "authors": "Peter L. Bartlett, Dylan J. Foster and Matus Telgarsky",
      "orig_title": "Spectrally-normalized margin bounds for neural networks",
      "paper_id": "1706.08498v2"
    },
    {
      "index": 9,
      "title": "Neural Lander: Stable Drone Landing Control Using Learned Dynamics",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Guanya Shi, Xichen Shi, Michael O’Connell, Rose Yu, Kamyar Azizzadenesheli, Animashree Anandkumar, Yisong Yue and Soon-Jo Chung",
      "orig_title": "Neural Lander: Stable Drone Landing Control Using Learned Dynamics",
      "paper_id": "1811.08027v2"
    },
    {
      "index": 10,
      "title": "Neural-Swarm: Decentralized Close-Proximity Multirotor Control Using Learned Interactions",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Guanya Shi, Wolfgang Hönig, Yisong Yue and Soon-Jo Chung",
      "orig_title": "Neural-Swarm: Decentralized Close-Proximity Multirotor Control Using Learned Interactions",
      "paper_id": "2003.02992v1"
    },
    {
      "index": 11,
      "title": "The effect of ground on a helicopter rotor in forward flight",
      "abstract": "",
      "year": "1955",
      "venue": "Aeronautical Research Council Reports And Memoranda",
      "authors": "IC Cheeseman and WE Bennett"
    },
    {
      "index": 12,
      "title": "An Empirical Model of Rotorcrafy UAV Downwash for Disturbance Localization and Avoidance",
      "abstract": "",
      "year": "2015",
      "venue": "AIAA Atmospheric Flight Mechanics Conf.",
      "authors": "Derrick Yeo, Elena Shrestha, Derek A. Paley and Ella M. Atkins"
    },
    {
      "index": 13,
      "title": "Analysis of Ground Effect for Small-Scale UAVs in Forward Flight",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "X. Kan, J. Thomas, H. Teng, H.. Tanner, V. Kumar and K. Karydis"
    },
    {
      "index": 14,
      "title": "Multirotor Drone Aerodynamic Interaction Investigation",
      "abstract": "",
      "year": "2018",
      "venue": "Drones",
      "authors": "Dhwanil Shukla and Narayanan Komerath"
    },
    {
      "index": 15,
      "title": "Meta-Learning-Based Robust Adaptive Flight Control Under Uncertain Wind Conditions",
      "abstract": "",
      "year": "2021",
      "venue": "arXiv preprint arXiv:2103.01932",
      "authors": "Michael O’Connell, Guanya Shi, Xichen Shi and Soon-Jo Chung",
      "orig_title": "Meta-learning-based robust adaptive flight control under uncertain wind conditions",
      "paper_id": "2103.01932v3"
    },
    {
      "index": 16,
      "title": "Smooth Imitation Learning for Online Sequence Prediction",
      "abstract": "",
      "year": "2016",
      "venue": "Int. Conf. Machine Learning",
      "authors": "Hoang Minh Le, Andrew Kang, Yisong Yue and Peter Carr",
      "orig_title": "Smooth Imitation Learning for Online Sequence Prediction",
      "paper_id": "1606.00968v1"
    },
    {
      "index": 17,
      "title": "Episodic Learning with Control Lyapunov Functions for Uncertain Robotic Systems*",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE/RSJ Int. Conf. Intell. Robots Syst.",
      "authors": "Andrew J. Taylor, Victor D. Dorobantu, Hoang M. Le, Yisong Yue and Aaron D. Ames",
      "orig_title": "Episodic Learning with Control Lyapunov Functions for Uncertain Robotic Systems",
      "paper_id": "1903.01577v1"
    },
    {
      "index": 18,
      "title": "Control Regularization for Reduced Variance Reinforcement Learning",
      "abstract": "",
      "year": "2019",
      "venue": "Int. Conf. Machine Learning",
      "authors": "Richard Cheng, Abhinav Verma, Gábor Orosz, Swarat Chaudhuri, Yisong Yue and Joel Burdick",
      "orig_title": "Control Regularization for Reduced Variance Reinforcement Learning",
      "paper_id": "1905.05380v1"
    },
    {
      "index": 19,
      "title": "Learn Fast, Forget Slow: Safe Predictive Learning Control for Systems with Unknown and Changing Dynamics Performing Repetitive Tasks",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Christopher D. McKinnon and Angela P. Schoellig",
      "orig_title": "Learn Fast, Forget Slow: Safe Predictive Learning Control for Systems With Unknown and Changing Dynamics Performing Repetitive Tasks",
      "paper_id": "1810.06681v3"
    },
    {
      "index": 20,
      "title": "Data-efficient control policy search using residual dynamics learning",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE/RSJ Int. Conf. Intell. Robots Syst.",
      "authors": "Matteo Saveriano, Yuchao Yin, Pietro Falco and Dongheui Lee"
    },
    {
      "index": 21,
      "title": "Residual Reinforcement Learning for Robot Control",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Tobias Johannink, Shikhar Bahl, Ashvin Nair, Jianlan Luo, Avinash Kumar, Matthias Loskyll, Juan Aparicio Ojea, Eugen Solowjow and Sergey Levine",
      "orig_title": "Residual Reinforcement Learning for Robot Control",
      "paper_id": "1812.03201v2"
    },
    {
      "index": 22,
      "title": "The graph neural network model",
      "abstract": "",
      "year": "2008",
      "venue": "IEEE Trans. Neural Netw.",
      "authors": "Franco Scarselli, Marco Gori, Ah Chung Tsoi, Markus Hagenbuchner and Gabriele Monfardini"
    },
    {
      "index": 23,
      "title": "Learning Decentralized Controllers for Robot Swarms with Graph Neural Networks",
      "abstract": "",
      "year": "2020",
      "venue": "Conf. Robot Learning",
      "authors": "Ekaterina Tolstaya, Fernando Gama, James Paulos, George Pappas, Vijay Kumar and Alejandro Ribeiro",
      "orig_title": "Learning decentralized controllers for robot swarms with graph neural networks",
      "paper_id": "1903.10527v4"
    },
    {
      "index": 24,
      "title": "Heterogeneous graph neural network",
      "abstract": "",
      "year": "2019",
      "venue": "ACM SIGKDD Int. Conf. Knowledge Discovery & Data Mining",
      "authors": "Chuxu Zhang, Dongjin Song, Chao Huang, Ananthram Swami and Nitesh V Chawla"
    },
    {
      "index": 25,
      "title": "GLAS: Global-to-Local Safe Autonomy Synthesis for Multi-Robot Motion Planning with End-to-End Learning",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Benjamin Rivière, Wolfgang Hönig, Yisong Yue and Soon-Jo Chung",
      "orig_title": "GLAS: Global-to-Local Safe Autonomy Synthesis for Multi-Robot Motion Planning With End-to-End Learning",
      "paper_id": "2002.11807v3"
    },
    {
      "index": 26,
      "title": "Model predictive control of swarms of spacecraft using sequential convex programming",
      "abstract": "",
      "year": "2014",
      "venue": "J. Guid., Control, Dyn.",
      "authors": "Daniel Morgan, Soon-Jo Chung and Fred Y Hadaegh"
    },
    {
      "index": 27,
      "title": "Mixed-integer quadratic program trajectory generation for heterogeneous quadrotor teams",
      "abstract": "",
      "year": "2012",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Daniel Mellinger, Aleksandr Kushleyev and Vijay Kumar"
    },
    {
      "index": 28,
      "title": "Approximation with artificial neural networks",
      "abstract": "",
      "year": "2001",
      "venue": "Faculty of Sciences, Etvs Lornd University, Hungary",
      "authors": "Balázs Csanád Csáji"
    },
    {
      "index": 29,
      "title": "Robust regression for safe exploration in control",
      "abstract": "",
      "year": "2020",
      "venue": "Learning for Dynamics and Control",
      "authors": "Anqi Liu, Guanya Shi, Soon-Jo Chung, Anima Anandkumar and Yisong Yue"
    },
    {
      "index": 30,
      "title": "Trajectory Generation for Multiagent Point-To-Point Transitions via Distributed Model Predictive Control",
      "abstract": "",
      "year": "2019",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Carlos E. Luis and Angela P. Schoellig",
      "orig_title": "Trajectory Generation for Multiagent Point-To-Point Transitions via Distributed Model Predictive Control",
      "paper_id": "1809.04230v2"
    },
    {
      "index": 31,
      "title": "Prioritized Planning Algorithms for Trajectory Coordination of Multiple Mobile Robots",
      "abstract": "",
      "year": "2015",
      "venue": "IEEE Trans. Autom. Sci. Eng.",
      "authors": "Michal Čáp, Peter Novák, Alexander Kleiner and Martin Selecký",
      "orig_title": "Prioritized Planning Algorithms for Trajectory Coordination of Multiple Mobile Robots",
      "paper_id": "1409.2399v1"
    },
    {
      "index": 32,
      "title": "Optimal Guidance and Control with Nonlinear Dynamics Using Sequential Convex Programming",
      "abstract": "",
      "year": "2020",
      "venue": "J. Guid., Control, Dyn.",
      "authors": "Rebecca Foust, Soon-Jo Chung and Fred Y. Hadaegh"
    },
    {
      "index": 33,
      "title": "Local Convergence of Sequential Convex Programming for Nonconvex Optimization",
      "abstract": "",
      "year": "2010",
      "venue": "Recent Advances in Optimization and Its Applications in Engineering",
      "authors": "Quoc Tran Dinh and Moritz Diehl"
    },
    {
      "index": 34,
      "title": "Asymptotically Optimal Planning by Feasible Kinodynamic Planning in State-Cost Space",
      "abstract": "",
      "year": "2016",
      "venue": "IEEE Trans. Robotics",
      "authors": "Kris Hauser and Yilun Zhou",
      "orig_title": "Asymptotically Optimal Planning by Feasible Kinodynamic Planning in a State-Cost Space",
      "paper_id": "1505.04098v1"
    },
    {
      "index": 35,
      "title": "Multidimensional Binary Search Trees Used for Associative Searching",
      "abstract": "",
      "year": "1975",
      "venue": "Commun. ACM",
      "authors": "Jon Louis Bentley"
    },
    {
      "index": 36,
      "title": "Kinodynamic RRTs with Fixed Time Step and Best-Input Extension Are Not Probabilistically Complete",
      "abstract": "",
      "year": "2015",
      "venue": "Int. Workshop Algorithmic Foundations of Robotics",
      "authors": "Tobias Kunz and Mike Stilman"
    },
    {
      "index": 37,
      "title": "Sampling-Based Algorithms for Optimal Motion Planning",
      "abstract": "",
      "year": "2011",
      "venue": "I. J. Robotics Res.",
      "authors": "Sertac Karaman and Emilio Frazzoli"
    },
    {
      "index": 38,
      "title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "abstract": "",
      "year": "2019",
      "venue": "Neural Inf. Process. Syst.",
      "authors": "Adam Paszke et al.",
      "orig_title": "PyTorch: An Imperative Style, High-Performance Deep Learning Library",
      "paper_id": "1912.01703v1"
    },
    {
      "index": 39,
      "title": "Chance-Constrained Trajectory Optimization for Safe Exploration and Learning of Nonlinear Systems",
      "abstract": "",
      "year": "2020",
      "venue": "IEEE Robotics and Automation Letters",
      "authors": "Yashwanth Kumar Nakka, Anqi Liu, Guanya Shi, Anima Anandkumar, Yisong Yue and Soon-Jo Chung",
      "orig_title": "Chance-constrained trajectory optimization for safe exploration and learning of nonlinear systems",
      "paper_id": "2005.04374v3"
    },
    {
      "index": 40,
      "title": "Nonlinear attitude control of spacecraft with a large captured object",
      "abstract": "",
      "year": "2016",
      "venue": "J. Guid., Control, Dyn.",
      "authors": "Saptarshi Bandyopadhyay, Soon-Jo Chung and Fred Y Hadaegh"
    },
    {
      "index": 41,
      "title": "Nonlinear control of autonomous flying cars with wings and distributed electric propulsion",
      "abstract": "",
      "year": "2018",
      "venue": "IEEE Conf. Decis. Control",
      "authors": "Xichen Shi, Kyunam Kim, Salar Rahili and Soon-Jo Chung"
    },
    {
      "index": 42,
      "title": "Numerical Predictive Control for Delay Compensation",
      "abstract": "",
      "year": "2020",
      "venue": "arXiv preprint arXiv:2009.14450",
      "authors": "Xichen Shi, Michael O’Connell and Soon-Jo Chung",
      "orig_title": "Numerical Predictive Control for Delay Compensation",
      "paper_id": "2009.14450v1"
    },
    {
      "index": 43,
      "title": "Crazyswarm: A large nano-quadcopter swarm",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "James A. Preiss, Wolfgang Hönig, Gaurav S. Sukhatme and Nora Ayanian"
    },
    {
      "index": 44,
      "title": "Crazyflie 2.0 Thrust Investigation",
      "abstract": "",
      "year": "2015",
      "venue": "",
      "authors": "Bitcraze"
    },
    {
      "index": 45,
      "title": "System Identification of the Crazyflie 2.0 Nano Quadrocopter",
      "abstract": "",
      "year": "2015",
      "venue": "ETH Zurich",
      "authors": "Julian Förster"
    },
    {
      "index": 46,
      "title": "Thrust Mixing, Saturation, and Body-Rate Control for Accurate Aggressive Quadrotor Flight",
      "abstract": "",
      "year": "2017",
      "venue": "IEEE Trans. Robot. Autom. Lett.",
      "authors": "Matthias Faessler, Davide Falanga and Davide Scaramuzza"
    },
    {
      "index": 47,
      "title": "Real-time obstacle avoidance for manipulators and mobile robots",
      "abstract": "",
      "year": "1985",
      "venue": "IEEE Int. Conf. Robot. Autom.",
      "authors": "Oussama Khatib"
    },
    {
      "index": 48,
      "title": "CVXPY: A Python-embedded modeling language for convex optimization",
      "abstract": "",
      "year": "2016",
      "venue": "J. Machine Learning Research",
      "authors": "Steven Diamond and Stephen Boyd"
    },
    {
      "index": 49,
      "title": "Gurobi Optimizer Reference Manual",
      "abstract": "",
      "year": "2020",
      "venue": "",
      "authors": "LLC Gurobi Optimization"
    }
  ]
}